Sort: all_nations.o_year ASC NULLS LAST
  Projection: all_nations.o_year, SUM(CASE WHEN all_nations.nation = Utf8("RUSSIA") THEN all_nations.volume ELSE Int64(0) END) / SUM(all_nations.volume) AS mkt_share
    Aggregate: groupBy=[[all_nations.o_year]], aggr=[[SUM(CASE WHEN all_nations.nation = Utf8("RUSSIA") THEN all_nations.volume ELSE Int64(0) END), SUM(all_nations.volume)]]
      SubqueryAlias: all_nations
        Projection: datepart(Utf8("YEAR"), orders.o_orderdate) AS o_year, lineitem.l_extendedprice * (Int64(1) - lineitem.l_discount) AS volume, n2.n_name AS nation
          Filter: part.p_partkey = lineitem.l_partkey AND supplier.s_suppkey = lineitem.l_suppkey AND lineitem.l_orderkey = orders.o_orderkey AND orders.o_custkey = customer.c_custkey AND customer.c_nationkey = n1.n_nationkey AND n1.n_regionkey = region.r_regionkey AND region.r_name = Utf8("EUROPE") AND supplier.s_nationkey = n2.n_nationkey AND orders.o_orderdate BETWEEN CAST(Utf8("1995-01-01") AS Date32) AND CAST(Utf8("1996-12-31") AS Date32) AND part.p_type = Utf8("SMALL PLATED TIN")
            CrossJoin:
              CrossJoin:
                CrossJoin:
                  CrossJoin:
                    CrossJoin:
                      CrossJoin:
                        CrossJoin:
                          TableScan: part
                          TableScan: supplier
                        TableScan: lineitem
                      TableScan: orders
                    TableScan: customer
                  SubqueryAlias: n1
                    TableScan: nation
                SubqueryAlias: n2
                  TableScan: nation
              TableScan: region