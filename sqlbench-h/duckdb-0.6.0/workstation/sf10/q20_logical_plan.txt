┌───────────────────────────┐                                                                                                                    
│          ORDER_BY         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          ORDERS:          │                                                                                                                    
│    supplier.s_name ASC    │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           s_name          │                                                                                                                    
│         s_address         │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│            SEMI           │                                                                                                                    
│       s_suppkey = #0      ├───────────────────────────────────────────┐                                                                        
│       EC = 0.000000       │                                           │                                                                        
│      COST = 0.000000      │                                           │                                                                        
└─────────────┬─────────────┘                                           │                                                                                                     
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │             #1            │                                                          
│ s_nationkey = n_nationkey ├──────────────┐              │                           │                                                          
│       EC = 0.000000       │              │              │                           │                                                          
│      COST = 0.000000      │              │              │                           │                                                          
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││        PARQUET_SCAN       ││           FILTER          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         s_suppkey         ││        n_nationkey        ││    (CAST(ps_availqty AS   │                                                          
│           s_name          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ DECIMAL(38,3)) > SUBQUERY)│                                                          
│         s_address         ││Filters: n_name=ROMANIA AND││                           │                                                          
│        s_nationkey        ││     n_name IS NOT NULL    ││                           │                                                          
│          EC=99960         ││            EC=0           ││                           │                                                          
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                                                                                       
                                                          ┌─────────────┴─────────────┐                                                          
                                                          │         HASH_JOIN         │                                                          
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                          │           SINGLE          │                                                          
                                                          │ ps_partkey IS NOT DISTINCT│                                                          
                                                          │       FROM ps_partkey     ├───────────────────────────────────────────┐              
                                                          │ ps_suppkey IS NOT DISTINCT│                                           │              
                                                          │       FROM ps_suppkey     │                                           │              
                                                          │       EC = 0.000000       │                                           │              
                                                          │      COST = 0.000000      │                                           │              
                                                          └─────────────┬─────────────┘                                           │                                           
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                                                          │         HASH_JOIN         │                             │         PROJECTION        │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │            SEMI           │                             │  (0.5 * sum(l_quantity))  │
                                                          │      ps_partkey = #0      ├──────────────┐              │             #0            │
                                                          │       EC = 0.000000       │              │              │             #1            │
                                                          │      COST = 0.000000      │              │              │                           │
                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │        PARQUET_SCAN       ││         PROJECTION        ││       HASH_GROUP_BY       │
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                          │         ps_partkey        ││             #0            ││             #0            │
                                                          │         ps_suppkey        ││                           ││             #1            │
                                                          │        ps_availqty        ││                           ││          sum(#2)          │
                                                          │         EC=7999944        ││                           ││                           │
                                                          └───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │           FILTER          ││         PROJECTION        │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │  prefix(p_name, 'brown')  ││         l_partkey         │
                                                                                       │                           ││         l_suppkey         │
                                                                                       │                           ││         l_quantity        │
                                                                                       └─────────────┬─────────────┘└─────────────┬─────────────┘                             
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │        PARQUET_SCAN       ││           FILTER          │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                       │         p_partkey         ││  ((l_partkey IS NOT NULL) │
                                                                                       │           p_name          ││ AND (l_suppkey IS NOT...  │
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │
                                                                                       │ Filters: p_name>=brown AND││                           │
                                                                                       │ p_name<browo AND p_name IS││                           │
                                                                                       │          NOT NULL         ││                           │
                                                                                       │         EC=1999968        ││                           │
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘                             
                                                                                                                    ┌─────────────┴─────────────┐
                                                                                                                    │        PARQUET_SCAN       │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         l_partkey         │
                                                                                                                    │         l_suppkey         │
                                                                                                                    │         l_quantity        │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │ Filters: l_shipdate>=1996 │
                                                                                                                    │-01-01 AND l_shipdate<...  │
                                                                                                                    │ -01 AND l_shipdate IS NOT │
                                                                                                                    │            NULL           │
                                                                                                                    │        EC=59955144        │
                                                                                                                    └───────────────────────────┘                             

