┌───────────────────────────┐                                                                                                                                                 
│          ORDER_BY         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          ORDERS:          │                                                                                                                                                 
│sum((partsupp.ps_supplycost│                                                                                                                                                 
│  * partsupp.ps_availqty)) │                                                                                                                                                 
│            DESC           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         ps_partkey        │                                                                                                                                                 
│           value           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│    PIECEWISE_MERGE_JOIN   │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│ CAST(sum((ps_supplycost * │                                                                                                                                                 
│ CAST(ps_availqty AS D...  ├────────────────────────────────────────────────────────────────────────┐                                                                        
│(18,0)))) AS DECIMAL(3...  │                                                                        │                                                                        
│         > SUBQUERY        │                                                                        │                                                                        
│       EC = 0.000000       │                                                                        │                                                                        
│      COST = 0.000000      │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │    UNGROUPED_AGGREGATE    │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │         first(#0)         │                                                          
│          sum(#1)          │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         ps_partkey        │                                                          │             #0            │                                                          
│   (ps_supplycost * CAST   │                                                          │                           │                                                          
│(ps_availqty AS DECIMA...  │                                                          │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │      STREAMING_LIMIT      │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                                                          
│           INNER           │                                                          │                           │                                                          
│   ps_suppkey = s_suppkey  ├──────────────┐                                           │                           │                                                          
│       EC = 0.000000       │              │                                           │                           │                                                          
│      COST = 0.000000      │              │                                           │                           │                                                          
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││         HASH_JOIN         │                             │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         ps_partkey        ││           INNER           │                             │ (sum((ps_supplycost * CAST│                                                          
│         ps_suppkey        ││ s_nationkey = n_nationkey ├──────────────┐              │(ps_availqty AS DECIMA...  │                                                          
│        ps_availqty        ││       EC = 0.000000       │              │              │    )))) * 0.0000100000)   │                                                          
│       ps_supplycost       ││      COST = 0.000000      │              │              │                           │                                                          
│         EC=7999944        ││                           │              │              │                           │                                                          
└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │        PARQUET_SCAN       ││        PARQUET_SCAN       ││    UNGROUPED_AGGREGATE    │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │         s_suppkey         ││        n_nationkey        ││          sum(#0)          │                                                          
                             │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
                             │          EC=99960         ││  Filters: n_name=PERU AND ││                           │                                                          
                             │                           ││     n_name IS NOT NULL    ││                           │                                                          
                             │                           ││            EC=0           ││                           │                                                          
                             └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                                                                                       
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         PROJECTION        │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │   (ps_supplycost * CAST   │                                                          
                                                                                       │(ps_availqty AS DECIMA...  │                                                          
                                                                                       └─────────────┬─────────────┘                                                                                       
                                                                                       ┌─────────────┴─────────────┐                                                          
                                                                                       │         HASH_JOIN         │                                                          
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                       │           INNER           │                                                          
                                                                                       │   ps_suppkey = s_suppkey  ├──────────────┐                                           
                                                                                       │       EC = 0.000000       │              │                                           
                                                                                       │      COST = 0.000000      │              │                                           
                                                                                       └─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │        PARQUET_SCAN       ││         HASH_JOIN         │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                       │         ps_suppkey        ││           INNER           │                             
                                                                                       │        ps_availqty        ││ s_nationkey = n_nationkey ├──────────────┐              
                                                                                       │       ps_supplycost       ││       EC = 0.000000       │              │              
                                                                                       │         EC=7999944        ││      COST = 0.000000      │              │              
                                                                                       └───────────────────────────┘└─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │        PARQUET_SCAN       ││        PARQUET_SCAN       │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │         s_suppkey         ││        n_nationkey        │
                                                                                                                    │        s_nationkey        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │          EC=99960         ││  Filters: n_name=PERU AND │
                                                                                                                    │                           ││     n_name IS NOT NULL    │
                                                                                                                    │                           ││            EC=0           │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

