AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(4) HashAggregate(keys=[], functions=[sum(CheckOverflow((promote_precision(cast(l_extendedprice#21 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#22 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[revenue#738])
   +- ShuffleQueryStage 3
      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#6482]
         +- *(3) HashAggregate(keys=[], functions=[partial_sum(CheckOverflow((promote_precision(cast(l_extendedprice#21 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#22 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[sum#743, isEmpty#744])
            +- *(3) Project [l_extendedprice#21, l_discount#22]
               +- *(3) BroadcastHashJoin [l_partkey#17L], [p_partkey#74L], Inner, BuildRight, (((((((p_brand#77 = Brand#41) AND p_container#80 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#20 >= 8.00)) AND (l_quantity#20 <= 18.00)) AND (p_size#79 <= 5)) OR (((((p_brand#77 = Brand#44) AND p_container#80 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#20 >= 12.00)) AND (l_quantity#20 <= 22.00)) AND (p_size#79 <= 10))) OR (((((p_brand#77 = Brand#34) AND p_container#80 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#20 >= 25.00)) AND (l_quantity#20 <= 35.00)) AND (p_size#79 <= 15))), false
                  :- AQEShuffleRead local
                  :  +- ShuffleQueryStage 0
                  :     +- Exchange hashpartitioning(l_partkey#17L, 200), ENSURE_REQUIREMENTS, [id=#6354]
                  :        +- *(1) Project [l_partkey#17L, l_quantity#20, l_extendedprice#21, l_discount#22]
                  :           +- *(1) Filter ((((isnotnull(l_shipinstruct#29) AND l_shipmode#30 IN (AIR,AIR REG)) AND (l_shipinstruct#29 = DELIVER IN PERSON)) AND isnotnull(l_partkey#17L)) AND ((((l_quantity#20 >= 8.00) AND (l_quantity#20 <= 18.00)) OR ((l_quantity#20 >= 12.00) AND (l_quantity#20 <= 22.00))) OR ((l_quantity#20 >= 25.00) AND (l_quantity#20 <= 35.00))))
                  :              +- *(1) ColumnarToRow
                  :                 +- FileScan parquet [l_partkey#17L,l_quantity#20,l_extendedprice#21,l_discount#22,l_shipinstruct#29,l_shipmode#30] Batched: true, DataFilters: [isnotnull(l_shipinstruct#29), l_shipmode#30 IN (AIR,AIR REG), (l_shipinstruct#29 = DELIVER IN PE..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf10-parquet/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipinstruct), In(l_shipmode, [AIR,AIR REG]), EqualTo(l_shipinstruct,DELIVER IN PERS..., ReadSchema: struct<l_partkey:bigint,l_quantity:decimal(11,2),l_extendedprice:decimal(11,2),l_discount:decimal...
                  +- BroadcastQueryStage 2
                     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [id=#6419]
                        +- AQEShuffleRead local
                           +- ShuffleQueryStage 1
                              +- Exchange hashpartitioning(p_partkey#74L, 200), ENSURE_REQUIREMENTS, [id=#6373]
                                 +- *(2) Filter (((isnotnull(p_size#79) AND (p_size#79 >= 1)) AND isnotnull(p_partkey#74L)) AND (((((p_brand#77 = Brand#41) AND p_container#80 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#79 <= 5)) OR (((p_brand#77 = Brand#44) AND p_container#80 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#79 <= 10))) OR (((p_brand#77 = Brand#34) AND p_container#80 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#79 <= 15))))
                                    +- *(2) ColumnarToRow
                                       +- FileScan parquet [p_partkey#74L,p_brand#77,p_size#79,p_container#80] Batched: true, DataFilters: [isnotnull(p_size#79), (p_size#79 >= 1), isnotnull(p_partkey#74L), (((((p_brand#77 = Brand#41) AN..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf10-parquet/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:bigint,p_brand:string,p_size:int,p_container:string>
+- == Initial Plan ==
   HashAggregate(keys=[], functions=[sum(CheckOverflow((promote_precision(cast(l_extendedprice#21 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#22 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[revenue#738])
   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#6320]
      +- HashAggregate(keys=[], functions=[partial_sum(CheckOverflow((promote_precision(cast(l_extendedprice#21 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#22 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[sum#743, isEmpty#744])
         +- Project [l_extendedprice#21, l_discount#22]
            +- SortMergeJoin [l_partkey#17L], [p_partkey#74L], Inner, (((((((p_brand#77 = Brand#41) AND p_container#80 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#20 >= 8.00)) AND (l_quantity#20 <= 18.00)) AND (p_size#79 <= 5)) OR (((((p_brand#77 = Brand#44) AND p_container#80 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#20 >= 12.00)) AND (l_quantity#20 <= 22.00)) AND (p_size#79 <= 10))) OR (((((p_brand#77 = Brand#34) AND p_container#80 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#20 >= 25.00)) AND (l_quantity#20 <= 35.00)) AND (p_size#79 <= 15)))
               :- Sort [l_partkey#17L ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(l_partkey#17L, 200), ENSURE_REQUIREMENTS, [id=#6312]
               :     +- Project [l_partkey#17L, l_quantity#20, l_extendedprice#21, l_discount#22]
               :        +- Filter ((((isnotnull(l_shipinstruct#29) AND l_shipmode#30 IN (AIR,AIR REG)) AND (l_shipinstruct#29 = DELIVER IN PERSON)) AND isnotnull(l_partkey#17L)) AND ((((l_quantity#20 >= 8.00) AND (l_quantity#20 <= 18.00)) OR ((l_quantity#20 >= 12.00) AND (l_quantity#20 <= 22.00))) OR ((l_quantity#20 >= 25.00) AND (l_quantity#20 <= 35.00))))
               :           +- FileScan parquet [l_partkey#17L,l_quantity#20,l_extendedprice#21,l_discount#22,l_shipinstruct#29,l_shipmode#30] Batched: true, DataFilters: [isnotnull(l_shipinstruct#29), l_shipmode#30 IN (AIR,AIR REG), (l_shipinstruct#29 = DELIVER IN PE..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf10-parquet/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipinstruct), In(l_shipmode, [AIR,AIR REG]), EqualTo(l_shipinstruct,DELIVER IN PERS..., ReadSchema: struct<l_partkey:bigint,l_quantity:decimal(11,2),l_extendedprice:decimal(11,2),l_discount:decimal...
               +- Sort [p_partkey#74L ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(p_partkey#74L, 200), ENSURE_REQUIREMENTS, [id=#6313]
                     +- Filter (((isnotnull(p_size#79) AND (p_size#79 >= 1)) AND isnotnull(p_partkey#74L)) AND (((((p_brand#77 = Brand#41) AND p_container#80 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#79 <= 5)) OR (((p_brand#77 = Brand#44) AND p_container#80 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#79 <= 10))) OR (((p_brand#77 = Brand#34) AND p_container#80 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#79 <= 15))))
                        +- FileScan parquet [p_partkey#74L,p_brand#77,p_size#79,p_container#80] Batched: true, DataFilters: [isnotnull(p_size#79), (p_size#79 >= 1), isnotnull(p_partkey#74L), (((((p_brand#77 = Brand#41) AN..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf10-parquet/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:bigint,p_brand:string,p_size:int,p_container:string>
