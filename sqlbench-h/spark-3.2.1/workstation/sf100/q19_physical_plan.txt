AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(4) HashAggregate(keys=[], functions=[sum(CheckOverflow((promote_precision(cast(l_extendedprice#79 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#80 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[revenue#814])
   +- ShuffleQueryStage 3
      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#7105]
         +- *(3) HashAggregate(keys=[], functions=[partial_sum(CheckOverflow((promote_precision(cast(l_extendedprice#79 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#80 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[sum#819, isEmpty#820])
            +- *(3) Project [l_extendedprice#79, l_discount#80]
               +- *(3) BroadcastHashJoin [l_partkey#75L], [p_partkey#14L], Inner, BuildRight, (((p_brand#17 = Brand#14) AND ((((p_container#20 IN (SM CASE,SM BOX,SM PACK,SM PKG) AND (l_quantity#78 >= 6.00)) AND (l_quantity#78 <= 16.00)) AND (p_size#19 <= 5)) OR (((p_container#20 IN (MED BAG,MED BOX,MED PKG,MED PACK) AND (l_quantity#78 >= 13.00)) AND (l_quantity#78 <= 23.00)) AND (p_size#19 <= 10)))) OR (((((p_brand#17 = Brand#53) AND p_container#20 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#78 >= 26.00)) AND (l_quantity#78 <= 36.00)) AND (p_size#19 <= 15))), false
                  :- AQEShuffleRead local
                  :  +- ShuffleQueryStage 0
                  :     +- Exchange hashpartitioning(l_partkey#75L, 200), ENSURE_REQUIREMENTS, [id=#6959]
                  :        +- *(1) Project [l_partkey#75L, l_quantity#78, l_extendedprice#79, l_discount#80]
                  :           +- *(1) Filter ((((isnotnull(l_shipinstruct#87) AND l_shipmode#88 IN (AIR,AIR REG)) AND (l_shipinstruct#87 = DELIVER IN PERSON)) AND isnotnull(l_partkey#75L)) AND ((((l_quantity#78 >= 6.00) AND (l_quantity#78 <= 16.00)) OR ((l_quantity#78 >= 13.00) AND (l_quantity#78 <= 23.00))) OR ((l_quantity#78 >= 26.00) AND (l_quantity#78 <= 36.00))))
                  :              +- *(1) ColumnarToRow
                  :                 +- FileScan parquet [l_partkey#75L,l_quantity#78,l_extendedprice#79,l_discount#80,l_shipinstruct#87,l_shipmode#88] Batched: true, DataFilters: [isnotnull(l_shipinstruct#87), l_shipmode#88 IN (AIR,AIR REG), (l_shipinstruct#87 = DELIVER IN PE..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf100-parquet/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipinstruct), In(l_shipmode, [AIR,AIR REG]), EqualTo(l_shipinstruct,DELIVER IN PERS..., ReadSchema: struct<l_partkey:bigint,l_quantity:decimal(11,2),l_extendedprice:decimal(11,2),l_discount:decimal...
                  +- BroadcastQueryStage 2
                     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [id=#7058]
                        +- AQEShuffleRead local
                           +- ShuffleQueryStage 1
                              +- Exchange hashpartitioning(p_partkey#14L, 200), ENSURE_REQUIREMENTS, [id=#6978]
                                 +- *(2) Filter (((isnotnull(p_size#19) AND (p_size#19 >= 1)) AND isnotnull(p_partkey#14L)) AND (((p_brand#17 = Brand#14) AND ((p_container#20 IN (SM CASE,SM BOX,SM PACK,SM PKG) AND (p_size#19 <= 5)) OR (p_container#20 IN (MED BAG,MED BOX,MED PKG,MED PACK) AND (p_size#19 <= 10)))) OR (((p_brand#17 = Brand#53) AND p_container#20 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#19 <= 15))))
                                    +- *(2) ColumnarToRow
                                       +- FileScan parquet [p_partkey#14L,p_brand#17,p_size#19,p_container#20] Batched: true, DataFilters: [isnotnull(p_size#19), (p_size#19 >= 1), isnotnull(p_partkey#14L), (((p_brand#17 = Brand#14) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf100-parquet/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(And(EqualTo(p_brand,Br..., ReadSchema: struct<p_partkey:bigint,p_brand:string,p_size:int,p_container:string>
+- == Initial Plan ==
   HashAggregate(keys=[], functions=[sum(CheckOverflow((promote_precision(cast(l_extendedprice#79 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#80 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[revenue#814])
   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#6925]
      +- HashAggregate(keys=[], functions=[partial_sum(CheckOverflow((promote_precision(cast(l_extendedprice#79 as decimal(12,2))) * promote_precision(CheckOverflow((1.00 - promote_precision(cast(l_discount#80 as decimal(12,2)))), DecimalType(12,2), true))), DecimalType(24,4), true))], output=[sum#819, isEmpty#820])
         +- Project [l_extendedprice#79, l_discount#80]
            +- SortMergeJoin [l_partkey#75L], [p_partkey#14L], Inner, (((p_brand#17 = Brand#14) AND ((((p_container#20 IN (SM CASE,SM BOX,SM PACK,SM PKG) AND (l_quantity#78 >= 6.00)) AND (l_quantity#78 <= 16.00)) AND (p_size#19 <= 5)) OR (((p_container#20 IN (MED BAG,MED BOX,MED PKG,MED PACK) AND (l_quantity#78 >= 13.00)) AND (l_quantity#78 <= 23.00)) AND (p_size#19 <= 10)))) OR (((((p_brand#17 = Brand#53) AND p_container#20 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#78 >= 26.00)) AND (l_quantity#78 <= 36.00)) AND (p_size#19 <= 15)))
               :- Sort [l_partkey#75L ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(l_partkey#75L, 200), ENSURE_REQUIREMENTS, [id=#6917]
               :     +- Project [l_partkey#75L, l_quantity#78, l_extendedprice#79, l_discount#80]
               :        +- Filter ((((isnotnull(l_shipinstruct#87) AND l_shipmode#88 IN (AIR,AIR REG)) AND (l_shipinstruct#87 = DELIVER IN PERSON)) AND isnotnull(l_partkey#75L)) AND ((((l_quantity#78 >= 6.00) AND (l_quantity#78 <= 16.00)) OR ((l_quantity#78 >= 13.00) AND (l_quantity#78 <= 23.00))) OR ((l_quantity#78 >= 26.00) AND (l_quantity#78 <= 36.00))))
               :           +- FileScan parquet [l_partkey#75L,l_quantity#78,l_extendedprice#79,l_discount#80,l_shipinstruct#87,l_shipmode#88] Batched: true, DataFilters: [isnotnull(l_shipinstruct#87), l_shipmode#88 IN (AIR,AIR REG), (l_shipinstruct#87 = DELIVER IN PE..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf100-parquet/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipinstruct), In(l_shipmode, [AIR,AIR REG]), EqualTo(l_shipinstruct,DELIVER IN PERS..., ReadSchema: struct<l_partkey:bigint,l_quantity:decimal(11,2),l_extendedprice:decimal(11,2),l_discount:decimal...
               +- Sort [p_partkey#14L ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(p_partkey#14L, 200), ENSURE_REQUIREMENTS, [id=#6918]
                     +- Filter (((isnotnull(p_size#19) AND (p_size#19 >= 1)) AND isnotnull(p_partkey#14L)) AND (((p_brand#17 = Brand#14) AND ((p_container#20 IN (SM CASE,SM BOX,SM PACK,SM PKG) AND (p_size#19 <= 5)) OR (p_container#20 IN (MED BAG,MED BOX,MED PKG,MED PACK) AND (p_size#19 <= 10)))) OR (((p_brand#17 = Brand#53) AND p_container#20 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#19 <= 15))))
                        +- FileScan parquet [p_partkey#14L,p_brand#17,p_size#19,p_container#20] Batched: true, DataFilters: [isnotnull(p_size#19), (p_size#19 >= 1), isnotnull(p_partkey#14L), (((p_brand#17 = Brand#14) AND ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpch/sf100-parquet/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(And(EqualTo(p_brand,Br..., ReadSchema: struct<p_partkey:bigint,p_brand:string,p_size:int,p_container:string>
