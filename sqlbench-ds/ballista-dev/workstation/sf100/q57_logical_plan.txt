+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |   Sort: CAST(v2.sum_sales AS Decimal128(22, 6)) - CAST(v2.avg_monthly_sales AS Decimal128(22, 6)) ASC NULLS LAST, v2.psum ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |     Projection: v2.cc_name, v2.d_year, v2.avg_monthly_sales, v2.sum_sales, v2.psum, v2.nsum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |       SubqueryAlias: v2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |         Projection: v1.cc_name, v1.d_year, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |           Projection: v1.cc_name, v1.d_year, v1.sum_sales, v1.avg_monthly_sales, v1_lag.sum_sales, v1_lead.sum_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |             Filter: CAST(v1.rn AS Int64) = CAST(v1_lead.rn AS Int64) - Int64(1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |               Inner Join: v1.i_category = v1_lead.i_category, v1.i_brand = v1_lead.i_brand, v1.cc_name = v1_lead.cc_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                 Filter: CAST(v1.rn AS Int64) = CAST(v1_lag.rn AS Int64) + Int64(1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                   Inner Join: v1.i_category = v1_lag.i_category, v1.i_brand = v1_lag.i_brand, v1.cc_name = v1_lag.cc_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                     SubqueryAlias: v1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                       Projection: item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, SUM(catalog_sales.cs_sales_price) AS sum_sales, AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                         Projection: AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year], RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST], item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, SUM(catalog_sales.cs_sales_price)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           Filter: date_dim.d_year = Int32(1999) AND AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] AND CASE WHEN AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] THEN abs(CAST(CAST(SUM(catalog_sales.cs_sales_price) AS Decimal128(22, 6)) - CAST(AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] AS Decimal128(22, 6)) AS Float64)) / CAST(AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] AS Float64) ELSE Float64(NULL) END > Float64(0.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             Projection: AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6) AS AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year], AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year], RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST], item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, SUM(catalog_sales.cs_sales_price)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                               WindowAggr: windowExpr=[[AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                 WindowAggr: windowExpr=[[RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                   Aggregate: groupBy=[[item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, date_dim.d_moy]], aggr=[[SUM(catalog_sales.cs_sales_price)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     Inner Join: catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       Inner Join: catalog_sales.cs_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                         Inner Join: item.i_item_sk = catalog_sales.cs_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                           TableScan: item projection=[i_item_sk, i_brand, i_category]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                           TableScan: catalog_sales projection=[cs_sold_date_sk, cs_call_center_sk, cs_item_sk, cs_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                         Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                           Filter: (date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year) AND (date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year) AND (date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                             Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               TableScan: date_dim projection=[d_date_sk, d_year, d_moy], partial_filters=[date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                       TableScan: call_center projection=[cc_call_center_sk, cc_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                     SubqueryAlias: v1_lag                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                       SubqueryAlias: v1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                         Projection: item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, SUM(catalog_sales.cs_sales_price) AS sum_sales, AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                           WindowAggr: windowExpr=[[AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                             WindowAggr: windowExpr=[[RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                               Aggregate: groupBy=[[item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, date_dim.d_moy]], aggr=[[SUM(catalog_sales.cs_sales_price)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                 Inner Join: catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   Inner Join: catalog_sales.cs_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     Inner Join: item.i_item_sk = catalog_sales.cs_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                       TableScan: item projection=[i_item_sk, i_brand, i_category]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                       TableScan: catalog_sales projection=[cs_sold_date_sk, cs_call_center_sk, cs_item_sk, cs_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                     Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                       Filter: (date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year) AND (date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year) AND (date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           TableScan: date_dim projection=[d_date_sk, d_year, d_moy], partial_filters=[date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   TableScan: call_center projection=[cc_call_center_sk, cc_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                 SubqueryAlias: v1_lead                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   SubqueryAlias: v1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                     Projection: item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, SUM(catalog_sales.cs_sales_price) AS sum_sales, AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                       WindowAggr: windowExpr=[[AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                         WindowAggr: windowExpr=[[RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                           Aggregate: groupBy=[[item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year, date_dim.d_moy]], aggr=[[SUM(catalog_sales.cs_sales_price)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             Inner Join: catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               Inner Join: catalog_sales.cs_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 Inner Join: item.i_item_sk = catalog_sales.cs_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   TableScan: item projection=[i_item_sk, i_brand, i_category]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                   TableScan: catalog_sales projection=[cs_sold_date_sk, cs_call_center_sk, cs_item_sk, cs_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                 Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                   Filter: (date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year) AND (date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year) AND (date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                     Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       TableScan: date_dim projection=[d_date_sk, d_year, d_moy], partial_filters=[date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2000), date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               TableScan: call_center projection=[cc_call_center_sk, cc_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| physical_plan | GlobalLimitExec: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |   SortPreservingMergeExec: [CAST(sum_sales@3 AS Decimal128(22, 6)) - CAST(avg_monthly_sales@2 AS Decimal128(22, 6)) ASC NULLS LAST,psum@4 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     SortExec: [CAST(sum_sales@3 AS Decimal128(22, 6)) - CAST(avg_monthly_sales@2 AS Decimal128(22, 6)) ASC NULLS LAST,psum@4 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |       ProjectionExec: expr=[cc_name@0 as cc_name, d_year@1 as d_year, avg_monthly_sales@2 as avg_monthly_sales, sum_sales@3 as sum_sales, psum@4 as psum, nsum@5 as nsum]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |         ProjectionExec: expr=[cc_name@0 as cc_name, d_year@1 as d_year, avg_monthly_sales@3 as avg_monthly_sales, sum_sales@2 as sum_sales, sum_sales@4 as psum, sum_sales@5 as nsum]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |           ProjectionExec: expr=[cc_name@2 as cc_name, d_year@3 as d_year, sum_sales@4 as sum_sales, avg_monthly_sales@5 as avg_monthly_sales, sum_sales@11 as sum_sales, sum_sales@18 as sum_sales]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |               FilterExec: CAST(rn@6 AS Int64) = CAST(rn@20 AS Int64) - 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                 CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_category", index: 0 }, Column { name: "i_category", index: 0 }), (Column { name: "i_brand", index: 1 }, Column { name: "i_brand", index: 1 }), (Column { name: "cc_name", index: 2 }, Column { name: "cc_name", index: 2 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                       FilterExec: CAST(rn@6 AS Int64) = CAST(rn@13 AS Int64) + 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                         CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_category", index: 0 }, Column { name: "i_category", index: 0 }), (Column { name: "i_brand", index: 1 }, Column { name: "i_brand", index: 1 }), (Column { name: "cc_name", index: 2 }, Column { name: "cc_name", index: 2 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                 ProjectionExec: expr=[i_category@2 as i_category, i_brand@3 as i_brand, cc_name@4 as cc_name, d_year@5 as d_year, SUM(catalog_sales.cs_sales_price)@6 as sum_sales, AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 as avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as rn]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                   ProjectionExec: expr=[AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@1 as AVG(SUM(catalog_sales.cs_sales_price)), RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@2 as RANK(), i_category@3 as i_category, i_brand@4 as i_brand, cc_name@5 as cc_name, d_year@6 as d_year, SUM(catalog_sales.cs_sales_price)@7 as SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       FilterExec: d_year@6 = 1999 AND AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 AND CASE WHEN AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 THEN abs(CAST(CAST(SUM(catalog_sales.cs_sales_price)@7 AS Decimal128(22, 6)) - CAST(AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@1 AS Decimal128(22, 6)) AS Float64)) / CAST(AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@1 AS Float64) ELSE NULL END > 0.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                         ProjectionExec: expr=[AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 > Some(0),21,6 as AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year], AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 as AVG(SUM(catalog_sales.cs_sales_price)), RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as RANK(), i_category@2 as i_category, i_brand@3 as i_brand, cc_name@4 as cc_name, d_year@5 as d_year, SUM(catalog_sales.cs_sales_price)@7 as SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                           WindowAggExec: wdw=[AVG(SUM(catalog_sales.cs_sales_price)): Ok(Field { name: "AVG(SUM(catalog_sales.cs_sales_price))", data_type: Decimal128(21, 6), nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                             SortExec: [i_category@1 ASC,i_brand@2 ASC,cc_name@3 ASC,d_year@4 ASC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                 RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 1 }, Column { name: "i_brand", index: 2 }, Column { name: "cc_name", index: 3 }, Column { name: "d_year", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   WindowAggExec: wdw=[RANK(): Ok(Field { name: "RANK()", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                     SortExec: [i_category@0 ASC,i_brand@1 ASC,cc_name@2 ASC,d_year@3 ASC NULLS LAST,d_moy@4 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                           AggregateExec: mode=FinalPartitioned, gby=[i_category@0 as i_category, i_brand@1 as i_brand, cc_name@2 as cc_name, d_year@3 as d_year, d_moy@4 as d_moy], aggr=[SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }, Column { name: "d_year", index: 3 }, Column { name: "d_moy", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                                 AggregateExec: mode=Partial, gby=[i_category@2 as i_category, i_brand@1 as i_brand, cc_name@11 as cc_name, d_year@8 as d_year, d_moy@9 as d_moy], aggr=[SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "cs_call_center_sk", index: 4 }, Column { name: "cc_call_center_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "cs_call_center_sk", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "cs_sold_date_sk", index: 3 }, Column { name: "d_date_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "cs_sold_date_sk", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_item_sk", index: 0 }, Column { name: "cs_item_sk", index: 2 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                                         RepartitionExec: partitioning=Hash([Column { name: "i_item_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00012-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00008-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00006-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00013-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00007-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00002-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00004-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00010-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00001-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00000-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00011-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00003-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00009-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00005-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet], projection=[i_item_sk, i_brand, i_category]                                           |
|               |                                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                                         RepartitionExec: partitioning=Hash([Column { name: "cs_item_sk", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00006-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00005-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00003-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00000-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00007-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00002-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00001-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00004-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet], projection=[cs_sold_date_sk, cs_call_center_sk, cs_item_sk, cs_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "d_date_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                                   ProjectionExec: expr=[d_date_sk@4 as d_date_sk, d_year@5 as d_year, d_moy@6 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                                       FilterExec: date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@2 OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@3 AND date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@2 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0 AND date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@1 OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@3 AND date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@1 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                         ProjectionExec: expr=[d_moy@2 = 1 as date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, d_year@1 = 1999 OR d_moy@2 = 12 as date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, d_year@1 = 1999 OR d_year@1 = 1998 as date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, d_year@1 = 2000 as date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_date_sk@0 as d_date_sk, d_year@1 as d_year, d_moy@2 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00002-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00000-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00001-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet], predicate=(d_year = Int32(1999) OR d_year = Int32(1998) OR d_year = Int32(2000)) AND (d_year = Int32(1999) OR d_year = Int32(1998) OR d_moy = Int32(1)) AND (d_year = Int32(1999) OR d_moy = Int32(12) OR d_year = Int32(2000)) AND (d_year = Int32(1999) OR d_moy = Int32(12) OR d_moy = Int32(1)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_year = Int32(1998) OR d_year = Int32(2000)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_year = Int32(1998) OR d_moy = Int32(1)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_moy = Int32(12) OR d_year = Int32(2000)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_moy = Int32(12) OR d_moy = Int32(1)), pruning_predicate=d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 1998 AND 1998 <= d_year_max@1 OR d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 1998 AND 1998 <= d_year_max@1 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3, projection=[d_date_sk, d_year, d_moy] |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "cc_call_center_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/call_center.parquet/part-00000-d152ce56-3249-465f-a04d-5b331ec639ec-c000.snappy.parquet], projection=[cc_call_center_sk, cc_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                 ProjectionExec: expr=[i_category@2 as i_category, i_brand@3 as i_brand, cc_name@4 as cc_name, d_year@5 as d_year, SUM(catalog_sales.cs_sales_price)@7 as sum_sales, AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 as avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as rn]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                   WindowAggExec: wdw=[AVG(SUM(catalog_sales.cs_sales_price)): Ok(Field { name: "AVG(SUM(catalog_sales.cs_sales_price))", data_type: Decimal128(21, 6), nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                     SortExec: [i_category@1 ASC,i_brand@2 ASC,cc_name@3 ASC,d_year@4 ASC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                         RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 1 }, Column { name: "i_brand", index: 2 }, Column { name: "cc_name", index: 3 }, Column { name: "d_year", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           WindowAggExec: wdw=[RANK(): Ok(Field { name: "RANK()", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             SortExec: [i_category@0 ASC,i_brand@1 ASC,cc_name@2 ASC,d_year@3 ASC NULLS LAST,d_moy@4 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                 RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                   AggregateExec: mode=FinalPartitioned, gby=[i_category@0 as i_category, i_brand@1 as i_brand, cc_name@2 as cc_name, d_year@3 as d_year, d_moy@4 as d_moy], aggr=[SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                       RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }, Column { name: "d_year", index: 3 }, Column { name: "d_moy", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                         AggregateExec: mode=Partial, gby=[i_category@2 as i_category, i_brand@1 as i_brand, cc_name@11 as cc_name, d_year@8 as d_year, d_moy@9 as d_moy], aggr=[SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "cs_call_center_sk", index: 4 }, Column { name: "cc_call_center_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "cs_call_center_sk", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "cs_sold_date_sk", index: 3 }, Column { name: "d_date_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "cs_sold_date_sk", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_item_sk", index: 0 }, Column { name: "cs_item_sk", index: 2 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "i_item_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00012-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00008-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00006-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00013-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00007-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00002-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00004-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00010-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00001-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00000-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00011-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00003-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00009-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00005-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet], projection=[i_item_sk, i_brand, i_category]                                                   |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "cs_item_sk", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00006-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00005-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00003-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00000-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00007-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00002-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00001-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00004-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet], projection=[cs_sold_date_sk, cs_call_center_sk, cs_item_sk, cs_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "d_date_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                           ProjectionExec: expr=[d_date_sk@4 as d_date_sk, d_year@5 as d_year, d_moy@6 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                               FilterExec: date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@2 OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@3 AND date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@2 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0 AND date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@1 OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@3 AND date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@1 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                 ProjectionExec: expr=[d_moy@2 = 1 as date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, d_year@1 = 1999 OR d_moy@2 = 12 as date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, d_year@1 = 1999 OR d_year@1 = 1998 as date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, d_year@1 = 2000 as date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_date_sk@0 as d_date_sk, d_year@1 as d_year, d_moy@2 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00002-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00000-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00001-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet], predicate=(d_year = Int32(1999) OR d_year = Int32(1998) OR d_year = Int32(2000)) AND (d_year = Int32(1999) OR d_year = Int32(1998) OR d_moy = Int32(1)) AND (d_year = Int32(1999) OR d_moy = Int32(12) OR d_year = Int32(2000)) AND (d_year = Int32(1999) OR d_moy = Int32(12) OR d_moy = Int32(1)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_year = Int32(1998) OR d_year = Int32(2000)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_year = Int32(1998) OR d_moy = Int32(1)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_moy = Int32(12) OR d_year = Int32(2000)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_moy = Int32(12) OR d_moy = Int32(1)), pruning_predicate=d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 1998 AND 1998 <= d_year_max@1 OR d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 1998 AND 1998 <= d_year_max@1 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3, projection=[d_date_sk, d_year, d_moy]         |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "cc_call_center_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/call_center.parquet/part-00000-d152ce56-3249-465f-a04d-5b331ec639ec-c000.snappy.parquet], projection=[cc_call_center_sk, cc_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                       RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                         ProjectionExec: expr=[i_category@2 as i_category, i_brand@3 as i_brand, cc_name@4 as cc_name, d_year@5 as d_year, SUM(catalog_sales.cs_sales_price)@7 as sum_sales, AVG(SUM(catalog_sales.cs_sales_price)) PARTITION BY [item.i_category, item.i_brand, call_center.cc_name, date_dim.d_year]@0 as avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, call_center.cc_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as rn]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           WindowAggExec: wdw=[AVG(SUM(catalog_sales.cs_sales_price)): Ok(Field { name: "AVG(SUM(catalog_sales.cs_sales_price))", data_type: Decimal128(21, 6), nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                             SortExec: [i_category@1 ASC,i_brand@2 ASC,cc_name@3 ASC,d_year@4 ASC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 1 }, Column { name: "i_brand", index: 2 }, Column { name: "cc_name", index: 3 }, Column { name: "d_year", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   WindowAggExec: wdw=[RANK(): Ok(Field { name: "RANK()", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                     SortExec: [i_category@0 ASC,i_brand@1 ASC,cc_name@2 ASC,d_year@3 ASC NULLS LAST,d_moy@4 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                         RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                           AggregateExec: mode=FinalPartitioned, gby=[i_category@0 as i_category, i_brand@1 as i_brand, cc_name@2 as cc_name, d_year@3 as d_year, d_moy@4 as d_moy], aggr=[SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "cc_name", index: 2 }, Column { name: "d_year", index: 3 }, Column { name: "d_moy", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                 AggregateExec: mode=Partial, gby=[i_category@2 as i_category, i_brand@1 as i_brand, cc_name@11 as cc_name, d_year@8 as d_year, d_moy@9 as d_moy], aggr=[SUM(catalog_sales.cs_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "cs_call_center_sk", index: 4 }, Column { name: "cc_call_center_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         RepartitionExec: partitioning=Hash([Column { name: "cs_call_center_sk", index: 4 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "cs_sold_date_sk", index: 3 }, Column { name: "d_date_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "cs_sold_date_sk", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_item_sk", index: 0 }, Column { name: "cs_item_sk", index: 2 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "i_item_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00012-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00008-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00006-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00013-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00007-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00002-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00004-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00010-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00001-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00000-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00011-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00003-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00009-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00005-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet], projection=[i_item_sk, i_brand, i_category]                                                           |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "cs_item_sk", index: 2 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00006-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00005-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00003-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00000-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00007-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00002-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00001-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet/part-00004-e71f6b55-81a6-46c0-a9c6-432a555096e7-c000.snappy.parquet], projection=[cs_sold_date_sk, cs_call_center_sk, cs_item_sk, cs_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "d_date_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                   ProjectionExec: expr=[d_date_sk@4 as d_date_sk, d_year@5 as d_year, d_moy@6 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                       FilterExec: date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@2 OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@3 AND date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@2 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0 AND date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@1 OR date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@3 AND date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year@1 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                         ProjectionExec: expr=[d_moy@2 = 1 as date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, d_year@1 = 1999 OR d_moy@2 = 12 as date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, d_year@1 = 1999 OR d_year@1 = 1998 as date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(1998)date_dim.d_year = Int32(1998)Int32(1998)date_dim.d_yeardate_dim.d_year = Int32(1999)Int32(1999)date_dim.d_year, d_year@1 = 2000 as date_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_date_sk@0 as d_date_sk, d_year@1 as d_year, d_moy@2 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00002-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00000-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00001-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet], predicate=(d_year = Int32(1999) OR d_year = Int32(1998) OR d_year = Int32(2000)) AND (d_year = Int32(1999) OR d_year = Int32(1998) OR d_moy = Int32(1)) AND (d_year = Int32(1999) OR d_moy = Int32(12) OR d_year = Int32(2000)) AND (d_year = Int32(1999) OR d_moy = Int32(12) OR d_moy = Int32(1)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_year = Int32(1998) OR d_year = Int32(2000)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_year = Int32(1998) OR d_moy = Int32(1)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_moy = Int32(12) OR d_year = Int32(2000)) AND (d_year = Int32(1999) AS date_dim.d_year = Int32(1999) OR d_moy = Int32(12) OR d_moy = Int32(1)), pruning_predicate=d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 1998 AND 1998 <= d_year_max@1 OR d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 1998 AND 1998 <= d_year_max@1 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 AND d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3, projection=[d_date_sk, d_year, d_moy]                 |
|               |                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         RepartitionExec: partitioning=Hash([Column { name: "cc_call_center_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/call_center.parquet/part-00000-d152ce56-3249-465f-a04d-5b331ec639ec-c000.snappy.parquet], projection=[cc_call_center_sk, cc_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+