+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |   Sort: CAST(v2.sum_sales AS Decimal128(22, 6)) - CAST(v2.avg_monthly_sales AS Decimal128(22, 6)) ASC NULLS LAST, v2.psum ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |     Projection: v2.i_category, v2.i_brand, v2.d_year, v2.d_moy, v2.avg_monthly_sales, v2.sum_sales, v2.psum, v2.nsum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |       SubqueryAlias: v2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |         Projection: v1.i_category, v1.i_brand, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |           Projection: v1.i_category, v1.i_brand, v1.d_year, v1.d_moy, v1.sum_sales, v1.avg_monthly_sales, v1_lag.sum_sales, v1_lead.sum_sales                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |             Filter: CAST(v1.rn AS Int64) = CAST(v1_lead.rn AS Int64) - Int64(1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |               Inner Join: v1.i_category = v1_lead.i_category, v1.i_brand = v1_lead.i_brand, v1.s_store_name = v1_lead.s_store_name, v1.s_company_name = v1_lead.s_company_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                 Filter: CAST(v1.rn AS Int64) = CAST(v1_lag.rn AS Int64) + Int64(1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                   Inner Join: v1.i_category = v1_lag.i_category, v1.i_brand = v1_lag.i_brand, v1.s_store_name = v1_lag.s_store_name, v1.s_company_name = v1_lag.s_company_name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                     SubqueryAlias: v1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                       Projection: item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                         Projection: AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST], item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                           Filter: date_dim.d_year = Int32(2000) AND AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AND CASE WHEN AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] THEN abs(CAST(CAST(SUM(store_sales.ss_sales_price) AS Decimal128(22, 6)) - CAST(AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS Decimal128(22, 6)) AS Float64)) / CAST(AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS Float64) ELSE Float64(NULL) END > Float64(0.1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             Projection: AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6) AS AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST], item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                               WindowAggr: windowExpr=[[AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 WindowAggr: windowExpr=[[RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   Aggregate: groupBy=[[item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy]], aggr=[[SUM(store_sales.ss_sales_price)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                     Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                       Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                         Inner Join: item.i_item_sk = store_sales.ss_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                           TableScan: item projection=[i_item_sk, i_brand, i_category]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                           TableScan: store_sales projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                         Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                           Filter: (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                             Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2001) AS date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               TableScan: date_dim projection=[d_date_sk, d_year, d_moy], partial_filters=[date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                       TableScan: store projection=[s_store_sk, s_store_name, s_company_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                     SubqueryAlias: v1_lag                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                       SubqueryAlias: v1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                         Projection: item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                           WindowAggr: windowExpr=[[AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                             WindowAggr: windowExpr=[[RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               Aggregate: groupBy=[[item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy]], aggr=[[SUM(store_sales.ss_sales_price)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                 Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                     Inner Join: item.i_item_sk = store_sales.ss_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                       TableScan: item projection=[i_item_sk, i_brand, i_category]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                       TableScan: store_sales projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                     Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                       Filter: (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2001) AS date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           TableScan: date_dim projection=[d_date_sk, d_year, d_moy], partial_filters=[date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   TableScan: store projection=[s_store_sk, s_store_name, s_company_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                 SubqueryAlias: v1_lead                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   SubqueryAlias: v1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                     Projection: item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                       WindowAggr: windowExpr=[[AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         WindowAggr: windowExpr=[[RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                           Aggregate: groupBy=[[item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy]], aggr=[[SUM(store_sales.ss_sales_price)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                             Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                               Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                 Inner Join: item.i_item_sk = store_sales.ss_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                   TableScan: item projection=[i_item_sk, i_brand, i_category]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                   TableScan: store_sales projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                 Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                   Filter: (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                     Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2001) AS date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       TableScan: date_dim projection=[d_date_sk, d_year, d_moy], partial_filters=[date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) OR date_dim.d_moy = Int32(1), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_year = Int32(2001), date_dim.d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) OR date_dim.d_moy = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               TableScan: store projection=[s_store_sk, s_store_name, s_company_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| physical_plan | GlobalLimitExec: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |   SortPreservingMergeExec: [CAST(sum_sales@5 AS Decimal128(22, 6)) - CAST(avg_monthly_sales@4 AS Decimal128(22, 6)) ASC NULLS LAST,psum@6 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     SortExec: [CAST(sum_sales@5 AS Decimal128(22, 6)) - CAST(avg_monthly_sales@4 AS Decimal128(22, 6)) ASC NULLS LAST,psum@6 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |       ProjectionExec: expr=[i_category@0 as i_category, i_brand@1 as i_brand, d_year@2 as d_year, d_moy@3 as d_moy, avg_monthly_sales@4 as avg_monthly_sales, sum_sales@5 as sum_sales, psum@6 as psum, nsum@7 as nsum]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |         ProjectionExec: expr=[i_category@0 as i_category, i_brand@1 as i_brand, d_year@2 as d_year, d_moy@3 as d_moy, avg_monthly_sales@5 as avg_monthly_sales, sum_sales@4 as sum_sales, sum_sales@6 as psum, sum_sales@7 as nsum]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |           ProjectionExec: expr=[i_category@0 as i_category, i_brand@1 as i_brand, d_year@4 as d_year, d_moy@5 as d_moy, sum_sales@6 as sum_sales, avg_monthly_sales@7 as avg_monthly_sales, sum_sales@15 as sum_sales, sum_sales@24 as sum_sales]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |               FilterExec: CAST(rn@8 AS Int64) = CAST(rn@26 AS Int64) - 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                 CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_category", index: 0 }, Column { name: "i_category", index: 0 }), (Column { name: "i_brand", index: 1 }, Column { name: "i_brand", index: 1 }), (Column { name: "s_store_name", index: 2 }, Column { name: "s_store_name", index: 2 }), (Column { name: "s_company_name", index: 3 }, Column { name: "s_company_name", index: 3 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                       FilterExec: CAST(rn@8 AS Int64) = CAST(rn@17 AS Int64) + 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                         CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_category", index: 0 }, Column { name: "i_category", index: 0 }), (Column { name: "i_brand", index: 1 }, Column { name: "i_brand", index: 1 }), (Column { name: "s_store_name", index: 2 }, Column { name: "s_store_name", index: 2 }), (Column { name: "s_company_name", index: 3 }, Column { name: "s_company_name", index: 3 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                 ProjectionExec: expr=[i_category@2 as i_category, i_brand@3 as i_brand, s_store_name@4 as s_store_name, s_company_name@5 as s_company_name, d_year@6 as d_year, d_moy@7 as d_moy, SUM(store_sales.ss_sales_price)@8 as sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 as avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as rn]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   ProjectionExec: expr=[AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@1 as AVG(SUM(store_sales.ss_sales_price)), RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@2 as RANK(), i_category@3 as i_category, i_brand@4 as i_brand, s_store_name@5 as s_store_name, s_company_name@6 as s_company_name, d_year@7 as d_year, d_moy@8 as d_moy, SUM(store_sales.ss_sales_price)@9 as SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       FilterExec: d_year@7 = 2000 AND AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 AND CASE WHEN AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 THEN abs(CAST(CAST(SUM(store_sales.ss_sales_price)@9 AS Decimal128(22, 6)) - CAST(AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@1 AS Decimal128(22, 6)) AS Float64)) / CAST(AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@1 AS Float64) ELSE NULL END > 0.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                         ProjectionExec: expr=[AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 > Some(0),21,6 as AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 as AVG(SUM(store_sales.ss_sales_price)), RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as RANK(), i_category@2 as i_category, i_brand@3 as i_brand, s_store_name@4 as s_store_name, s_company_name@5 as s_company_name, d_year@6 as d_year, d_moy@7 as d_moy, SUM(store_sales.ss_sales_price)@8 as SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                           WindowAggExec: wdw=[AVG(SUM(store_sales.ss_sales_price)): Ok(Field { name: "AVG(SUM(store_sales.ss_sales_price))", data_type: Decimal128(21, 6), nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                             SortExec: [i_category@1 ASC,i_brand@2 ASC,s_store_name@3 ASC,s_company_name@4 ASC,d_year@5 ASC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                 RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 1 }, Column { name: "i_brand", index: 2 }, Column { name: "s_store_name", index: 3 }, Column { name: "s_company_name", index: 4 }, Column { name: "d_year", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                   WindowAggExec: wdw=[RANK(): Ok(Field { name: "RANK()", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                     SortExec: [i_category@0 ASC,i_brand@1 ASC,s_store_name@2 ASC,s_company_name@3 ASC,d_year@4 ASC NULLS LAST,d_moy@5 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                           AggregateExec: mode=FinalPartitioned, gby=[i_category@0 as i_category, i_brand@1 as i_brand, s_store_name@2 as s_store_name, s_company_name@3 as s_company_name, d_year@4 as d_year, d_moy@5 as d_moy], aggr=[SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }, Column { name: "d_year", index: 4 }, Column { name: "d_moy", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                 AggregateExec: mode=Partial, gby=[i_category@2 as i_category, i_brand@1 as i_brand, s_store_name@11 as s_store_name, s_company_name@12 as s_company_name, d_year@8 as d_year, d_moy@9 as d_moy], aggr=[SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "ss_store_sk", index: 5 }, Column { name: "s_store_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "ss_store_sk", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "ss_sold_date_sk", index: 3 }, Column { name: "d_date_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "ss_sold_date_sk", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_item_sk", index: 0 }, Column { name: "ss_item_sk", index: 1 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                                         RepartitionExec: partitioning=Hash([Column { name: "i_item_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00012-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00008-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00006-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00013-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00007-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00002-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00004-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00010-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00001-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00000-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00011-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00003-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00009-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00005-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet], projection=[i_item_sk, i_brand, i_category]                                           |
|               |                                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                                         RepartitionExec: partitioning=Hash([Column { name: "ss_item_sk", index: 1 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00001-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00002-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00003-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00007-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00000-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00004-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00005-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00006-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet], projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "d_date_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                                   ProjectionExec: expr=[d_date_sk@4 as d_date_sk, d_year@5 as d_year, d_moy@6 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                                       FilterExec: date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@2 OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year@3 AND date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@2 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0 AND date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@1 OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year@3 AND date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@1 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                         ProjectionExec: expr=[d_moy@2 = 1 as date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, d_year@1 = 2000 OR d_moy@2 = 12 as date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_year@1 = 2000 OR d_year@1 = 1999 as date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_year@1 = 2001 as date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, d_date_sk@0 as d_date_sk, d_year@1 as d_year, d_moy@2 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00002-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00000-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00001-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet], predicate=(d_year = Int32(2000) OR d_year = Int32(1999) OR d_year = Int32(2001)) AND (d_year = Int32(2000) OR d_year = Int32(1999) OR d_moy = Int32(1)) AND (d_year = Int32(2000) OR d_moy = Int32(12) OR d_year = Int32(2001)) AND (d_year = Int32(2000) OR d_moy = Int32(12) OR d_moy = Int32(1)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_year = Int32(1999) OR d_year = Int32(2001)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_year = Int32(1999) OR d_moy = Int32(1)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_moy = Int32(12) OR d_year = Int32(2001)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_moy = Int32(12) OR d_moy = Int32(1)), pruning_predicate=d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 2001 AND 2001 <= d_year_max@1 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_year_min@0 <= 2001 AND 2001 <= d_year_max@1 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3, projection=[d_date_sk, d_year, d_moy] |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "s_store_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/store.parquet/part-00000-5fa4c400-5d01-4870-a934-17bfecf88674-c000.snappy.parquet], projection=[s_store_sk, s_store_name, s_company_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                 ProjectionExec: expr=[i_category@2 as i_category, i_brand@3 as i_brand, s_store_name@4 as s_store_name, s_company_name@5 as s_company_name, d_year@6 as d_year, d_moy@7 as d_moy, SUM(store_sales.ss_sales_price)@8 as sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 as avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as rn]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   WindowAggExec: wdw=[AVG(SUM(store_sales.ss_sales_price)): Ok(Field { name: "AVG(SUM(store_sales.ss_sales_price))", data_type: Decimal128(21, 6), nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                     SortExec: [i_category@1 ASC,i_brand@2 ASC,s_store_name@3 ASC,s_company_name@4 ASC,d_year@5 ASC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                         RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 1 }, Column { name: "i_brand", index: 2 }, Column { name: "s_store_name", index: 3 }, Column { name: "s_company_name", index: 4 }, Column { name: "d_year", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                           WindowAggExec: wdw=[RANK(): Ok(Field { name: "RANK()", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             SortExec: [i_category@0 ASC,i_brand@1 ASC,s_store_name@2 ASC,s_company_name@3 ASC,d_year@4 ASC NULLS LAST,d_moy@5 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                 RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                   AggregateExec: mode=FinalPartitioned, gby=[i_category@0 as i_category, i_brand@1 as i_brand, s_store_name@2 as s_store_name, s_company_name@3 as s_company_name, d_year@4 as d_year, d_moy@5 as d_moy], aggr=[SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                       RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }, Column { name: "d_year", index: 4 }, Column { name: "d_moy", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                         AggregateExec: mode=Partial, gby=[i_category@2 as i_category, i_brand@1 as i_brand, s_store_name@11 as s_store_name, s_company_name@12 as s_company_name, d_year@8 as d_year, d_moy@9 as d_moy], aggr=[SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "ss_store_sk", index: 5 }, Column { name: "s_store_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "ss_store_sk", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "ss_sold_date_sk", index: 3 }, Column { name: "d_date_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "ss_sold_date_sk", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_item_sk", index: 0 }, Column { name: "ss_item_sk", index: 1 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "i_item_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00012-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00008-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00006-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00013-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00007-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00002-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00004-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00010-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00001-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00000-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00011-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00003-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00009-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00005-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet], projection=[i_item_sk, i_brand, i_category]                                                   |
|               |                                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                                 RepartitionExec: partitioning=Hash([Column { name: "ss_item_sk", index: 1 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00001-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00002-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00003-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00007-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00000-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00004-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00005-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00006-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet], projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "d_date_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                           ProjectionExec: expr=[d_date_sk@4 as d_date_sk, d_year@5 as d_year, d_moy@6 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                               FilterExec: date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@2 OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year@3 AND date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@2 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0 AND date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@1 OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year@3 AND date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@1 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                 ProjectionExec: expr=[d_moy@2 = 1 as date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, d_year@1 = 2000 OR d_moy@2 = 12 as date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_year@1 = 2000 OR d_year@1 = 1999 as date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_year@1 = 2001 as date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, d_date_sk@0 as d_date_sk, d_year@1 as d_year, d_moy@2 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00002-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00000-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00001-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet], predicate=(d_year = Int32(2000) OR d_year = Int32(1999) OR d_year = Int32(2001)) AND (d_year = Int32(2000) OR d_year = Int32(1999) OR d_moy = Int32(1)) AND (d_year = Int32(2000) OR d_moy = Int32(12) OR d_year = Int32(2001)) AND (d_year = Int32(2000) OR d_moy = Int32(12) OR d_moy = Int32(1)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_year = Int32(1999) OR d_year = Int32(2001)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_year = Int32(1999) OR d_moy = Int32(1)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_moy = Int32(12) OR d_year = Int32(2001)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_moy = Int32(12) OR d_moy = Int32(1)), pruning_predicate=d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 2001 AND 2001 <= d_year_max@1 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_year_min@0 <= 2001 AND 2001 <= d_year_max@1 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3, projection=[d_date_sk, d_year, d_moy]         |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "s_store_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                   RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                     ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/store.parquet/part-00000-5fa4c400-5d01-4870-a934-17bfecf88674-c000.snappy.parquet], projection=[s_store_sk, s_store_name, s_company_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                       RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                         ProjectionExec: expr=[i_category@2 as i_category, i_brand@3 as i_brand, s_store_name@4 as s_store_name, s_company_name@5 as s_company_name, d_year@6 as d_year, d_moy@7 as d_moy, SUM(store_sales.ss_sales_price)@8 as sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year]@0 as avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST]@1 as rn]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                           WindowAggExec: wdw=[AVG(SUM(store_sales.ss_sales_price)): Ok(Field { name: "AVG(SUM(store_sales.ss_sales_price))", data_type: Decimal128(21, 6), nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             SortExec: [i_category@1 ASC,i_brand@2 ASC,s_store_name@3 ASC,s_company_name@4 ASC,d_year@5 ASC]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 1 }, Column { name: "i_brand", index: 2 }, Column { name: "s_store_name", index: 3 }, Column { name: "s_company_name", index: 4 }, Column { name: "d_year", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                   WindowAggExec: wdw=[RANK(): Ok(Field { name: "RANK()", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                     SortExec: [i_category@0 ASC,i_brand@1 ASC,s_store_name@2 ASC,s_company_name@3 ASC,d_year@4 ASC NULLS LAST,d_moy@5 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                         RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                           AggregateExec: mode=FinalPartitioned, gby=[i_category@0 as i_category, i_brand@1 as i_brand, s_store_name@2 as s_store_name, s_company_name@3 as s_company_name, d_year@4 as d_year, d_moy@5 as d_moy], aggr=[SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                             CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               RepartitionExec: partitioning=Hash([Column { name: "i_category", index: 0 }, Column { name: "i_brand", index: 1 }, Column { name: "s_store_name", index: 2 }, Column { name: "s_company_name", index: 3 }, Column { name: "d_year", index: 4 }, Column { name: "d_moy", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                 AggregateExec: mode=Partial, gby=[i_category@2 as i_category, i_brand@1 as i_brand, s_store_name@11 as s_store_name, s_company_name@12 as s_company_name, d_year@8 as d_year, d_moy@9 as d_moy], aggr=[SUM(store_sales.ss_sales_price)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "ss_store_sk", index: 5 }, Column { name: "s_store_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         RepartitionExec: partitioning=Hash([Column { name: "ss_store_sk", index: 5 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "ss_sold_date_sk", index: 3 }, Column { name: "d_date_sk", index: 0 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "ss_sold_date_sk", index: 3 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                   CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(Column { name: "i_item_sk", index: 0 }, Column { name: "ss_item_sk", index: 1 })]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "i_item_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00012-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00008-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00006-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00013-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00007-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00002-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00004-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00010-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00001-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00000-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00011-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00003-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00009-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/item.parquet/part-00005-478fef90-109a-46ba-86cb-48af1b046f2e-c000.snappy.parquet], projection=[i_item_sk, i_brand, i_category]                                                           |
|               |                                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([Column { name: "ss_item_sk", index: 1 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00001-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00002-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00003-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00007-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00000-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00004-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00005-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet/part-00006-cff04137-32a6-4e5b-811a-668f5d4b1802-c000.snappy.parquet], projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_sales_price]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                               CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                 RepartitionExec: partitioning=Hash([Column { name: "d_date_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                   ProjectionExec: expr=[d_date_sk@4 as d_date_sk, d_year@5 as d_year, d_moy@6 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                     CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                       FilterExec: date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@2 OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year@3 AND date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@2 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0 AND date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@1 OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year@3 AND date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year@1 OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy@0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                         ProjectionExec: expr=[d_moy@2 = 1 as date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, d_year@1 = 2000 OR d_moy@2 = 12 as date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_year@1 = 2000 OR d_year@1 = 1999 as date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, d_year@1 = 2001 as date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, d_date_sk@0 as d_date_sk, d_year@1 as d_year, d_moy@2 as d_moy]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00002-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00000-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet, mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet/part-00001-469ea7b0-846a-413b-b2f9-dd0b094f64b1-c000.snappy.parquet], predicate=(d_year = Int32(2000) OR d_year = Int32(1999) OR d_year = Int32(2001)) AND (d_year = Int32(2000) OR d_year = Int32(1999) OR d_moy = Int32(1)) AND (d_year = Int32(2000) OR d_moy = Int32(12) OR d_year = Int32(2001)) AND (d_year = Int32(2000) OR d_moy = Int32(12) OR d_moy = Int32(1)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_year = Int32(1999) OR d_year = Int32(2001)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_year = Int32(1999) OR d_moy = Int32(1)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_moy = Int32(12) OR d_year = Int32(2001)) AND (d_year = Int32(2000) AS date_dim.d_year = Int32(2000) OR d_moy = Int32(12) OR d_moy = Int32(1)), pruning_predicate=d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_year_min@0 <= 2001 AND 2001 <= d_year_max@1 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_year_min@0 <= 1999 AND 1999 <= d_year_max@1 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_year_min@0 <= 2001 AND 2001 <= d_year_max@1 AND d_year_min@0 <= 2000 AND 2000 <= d_year_max@1 OR d_moy_min@2 <= 12 AND 12 <= d_moy_max@3 OR d_moy_min@2 <= 1 AND 1 <= d_moy_max@3, projection=[d_date_sk, d_year, d_moy]                 |
|               |                                                       CoalesceBatchesExec: target_batch_size=4096                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         RepartitionExec: partitioning=Hash([Column { name: "s_store_sk", index: 0 }], 48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                           RepartitionExec: partitioning=RoundRobinBatch(48)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                             ParquetExec: limit=None, partitions=[mnt/bigdata/tpcds/sf100-parquet/store.parquet/part-00000-5fa4c400-5d01-4870-a934-17bfecf88674-c000.snappy.parquet], projection=[s_store_sk, s_store_name, s_company_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+