AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   GpuColumnarToRow false
   +- GpuTopN(limit=100, orderBy=[channel#29679 ASC NULLS FIRST,id#29680 ASC NULLS FIRST], output=[channel#29679,id#29680,sales#29512,returns#29513,profit#29514])
      +- GpuHashAggregate(keys=[channel#29679, id#29680, spark_grouping_id#29678L], functions=[gpudecimal128sum(sales#29516, DecimalType(27,2), false, false), gpudecimal128sum(returns#29517, DecimalType(32,2), false, false), gpudecimal128sum(profit#29518, DecimalType(33,2), false, false)], output=[channel#29679, id#29680, sales#29512, returns#29513, profit#29514])
         +- GpuShuffleCoalesce 2147483647
            +- GpuCustomShuffleReader coalesced
               +- ShuffleQueryStage 39
                  +- GpuColumnarExchange gpuhashpartitioning(channel#29679, id#29680, spark_grouping_id#29678L, 200), ENSURE_REQUIREMENTS, [id=#501092]
                     +- GpuHashAggregate(keys=[channel#29679, id#29680, spark_grouping_id#29678L], functions=[partial_gpudecimal128sum(sales#29516, DecimalType(27,2), false, false), partial_gpudecimal128sum(returns#29517, DecimalType(32,2), false, false), partial_gpudecimal128sum(profit#29518, DecimalType(33,2), false, false)], output=[channel#29679, id#29680, spark_grouping_id#29678L, sum#29696, isEmpty#29697, sum#29698, isEmpty#29699, sum#29700, isEmpty#29701])
                        +- GpuExpand [[sales#29516, returns#29517, profit#29518, channel#29676, id#29677, 0], [sales#29516, returns#29517, profit#29518, channel#29676, null, 1], [sales#29516, returns#29517, profit#29518, null, null, 3]], [sales#29516, returns#29517, profit#29518, channel#29679, id#29680, spark_grouping_id#29678L]
                           +- GpuUnion
                              :- GpuRowToColumnar targetsize(2147483647)
                              :  +- *(4) HashAggregate(keys=[s_store_id#713], functions=[sum(UnscaledValue(ss_ext_sales_price#267)), sum(coalesce(cast(sr_return_amt#147 as decimal(12,2)), 0.00)), sum(CheckOverflow((promote_precision(cast(ss_net_profit#274 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#155 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[sales#29516, returns#29517, profit#29518, channel#29676, id#29677])
                              :     +- AQEShuffleRead coalesced
                              :        +- ShuffleQueryStage 36
                              :           +- Exchange hashpartitioning(s_store_id#713, 200), ENSURE_REQUIREMENTS, [id=#500437]
                              :              +- *(1) HashAggregate(keys=[s_store_id#713], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#267)), partial_sum(coalesce(cast(sr_return_amt#147 as decimal(12,2)), 0.00)), partial_sum(CheckOverflow((promote_precision(cast(ss_net_profit#274 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#155 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[s_store_id#713, sum#29707L, sum#29708, isEmpty#29709, sum#29710, isEmpty#29711])
                              :                 +- GpuColumnarToRow false
                              :                    +- GpuProject [ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155, s_store_id#713], true
                              :                       +- GpuShuffledHashJoin [ss_promo_sk#260], [p_promo_sk#98], Inner, GpuBuildRight, false
                              :                          :- GpuShuffleCoalesce 2147483647
                              :                          :  +- GpuCustomShuffleReader coalesced
                              :                          :     +- ShuffleQueryStage 33
                              :                          :        +- GpuColumnarExchange gpuhashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#499514]
                              :                          :           +- GpuProject [ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155, s_store_id#713], true
                              :                          :              +- GpuShuffledHashJoin [ss_item_sk#254], [i_item_sk#668], Inner, GpuBuildRight, false
                              :                          :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :     +- ShuffleQueryStage 30
                              :                          :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#498299]
                              :                          :                 :           +- GpuProject [ss_item_sk#254, ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155, s_store_id#713], true
                              :                          :                 :              +- GpuShuffledHashJoin [ss_store_sk#259], [s_store_sk#712], Inner, GpuBuildRight, false
                              :                          :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :     +- ShuffleQueryStage 27
                              :                          :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#496778]
                              :                          :                 :                 :           +- GpuProject [ss_item_sk#254, ss_store_sk#259, ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155], true
                              :                          :                 :                 :              +- GpuShuffledHashJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner, GpuBuildRight, false
                              :                          :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :                 :     +- ShuffleQueryStage 24
                              :                          :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#492973]
                              :                          :                 :                 :                 :           +- GpuProject [ss_sold_date_sk#252, ss_item_sk#254, ss_store_sk#259, ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155], true
                              :                          :                 :                 :                 :              +- GpuShuffledHashJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], LeftOuter, GpuBuildRight, false
                              :                          :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :                 :                 :                 :  +- ShuffleQueryStage 0
                              :                          :                 :                 :                 :                 :     +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#489398]
                              :                          :                 :                 :                 :                 :        +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                 :                 :                 :           +- GpuFilter (((gpuisnotnull(ss_sold_date_sk#252) AND gpuisnotnull(ss_store_sk#259)) AND gpuisnotnull(ss_item_sk#254)) AND gpuisnotnull(ss_promo_sk#260)), true
                              :                          :                 :                 :                 :                 :              +- GpuFileGpuScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_ext_sales_price#267,ss_net_profit#274] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#252), isnotnull(ss_store_sk#259), isnotnull(ss_item_sk#254), isnotnull..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_promo_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_ticket_number:bigint...
                              :                          :                 :                 :                 :                 +- ShuffleQueryStage 1
                              :                          :                 :                 :                 :                    +- GpuColumnarExchange gpuhashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#489426]
                              :                          :                 :                 :                 :                       +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                 :                 :                          +- GpuFilter (gpuisnotnull(sr_item_sk#138) AND gpuisnotnull(sr_ticket_number#145L)), true
                              :                          :                 :                 :                 :                             +- GpuFileGpuScan parquet [sr_item_sk#138,sr_ticket_number#145L,sr_return_amt#147,sr_net_loss#155] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>
                              :                          :                 :                 :                 +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :                    +- ShuffleQueryStage 2
                              :                          :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#489467]
                              :                          :                 :                 :                          +- GpuProject [d_date_sk#612], true
                              :                          :                 :                 :                             +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                 :                                +- GpuFilter (((gpuisnotnull(d_date#614) AND (d_date#614 >= 11903)) AND (d_date#614 <= 11933)) AND gpuisnotnull(d_date_sk#612)), true
                              :                          :                 :                 :                                   +- GpuFileGpuScan parquet [d_date_sk#612,d_date#614] Batched: true, DataFilters: [isnotnull(d_date#614), (d_date#614 >= 2002-08-04), (d_date#614 <= 2002-09-03), isnotnull(d_date_..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2002-08-04), LessThanOrEqual(d_date,2002-09-03), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                              :                          :                 :                 +- GpuCustomShuffleReader coalesced
                              :                          :                 :                    +- ShuffleQueryStage 3
                              :                          :                 :                       +- GpuColumnarExchange gpuhashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#489501]
                              :                          :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                             +- GpuFilter gpuisnotnull(s_store_sk#712), true
                              :                          :                 :                                +- GpuFileGpuScan parquet [s_store_sk#712,s_store_id#713] Batched: true, DataFilters: [isnotnull(s_store_sk#712)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                              :                          :                 +- GpuCustomShuffleReader coalesced
                              :                          :                    +- ShuffleQueryStage 4
                              :                          :                       +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#489542]
                              :                          :                          +- GpuProject [i_item_sk#668], true
                              :                          :                             +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                                +- GpuFilter ((gpuisnotnull(i_current_price#673) AND (i_current_price#673 > 50.00)) AND gpuisnotnull(i_item_sk#668)), true
                              :                          :                                   +- GpuFileGpuScan parquet [i_item_sk#668,i_current_price#673] Batched: true, DataFilters: [isnotnull(i_current_price#673), (i_current_price#673 > 50.00), isnotnull(i_item_sk#668)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThan(i_current_price,50.00), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2)>
                              :                          +- GpuCustomShuffleReader coalesced
                              :                             +- ShuffleQueryStage 5
                              :                                +- GpuColumnarExchange gpuhashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#489585]
                              :                                   +- GpuProject [p_promo_sk#98], true
                              :                                      +- GpuCoalesceBatches targetsize(2147483647)
                              :                                         +- GpuFilter ((gpuisnotnull(p_channel_tv#109) AND (p_channel_tv#109 = N)) AND gpuisnotnull(p_promo_sk#98)), true
                              :                                            +- GpuFileGpuScan parquet [p_promo_sk#98,p_channel_tv#109] Batched: true, DataFilters: [isnotnull(p_channel_tv#109), (p_channel_tv#109 = N), isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_channel_tv), EqualTo(p_channel_tv,N), IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int,p_channel_tv:string>
                              :- GpuRowToColumnar targetsize(2147483647)
                              :  +- *(5) HashAggregate(keys=[cp_catalog_page_id#205], functions=[sum(UnscaledValue(cs_ext_sales_price#567)), sum(coalesce(cast(cr_return_amount#364 as decimal(12,2)), 0.00)), sum(CheckOverflow((promote_precision(cast(cs_net_profit#577 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#372 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[sales#29520, returns#29521, profit#29522, channel#29686, id#29687])
                              :     +- AQEShuffleRead coalesced
                              :        +- ShuffleQueryStage 37
                              :           +- Exchange hashpartitioning(cp_catalog_page_id#205, 200), ENSURE_REQUIREMENTS, [id=#500673]
                              :              +- *(2) HashAggregate(keys=[cp_catalog_page_id#205], functions=[partial_sum(UnscaledValue(cs_ext_sales_price#567)), partial_sum(coalesce(cast(cr_return_amount#364 as decimal(12,2)), 0.00)), partial_sum(CheckOverflow((promote_precision(cast(cs_net_profit#577 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#372 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[cp_catalog_page_id#205, sum#29717L, sum#29718, isEmpty#29719, sum#29720, isEmpty#29721])
                              :                 +- GpuColumnarToRow false
                              :                    +- GpuProject [cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372, cp_catalog_page_id#205], true
                              :                       +- GpuShuffledHashJoin [cs_promo_sk#560], [p_promo_sk#29576], Inner, GpuBuildRight, false
                              :                          :- GpuShuffleCoalesce 2147483647
                              :                          :  +- GpuCustomShuffleReader coalesced
                              :                          :     +- ShuffleQueryStage 34
                              :                          :        +- GpuColumnarExchange gpuhashpartitioning(cs_promo_sk#560, 200), ENSURE_REQUIREMENTS, [id=#499847]
                              :                          :           +- GpuProject [cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372, cp_catalog_page_id#205], true
                              :                          :              +- GpuShuffledHashJoin [cs_item_sk#559], [i_item_sk#29554], Inner, GpuBuildRight, false
                              :                          :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :     +- ShuffleQueryStage 31
                              :                          :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#498734]
                              :                          :                 :           +- GpuProject [cs_item_sk#559, cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372, cp_catalog_page_id#205], true
                              :                          :                 :              +- GpuShuffledHashJoin [cs_catalog_page_sk#556], [cp_catalog_page_sk#204], Inner, GpuBuildRight, false
                              :                          :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :     +- ShuffleQueryStage 28
                              :                          :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_catalog_page_sk#556, 200), ENSURE_REQUIREMENTS, [id=#497315]
                              :                          :                 :                 :           +- GpuProject [cs_catalog_page_sk#556, cs_item_sk#559, cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372], true
                              :                          :                 :                 :              +- GpuShuffledHashJoin [cs_sold_date_sk#544], [d_date_sk#29526], Inner, GpuBuildRight, false
                              :                          :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :                 :     +- ShuffleQueryStage 25
                              :                          :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#494630]
                              :                          :                 :                 :                 :           +- GpuProject [cs_sold_date_sk#544, cs_catalog_page_sk#556, cs_item_sk#559, cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372], true
                              :                          :                 :                 :                 :              +- GpuShuffledHashJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], LeftOuter, GpuBuildRight, false
                              :                          :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                          :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :                 :                 :     +- ShuffleQueryStage 6
                              :                          :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#489620]
                              :                          :                 :                 :                 :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                 :                 :                 :              +- GpuFilter (((gpuisnotnull(cs_sold_date_sk#544) AND gpuisnotnull(cs_catalog_page_sk#556)) AND gpuisnotnull(cs_item_sk#559)) AND gpuisnotnull(cs_promo_sk#560)), true
                              :                          :                 :                 :                 :                 :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#544,cs_catalog_page_sk#556,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_ext_sales_price#567,cs_net_profit#577] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_catalog_page_sk#556), isnotnull(cs_item_sk#559), is..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_catalog_page_sk), IsNotNull(cs_item_sk), IsNotNull(cs_p..., ReadSchema: struct<cs_sold_date_sk:int,cs_catalog_page_sk:int,cs_item_sk:int,cs_promo_sk:int,cs_order_number:...
                              :                          :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :                 :                    +- ShuffleQueryStage 7
                              :                          :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#489648]
                              :                          :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                 :                 :                             +- GpuFilter (gpuisnotnull(cr_item_sk#348) AND gpuisnotnull(cr_order_number#362L)), true
                              :                          :                 :                 :                 :                                +- GpuFileGpuScan parquet [cr_item_sk#348,cr_order_number#362L,cr_return_amount#364,cr_net_loss#372] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_return_amount:decimal(7,2),cr_net_loss:decimal(7,2)>
                              :                          :                 :                 :                 +- GpuCustomShuffleReader coalesced
                              :                          :                 :                 :                    +- ShuffleQueryStage 9
                              :                          :                 :                 :                       +- ReusedExchange [d_date_sk#29526], GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#489467]
                              :                          :                 :                 +- GpuCustomShuffleReader coalesced
                              :                          :                 :                    +- ShuffleQueryStage 10
                              :                          :                 :                       +- GpuColumnarExchange gpuhashpartitioning(cp_catalog_page_sk#204, 200), ENSURE_REQUIREMENTS, [id=#489725]
                              :                          :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                              :                          :                 :                             +- GpuFilter gpuisnotnull(cp_catalog_page_sk#204), true
                              :                          :                 :                                +- GpuFileGpuScan parquet [cp_catalog_page_sk#204,cp_catalog_page_id#205] Batched: true, DataFilters: [isnotnull(cp_catalog_page_sk#204)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_page.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cp_catalog_page_sk)], ReadSchema: struct<cp_catalog_page_sk:int,cp_catalog_page_id:string>
                              :                          :                 +- GpuCustomShuffleReader coalesced
                              :                          :                    +- ShuffleQueryStage 12
                              :                          :                       +- ReusedExchange [i_item_sk#29554], GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#489542]
                              :                          +- GpuCustomShuffleReader coalesced
                              :                             +- ShuffleQueryStage 14
                              :                                +- ReusedExchange [p_promo_sk#29576], GpuColumnarExchange gpuhashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#489585]
                              +- GpuRowToColumnar targetsize(2147483647)
                                 +- *(6) HashAggregate(keys=[web_site_id#799], functions=[sum(UnscaledValue(ws_ext_sales_price#499)), sum(coalesce(cast(wr_return_amt#313 as decimal(12,2)), 0.00)), sum(CheckOverflow((promote_precision(cast(ws_net_profit#509 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#321 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[sales#29523, returns#29524, profit#29525, channel#29688, id#29689])
                                    +- AQEShuffleRead coalesced
                                       +- ShuffleQueryStage 38
                                          +- Exchange hashpartitioning(web_site_id#799, 200), ENSURE_REQUIREMENTS, [id=#500868]
                                             +- *(3) HashAggregate(keys=[web_site_id#799], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#499)), partial_sum(coalesce(cast(wr_return_amt#313 as decimal(12,2)), 0.00)), partial_sum(CheckOverflow((promote_precision(cast(ws_net_profit#509 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#321 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[web_site_id#799, sum#29727L, sum#29728, isEmpty#29729, sum#29730, isEmpty#29731])
                                                +- GpuColumnarToRow false
                                                   +- GpuProject [ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321, web_site_id#799], true
                                                      +- GpuShuffledHashJoin [ws_promo_sk#492], [p_promo_sk#29645], Inner, GpuBuildRight, false
                                                         :- GpuShuffleCoalesce 2147483647
                                                         :  +- GpuCustomShuffleReader coalesced
                                                         :     +- ShuffleQueryStage 35
                                                         :        +- GpuColumnarExchange gpuhashpartitioning(ws_promo_sk#492, 200), ENSURE_REQUIREMENTS, [id=#500150]
                                                         :           +- GpuProject [ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321, web_site_id#799], true
                                                         :              +- GpuShuffledHashJoin [ws_item_sk#479], [i_item_sk#29623], Inner, GpuBuildRight, false
                                                         :                 :- GpuShuffleCoalesce 2147483647
                                                         :                 :  +- GpuCustomShuffleReader coalesced
                                                         :                 :     +- ShuffleQueryStage 32
                                                         :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#499139]
                                                         :                 :           +- GpuProject [ws_item_sk#479, ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321, web_site_id#799], true
                                                         :                 :              +- GpuShuffledHashJoin [ws_web_site_sk#489], [web_site_sk#798], Inner, GpuBuildRight, false
                                                         :                 :                 :- GpuShuffleCoalesce 2147483647
                                                         :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                         :                 :                 :     +- ShuffleQueryStage 29
                                                         :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_web_site_sk#489, 200), ENSURE_REQUIREMENTS, [id=#497822]
                                                         :                 :                 :           +- GpuProject [ws_item_sk#479, ws_web_site_sk#489, ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321], true
                                                         :                 :                 :              +- GpuShuffledHashJoin [ws_sold_date_sk#476], [d_date_sk#29595], Inner, GpuBuildRight, false
                                                         :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                         :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                         :                 :                 :                 :     +- ShuffleQueryStage 26
                                                         :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#496199]
                                                         :                 :                 :                 :           +- GpuProject [ws_sold_date_sk#476, ws_item_sk#479, ws_web_site_sk#489, ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321], true
                                                         :                 :                 :                 :              +- GpuShuffledHashJoin [ws_item_sk#479, ws_order_number#493L], [wr_item_sk#300, wr_order_number#311L], LeftOuter, GpuBuildRight, false
                                                         :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                         :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                         :                 :                 :                 :                 :     +- ShuffleQueryStage 15
                                                         :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_item_sk#479, ws_order_number#493L, 200), ENSURE_REQUIREMENTS, [id=#489848]
                                                         :                 :                 :                 :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                                                         :                 :                 :                 :                 :              +- GpuFilter (((gpuisnotnull(ws_sold_date_sk#476) AND gpuisnotnull(ws_web_site_sk#489)) AND gpuisnotnull(ws_item_sk#479)) AND gpuisnotnull(ws_promo_sk#492)), true
                                                         :                 :                 :                 :                 :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#476,ws_item_sk#479,ws_web_site_sk#489,ws_promo_sk#492,ws_order_number#493L,ws_ext_sales_price#499,ws_net_profit#509] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_web_site_sk#489), isnotnull(ws_item_sk#479), isnotn..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_web_site_sk), IsNotNull(ws_item_sk), IsNotNull(ws_promo..., ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_web_site_sk:int,ws_promo_sk:int,ws_order_number:bigi...
                                                         :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                         :                 :                 :                 :                    +- ShuffleQueryStage 16
                                                         :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(wr_item_sk#300, wr_order_number#311L, 200), ENSURE_REQUIREMENTS, [id=#489876]
                                                         :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                                                         :                 :                 :                 :                             +- GpuFilter (gpuisnotnull(wr_item_sk#300) AND gpuisnotnull(wr_order_number#311L)), true
                                                         :                 :                 :                 :                                +- GpuFileGpuScan parquet [wr_item_sk#300,wr_order_number#311L,wr_return_amt#313,wr_net_loss#321] Batched: true, DataFilters: [isnotnull(wr_item_sk#300), isnotnull(wr_order_number#311L)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_order_number)], ReadSchema: struct<wr_item_sk:int,wr_order_number:bigint,wr_return_amt:decimal(7,2),wr_net_loss:decimal(7,2)>
                                                         :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                         :                 :                 :                    +- ShuffleQueryStage 18
                                                         :                 :                 :                       +- ReusedExchange [d_date_sk#29595], GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#489467]
                                                         :                 :                 +- GpuCustomShuffleReader coalesced
                                                         :                 :                    +- ShuffleQueryStage 19
                                                         :                 :                       +- GpuColumnarExchange gpuhashpartitioning(web_site_sk#798, 200), ENSURE_REQUIREMENTS, [id=#489953]
                                                         :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                                                         :                 :                             +- GpuFilter gpuisnotnull(web_site_sk#798), true
                                                         :                 :                                +- GpuFileGpuScan parquet [web_site_sk#798,web_site_id#799] Batched: true, DataFilters: [isnotnull(web_site_sk#798)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_site.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(web_site_sk)], ReadSchema: struct<web_site_sk:int,web_site_id:string>
                                                         :                 +- GpuCustomShuffleReader coalesced
                                                         :                    +- ShuffleQueryStage 21
                                                         :                       +- ReusedExchange [i_item_sk#29623], GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#489542]
                                                         +- GpuCustomShuffleReader coalesced
                                                            +- ShuffleQueryStage 23
                                                               +- ReusedExchange [p_promo_sk#29645], GpuColumnarExchange gpuhashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#489585]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#29679 ASC NULLS FIRST,id#29680 ASC NULLS FIRST], output=[channel#29679,id#29680,sales#29512,returns#29513,profit#29514])
   +- HashAggregate(keys=[channel#29679, id#29680, spark_grouping_id#29678L], functions=[sum(sales#29516), sum(returns#29517), sum(profit#29518)], output=[channel#29679, id#29680, sales#29512, returns#29513, profit#29514])
      +- Exchange hashpartitioning(channel#29679, id#29680, spark_grouping_id#29678L, 200), ENSURE_REQUIREMENTS, [id=#487482]
         +- HashAggregate(keys=[channel#29679, id#29680, spark_grouping_id#29678L], functions=[partial_sum(sales#29516), partial_sum(returns#29517), partial_sum(profit#29518)], output=[channel#29679, id#29680, spark_grouping_id#29678L, sum#29696, isEmpty#29697, sum#29698, isEmpty#29699, sum#29700, isEmpty#29701])
            +- Expand [[sales#29516, returns#29517, profit#29518, channel#29676, id#29677, 0], [sales#29516, returns#29517, profit#29518, channel#29676, null, 1], [sales#29516, returns#29517, profit#29518, null, null, 3]], [sales#29516, returns#29517, profit#29518, channel#29679, id#29680, spark_grouping_id#29678L]
               +- Union
                  :- HashAggregate(keys=[s_store_id#713], functions=[sum(UnscaledValue(ss_ext_sales_price#267)), sum(coalesce(cast(sr_return_amt#147 as decimal(12,2)), 0.00)), sum(CheckOverflow((promote_precision(cast(ss_net_profit#274 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#155 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[sales#29516, returns#29517, profit#29518, channel#29676, id#29677])
                  :  +- Exchange hashpartitioning(s_store_id#713, 200), ENSURE_REQUIREMENTS, [id=#487390]
                  :     +- HashAggregate(keys=[s_store_id#713], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#267)), partial_sum(coalesce(cast(sr_return_amt#147 as decimal(12,2)), 0.00)), partial_sum(CheckOverflow((promote_precision(cast(ss_net_profit#274 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#155 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[s_store_id#713, sum#29707L, sum#29708, isEmpty#29709, sum#29710, isEmpty#29711])
                  :        +- Project [ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155, s_store_id#713]
                  :           +- SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
                  :              :- Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
                  :              :  +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#487382]
                  :              :     +- Project [ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155, s_store_id#713]
                  :              :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
                  :              :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :              :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#487374]
                  :              :           :     +- Project [ss_item_sk#254, ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155, s_store_id#713]
                  :              :           :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
                  :              :           :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
                  :              :           :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#487366]
                  :              :           :           :     +- Project [ss_item_sk#254, ss_store_sk#259, ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155]
                  :              :           :           :        +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :              :           :           :           :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :              :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#487358]
                  :              :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_store_sk#259, ss_promo_sk#260, ss_ext_sales_price#267, ss_net_profit#274, sr_return_amt#147, sr_net_loss#155]
                  :              :           :           :           :        +- SortMergeJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], LeftOuter
                  :              :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST, ss_ticket_number#261L ASC NULLS FIRST], false, 0
                  :              :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#487350]
                  :              :           :           :           :           :     +- Filter (((isnotnull(ss_sold_date_sk#252) AND isnotnull(ss_store_sk#259)) AND isnotnull(ss_item_sk#254)) AND isnotnull(ss_promo_sk#260))
                  :              :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_ext_sales_price#267,ss_net_profit#274] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#252), isnotnull(ss_store_sk#259), isnotnull(ss_item_sk#254), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_promo_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_ticket_number:bigint...
                  :              :           :           :           :           +- Sort [sr_item_sk#138 ASC NULLS FIRST, sr_ticket_number#145L ASC NULLS FIRST], false, 0
                  :              :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#487351]
                  :              :           :           :           :                 +- Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_ticket_number#145L))
                  :              :           :           :           :                    +- FileScan parquet [sr_item_sk#138,sr_ticket_number#145L,sr_return_amt#147,sr_net_loss#155] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint,sr_return_amt:decimal(7,2),sr_net_loss:decimal(7,2)>
                  :              :           :           :           +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :              :           :           :              +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#487359]
                  :              :           :           :                 +- Project [d_date_sk#612]
                  :              :           :           :                    +- Filter (((isnotnull(d_date#614) AND (d_date#614 >= 2002-08-04)) AND (d_date#614 <= 2002-09-03)) AND isnotnull(d_date_sk#612))
                  :              :           :           :                       +- FileScan parquet [d_date_sk#612,d_date#614] Batched: true, DataFilters: [isnotnull(d_date#614), (d_date#614 >= 2002-08-04), (d_date#614 <= 2002-09-03), isnotnull(d_date_..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2002-08-04), LessThanOrEqual(d_date,2002-09-03), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :              :           :           +- Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
                  :              :           :              +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#487367]
                  :              :           :                 +- Filter isnotnull(s_store_sk#712)
                  :              :           :                    +- FileScan parquet [s_store_sk#712,s_store_id#713] Batched: true, DataFilters: [isnotnull(s_store_sk#712)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                  :              :           +- Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
                  :              :              +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#487375]
                  :              :                 +- Project [i_item_sk#668]
                  :              :                    +- Filter ((isnotnull(i_current_price#673) AND (i_current_price#673 > 50.00)) AND isnotnull(i_item_sk#668))
                  :              :                       +- FileScan parquet [i_item_sk#668,i_current_price#673] Batched: true, DataFilters: [isnotnull(i_current_price#673), (i_current_price#673 > 50.00), isnotnull(i_item_sk#668)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThan(i_current_price,50.00), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2)>
                  :              +- Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
                  :                 +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#487383]
                  :                    +- Project [p_promo_sk#98]
                  :                       +- Filter ((isnotnull(p_channel_tv#109) AND (p_channel_tv#109 = N)) AND isnotnull(p_promo_sk#98))
                  :                          +- FileScan parquet [p_promo_sk#98,p_channel_tv#109] Batched: true, DataFilters: [isnotnull(p_channel_tv#109), (p_channel_tv#109 = N), isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_channel_tv), EqualTo(p_channel_tv,N), IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int,p_channel_tv:string>
                  :- HashAggregate(keys=[cp_catalog_page_id#205], functions=[sum(UnscaledValue(cs_ext_sales_price#567)), sum(coalesce(cast(cr_return_amount#364 as decimal(12,2)), 0.00)), sum(CheckOverflow((promote_precision(cast(cs_net_profit#577 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#372 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[sales#29520, returns#29521, profit#29522, channel#29686, id#29687])
                  :  +- Exchange hashpartitioning(cp_catalog_page_id#205, 200), ENSURE_REQUIREMENTS, [id=#487433]
                  :     +- HashAggregate(keys=[cp_catalog_page_id#205], functions=[partial_sum(UnscaledValue(cs_ext_sales_price#567)), partial_sum(coalesce(cast(cr_return_amount#364 as decimal(12,2)), 0.00)), partial_sum(CheckOverflow((promote_precision(cast(cs_net_profit#577 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#372 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[cp_catalog_page_id#205, sum#29717L, sum#29718, isEmpty#29719, sum#29720, isEmpty#29721])
                  :        +- Project [cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372, cp_catalog_page_id#205]
                  :           +- SortMergeJoin [cs_promo_sk#560], [p_promo_sk#29576], Inner
                  :              :- Sort [cs_promo_sk#560 ASC NULLS FIRST], false, 0
                  :              :  +- Exchange hashpartitioning(cs_promo_sk#560, 200), ENSURE_REQUIREMENTS, [id=#487425]
                  :              :     +- Project [cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372, cp_catalog_page_id#205]
                  :              :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#29554], Inner
                  :              :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :              :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#487417]
                  :              :           :     +- Project [cs_item_sk#559, cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372, cp_catalog_page_id#205]
                  :              :           :        +- SortMergeJoin [cs_catalog_page_sk#556], [cp_catalog_page_sk#204], Inner
                  :              :           :           :- Sort [cs_catalog_page_sk#556 ASC NULLS FIRST], false, 0
                  :              :           :           :  +- Exchange hashpartitioning(cs_catalog_page_sk#556, 200), ENSURE_REQUIREMENTS, [id=#487409]
                  :              :           :           :     +- Project [cs_catalog_page_sk#556, cs_item_sk#559, cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372]
                  :              :           :           :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#29526], Inner
                  :              :           :           :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :              :           :           :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#487401]
                  :              :           :           :           :     +- Project [cs_sold_date_sk#544, cs_catalog_page_sk#556, cs_item_sk#559, cs_promo_sk#560, cs_ext_sales_price#567, cs_net_profit#577, cr_return_amount#364, cr_net_loss#372]
                  :              :           :           :           :        +- SortMergeJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], LeftOuter
                  :              :           :           :           :           :- Sort [cs_item_sk#559 ASC NULLS FIRST, cs_order_number#561L ASC NULLS FIRST], false, 0
                  :              :           :           :           :           :  +- Exchange hashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#487393]
                  :              :           :           :           :           :     +- Filter (((isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_catalog_page_sk#556)) AND isnotnull(cs_item_sk#559)) AND isnotnull(cs_promo_sk#560))
                  :              :           :           :           :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_catalog_page_sk#556,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_ext_sales_price#567,cs_net_profit#577] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_catalog_page_sk#556), isnotnull(cs_item_sk#559), is..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_catalog_page_sk), IsNotNull(cs_item_sk), IsNotNull(cs_p..., ReadSchema: struct<cs_sold_date_sk:int,cs_catalog_page_sk:int,cs_item_sk:int,cs_promo_sk:int,cs_order_number:...
                  :              :           :           :           :           +- Sort [cr_item_sk#348 ASC NULLS FIRST, cr_order_number#362L ASC NULLS FIRST], false, 0
                  :              :           :           :           :              +- Exchange hashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#487394]
                  :              :           :           :           :                 +- Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_order_number#362L))
                  :              :           :           :           :                    +- FileScan parquet [cr_item_sk#348,cr_order_number#362L,cr_return_amount#364,cr_net_loss#372] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_return_amount:decimal(7,2),cr_net_loss:decimal(7,2)>
                  :              :           :           :           +- Sort [d_date_sk#29526 ASC NULLS FIRST], false, 0
                  :              :           :           :              +- Exchange hashpartitioning(d_date_sk#29526, 200), ENSURE_REQUIREMENTS, [id=#487402]
                  :              :           :           :                 +- Project [d_date_sk#29526]
                  :              :           :           :                    +- Filter (((isnotnull(d_date#29528) AND (d_date#29528 >= 2002-08-04)) AND (d_date#29528 <= 2002-09-03)) AND isnotnull(d_date_sk#29526))
                  :              :           :           :                       +- FileScan parquet [d_date_sk#29526,d_date#29528] Batched: true, DataFilters: [isnotnull(d_date#29528), (d_date#29528 >= 2002-08-04), (d_date#29528 <= 2002-09-03), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2002-08-04), LessThanOrEqual(d_date,2002-09-03), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                  :              :           :           +- Sort [cp_catalog_page_sk#204 ASC NULLS FIRST], false, 0
                  :              :           :              +- Exchange hashpartitioning(cp_catalog_page_sk#204, 200), ENSURE_REQUIREMENTS, [id=#487410]
                  :              :           :                 +- Filter isnotnull(cp_catalog_page_sk#204)
                  :              :           :                    +- FileScan parquet [cp_catalog_page_sk#204,cp_catalog_page_id#205] Batched: true, DataFilters: [isnotnull(cp_catalog_page_sk#204)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_page.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cp_catalog_page_sk)], ReadSchema: struct<cp_catalog_page_sk:int,cp_catalog_page_id:string>
                  :              :           +- Sort [i_item_sk#29554 ASC NULLS FIRST], false, 0
                  :              :              +- Exchange hashpartitioning(i_item_sk#29554, 200), ENSURE_REQUIREMENTS, [id=#487418]
                  :              :                 +- Project [i_item_sk#29554]
                  :              :                    +- Filter ((isnotnull(i_current_price#29559) AND (i_current_price#29559 > 50.00)) AND isnotnull(i_item_sk#29554))
                  :              :                       +- FileScan parquet [i_item_sk#29554,i_current_price#29559] Batched: true, DataFilters: [isnotnull(i_current_price#29559), (i_current_price#29559 > 50.00), isnotnull(i_item_sk#29554)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThan(i_current_price,50.00), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2)>
                  :              +- Sort [p_promo_sk#29576 ASC NULLS FIRST], false, 0
                  :                 +- Exchange hashpartitioning(p_promo_sk#29576, 200), ENSURE_REQUIREMENTS, [id=#487426]
                  :                    +- Project [p_promo_sk#29576]
                  :                       +- Filter ((isnotnull(p_channel_tv#29587) AND (p_channel_tv#29587 = N)) AND isnotnull(p_promo_sk#29576))
                  :                          +- FileScan parquet [p_promo_sk#29576,p_channel_tv#29587] Batched: true, DataFilters: [isnotnull(p_channel_tv#29587), (p_channel_tv#29587 = N), isnotnull(p_promo_sk#29576)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_channel_tv), EqualTo(p_channel_tv,N), IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int,p_channel_tv:string>
                  +- HashAggregate(keys=[web_site_id#799], functions=[sum(UnscaledValue(ws_ext_sales_price#499)), sum(coalesce(cast(wr_return_amt#313 as decimal(12,2)), 0.00)), sum(CheckOverflow((promote_precision(cast(ws_net_profit#509 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#321 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[sales#29523, returns#29524, profit#29525, channel#29688, id#29689])
                     +- Exchange hashpartitioning(web_site_id#799, 200), ENSURE_REQUIREMENTS, [id=#487476]
                        +- HashAggregate(keys=[web_site_id#799], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#499)), partial_sum(coalesce(cast(wr_return_amt#313 as decimal(12,2)), 0.00)), partial_sum(CheckOverflow((promote_precision(cast(ws_net_profit#509 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#321 as decimal(12,2)), 0.00) as decimal(13,2)))), DecimalType(13,2), true))], output=[web_site_id#799, sum#29727L, sum#29728, isEmpty#29729, sum#29730, isEmpty#29731])
                           +- Project [ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321, web_site_id#799]
                              +- SortMergeJoin [ws_promo_sk#492], [p_promo_sk#29645], Inner
                                 :- Sort [ws_promo_sk#492 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(ws_promo_sk#492, 200), ENSURE_REQUIREMENTS, [id=#487468]
                                 :     +- Project [ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321, web_site_id#799]
                                 :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#29623], Inner
                                 :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                                 :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#487460]
                                 :           :     +- Project [ws_item_sk#479, ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321, web_site_id#799]
                                 :           :        +- SortMergeJoin [ws_web_site_sk#489], [web_site_sk#798], Inner
                                 :           :           :- Sort [ws_web_site_sk#489 ASC NULLS FIRST], false, 0
                                 :           :           :  +- Exchange hashpartitioning(ws_web_site_sk#489, 200), ENSURE_REQUIREMENTS, [id=#487452]
                                 :           :           :     +- Project [ws_item_sk#479, ws_web_site_sk#489, ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321]
                                 :           :           :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#29595], Inner
                                 :           :           :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                                 :           :           :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#487444]
                                 :           :           :           :     +- Project [ws_sold_date_sk#476, ws_item_sk#479, ws_web_site_sk#489, ws_promo_sk#492, ws_ext_sales_price#499, ws_net_profit#509, wr_return_amt#313, wr_net_loss#321]
                                 :           :           :           :        +- SortMergeJoin [ws_item_sk#479, ws_order_number#493L], [wr_item_sk#300, wr_order_number#311L], LeftOuter
                                 :           :           :           :           :- Sort [ws_item_sk#479 ASC NULLS FIRST, ws_order_number#493L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :  +- Exchange hashpartitioning(ws_item_sk#479, ws_order_number#493L, 200), ENSURE_REQUIREMENTS, [id=#487436]
                                 :           :           :           :           :     +- Filter (((isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_web_site_sk#489)) AND isnotnull(ws_item_sk#479)) AND isnotnull(ws_promo_sk#492))
                                 :           :           :           :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479,ws_web_site_sk#489,ws_promo_sk#492,ws_order_number#493L,ws_ext_sales_price#499,ws_net_profit#509] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_web_site_sk#489), isnotnull(ws_item_sk#479), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_web_site_sk), IsNotNull(ws_item_sk), IsNotNull(ws_promo..., ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_web_site_sk:int,ws_promo_sk:int,ws_order_number:bigi...
                                 :           :           :           :           +- Sort [wr_item_sk#300 ASC NULLS FIRST, wr_order_number#311L ASC NULLS FIRST], false, 0
                                 :           :           :           :              +- Exchange hashpartitioning(wr_item_sk#300, wr_order_number#311L, 200), ENSURE_REQUIREMENTS, [id=#487437]
                                 :           :           :           :                 +- Filter (isnotnull(wr_item_sk#300) AND isnotnull(wr_order_number#311L))
                                 :           :           :           :                    +- FileScan parquet [wr_item_sk#300,wr_order_number#311L,wr_return_amt#313,wr_net_loss#321] Batched: true, DataFilters: [isnotnull(wr_item_sk#300), isnotnull(wr_order_number#311L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_order_number)], ReadSchema: struct<wr_item_sk:int,wr_order_number:bigint,wr_return_amt:decimal(7,2),wr_net_loss:decimal(7,2)>
                                 :           :           :           +- Sort [d_date_sk#29595 ASC NULLS FIRST], false, 0
                                 :           :           :              +- Exchange hashpartitioning(d_date_sk#29595, 200), ENSURE_REQUIREMENTS, [id=#487445]
                                 :           :           :                 +- Project [d_date_sk#29595]
                                 :           :           :                    +- Filter (((isnotnull(d_date#29597) AND (d_date#29597 >= 2002-08-04)) AND (d_date#29597 <= 2002-09-03)) AND isnotnull(d_date_sk#29595))
                                 :           :           :                       +- FileScan parquet [d_date_sk#29595,d_date#29597] Batched: true, DataFilters: [isnotnull(d_date#29597), (d_date#29597 >= 2002-08-04), (d_date#29597 <= 2002-09-03), isnotnull(d..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), GreaterThanOrEqual(d_date,2002-08-04), LessThanOrEqual(d_date,2002-09-03), Is..., ReadSchema: struct<d_date_sk:int,d_date:date>
                                 :           :           +- Sort [web_site_sk#798 ASC NULLS FIRST], false, 0
                                 :           :              +- Exchange hashpartitioning(web_site_sk#798, 200), ENSURE_REQUIREMENTS, [id=#487453]
                                 :           :                 +- Filter isnotnull(web_site_sk#798)
                                 :           :                    +- FileScan parquet [web_site_sk#798,web_site_id#799] Batched: true, DataFilters: [isnotnull(web_site_sk#798)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_site.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(web_site_sk)], ReadSchema: struct<web_site_sk:int,web_site_id:string>
                                 :           +- Sort [i_item_sk#29623 ASC NULLS FIRST], false, 0
                                 :              +- Exchange hashpartitioning(i_item_sk#29623, 200), ENSURE_REQUIREMENTS, [id=#487461]
                                 :                 +- Project [i_item_sk#29623]
                                 :                    +- Filter ((isnotnull(i_current_price#29628) AND (i_current_price#29628 > 50.00)) AND isnotnull(i_item_sk#29623))
                                 :                       +- FileScan parquet [i_item_sk#29623,i_current_price#29628] Batched: true, DataFilters: [isnotnull(i_current_price#29628), (i_current_price#29628 > 50.00), isnotnull(i_item_sk#29623)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), GreaterThan(i_current_price,50.00), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2)>
                                 +- Sort [p_promo_sk#29645 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(p_promo_sk#29645, 200), ENSURE_REQUIREMENTS, [id=#487469]
                                       +- Project [p_promo_sk#29645]
                                          +- Filter ((isnotnull(p_channel_tv#29656) AND (p_channel_tv#29656 = N)) AND isnotnull(p_promo_sk#29645))
                                             +- FileScan parquet [p_promo_sk#29645,p_channel_tv#29656] Batched: true, DataFilters: [isnotnull(p_channel_tv#29656), (p_channel_tv#29656 = N), isnotnull(p_promo_sk#29645)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_channel_tv), EqualTo(p_channel_tv,N), IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int,p_channel_tv:string>
