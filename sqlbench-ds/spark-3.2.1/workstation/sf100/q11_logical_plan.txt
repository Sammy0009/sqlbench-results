GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#3853 ASC NULLS FIRST, customer_first_name#3854 ASC NULLS FIRST, customer_last_name#3855 ASC NULLS FIRST, customer_birth_country#3857 ASC NULLS FIRST], true
      +- Project [customer_id#3853, customer_first_name#3854, customer_last_name#3855, customer_birth_country#3857]
         +- Join Inner, ((customer_id#3785 = customer_id#3873) AND (CASE WHEN (year_total#4203 > 0.00) THEN CheckOverflow((promote_precision(year_total#3881) / promote_precision(year_total#4203)), DecimalType(38,20), true) ELSE 0E-20 END > CASE WHEN (year_total#3793 > 0.00) THEN CheckOverflow((promote_precision(year_total#3861) / promote_precision(year_total#3793)), DecimalType(38,20), true) ELSE 0E-20 END))
            :- Project [customer_id#3785, year_total#3793, customer_id#3853, customer_first_name#3854, customer_last_name#3855, customer_birth_country#3857, year_total#3861, year_total#4203]
            :  +- Join Inner, (customer_id#3785 = customer_id#4195)
            :     :- Join Inner, (customer_id#3853 = customer_id#3785)
            :     :  :- Filter (isnotnull(year_total#3793) AND (year_total#3793 > 0.00))
            :     :  :  +- Aggregate [c_customer_id#563, c_first_name#570, c_last_name#571, c_preferred_cust_flag#572, c_birth_country#576, c_login#577, c_email_address#578, d_year#604], [c_customer_id#563 AS customer_id#3785, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#681 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#678 as decimal(8,2)))), DecimalType(8,2), true))),18,2) AS year_total#3793]
            :     :  :     +- Project [c_customer_id#563, c_first_name#570, c_last_name#571, c_preferred_cust_flag#572, c_birth_country#576, c_login#577, c_email_address#578, ss_ext_discount_amt#678, ss_ext_list_price#681, d_year#604]
            :     :  :        +- Join Inner, (ss_sold_date_sk#664 = d_date_sk#598)
            :     :  :           :- Project [c_customer_id#563, c_first_name#570, c_last_name#571, c_preferred_cust_flag#572, c_birth_country#576, c_login#577, c_email_address#578, ss_sold_date_sk#664, ss_ext_discount_amt#678, ss_ext_list_price#681]
            :     :  :           :  +- Join Inner, (c_customer_sk#562 = ss_customer_sk#667)
            :     :  :           :     :- Project [c_customer_sk#562, c_customer_id#563, c_first_name#570, c_last_name#571, c_preferred_cust_flag#572, c_birth_country#576, c_login#577, c_email_address#578]
            :     :  :           :     :  +- Filter (isnotnull(c_customer_sk#562) AND isnotnull(c_customer_id#563))
            :     :  :           :     :     +- Relation [c_customer_sk#562,c_customer_id#563,c_current_cdemo_sk#564,c_current_hdemo_sk#565,c_current_addr_sk#566,c_first_shipto_date_sk#567,c_first_sales_date_sk#568,c_salutation#569,c_first_name#570,c_last_name#571,c_preferred_cust_flag#572,c_birth_day#573,c_birth_month#574,c_birth_year#575,c_birth_country#576,c_login#577,c_email_address#578,c_last_review_date_sk#579] parquet
            :     :  :           :     +- Project [ss_sold_date_sk#664, ss_customer_sk#667, ss_ext_discount_amt#678, ss_ext_list_price#681]
            :     :  :           :        +- Filter (isnotnull(ss_customer_sk#667) AND isnotnull(ss_sold_date_sk#664))
            :     :  :           :           +- Relation [ss_sold_date_sk#664,ss_sold_time_sk#665,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_quantity#674,ss_wholesale_cost#675,ss_list_price#676,ss_sales_price#677,ss_ext_discount_amt#678,ss_ext_sales_price#679,ss_ext_wholesale_cost#680,ss_ext_list_price#681,ss_ext_tax#682,ss_coupon_amt#683,ss_net_paid#684,ss_net_paid_inc_tax#685,ss_net_profit#686] parquet
            :     :  :           +- Project [d_date_sk#598, d_year#604]
            :     :  :              +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 1998)) AND isnotnull(d_date_sk#598))
            :     :  :                 +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
            :     :  +- Aggregate [c_customer_id#3888, c_first_name#3895, c_last_name#3896, c_preferred_cust_flag#3897, c_birth_country#3901, c_login#3902, c_email_address#3903, d_year#3934], [c_customer_id#3888 AS customer_id#3853, c_first_name#3895 AS customer_first_name#3854, c_last_name#3896 AS customer_last_name#3855, c_birth_country#3901 AS customer_birth_country#3857, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ss_ext_list_price#3922 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#3919 as decimal(8,2)))), DecimalType(8,2), true))),18,2) AS year_total#3861]
            :     :     +- Project [c_customer_id#3888, c_first_name#3895, c_last_name#3896, c_preferred_cust_flag#3897, c_birth_country#3901, c_login#3902, c_email_address#3903, ss_ext_discount_amt#3919, ss_ext_list_price#3922, d_year#3934]
            :     :        +- Join Inner, (ss_sold_date_sk#3905 = d_date_sk#3928)
            :     :           :- Project [c_customer_id#3888, c_first_name#3895, c_last_name#3896, c_preferred_cust_flag#3897, c_birth_country#3901, c_login#3902, c_email_address#3903, ss_sold_date_sk#3905, ss_ext_discount_amt#3919, ss_ext_list_price#3922]
            :     :           :  +- Join Inner, (c_customer_sk#3887 = ss_customer_sk#3908)
            :     :           :     :- Project [c_customer_sk#3887, c_customer_id#3888, c_first_name#3895, c_last_name#3896, c_preferred_cust_flag#3897, c_birth_country#3901, c_login#3902, c_email_address#3903]
            :     :           :     :  +- Filter (isnotnull(c_customer_sk#3887) AND isnotnull(c_customer_id#3888))
            :     :           :     :     +- Relation [c_customer_sk#3887,c_customer_id#3888,c_current_cdemo_sk#3889,c_current_hdemo_sk#3890,c_current_addr_sk#3891,c_first_shipto_date_sk#3892,c_first_sales_date_sk#3893,c_salutation#3894,c_first_name#3895,c_last_name#3896,c_preferred_cust_flag#3897,c_birth_day#3898,c_birth_month#3899,c_birth_year#3900,c_birth_country#3901,c_login#3902,c_email_address#3903,c_last_review_date_sk#3904] parquet
            :     :           :     +- Project [ss_sold_date_sk#3905, ss_customer_sk#3908, ss_ext_discount_amt#3919, ss_ext_list_price#3922]
            :     :           :        +- Filter (isnotnull(ss_customer_sk#3908) AND isnotnull(ss_sold_date_sk#3905))
            :     :           :           +- Relation [ss_sold_date_sk#3905,ss_sold_time_sk#3906,ss_item_sk#3907,ss_customer_sk#3908,ss_cdemo_sk#3909,ss_hdemo_sk#3910,ss_addr_sk#3911,ss_store_sk#3912,ss_promo_sk#3913,ss_ticket_number#3914L,ss_quantity#3915,ss_wholesale_cost#3916,ss_list_price#3917,ss_sales_price#3918,ss_ext_discount_amt#3919,ss_ext_sales_price#3920,ss_ext_wholesale_cost#3921,ss_ext_list_price#3922,ss_ext_tax#3923,ss_coupon_amt#3924,ss_net_paid#3925,ss_net_paid_inc_tax#3926,ss_net_profit#3927] parquet
            :     :           +- Project [d_date_sk#3928, d_year#3934]
            :     :              +- Filter ((isnotnull(d_year#3934) AND (d_year#3934 = 1999)) AND isnotnull(d_date_sk#3928))
            :     :                 +- Relation [d_date_sk#3928,d_date_id#3929,d_date#3930,d_month_seq#3931,d_week_seq#3932,d_quarter_seq#3933,d_year#3934,d_dow#3935,d_moy#3936,d_dom#3937,d_qoy#3938,d_fy_year#3939,d_fy_quarter_seq#3940,d_fy_week_seq#3941,d_day_name#3942,d_quarter_name#3943,d_holiday#3944,d_weekend#3945,d_following_holiday#3946,d_first_dom#3947,d_last_dom#3948,d_same_day_ly#3949,d_same_day_lq#3950,d_current_day#3951,... 4 more fields] parquet
            :     +- Project [customer_id#3795 AS customer_id#4195, year_total#3803 AS year_total#4203]
            :        +- Filter (isnotnull(year_total#3803) AND (year_total#3803 > 0.00))
            :           +- Aggregate [c_customer_id#4116, c_first_name#4123, c_last_name#4124, c_preferred_cust_flag#4125, c_birth_country#4129, c_login#4130, c_email_address#4131, d_year#4173], [c_customer_id#4116 AS customer_id#3795, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#4158 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#4155 as decimal(8,2)))), DecimalType(8,2), true))),18,2) AS year_total#3803]
            :              +- Project [c_customer_id#4116, c_first_name#4123, c_last_name#4124, c_preferred_cust_flag#4125, c_birth_country#4129, c_login#4130, c_email_address#4131, ws_ext_discount_amt#4155, ws_ext_list_price#4158, d_year#4173]
            :                 +- Join Inner, (ws_sold_date_sk#4133 = d_date_sk#4167)
            :                    :- Project [c_customer_id#4116, c_first_name#4123, c_last_name#4124, c_preferred_cust_flag#4125, c_birth_country#4129, c_login#4130, c_email_address#4131, ws_sold_date_sk#4133, ws_ext_discount_amt#4155, ws_ext_list_price#4158]
            :                    :  +- Join Inner, (c_customer_sk#4115 = ws_bill_customer_sk#4137)
            :                    :     :- Project [c_customer_sk#4115, c_customer_id#4116, c_first_name#4123, c_last_name#4124, c_preferred_cust_flag#4125, c_birth_country#4129, c_login#4130, c_email_address#4131]
            :                    :     :  +- Filter (isnotnull(c_customer_sk#4115) AND isnotnull(c_customer_id#4116))
            :                    :     :     +- Relation [c_customer_sk#4115,c_customer_id#4116,c_current_cdemo_sk#4117,c_current_hdemo_sk#4118,c_current_addr_sk#4119,c_first_shipto_date_sk#4120,c_first_sales_date_sk#4121,c_salutation#4122,c_first_name#4123,c_last_name#4124,c_preferred_cust_flag#4125,c_birth_day#4126,c_birth_month#4127,c_birth_year#4128,c_birth_country#4129,c_login#4130,c_email_address#4131,c_last_review_date_sk#4132] parquet
            :                    :     +- Project [ws_sold_date_sk#4133, ws_bill_customer_sk#4137, ws_ext_discount_amt#4155, ws_ext_list_price#4158]
            :                    :        +- Filter (isnotnull(ws_bill_customer_sk#4137) AND isnotnull(ws_sold_date_sk#4133))
            :                    :           +- Relation [ws_sold_date_sk#4133,ws_sold_time_sk#4134,ws_ship_date_sk#4135,ws_item_sk#4136,ws_bill_customer_sk#4137,ws_bill_cdemo_sk#4138,ws_bill_hdemo_sk#4139,ws_bill_addr_sk#4140,ws_ship_customer_sk#4141,ws_ship_cdemo_sk#4142,ws_ship_hdemo_sk#4143,ws_ship_addr_sk#4144,ws_web_page_sk#4145,ws_web_site_sk#4146,ws_ship_mode_sk#4147,ws_warehouse_sk#4148,ws_promo_sk#4149,ws_order_number#4150L,ws_quantity#4151,ws_wholesale_cost#4152,ws_list_price#4153,ws_sales_price#4154,ws_ext_discount_amt#4155,ws_ext_sales_price#4156,... 10 more fields] parquet
            :                    +- Project [d_date_sk#4167, d_year#4173]
            :                       +- Filter ((isnotnull(d_year#4173) AND (d_year#4173 = 1998)) AND isnotnull(d_date_sk#4167))
            :                          +- Relation [d_date_sk#4167,d_date_id#4168,d_date#4169,d_month_seq#4170,d_week_seq#4171,d_quarter_seq#4172,d_year#4173,d_dow#4174,d_moy#4175,d_dom#4176,d_qoy#4177,d_fy_year#4178,d_fy_quarter_seq#4179,d_fy_week_seq#4180,d_day_name#4181,d_quarter_name#4182,d_holiday#4183,d_weekend#4184,d_following_holiday#4185,d_first_dom#4186,d_last_dom#4187,d_same_day_ly#4188,d_same_day_lq#4189,d_current_day#4190,... 4 more fields] parquet
            +- Aggregate [c_customer_id#4275, c_first_name#4282, c_last_name#4283, c_preferred_cust_flag#4284, c_birth_country#4288, c_login#4289, c_email_address#4290, d_year#4332], [c_customer_id#4275 AS customer_id#3873, MakeDecimal(sum(UnscaledValue(CheckOverflow((promote_precision(cast(ws_ext_list_price#4317 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#4314 as decimal(8,2)))), DecimalType(8,2), true))),18,2) AS year_total#3881]
               +- Project [c_customer_id#4275, c_first_name#4282, c_last_name#4283, c_preferred_cust_flag#4284, c_birth_country#4288, c_login#4289, c_email_address#4290, ws_ext_discount_amt#4314, ws_ext_list_price#4317, d_year#4332]
                  +- Join Inner, (ws_sold_date_sk#4292 = d_date_sk#4326)
                     :- Project [c_customer_id#4275, c_first_name#4282, c_last_name#4283, c_preferred_cust_flag#4284, c_birth_country#4288, c_login#4289, c_email_address#4290, ws_sold_date_sk#4292, ws_ext_discount_amt#4314, ws_ext_list_price#4317]
                     :  +- Join Inner, (c_customer_sk#4274 = ws_bill_customer_sk#4296)
                     :     :- Project [c_customer_sk#4274, c_customer_id#4275, c_first_name#4282, c_last_name#4283, c_preferred_cust_flag#4284, c_birth_country#4288, c_login#4289, c_email_address#4290]
                     :     :  +- Filter (isnotnull(c_customer_sk#4274) AND isnotnull(c_customer_id#4275))
                     :     :     +- Relation [c_customer_sk#4274,c_customer_id#4275,c_current_cdemo_sk#4276,c_current_hdemo_sk#4277,c_current_addr_sk#4278,c_first_shipto_date_sk#4279,c_first_sales_date_sk#4280,c_salutation#4281,c_first_name#4282,c_last_name#4283,c_preferred_cust_flag#4284,c_birth_day#4285,c_birth_month#4286,c_birth_year#4287,c_birth_country#4288,c_login#4289,c_email_address#4290,c_last_review_date_sk#4291] parquet
                     :     +- Project [ws_sold_date_sk#4292, ws_bill_customer_sk#4296, ws_ext_discount_amt#4314, ws_ext_list_price#4317]
                     :        +- Filter (isnotnull(ws_bill_customer_sk#4296) AND isnotnull(ws_sold_date_sk#4292))
                     :           +- Relation [ws_sold_date_sk#4292,ws_sold_time_sk#4293,ws_ship_date_sk#4294,ws_item_sk#4295,ws_bill_customer_sk#4296,ws_bill_cdemo_sk#4297,ws_bill_hdemo_sk#4298,ws_bill_addr_sk#4299,ws_ship_customer_sk#4300,ws_ship_cdemo_sk#4301,ws_ship_hdemo_sk#4302,ws_ship_addr_sk#4303,ws_web_page_sk#4304,ws_web_site_sk#4305,ws_ship_mode_sk#4306,ws_warehouse_sk#4307,ws_promo_sk#4308,ws_order_number#4309L,ws_quantity#4310,ws_wholesale_cost#4311,ws_list_price#4312,ws_sales_price#4313,ws_ext_discount_amt#4314,ws_ext_sales_price#4315,... 10 more fields] parquet
                     +- Project [d_date_sk#4326, d_year#4332]
                        +- Filter ((isnotnull(d_year#4332) AND (d_year#4332 = 1999)) AND isnotnull(d_date_sk#4326))
                           +- Relation [d_date_sk#4326,d_date_id#4327,d_date#4328,d_month_seq#4329,d_week_seq#4330,d_quarter_seq#4331,d_year#4332,d_dow#4333,d_moy#4334,d_dom#4335,d_qoy#4336,d_fy_year#4337,d_fy_quarter_seq#4338,d_fy_week_seq#4339,d_day_name#4340,d_quarter_name#4341,d_holiday#4342,d_weekend#4343,d_following_holiday#4344,d_first_dom#4345,d_last_dom#4346,d_same_day_ly#4347,d_same_day_lq#4348,d_current_day#4349,... 4 more fields] parquet
