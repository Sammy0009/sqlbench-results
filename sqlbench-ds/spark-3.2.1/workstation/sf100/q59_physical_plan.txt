AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   GpuColumnarToRow false
   +- GpuTopN(limit=100, orderBy=[s_store_name1#19449 ASC NULLS FIRST,s_store_id1#19451 ASC NULLS FIRST,d_week_seq1#19450 ASC NULLS FIRST], output=[s_store_name1#19449,s_store_id1#19451,d_week_seq1#19450,(sun_sales1 / sun_sales2)#19568,(mon_sales1 / mon_sales2)#19569,(tue_sales1 / tue_sales2)#19570,(wed_sales1 / wed_sales2)#19571,(thu_sales1 / thu_sales2)#19572,(fri_sales1 / fri_sales2)#19573,(sat_sales1 / sat_sales2)#19574])
      +- GpuShuffleCoalesce 2147483647
         +- GpuColumnarExchange gpusinglepartitioning$(), ENSURE_REQUIREMENTS, [id=#341184]
            +- GpuTopN(limit=100, orderBy=[s_store_name1#19449 ASC NULLS FIRST,s_store_id1#19451 ASC NULLS FIRST,d_week_seq1#19450 ASC NULLS FIRST], output=[s_store_name1#19449,s_store_id1#19451,d_week_seq1#19450,(sun_sales1 / sun_sales2)#19568,(mon_sales1 / mon_sales2)#19569,(tue_sales1 / tue_sales2)#19570,(wed_sales1 / wed_sales2)#19571,(thu_sales1 / thu_sales2)#19572,(fri_sales1 / fri_sales2)#19573,(sat_sales1 / sat_sales2)#19574])
               +- GpuProject [s_store_name1#19449, s_store_id1#19451, d_week_seq1#19450, (gpupromoteprecision(sun_sales1#19452) / gpupromoteprecision(sun_sales2#19462)) AS (sun_sales1 / sun_sales2)#19568, (gpupromoteprecision(mon_sales1#19453) / gpupromoteprecision(mon_sales2#19463)) AS (mon_sales1 / mon_sales2)#19569, (gpupromoteprecision(tue_sales1#19454) / gpupromoteprecision(tue_sales2#19464)) AS (tue_sales1 / tue_sales2)#19570, (gpupromoteprecision(wed_sales1#19455) / gpupromoteprecision(wed_sales2#19465)) AS (wed_sales1 / wed_sales2)#19571, (gpupromoteprecision(thu_sales1#19456) / gpupromoteprecision(thu_sales2#19466)) AS (thu_sales1 / thu_sales2)#19572, (gpupromoteprecision(fri_sales1#19457) / gpupromoteprecision(fri_sales2#19467)) AS (fri_sales1 / fri_sales2)#19573, (gpupromoteprecision(sat_sales1#19458) / gpupromoteprecision(sat_sales2#19468)) AS (sat_sales1 / sat_sales2)#19574], true
                  +- GpuShuffledHashJoin [s_store_id1#19451, d_week_seq1#19450], [s_store_id2#19461, (d_week_seq2#19460 - 52)], Inner, GpuBuildRight, false
                     :- GpuShuffleCoalesce 2147483647
                     :  +- GpuCustomShuffleReader coalesced
                     :     +- ShuffleQueryStage 19
                     :        +- GpuColumnarExchange gpuhashpartitioning(s_store_id1#19451, d_week_seq1#19450, 200), ENSURE_REQUIREMENTS, [id=#341034]
                     :           +- GpuProject [s_store_name#717 AS s_store_name1#19449, d_week_seq#616 AS d_week_seq1#19450, s_store_id#713 AS s_store_id1#19451, sun_sales#19469 AS sun_sales1#19452, mon_sales#19470 AS mon_sales1#19453, tue_sales#19471 AS tue_sales1#19454, wed_sales#19472 AS wed_sales1#19455, thu_sales#19473 AS thu_sales1#19456, fri_sales#19474 AS fri_sales1#19457, sat_sales#19475 AS sat_sales1#19458], true
                     :              +- GpuShuffledHashJoin [d_week_seq#616], [d_week_seq#19480], Inner, GpuBuildRight, false
                     :                 :- GpuShuffleCoalesce 2147483647
                     :                 :  +- GpuCustomShuffleReader coalesced
                     :                 :     +- ShuffleQueryStage 16
                     :                 :        +- GpuColumnarExchange gpuhashpartitioning(d_week_seq#616, 200), ENSURE_REQUIREMENTS, [id=#340638]
                     :                 :           +- GpuProject [d_week_seq#616, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475, s_store_id#713, s_store_name#717], true
                     :                 :              +- GpuShuffledHashJoin [ss_store_sk#259], [s_store_sk#712], Inner, GpuBuildRight, false
                     :                 :                 :- GpuShuffleCoalesce 2147483647
                     :                 :                 :  +- GpuCustomShuffleReader coalesced
                     :                 :                 :     +- ShuffleQueryStage 13
                     :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#340333]
                     :                 :                 :           +- GpuHashAggregate(keys=[d_week_seq#616, ss_store_sk#259], functions=[gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN ss_sales_price#265 END), LongType, false), gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN ss_sales_price#265 END), LongType, false), gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN ss_sales_price#265 END), LongType, false), gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN ss_sales_price#265 END), LongType, false), gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN ss_sales_price#265 END), LongType, false), gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN ss_sales_price#265 END), LongType, false), gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN ss_sales_price#265 END), LongType, false)], output=[d_week_seq#616, ss_store_sk#259, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475])
                     :                 :                 :              +- GpuShuffleCoalesce 2147483647
                     :                 :                 :                 +- GpuCustomShuffleReader coalesced
                     :                 :                 :                    +- ShuffleQueryStage 10
                     :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(d_week_seq#616, ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#340009]
                     :                 :                 :                          +- GpuHashAggregate(keys=[d_week_seq#616, ss_store_sk#259], functions=[partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN ss_sales_price#265 END), LongType, false), partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN ss_sales_price#265 END), LongType, false), partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN ss_sales_price#265 END), LongType, false), partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN ss_sales_price#265 END), LongType, false), partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN ss_sales_price#265 END), LongType, false), partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN ss_sales_price#265 END), LongType, false), partial_gpubasicsum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN ss_sales_price#265 END), LongType, false)], output=[d_week_seq#616, ss_store_sk#259, sum#19592L, sum#19593L, sum#19594L, sum#19595L, sum#19596L, sum#19597L, sum#19598L])
                     :                 :                 :                             +- GpuProject [ss_store_sk#259, ss_sales_price#265, d_week_seq#616, d_day_name#626], true
                     :                 :                 :                                +- GpuShuffledHashJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner, GpuBuildRight, false
                     :                 :                 :                                   :- GpuShuffleCoalesce 2147483647
                     :                 :                 :                                   :  +- GpuCustomShuffleReader coalesced
                     :                 :                 :                                   :     +- ShuffleQueryStage 0
                     :                 :                 :                                   :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#338297]
                     :                 :                 :                                   :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                 :                 :                                   :              +- GpuFilter (gpuisnotnull(ss_sold_date_sk#252) AND gpuisnotnull(ss_store_sk#259)), true
                     :                 :                 :                                   :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#252,ss_store_sk#259,ss_sales_price#265] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#252), isnotnull(ss_store_sk#259)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>
                     :                 :                 :                                   +- GpuCustomShuffleReader coalesced
                     :                 :                 :                                      +- ShuffleQueryStage 1
                     :                 :                 :                                         +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#338325]
                     :                 :                 :                                            +- GpuCoalesceBatches targetsize(2147483647)
                     :                 :                 :                                               +- GpuFilter (gpuisnotnull(d_date_sk#612) AND gpuisnotnull(d_week_seq#616)), true
                     :                 :                 :                                                  +- GpuFileGpuScan parquet [d_date_sk#612,d_week_seq#616,d_day_name#626] Batched: true, DataFilters: [isnotnull(d_date_sk#612), isnotnull(d_week_seq#616)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
                     :                 :                 +- GpuCustomShuffleReader coalesced
                     :                 :                    +- ShuffleQueryStage 2
                     :                 :                       +- GpuColumnarExchange gpuhashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#338360]
                     :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                     :                 :                             +- GpuFilter (gpuisnotnull(s_store_sk#712) AND gpuisnotnull(s_store_id#713)), true
                     :                 :                                +- GpuFileGpuScan parquet [s_store_sk#712,s_store_id#713,s_store_name#717] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_id#713)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string>
                     :                 +- GpuCustomShuffleReader coalesced
                     :                    +- ShuffleQueryStage 3
                     :                       +- GpuColumnarExchange gpuhashpartitioning(d_week_seq#19480, 200), ENSURE_REQUIREMENTS, [id=#338401]
                     :                          +- GpuProject [d_week_seq#19480], true
                     :                             +- GpuCoalesceBatches targetsize(2147483647)
                     :                                +- GpuFilter (((gpuisnotnull(d_month_seq#19479) AND (d_month_seq#19479 >= 1183)) AND (d_month_seq#19479 <= 1194)) AND gpuisnotnull(d_week_seq#19480)), true
                     :                                   +- GpuFileGpuScan parquet [d_month_seq#19479,d_week_seq#19480] Batched: true, DataFilters: [isnotnull(d_month_seq#19479), (d_month_seq#19479 >= 1183), (d_month_seq#19479 <= 1194), isnotnul..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1183), LessThanOrEqual(d_month_seq,1194),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>
                     +- GpuCustomShuffleReader coalesced
                        +- ShuffleQueryStage 18
                           +- GpuColumnarExchange gpuhashpartitioning(s_store_id2#19461, (d_week_seq2#19460 - 52), 200), ENSURE_REQUIREMENTS, [id=#340902]
                              +- GpuProject [d_week_seq#616 AS d_week_seq2#19460, s_store_id#19505 AS s_store_id2#19461, sun_sales#19469 AS sun_sales2#19462, mon_sales#19470 AS mon_sales2#19463, tue_sales#19471 AS tue_sales2#19464, wed_sales#19472 AS wed_sales2#19465, thu_sales#19473 AS thu_sales2#19466, fri_sales#19474 AS fri_sales2#19467, sat_sales#19475 AS sat_sales2#19468], true
                                 +- GpuShuffledHashJoin [d_week_seq#616], [d_week_seq#19537], Inner, GpuBuildRight, false
                                    :- GpuShuffleCoalesce 2147483647
                                    :  +- GpuCustomShuffleReader coalesced
                                    :     +- ShuffleQueryStage 17
                                    :        +- GpuColumnarExchange gpuhashpartitioning(d_week_seq#616, 200), ENSURE_REQUIREMENTS, [id=#340721]
                                    :           +- GpuProject [d_week_seq#616, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475, s_store_id#19505], true
                                    :              +- GpuShuffledHashJoin [ss_store_sk#259], [s_store_sk#19504], Inner, GpuBuildRight, false
                                    :                 :- GpuShuffleCoalesce 2147483647
                                    :                 :  +- GpuCustomShuffleReader coalesced
                                    :                 :     +- ShuffleQueryStage 15
                                    :                 :        +- ReusedExchange [d_week_seq#616, ss_store_sk#259, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475], GpuColumnarExchange gpuhashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#340333]
                                    :                 +- GpuCustomShuffleReader coalesced
                                    :                    +- ShuffleQueryStage 8
                                    :                       +- GpuColumnarExchange gpuhashpartitioning(s_store_sk#19504, 200), ENSURE_REQUIREMENTS, [id=#338560]
                                    :                          +- GpuCoalesceBatches targetsize(2147483647)
                                    :                             +- GpuFilter (gpuisnotnull(s_store_sk#19504) AND gpuisnotnull(s_store_id#19505)), true
                                    :                                +- GpuFileGpuScan parquet [s_store_sk#19504,s_store_id#19505] Batched: true, DataFilters: [isnotnull(s_store_sk#19504), isnotnull(s_store_id#19505)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                                    +- GpuCustomShuffleReader coalesced
                                       +- ShuffleQueryStage 9
                                          +- GpuColumnarExchange gpuhashpartitioning(d_week_seq#19537, 200), ENSURE_REQUIREMENTS, [id=#338601]
                                             +- GpuProject [d_week_seq#19537], true
                                                +- GpuCoalesceBatches targetsize(2147483647)
                                                   +- GpuFilter (((gpuisnotnull(d_month_seq#19536) AND (d_month_seq#19536 >= 1195)) AND (d_month_seq#19536 <= 1206)) AND gpuisnotnull(d_week_seq#19537)), true
                                                      +- GpuFileGpuScan parquet [d_month_seq#19536,d_week_seq#19537] Batched: true, DataFilters: [isnotnull(d_month_seq#19536), (d_month_seq#19536 >= 1195), (d_month_seq#19536 <= 1206), isnotnul..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1195), LessThanOrEqual(d_month_seq,1206),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[s_store_name1#19449 ASC NULLS FIRST,s_store_id1#19451 ASC NULLS FIRST,d_week_seq1#19450 ASC NULLS FIRST], output=[s_store_name1#19449,s_store_id1#19451,d_week_seq1#19450,(sun_sales1 / sun_sales2)#19568,(mon_sales1 / mon_sales2)#19569,(tue_sales1 / tue_sales2)#19570,(wed_sales1 / wed_sales2)#19571,(thu_sales1 / thu_sales2)#19572,(fri_sales1 / fri_sales2)#19573,(sat_sales1 / sat_sales2)#19574])
   +- Project [s_store_name1#19449, s_store_id1#19451, d_week_seq1#19450, CheckOverflow((promote_precision(sun_sales1#19452) / promote_precision(sun_sales2#19462)), DecimalType(37,20), true) AS (sun_sales1 / sun_sales2)#19568, CheckOverflow((promote_precision(mon_sales1#19453) / promote_precision(mon_sales2#19463)), DecimalType(37,20), true) AS (mon_sales1 / mon_sales2)#19569, CheckOverflow((promote_precision(tue_sales1#19454) / promote_precision(tue_sales2#19464)), DecimalType(37,20), true) AS (tue_sales1 / tue_sales2)#19570, CheckOverflow((promote_precision(wed_sales1#19455) / promote_precision(wed_sales2#19465)), DecimalType(37,20), true) AS (wed_sales1 / wed_sales2)#19571, CheckOverflow((promote_precision(thu_sales1#19456) / promote_precision(thu_sales2#19466)), DecimalType(37,20), true) AS (thu_sales1 / thu_sales2)#19572, CheckOverflow((promote_precision(fri_sales1#19457) / promote_precision(fri_sales2#19467)), DecimalType(37,20), true) AS (fri_sales1 / fri_sales2)#19573, CheckOverflow((promote_precision(sat_sales1#19458) / promote_precision(sat_sales2#19468)), DecimalType(37,20), true) AS (sat_sales1 / sat_sales2)#19574]
      +- SortMergeJoin [s_store_id1#19451, d_week_seq1#19450], [s_store_id2#19461, (d_week_seq2#19460 - 52)], Inner
         :- Sort [s_store_id1#19451 ASC NULLS FIRST, d_week_seq1#19450 ASC NULLS FIRST], false, 0
         :  +- Exchange hashpartitioning(s_store_id1#19451, d_week_seq1#19450, 200), ENSURE_REQUIREMENTS, [id=#337485]
         :     +- Project [s_store_name#717 AS s_store_name1#19449, d_week_seq#616 AS d_week_seq1#19450, s_store_id#713 AS s_store_id1#19451, sun_sales#19469 AS sun_sales1#19452, mon_sales#19470 AS mon_sales1#19453, tue_sales#19471 AS tue_sales1#19454, wed_sales#19472 AS wed_sales1#19455, thu_sales#19473 AS thu_sales1#19456, fri_sales#19474 AS fri_sales1#19457, sat_sales#19475 AS sat_sales1#19458]
         :        +- SortMergeJoin [d_week_seq#616], [d_week_seq#19480], Inner
         :           :- Sort [d_week_seq#616 ASC NULLS FIRST], false, 0
         :           :  +- Exchange hashpartitioning(d_week_seq#616, 200), ENSURE_REQUIREMENTS, [id=#337450]
         :           :     +- Project [d_week_seq#616, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475, s_store_id#713, s_store_name#717]
         :           :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
         :           :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
         :           :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#337442]
         :           :           :     +- HashAggregate(keys=[d_week_seq#616, ss_store_sk#259], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN ss_sales_price#265 END))], output=[d_week_seq#616, ss_store_sk#259, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475])
         :           :           :        +- Exchange hashpartitioning(d_week_seq#616, ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#337438]
         :           :           :           +- HashAggregate(keys=[d_week_seq#616, ss_store_sk#259], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN ss_sales_price#265 END))], output=[d_week_seq#616, ss_store_sk#259, sum#19592L, sum#19593L, sum#19594L, sum#19595L, sum#19596L, sum#19597L, sum#19598L])
         :           :           :              +- Project [ss_store_sk#259, ss_sales_price#265, d_week_seq#616, d_day_name#626]
         :           :           :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
         :           :           :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
         :           :           :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#337430]
         :           :           :                    :     +- Filter (isnotnull(ss_sold_date_sk#252) AND isnotnull(ss_store_sk#259))
         :           :           :                    :        +- FileScan parquet [ss_sold_date_sk#252,ss_store_sk#259,ss_sales_price#265] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#252), isnotnull(ss_store_sk#259)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>
         :           :           :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :           :           :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#337431]
         :           :           :                          +- Filter (isnotnull(d_date_sk#612) AND isnotnull(d_week_seq#616))
         :           :           :                             +- FileScan parquet [d_date_sk#612,d_week_seq#616,d_day_name#626] Batched: true, DataFilters: [isnotnull(d_date_sk#612), isnotnull(d_week_seq#616)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
         :           :           +- Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
         :           :              +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#337443]
         :           :                 +- Filter (isnotnull(s_store_sk#712) AND isnotnull(s_store_id#713))
         :           :                    +- FileScan parquet [s_store_sk#712,s_store_id#713,s_store_name#717] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_id#713)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_store_name:string>
         :           +- Sort [d_week_seq#19480 ASC NULLS FIRST], false, 0
         :              +- Exchange hashpartitioning(d_week_seq#19480, 200), ENSURE_REQUIREMENTS, [id=#337451]
         :                 +- Project [d_week_seq#19480]
         :                    +- Filter (((isnotnull(d_month_seq#19479) AND (d_month_seq#19479 >= 1183)) AND (d_month_seq#19479 <= 1194)) AND isnotnull(d_week_seq#19480))
         :                       +- FileScan parquet [d_month_seq#19479,d_week_seq#19480] Batched: true, DataFilters: [isnotnull(d_month_seq#19479), (d_month_seq#19479 >= 1183), (d_month_seq#19479 <= 1194), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1183), LessThanOrEqual(d_month_seq,1194),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>
         +- Sort [s_store_id2#19461 ASC NULLS FIRST, (d_week_seq2#19460 - 52) ASC NULLS FIRST], false, 0
            +- Exchange hashpartitioning(s_store_id2#19461, (d_week_seq2#19460 - 52), 200), ENSURE_REQUIREMENTS, [id=#337486]
               +- Project [d_week_seq#616 AS d_week_seq2#19460, s_store_id#19505 AS s_store_id2#19461, sun_sales#19469 AS sun_sales2#19462, mon_sales#19470 AS mon_sales2#19463, tue_sales#19471 AS tue_sales2#19464, wed_sales#19472 AS wed_sales2#19465, thu_sales#19473 AS thu_sales2#19466, fri_sales#19474 AS fri_sales2#19467, sat_sales#19475 AS sat_sales2#19468]
                  +- SortMergeJoin [d_week_seq#616], [d_week_seq#19537], Inner
                     :- Sort [d_week_seq#616 ASC NULLS FIRST], false, 0
                     :  +- Exchange hashpartitioning(d_week_seq#616, 200), ENSURE_REQUIREMENTS, [id=#337477]
                     :     +- Project [d_week_seq#616, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475, s_store_id#19505]
                     :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#19504], Inner
                     :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
                     :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#337469]
                     :           :     +- HashAggregate(keys=[d_week_seq#616, ss_store_sk#259], functions=[sum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN ss_sales_price#265 END)), sum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN ss_sales_price#265 END))], output=[d_week_seq#616, ss_store_sk#259, sun_sales#19469, mon_sales#19470, tue_sales#19471, wed_sales#19472, thu_sales#19473, fri_sales#19474, sat_sales#19475])
                     :           :        +- Exchange hashpartitioning(d_week_seq#616, ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#337465]
                     :           :           +- HashAggregate(keys=[d_week_seq#616, ss_store_sk#259], functions=[partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN ss_sales_price#265 END)), partial_sum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN ss_sales_price#265 END))], output=[d_week_seq#616, ss_store_sk#259, sum#19606L, sum#19607L, sum#19608L, sum#19609L, sum#19610L, sum#19611L, sum#19612L])
                     :           :              +- Project [ss_store_sk#259, ss_sales_price#265, d_week_seq#616, d_day_name#626]
                     :           :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                     :           :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                     :           :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#337457]
                     :           :                    :     +- Filter (isnotnull(ss_sold_date_sk#252) AND isnotnull(ss_store_sk#259))
                     :           :                    :        +- FileScan parquet [ss_sold_date_sk#252,ss_store_sk#259,ss_sales_price#265] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#252), isnotnull(ss_store_sk#259)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_store_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_store_sk:int,ss_sales_price:decimal(7,2)>
                     :           :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                     :           :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#337458]
                     :           :                          +- Filter (isnotnull(d_date_sk#612) AND isnotnull(d_week_seq#616))
                     :           :                             +- FileScan parquet [d_date_sk#612,d_week_seq#616,d_day_name#626] Batched: true, DataFilters: [isnotnull(d_date_sk#612), isnotnull(d_week_seq#616)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk), IsNotNull(d_week_seq)], ReadSchema: struct<d_date_sk:int,d_week_seq:int,d_day_name:string>
                     :           +- Sort [s_store_sk#19504 ASC NULLS FIRST], false, 0
                     :              +- Exchange hashpartitioning(s_store_sk#19504, 200), ENSURE_REQUIREMENTS, [id=#337470]
                     :                 +- Filter (isnotnull(s_store_sk#19504) AND isnotnull(s_store_id#19505))
                     :                    +- FileScan parquet [s_store_sk#19504,s_store_id#19505] Batched: true, DataFilters: [isnotnull(s_store_sk#19504), isnotnull(s_store_id#19505)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_id)], ReadSchema: struct<s_store_sk:int,s_store_id:string>
                     +- Sort [d_week_seq#19537 ASC NULLS FIRST], false, 0
                        +- Exchange hashpartitioning(d_week_seq#19537, 200), ENSURE_REQUIREMENTS, [id=#337478]
                           +- Project [d_week_seq#19537]
                              +- Filter (((isnotnull(d_month_seq#19536) AND (d_month_seq#19536 >= 1195)) AND (d_month_seq#19536 <= 1206)) AND isnotnull(d_week_seq#19537))
                                 +- FileScan parquet [d_month_seq#19536,d_week_seq#19537] Batched: true, DataFilters: [isnotnull(d_month_seq#19536), (d_month_seq#19536 >= 1195), (d_month_seq#19536 <= 1206), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_month_seq), GreaterThanOrEqual(d_month_seq,1195), LessThanOrEqual(d_month_seq,1206),..., ReadSchema: struct<d_month_seq:int,d_week_seq:int>
