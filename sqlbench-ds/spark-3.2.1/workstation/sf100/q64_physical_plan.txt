AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(65) Project [product_name#12675, store_name#12677, store_zip#12678, b_street_number#12679, b_street_name#12680, b_city#12681, b_zip#12682, c_street_number#12683, c_street_name#12684, c_city#12685, c_zip#12686, syear#12687, cnt#12690L, s11#12667, s21#12668, s31#12669, s12#12670, s22#12671, s32#12672, syear#12800, cnt#12803L]
   +- *(65) Sort [product_name#12675 ASC NULLS FIRST, store_name#12677 ASC NULLS FIRST, cnt#12803L ASC NULLS FIRST, s1#12691 ASC NULLS FIRST, s1#12804 ASC NULLS FIRST], true, 0
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 72
            +- Exchange rangepartitioning(product_name#12675 ASC NULLS FIRST, store_name#12677 ASC NULLS FIRST, cnt#12803L ASC NULLS FIRST, s1#12691 ASC NULLS FIRST, s1#12804 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#111362]
               +- *(64) Project [product_name#12675, store_name#12677, store_zip#12678, b_street_number#12679, b_street_name#12680, b_city#12681, b_zip#12682, c_street_number#12683, c_street_name#12684, c_city#12685, c_zip#12686, syear#12687, cnt#12690L, s1#12691 AS s11#12667, s2#12692 AS s21#12668, s3#12693 AS s31#12669, s1#12804 AS s12#12670, s2#12805 AS s22#12671, s3#12806 AS s32#12672, syear#12800, cnt#12803L, s1#12691, s1#12804]
                  +- *(64) BroadcastHashJoin [item_sk#12676, store_name#12677, store_zip#12678], [item_sk#12789, store_name#12790, store_zip#12791], Inner, BuildLeft, (cnt#12803L <= cnt#12690L), false
                     :- BroadcastQueryStage 71
                     :  +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, true], input[2, string, true], input[3, string, true]),false), [id=#111296]
                     :     +- *(63) HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#675)), sum(UnscaledValue(ss_list_price#676)), sum(UnscaledValue(ss_coupon_amt#683))], output=[product_name#12675, item_sk#12676, store_name#12677, store_zip#12678, b_street_number#12679, b_street_name#12680, b_city#12681, b_zip#12682, c_street_number#12683, c_street_name#12684, c_city#12685, c_zip#12686, syear#12687, cnt#12690L, s1#12691, s2#12692, s3#12693])
                     :        +- AQEShuffleRead coalesced
                     :           +- ShuffleQueryStage 69
                     :              +- Exchange hashpartitioning(i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728, 200), ENSURE_REQUIREMENTS, [id=#110816]
                     :                 +- *(59) HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#675)), partial_sum(UnscaledValue(ss_list_price#676)), partial_sum(UnscaledValue(ss_coupon_amt#683))], output=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728, count#13187L, sum#13188L, sum#13189L, sum#13190L])
                     :                    +- *(59) Project [ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, d_year#12700, d_year#12728, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, i_item_sk#500, i_product_name#521]
                     :                       +- *(59) BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
                     :                          :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#12700, d_year#12728, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773]
                     :                          :  +- *(59) BroadcastHashJoin [hd_income_band_sk#12760], [ib_income_band_sk#12777], Inner, BuildRight, false
                     :                          :     :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#12700, d_year#12728, hd_income_band_sk#12760, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773]
                     :                          :     :  +- *(59) BroadcastHashJoin [hd_income_band_sk#655], [ib_income_band_sk#302], Inner, BuildRight, false
                     :                          :     :     :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#12700, d_year#12728, hd_income_band_sk#655, hd_income_band_sk#12760, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773]
                     :                          :     :     :  +- *(59) BroadcastHashJoin [c_current_addr_sk#566], [ca_address_sk#12764], Inner, BuildRight, false
                     :                          :     :     :     :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#12700, d_year#12728, hd_income_band_sk#655, hd_income_band_sk#12760, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223]
                     :                          :     :     :     :  +- *(59) BroadcastHashJoin [ss_addr_sk#670], [ca_address_sk#214], Inner, BuildRight, false
                     :                          :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#12700, d_year#12728, hd_income_band_sk#655, hd_income_band_sk#12760]
                     :                          :     :     :     :     :  +- *(59) BroadcastHashJoin [c_current_hdemo_sk#565], [hd_demo_sk#12759], Inner, BuildRight, false
                     :                          :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728, hd_income_band_sk#655]
                     :                          :     :     :     :     :     :  +- *(59) BroadcastHashJoin [ss_hdemo_sk#669], [hd_demo_sk#654], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728]
                     :                          :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [ss_promo_sk#672], [p_promo_sk#750], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728]
                     :                          :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [c_current_cdemo_sk#564], [cd_demo_sk#12750], Inner, BuildRight, NOT (cd_marital_status#50 = cd_marital_status#12752), false
                     :                          :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728, cd_marital_status#50]
                     :                          :     :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [ss_cdemo_sk#668], [cd_demo_sk#48], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728]
                     :                          :     :     :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [c_first_shipto_date_sk#567], [d_date_sk#12722], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, d_year#12700]
                     :                          :     :     :     :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [c_first_sales_date_sk#568], [d_date_sk#12694], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, c_first_sales_date_sk#568]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :  +- *(59) SortMergeJoin [ss_customer_sk#667], [c_customer_sk#562], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :- *(57) Sort [ss_customer_sk#667 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :  +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :     +- ShuffleQueryStage 67
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(ss_customer_sk#667, 200), ENSURE_REQUIREMENTS, [id=#110114]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(53) Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(53) BroadcastHashJoin [ss_store_sk#671], [s_store_sk#326], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :- *(53) Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :  +- *(53) BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :- *(53) Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :  +- *(53) SortMergeJoin [ss_item_sk#666], [cs_item_sk#133], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :- *(51) Sort [ss_item_sk#666 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :  +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :     +- ShuffleQueryStage 61
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :        +- Exchange hashpartitioning(ss_item_sk#666, 200), ENSURE_REQUIREMENTS, [id=#107306]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :           +- *(41) Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :              +- *(41) SortMergeJoin [ss_item_sk#666, ss_ticket_number#673L], [sr_item_sk#712, sr_ticket_number#719L], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :- *(39) Sort [ss_item_sk#666 ASC NULLS FIRST, ss_ticket_number#673L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :  +- ShuffleQueryStage 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :     +- Exchange hashpartitioning(ss_item_sk#666, ss_ticket_number#673L, 200), ENSURE_REQUIREMENTS, [id=#101140]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :        +- *(1) Filter ((((((((isnotnull(ss_item_sk#666) AND isnotnull(ss_ticket_number#673L)) AND isnotnull(ss_sold_date_sk#664)) AND isnotnull(ss_store_sk#671)) AND isnotnull(ss_customer_sk#667)) AND isnotnull(ss_cdemo_sk#668)) AND isnotnull(ss_promo_sk#672)) AND isnotnull(ss_hdemo_sk#669)) AND isnotnull(ss_addr_sk#670))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :           +- *(1) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :              +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_wholesale_cost#675,ss_list_price#676,ss_coupon_amt#683] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_ticket_number#673L), isnotnull(ss_sold_date_sk#664), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 +- *(40) Sort [sr_item_sk#712 ASC NULLS FIRST, sr_ticket_number#719L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                    +- ShuffleQueryStage 1
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                       +- Exchange hashpartitioning(sr_item_sk#712, sr_ticket_number#719L, 200), ENSURE_REQUIREMENTS, [id=#101157]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                          +- *(2) Filter (isnotnull(sr_item_sk#712) AND isnotnull(sr_ticket_number#719L))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                             +- *(2) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                                +- FileScan parquet [sr_item_sk#712,sr_ticket_number#719L] Batched: true, DataFilters: [isnotnull(sr_item_sk#712), isnotnull(sr_ticket_number#719L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     +- *(52) Sort [cs_item_sk#133 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :        +- *(52) Project [cs_item_sk#133]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :           +- *(52) Filter (isnotnull(sale#12673) AND (cast(sale#12673 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12674)), DecimalType(21,2), true)))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :              +- *(52) HashAggregate(keys=[cs_item_sk#133], functions=[sum(UnscaledValue(cs_ext_list_price#143)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sale#12673, refund#12674])
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                 +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                    +- ShuffleQueryStage 64
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                       +- Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#108957]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                          +- *(47) HashAggregate(keys=[cs_item_sk#133], functions=[partial_sum(UnscaledValue(cs_ext_list_price#143)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sum#13194L, sum#13195, isEmpty#13196])
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                             +- *(47) Project [cs_item_sk#133, cs_ext_list_price#143, cr_refunded_cash#271, cr_reversed_charge#272, cr_store_credit#273]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                +- *(47) SortMergeJoin [cs_item_sk#133, cs_order_number#135L], [cr_item_sk#250, cr_order_number#264L], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :- *(45) Sort [cs_item_sk#133 ASC NULLS FIRST, cs_order_number#135L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :  +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :     +- ShuffleQueryStage 2
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :        +- Exchange hashpartitioning(cs_item_sk#133, cs_order_number#135L, 200), ENSURE_REQUIREMENTS, [id=#101178]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :           +- *(3) Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_order_number#135L))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :              +- *(3) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :                 +- FileScan parquet [cs_item_sk#133,cs_order_number#135L,cs_ext_list_price#143] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_order_number#135L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   +- *(46) Sort [cr_item_sk#250 ASC NULLS FIRST, cr_order_number#264L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                      +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                         +- ShuffleQueryStage 3
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                            +- Exchange hashpartitioning(cr_item_sk#250, cr_order_number#264L, 200), ENSURE_REQUIREMENTS, [id=#101195]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                               +- *(4) Filter (isnotnull(cr_item_sk#250) AND isnotnull(cr_order_number#264L))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                                  +- *(4) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                                     +- FileScan parquet [cr_item_sk#250,cr_order_number#264L,cr_refunded_cash#271,cr_reversed_charge#272,cr_store_credit#273] Batched: true, DataFilters: [isnotnull(cr_item_sk#250), isnotnull(cr_order_number#264L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     +- BroadcastQueryStage 4
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101222]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :           +- *(5) Filter ((isnotnull(d_year#604) AND (d_year#604 = 2001)) AND isnotnull(d_date_sk#598))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :              +- *(5) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :                 +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 +- BroadcastQueryStage 5
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101239]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                       +- *(6) Filter ((isnotnull(s_store_sk#326) AND isnotnull(s_store_name#331)) AND isnotnull(s_zip#351))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                          +- *(6) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [s_store_sk#326,s_store_name#331,s_zip#351] Batched: true, DataFilters: [isnotnull(s_store_sk#326), isnotnull(s_store_name#331), isnotnull(s_zip#351)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     +- *(58) Sort [c_customer_sk#562 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :        +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :           +- ShuffleQueryStage 6
                     :                          :     :     :     :     :     :     :     :     :     :     :     :              +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#101258]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :                 +- *(7) Filter (((((isnotnull(c_customer_sk#562) AND isnotnull(c_first_sales_date_sk#568)) AND isnotnull(c_first_shipto_date_sk#567)) AND isnotnull(c_current_cdemo_sk#564)) AND isnotnull(c_current_hdemo_sk#565)) AND isnotnull(c_current_addr_sk#566))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :                    +- *(7) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :                       +- FileScan parquet [c_customer_sk#562,c_current_cdemo_sk#564,c_current_hdemo_sk#565,c_current_addr_sk#566,c_first_shipto_date_sk#567,c_first_sales_date_sk#568] Batched: true, DataFilters: [isnotnull(c_customer_sk#562), isnotnull(c_first_sales_date_sk#568), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                     :                          :     :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 7
                     :                          :     :     :     :     :     :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101277]
                     :                          :     :     :     :     :     :     :     :     :     :     :           +- *(8) Filter isnotnull(d_date_sk#12694)
                     :                          :     :     :     :     :     :     :     :     :     :     :              +- *(8) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet [d_date_sk#12694,d_year#12700] Batched: true, DataFilters: [isnotnull(d_date_sk#12694)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                          :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 9
                     :                          :     :     :     :     :     :     :     :     :     :        +- ReusedExchange [d_date_sk#12722, d_year#12728], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101277]
                     :                          :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 10
                     :                          :     :     :     :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101313]
                     :                          :     :     :     :     :     :     :     :     :           +- *(10) Filter (isnotnull(cd_demo_sk#48) AND isnotnull(cd_marital_status#50))
                     :                          :     :     :     :     :     :     :     :     :              +- *(10) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :                 +- FileScan parquet [cd_demo_sk#48,cd_marital_status#50] Batched: true, DataFilters: [isnotnull(cd_demo_sk#48), isnotnull(cd_marital_status#50)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                     :                          :     :     :     :     :     :     :     :     +- BroadcastQueryStage 12
                     :                          :     :     :     :     :     :     :     :        +- ReusedExchange [cd_demo_sk#12750, cd_marital_status#12752], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101313]
                     :                          :     :     :     :     :     :     :     +- BroadcastQueryStage 13
                     :                          :     :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101349]
                     :                          :     :     :     :     :     :     :           +- *(12) Filter isnotnull(p_promo_sk#750)
                     :                          :     :     :     :     :     :     :              +- *(12) ColumnarToRow
                     :                          :     :     :     :     :     :     :                 +- FileScan parquet [p_promo_sk#750] Batched: true, DataFilters: [isnotnull(p_promo_sk#750)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                     :                          :     :     :     :     :     :     +- BroadcastQueryStage 14
                     :                          :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101366]
                     :                          :     :     :     :     :     :           +- *(13) Filter (isnotnull(hd_demo_sk#654) AND isnotnull(hd_income_band_sk#655))
                     :                          :     :     :     :     :     :              +- *(13) ColumnarToRow
                     :                          :     :     :     :     :     :                 +- FileScan parquet [hd_demo_sk#654,hd_income_band_sk#655] Batched: true, DataFilters: [isnotnull(hd_demo_sk#654), isnotnull(hd_income_band_sk#655)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                     :                          :     :     :     :     :     +- BroadcastQueryStage 16
                     :                          :     :     :     :     :        +- ReusedExchange [hd_demo_sk#12759, hd_income_band_sk#12760], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101366]
                     :                          :     :     :     :     +- BroadcastQueryStage 17
                     :                          :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101402]
                     :                          :     :     :     :           +- *(15) Filter isnotnull(ca_address_sk#214)
                     :                          :     :     :     :              +- *(15) ColumnarToRow
                     :                          :     :     :     :                 +- FileScan parquet [ca_address_sk#214,ca_street_number#216,ca_street_name#217,ca_city#220,ca_zip#223] Batched: true, DataFilters: [isnotnull(ca_address_sk#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                     :                          :     :     :     +- BroadcastQueryStage 19
                     :                          :     :     :        +- ReusedExchange [ca_address_sk#12764, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101402]
                     :                          :     :     +- BroadcastQueryStage 20
                     :                          :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101438]
                     :                          :     :           +- *(17) Filter isnotnull(ib_income_band_sk#302)
                     :                          :     :              +- *(17) ColumnarToRow
                     :                          :     :                 +- FileScan parquet [ib_income_band_sk#302] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#302)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                     :                          :     +- BroadcastQueryStage 22
                     :                          :        +- ReusedExchange [ib_income_band_sk#12777], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101438]
                     :                          +- BroadcastQueryStage 23
                     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#101476]
                     :                                +- *(19) Project [i_item_sk#500, i_product_name#521]
                     :                                   +- *(19) Filter ((((((isnotnull(i_current_price#505) AND i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#505 >= 75.00)) AND (i_current_price#505 <= 85.00)) AND (i_current_price#505 >= 76.00)) AND (i_current_price#505 <= 90.00)) AND isnotnull(i_item_sk#500))
                     :                                      +- *(19) ColumnarToRow
                     :                                         +- FileScan parquet [i_item_sk#500,i_current_price#505,i_color#517,i_product_name#521] Batched: true, DataFilters: [isnotnull(i_current_price#505), i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
                     +- *(64) HashAggregate(keys=[i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#12839)), sum(UnscaledValue(ss_list_price#12840)), sum(UnscaledValue(ss_coupon_amt#12847))], output=[item_sk#12789, store_name#12790, store_zip#12791, syear#12800, cnt#12803L, s1#12804, s2#12805, s3#12806])
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage 70
                              +- Exchange hashpartitioning(i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994, 200), ENSURE_REQUIREMENTS, [id=#111168]
                                 +- *(62) HashAggregate(keys=[i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#12839)), partial_sum(UnscaledValue(ss_list_price#12840)), partial_sum(UnscaledValue(ss_coupon_amt#12847))], output=[i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994, count#13187L, sum#13200L, sum#13201L, sum#13202L])
                                    +- *(62) Project [ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, d_year#12966, d_year#12994, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, i_item_sk#13142, i_product_name#13163]
                                       +- *(62) BroadcastHashJoin [ss_item_sk#12830], [i_item_sk#13142], Inner, BuildRight, false
                                          :- *(62) Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, d_year#12966, d_year#12994, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132]
                                          :  +- *(62) BroadcastHashJoin [hd_income_band_sk#13106], [ib_income_band_sk#13139], Inner, BuildRight, false
                                          :     :- *(62) Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, d_year#12966, d_year#12994, hd_income_band_sk#13106, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132]
                                          :     :  +- *(62) BroadcastHashJoin [hd_income_band_sk#13101], [ib_income_band_sk#13136], Inner, BuildRight, false
                                          :     :     :- *(62) Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, d_year#12966, d_year#12994, hd_income_band_sk#13101, hd_income_band_sk#13106, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132]
                                          :     :     :  +- *(62) BroadcastHashJoin [c_current_addr_sk#13049], [ca_address_sk#13123], Inner, BuildRight, false
                                          :     :     :     :- *(62) Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_addr_sk#13049, d_year#12966, d_year#12994, hd_income_band_sk#13101, hd_income_band_sk#13106, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119]
                                          :     :     :     :  +- *(62) BroadcastHashJoin [ss_addr_sk#12834], [ca_address_sk#13110], Inner, BuildRight, false
                                          :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_addr_sk#12834, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_addr_sk#13049, d_year#12966, d_year#12994, hd_income_band_sk#13101, hd_income_band_sk#13106]
                                          :     :     :     :     :  +- *(62) BroadcastHashJoin [c_current_hdemo_sk#13048], [hd_demo_sk#13105], Inner, BuildRight, false
                                          :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_addr_sk#12834, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994, hd_income_band_sk#13101]
                                          :     :     :     :     :     :  +- *(62) BroadcastHashJoin [ss_hdemo_sk#12833], [hd_demo_sk#13100], Inner, BuildRight, false
                                          :     :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994]
                                          :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [ss_promo_sk#12836], [p_promo_sk#13081], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994]
                                          :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [c_current_cdemo_sk#13047], [cd_demo_sk#13072], Inner, BuildRight, NOT (cd_marital_status#13065 = cd_marital_status#13074), false
                                          :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994, cd_marital_status#13065]
                                          :     :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [ss_cdemo_sk#12832], [cd_demo_sk#13063], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994]
                                          :     :     :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [c_first_shipto_date_sk#13050], [d_date_sk#12988], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, c_first_shipto_date_sk#13050, d_year#12966]
                                          :     :     :     :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [c_first_sales_date_sk#13051], [d_date_sk#12960], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#12830, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, c_first_shipto_date_sk#13050, c_first_sales_date_sk#13051]
                                          :     :     :     :     :     :     :     :     :     :     :     :  +- *(62) SortMergeJoin [ss_customer_sk#12831], [c_customer_sk#13045], Inner
                                          :     :     :     :     :     :     :     :     :     :     :     :     :- *(60) Sort [ss_customer_sk#12831 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :     :  +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :     :     +- ShuffleQueryStage 68
                                          :     :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(ss_customer_sk#12831, 200), ENSURE_REQUIREMENTS, [id=#110217]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(56) Project [ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(56) BroadcastHashJoin [ss_store_sk#12835], [s_store_sk#13016], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :- *(56) Project [ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_store_sk#12835, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :  +- *(56) BroadcastHashJoin [ss_sold_date_sk#12828], [d_date_sk#12932], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :- *(56) Project [ss_sold_date_sk#12828, ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_store_sk#12835, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :  +- *(56) SortMergeJoin [ss_item_sk#12830], [cs_item_sk#12886], Inner
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :- *(54) Sort [ss_item_sk#12830 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :  +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :     +- ShuffleQueryStage 63
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :        +- ReusedExchange [ss_sold_date_sk#12828, ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_store_sk#12835, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847], Exchange hashpartitioning(ss_item_sk#666, 200), ENSURE_REQUIREMENTS, [id=#107306]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     +- *(55) Sort [cs_item_sk#12886 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :        +- *(55) Project [cs_item_sk#12886]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :           +- *(55) Filter (isnotnull(sale#12673) AND (cast(sale#12673 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12674)), DecimalType(21,2), true)))
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :              +- *(55) HashAggregate(keys=[cs_item_sk#12886], functions=[sum(UnscaledValue(cs_ext_list_price#12896)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#12928 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#12929 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#12930 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#12886, sale#12673, refund#12674])
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                 +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                    +- ShuffleQueryStage 66
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                       +- ReusedExchange [cs_item_sk#12886, sum#13206L, sum#13207, isEmpty#13208], Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#108957]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     +- BroadcastQueryStage 32
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101590]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :           +- *(24) Filter ((isnotnull(d_year#12938) AND (d_year#12938 = 2002)) AND isnotnull(d_date_sk#12932))
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :              +- *(24) ColumnarToRow
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :                 +- FileScan parquet [d_date_sk#12932,d_year#12938] Batched: true, DataFilters: [isnotnull(d_year#12938), (d_year#12938 = 2002), isnotnull(d_date_sk#12932)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 +- BroadcastQueryStage 34
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                    +- ReusedExchange [s_store_sk#13016, s_store_name#13021, s_zip#13041], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101239]
                                          :     :     :     :     :     :     :     :     :     :     :     :     +- *(61) Sort [c_customer_sk#13045 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :        +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :           +- ShuffleQueryStage 36
                                          :     :     :     :     :     :     :     :     :     :     :     :              +- ReusedExchange [c_customer_sk#13045, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, c_first_shipto_date_sk#13050, c_first_sales_date_sk#13051], Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#101258]
                                          :     :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 38
                                          :     :     :     :     :     :     :     :     :     :     :        +- ReusedExchange [d_date_sk#12960, d_year#12966], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101277]
                                          :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 40
                                          :     :     :     :     :     :     :     :     :     :        +- ReusedExchange [d_date_sk#12988, d_year#12994], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101277]
                                          :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 42
                                          :     :     :     :     :     :     :     :     :        +- ReusedExchange [cd_demo_sk#13063, cd_marital_status#13065], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101313]
                                          :     :     :     :     :     :     :     :     +- BroadcastQueryStage 44
                                          :     :     :     :     :     :     :     :        +- ReusedExchange [cd_demo_sk#13072, cd_marital_status#13074], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101313]
                                          :     :     :     :     :     :     :     +- BroadcastQueryStage 46
                                          :     :     :     :     :     :     :        +- ReusedExchange [p_promo_sk#13081], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101349]
                                          :     :     :     :     :     :     +- BroadcastQueryStage 48
                                          :     :     :     :     :     :        +- ReusedExchange [hd_demo_sk#13100, hd_income_band_sk#13101], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101366]
                                          :     :     :     :     :     +- BroadcastQueryStage 50
                                          :     :     :     :     :        +- ReusedExchange [hd_demo_sk#13105, hd_income_band_sk#13106], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101366]
                                          :     :     :     :     +- BroadcastQueryStage 52
                                          :     :     :     :        +- ReusedExchange [ca_address_sk#13110, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101402]
                                          :     :     :     +- BroadcastQueryStage 54
                                          :     :     :        +- ReusedExchange [ca_address_sk#13123, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101402]
                                          :     :     +- BroadcastQueryStage 56
                                          :     :        +- ReusedExchange [ib_income_band_sk#13136], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101438]
                                          :     +- BroadcastQueryStage 58
                                          :        +- ReusedExchange [ib_income_band_sk#13139], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#101438]
                                          +- BroadcastQueryStage 60
                                             +- ReusedExchange [i_item_sk#13142, i_product_name#13163], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#101476]
+- == Initial Plan ==
   Project [product_name#12675, store_name#12677, store_zip#12678, b_street_number#12679, b_street_name#12680, b_city#12681, b_zip#12682, c_street_number#12683, c_street_name#12684, c_city#12685, c_zip#12686, syear#12687, cnt#12690L, s11#12667, s21#12668, s31#12669, s12#12670, s22#12671, s32#12672, syear#12800, cnt#12803L]
   +- Sort [product_name#12675 ASC NULLS FIRST, store_name#12677 ASC NULLS FIRST, cnt#12803L ASC NULLS FIRST, s1#12691 ASC NULLS FIRST, s1#12804 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(product_name#12675 ASC NULLS FIRST, store_name#12677 ASC NULLS FIRST, cnt#12803L ASC NULLS FIRST, s1#12691 ASC NULLS FIRST, s1#12804 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#100734]
         +- Project [product_name#12675, store_name#12677, store_zip#12678, b_street_number#12679, b_street_name#12680, b_city#12681, b_zip#12682, c_street_number#12683, c_street_name#12684, c_city#12685, c_zip#12686, syear#12687, cnt#12690L, s1#12691 AS s11#12667, s2#12692 AS s21#12668, s3#12693 AS s31#12669, s1#12804 AS s12#12670, s2#12805 AS s22#12671, s3#12806 AS s32#12672, syear#12800, cnt#12803L, s1#12691, s1#12804]
            +- SortMergeJoin [item_sk#12676, store_name#12677, store_zip#12678], [item_sk#12789, store_name#12790, store_zip#12791], Inner, (cnt#12803L <= cnt#12690L)
               :- Sort [item_sk#12676 ASC NULLS FIRST, store_name#12677 ASC NULLS FIRST, store_zip#12678 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(item_sk#12676, store_name#12677, store_zip#12678, 200), ENSURE_REQUIREMENTS, [id=#100727]
               :     +- HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#675)), sum(UnscaledValue(ss_list_price#676)), sum(UnscaledValue(ss_coupon_amt#683))], output=[product_name#12675, item_sk#12676, store_name#12677, store_zip#12678, b_street_number#12679, b_street_name#12680, b_city#12681, b_zip#12682, c_street_number#12683, c_street_name#12684, c_city#12685, c_zip#12686, syear#12687, cnt#12690L, s1#12691, s2#12692, s3#12693])
               :        +- Exchange hashpartitioning(i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728, 200), ENSURE_REQUIREMENTS, [id=#100628]
               :           +- HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#675)), partial_sum(UnscaledValue(ss_list_price#676)), partial_sum(UnscaledValue(ss_coupon_amt#683))], output=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, d_year#604, d_year#12700, d_year#12728, count#13187L, sum#13188L, sum#13189L, sum#13190L])
               :              +- Project [ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, d_year#12700, d_year#12728, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773, i_item_sk#500, i_product_name#521]
               :                 +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
               :                    :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#12700, d_year#12728, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773]
               :                    :  +- BroadcastHashJoin [hd_income_band_sk#12760], [ib_income_band_sk#12777], Inner, BuildRight, false
               :                    :     :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#12700, d_year#12728, hd_income_band_sk#12760, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773]
               :                    :     :  +- BroadcastHashJoin [hd_income_band_sk#655], [ib_income_band_sk#302], Inner, BuildRight, false
               :                    :     :     :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#12700, d_year#12728, hd_income_band_sk#655, hd_income_band_sk#12760, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#12766, ca_street_name#12767, ca_city#12770, ca_zip#12773]
               :                    :     :     :  +- BroadcastHashJoin [c_current_addr_sk#566], [ca_address_sk#12764], Inner, BuildRight, false
               :                    :     :     :     :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#12700, d_year#12728, hd_income_band_sk#655, hd_income_band_sk#12760, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223]
               :                    :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#670], [ca_address_sk#214], Inner, BuildRight, false
               :                    :     :     :     :     :- Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#12700, d_year#12728, hd_income_band_sk#655, hd_income_band_sk#12760]
               :                    :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#565], [hd_demo_sk#12759], Inner, BuildRight, false
               :                    :     :     :     :     :     :- Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728, hd_income_band_sk#655]
               :                    :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#669], [hd_demo_sk#654], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728]
               :                    :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#672], [p_promo_sk#750], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728]
               :                    :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#564], [cd_demo_sk#12750], Inner, BuildRight, NOT (cd_marital_status#50 = cd_marital_status#12752), false
               :                    :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728, cd_marital_status#50]
               :                    :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#668], [cd_demo_sk#48], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#12700, d_year#12728]
               :                    :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#567], [d_date_sk#12722], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, d_year#12700]
               :                    :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#568], [d_date_sk#12694], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, c_first_sales_date_sk#568]
               :                    :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_customer_sk#667], [c_customer_sk#562], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_customer_sk#667 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_customer_sk#667, 200), ENSURE_REQUIREMENTS, [id=#100572]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_store_sk#671], [s_store_sk#326], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :- Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :- Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :  +- SortMergeJoin [ss_item_sk#666], [cs_item_sk#133], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :- Sort [ss_item_sk#666 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :  +- Exchange hashpartitioning(ss_item_sk#666, 200), ENSURE_REQUIREMENTS, [id=#100557]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :     +- Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :        +- SortMergeJoin [ss_item_sk#666, ss_ticket_number#673L], [sr_item_sk#712, sr_ticket_number#719L], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :- Sort [ss_item_sk#666 ASC NULLS FIRST, ss_ticket_number#673L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :  +- Exchange hashpartitioning(ss_item_sk#666, ss_ticket_number#673L, 200), ENSURE_REQUIREMENTS, [id=#100536]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :     +- Filter ((((((((isnotnull(ss_item_sk#666) AND isnotnull(ss_ticket_number#673L)) AND isnotnull(ss_sold_date_sk#664)) AND isnotnull(ss_store_sk#671)) AND isnotnull(ss_customer_sk#667)) AND isnotnull(ss_cdemo_sk#668)) AND isnotnull(ss_promo_sk#672)) AND isnotnull(ss_hdemo_sk#669)) AND isnotnull(ss_addr_sk#670))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :        +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_wholesale_cost#675,ss_list_price#676,ss_coupon_amt#683] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_ticket_number#673L), isnotnull(ss_sold_date_sk#664), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           +- Sort [sr_item_sk#712 ASC NULLS FIRST, sr_ticket_number#719L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :              +- Exchange hashpartitioning(sr_item_sk#712, sr_ticket_number#719L, 200), ENSURE_REQUIREMENTS, [id=#100537]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                 +- Filter (isnotnull(sr_item_sk#712) AND isnotnull(sr_ticket_number#719L))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                    +- FileScan parquet [sr_item_sk#712,sr_ticket_number#719L] Batched: true, DataFilters: [isnotnull(sr_item_sk#712), isnotnull(sr_ticket_number#719L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     +- Sort [cs_item_sk#133 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :        +- Project [cs_item_sk#133]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :           +- Filter (isnotnull(sale#12673) AND (cast(sale#12673 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12674)), DecimalType(21,2), true)))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :              +- HashAggregate(keys=[cs_item_sk#133], functions=[sum(UnscaledValue(cs_ext_list_price#143)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sale#12673, refund#12674])
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                 +- Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#100551]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                    +- HashAggregate(keys=[cs_item_sk#133], functions=[partial_sum(UnscaledValue(cs_ext_list_price#143)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sum#13194L, sum#13195, isEmpty#13196])
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                       +- Project [cs_item_sk#133, cs_ext_list_price#143, cr_refunded_cash#271, cr_reversed_charge#272, cr_store_credit#273]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                          +- SortMergeJoin [cs_item_sk#133, cs_order_number#135L], [cr_item_sk#250, cr_order_number#264L], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :- Sort [cs_item_sk#133 ASC NULLS FIRST, cs_order_number#135L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :  +- Exchange hashpartitioning(cs_item_sk#133, cs_order_number#135L, 200), ENSURE_REQUIREMENTS, [id=#100543]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :     +- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_order_number#135L))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :        +- FileScan parquet [cs_item_sk#133,cs_order_number#135L,cs_ext_list_price#143] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_order_number#135L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             +- Sort [cr_item_sk#250 ASC NULLS FIRST, cr_order_number#264L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                +- Exchange hashpartitioning(cr_item_sk#250, cr_order_number#264L, 200), ENSURE_REQUIREMENTS, [id=#100544]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                   +- Filter (isnotnull(cr_item_sk#250) AND isnotnull(cr_order_number#264L))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                      +- FileScan parquet [cr_item_sk#250,cr_order_number#264L,cr_refunded_cash#271,cr_reversed_charge#272,cr_store_credit#273] Batched: true, DataFilters: [isnotnull(cr_item_sk#250), isnotnull(cr_order_number#264L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100563]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :        +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 2001)) AND isnotnull(d_date_sk#598))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :           +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100567]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(s_store_sk#326) AND isnotnull(s_store_name#331)) AND isnotnull(s_zip#351))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet [s_store_sk#326,s_store_name#331,s_zip#351] Batched: true, DataFilters: [isnotnull(s_store_sk#326), isnotnull(s_store_name#331), isnotnull(s_zip#351)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [c_customer_sk#562 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#100573]
               :                    :     :     :     :     :     :     :     :     :     :     :     :           +- Filter (((((isnotnull(c_customer_sk#562) AND isnotnull(c_first_sales_date_sk#568)) AND isnotnull(c_first_shipto_date_sk#567)) AND isnotnull(c_current_cdemo_sk#564)) AND isnotnull(c_current_hdemo_sk#565)) AND isnotnull(c_current_addr_sk#566))
               :                    :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet [c_customer_sk#562,c_current_cdemo_sk#564,c_current_hdemo_sk#565,c_current_addr_sk#566,c_first_shipto_date_sk#567,c_first_sales_date_sk#568] Batched: true, DataFilters: [isnotnull(c_customer_sk#562), isnotnull(c_first_sales_date_sk#568), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
               :                    :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100579]
               :                    :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#12694)
               :                    :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#12694,d_year#12700] Batched: true, DataFilters: [isnotnull(d_date_sk#12694)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100583]
               :                    :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#12722)
               :                    :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#12722,d_year#12728] Batched: true, DataFilters: [isnotnull(d_date_sk#12722)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100587]
               :                    :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#48) AND isnotnull(cd_marital_status#50))
               :                    :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#48,cd_marital_status#50] Batched: true, DataFilters: [isnotnull(cd_demo_sk#48), isnotnull(cd_marital_status#50)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                    :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100591]
               :                    :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#12750) AND isnotnull(cd_marital_status#12752))
               :                    :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#12750,cd_marital_status#12752] Batched: true, DataFilters: [isnotnull(cd_demo_sk#12750), isnotnull(cd_marital_status#12752)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                    :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100595]
               :                    :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#750)
               :                    :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#750] Batched: true, DataFilters: [isnotnull(p_promo_sk#750)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
               :                    :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100599]
               :                    :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#654) AND isnotnull(hd_income_band_sk#655))
               :                    :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#654,hd_income_band_sk#655] Batched: true, DataFilters: [isnotnull(hd_demo_sk#654), isnotnull(hd_income_band_sk#655)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                    :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100603]
               :                    :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#12759) AND isnotnull(hd_income_band_sk#12760))
               :                    :     :     :     :     :           +- FileScan parquet [hd_demo_sk#12759,hd_income_band_sk#12760] Batched: true, DataFilters: [isnotnull(hd_demo_sk#12759), isnotnull(hd_income_band_sk#12760)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                    :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100607]
               :                    :     :     :     :        +- Filter isnotnull(ca_address_sk#214)
               :                    :     :     :     :           +- FileScan parquet [ca_address_sk#214,ca_street_number#216,ca_street_name#217,ca_city#220,ca_zip#223] Batched: true, DataFilters: [isnotnull(ca_address_sk#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                    :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100611]
               :                    :     :     :        +- Filter isnotnull(ca_address_sk#12764)
               :                    :     :     :           +- FileScan parquet [ca_address_sk#12764,ca_street_number#12766,ca_street_name#12767,ca_city#12770,ca_zip#12773] Batched: true, DataFilters: [isnotnull(ca_address_sk#12764)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                    :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100615]
               :                    :     :        +- Filter isnotnull(ib_income_band_sk#302)
               :                    :     :           +- FileScan parquet [ib_income_band_sk#302] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#302)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100619]
               :                    :        +- Filter isnotnull(ib_income_band_sk#12777)
               :                    :           +- FileScan parquet [ib_income_band_sk#12777] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#12777)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#100623]
               :                       +- Project [i_item_sk#500, i_product_name#521]
               :                          +- Filter ((((((isnotnull(i_current_price#505) AND i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#505 >= 75.00)) AND (i_current_price#505 <= 85.00)) AND (i_current_price#505 >= 76.00)) AND (i_current_price#505 <= 90.00)) AND isnotnull(i_item_sk#500))
               :                             +- FileScan parquet [i_item_sk#500,i_current_price#505,i_color#517,i_product_name#521] Batched: true, DataFilters: [isnotnull(i_current_price#505), i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
               +- Sort [item_sk#12789 ASC NULLS FIRST, store_name#12790 ASC NULLS FIRST, store_zip#12791 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(item_sk#12789, store_name#12790, store_zip#12791, 200), ENSURE_REQUIREMENTS, [id=#100728]
                     +- HashAggregate(keys=[i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#12839)), sum(UnscaledValue(ss_list_price#12840)), sum(UnscaledValue(ss_coupon_amt#12847))], output=[item_sk#12789, store_name#12790, store_zip#12791, syear#12800, cnt#12803L, s1#12804, s2#12805, s3#12806])
                        +- Exchange hashpartitioning(i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994, 200), ENSURE_REQUIREMENTS, [id=#100723]
                           +- HashAggregate(keys=[i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#12839)), partial_sum(UnscaledValue(ss_list_price#12840)), partial_sum(UnscaledValue(ss_coupon_amt#12847))], output=[i_product_name#13163, i_item_sk#13142, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, d_year#12938, d_year#12966, d_year#12994, count#13187L, sum#13200L, sum#13201L, sum#13202L])
                              +- Project [ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, d_year#12966, d_year#12994, s_store_name#13021, s_zip#13041, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132, i_item_sk#13142, i_product_name#13163]
                                 +- BroadcastHashJoin [ss_item_sk#12830], [i_item_sk#13142], Inner, BuildRight, false
                                    :- Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, d_year#12966, d_year#12994, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132]
                                    :  +- BroadcastHashJoin [hd_income_band_sk#13106], [ib_income_band_sk#13139], Inner, BuildRight, false
                                    :     :- Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, d_year#12966, d_year#12994, hd_income_band_sk#13106, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132]
                                    :     :  +- BroadcastHashJoin [hd_income_band_sk#13101], [ib_income_band_sk#13136], Inner, BuildRight, false
                                    :     :     :- Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, d_year#12966, d_year#12994, hd_income_band_sk#13101, hd_income_band_sk#13106, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119, ca_street_number#13125, ca_street_name#13126, ca_city#13129, ca_zip#13132]
                                    :     :     :  +- BroadcastHashJoin [c_current_addr_sk#13049], [ca_address_sk#13123], Inner, BuildRight, false
                                    :     :     :     :- Project [ss_item_sk#12830, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_addr_sk#13049, d_year#12966, d_year#12994, hd_income_band_sk#13101, hd_income_band_sk#13106, ca_street_number#13112, ca_street_name#13113, ca_city#13116, ca_zip#13119]
                                    :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#12834], [ca_address_sk#13110], Inner, BuildRight, false
                                    :     :     :     :     :- Project [ss_item_sk#12830, ss_addr_sk#12834, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_addr_sk#13049, d_year#12966, d_year#12994, hd_income_band_sk#13101, hd_income_band_sk#13106]
                                    :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#13048], [hd_demo_sk#13105], Inner, BuildRight, false
                                    :     :     :     :     :     :- Project [ss_item_sk#12830, ss_addr_sk#12834, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994, hd_income_band_sk#13101]
                                    :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#12833], [hd_demo_sk#13100], Inner, BuildRight, false
                                    :     :     :     :     :     :     :- Project [ss_item_sk#12830, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994]
                                    :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#12836], [p_promo_sk#13081], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :- Project [ss_item_sk#12830, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994]
                                    :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#13047], [cd_demo_sk#13072], Inner, BuildRight, NOT (cd_marital_status#13065 = cd_marital_status#13074), false
                                    :     :     :     :     :     :     :     :     :- Project [ss_item_sk#12830, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994, cd_marital_status#13065]
                                    :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#12832], [cd_demo_sk#13063], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#12830, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, d_year#12966, d_year#12994]
                                    :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#13050], [d_date_sk#12988], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#12830, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, c_first_shipto_date_sk#13050, d_year#12966]
                                    :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#13051], [d_date_sk#12960], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#12830, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041, c_current_cdemo_sk#13047, c_current_hdemo_sk#13048, c_current_addr_sk#13049, c_first_shipto_date_sk#13050, c_first_sales_date_sk#13051]
                                    :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_customer_sk#12831], [c_customer_sk#13045], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_customer_sk#12831 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_customer_sk#12831, 200), ENSURE_REQUIREMENTS, [id=#100667]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938, s_store_name#13021, s_zip#13041]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_store_sk#12835], [s_store_sk#13016], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :- Project [ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_store_sk#12835, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847, d_year#12938]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- BroadcastHashJoin [ss_sold_date_sk#12828], [d_date_sk#12932], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :- Project [ss_sold_date_sk#12828, ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_store_sk#12835, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :  +- SortMergeJoin [ss_item_sk#12830], [cs_item_sk#12886], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :- Sort [ss_item_sk#12830 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :  +- Exchange hashpartitioning(ss_item_sk#12830, 200), ENSURE_REQUIREMENTS, [id=#100652]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :     +- Project [ss_sold_date_sk#12828, ss_item_sk#12830, ss_customer_sk#12831, ss_cdemo_sk#12832, ss_hdemo_sk#12833, ss_addr_sk#12834, ss_store_sk#12835, ss_promo_sk#12836, ss_wholesale_cost#12839, ss_list_price#12840, ss_coupon_amt#12847]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :        +- SortMergeJoin [ss_item_sk#12830, ss_ticket_number#12837L], [sr_item_sk#12853, sr_ticket_number#12860L], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :- Sort [ss_item_sk#12830 ASC NULLS FIRST, ss_ticket_number#12837L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :  +- Exchange hashpartitioning(ss_item_sk#12830, ss_ticket_number#12837L, 200), ENSURE_REQUIREMENTS, [id=#100631]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :     +- Filter ((((((((isnotnull(ss_item_sk#12830) AND isnotnull(ss_ticket_number#12837L)) AND isnotnull(ss_sold_date_sk#12828)) AND isnotnull(ss_store_sk#12835)) AND isnotnull(ss_customer_sk#12831)) AND isnotnull(ss_cdemo_sk#12832)) AND isnotnull(ss_promo_sk#12836)) AND isnotnull(ss_hdemo_sk#12833)) AND isnotnull(ss_addr_sk#12834))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :        +- FileScan parquet [ss_sold_date_sk#12828,ss_item_sk#12830,ss_customer_sk#12831,ss_cdemo_sk#12832,ss_hdemo_sk#12833,ss_addr_sk#12834,ss_store_sk#12835,ss_promo_sk#12836,ss_ticket_number#12837L,ss_wholesale_cost#12839,ss_list_price#12840,ss_coupon_amt#12847] Batched: true, DataFilters: [isnotnull(ss_item_sk#12830), isnotnull(ss_ticket_number#12837L), isnotnull(ss_sold_date_sk#12828..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           +- Sort [sr_item_sk#12853 ASC NULLS FIRST, sr_ticket_number#12860L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :              +- Exchange hashpartitioning(sr_item_sk#12853, sr_ticket_number#12860L, 200), ENSURE_REQUIREMENTS, [id=#100632]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                 +- Filter (isnotnull(sr_item_sk#12853) AND isnotnull(sr_ticket_number#12860L))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                    +- FileScan parquet [sr_item_sk#12853,sr_ticket_number#12860L] Batched: true, DataFilters: [isnotnull(sr_item_sk#12853), isnotnull(sr_ticket_number#12860L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     +- Sort [cs_item_sk#12886 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :        +- Project [cs_item_sk#12886]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :           +- Filter (isnotnull(sale#12673) AND (cast(sale#12673 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12674)), DecimalType(21,2), true)))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :              +- HashAggregate(keys=[cs_item_sk#12886], functions=[sum(UnscaledValue(cs_ext_list_price#12896)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#12928 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#12929 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#12930 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#12886, sale#12673, refund#12674])
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                 +- Exchange hashpartitioning(cs_item_sk#12886, 200), ENSURE_REQUIREMENTS, [id=#100646]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                    +- HashAggregate(keys=[cs_item_sk#12886], functions=[partial_sum(UnscaledValue(cs_ext_list_price#12896)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#12928 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#12929 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#12930 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#12886, sum#13206L, sum#13207, isEmpty#13208])
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                       +- Project [cs_item_sk#12886, cs_ext_list_price#12896, cr_refunded_cash#12928, cr_reversed_charge#12929, cr_store_credit#12930]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                          +- SortMergeJoin [cs_item_sk#12886, cs_order_number#12888L], [cr_item_sk#12907, cr_order_number#12921L], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :- Sort [cs_item_sk#12886 ASC NULLS FIRST, cs_order_number#12888L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :  +- Exchange hashpartitioning(cs_item_sk#12886, cs_order_number#12888L, 200), ENSURE_REQUIREMENTS, [id=#100638]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :     +- Filter (isnotnull(cs_item_sk#12886) AND isnotnull(cs_order_number#12888L))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :        +- FileScan parquet [cs_item_sk#12886,cs_order_number#12888L,cs_ext_list_price#12896] Batched: true, DataFilters: [isnotnull(cs_item_sk#12886), isnotnull(cs_order_number#12888L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             +- Sort [cr_item_sk#12907 ASC NULLS FIRST, cr_order_number#12921L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                +- Exchange hashpartitioning(cr_item_sk#12907, cr_order_number#12921L, 200), ENSURE_REQUIREMENTS, [id=#100639]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                   +- Filter (isnotnull(cr_item_sk#12907) AND isnotnull(cr_order_number#12921L))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                      +- FileScan parquet [cr_item_sk#12907,cr_order_number#12921L,cr_refunded_cash#12928,cr_reversed_charge#12929,cr_store_credit#12930] Batched: true, DataFilters: [isnotnull(cr_item_sk#12907), isnotnull(cr_order_number#12921L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100658]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :        +- Filter ((isnotnull(d_year#12938) AND (d_year#12938 = 2002)) AND isnotnull(d_date_sk#12932))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :           +- FileScan parquet [d_date_sk#12932,d_year#12938] Batched: true, DataFilters: [isnotnull(d_year#12938), (d_year#12938 = 2002), isnotnull(d_date_sk#12932)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100662]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(s_store_sk#13016) AND isnotnull(s_store_name#13021)) AND isnotnull(s_zip#13041))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet [s_store_sk#13016,s_store_name#13021,s_zip#13041] Batched: true, DataFilters: [isnotnull(s_store_sk#13016), isnotnull(s_store_name#13021), isnotnull(s_zip#13041)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                                    :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [c_customer_sk#13045 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(c_customer_sk#13045, 200), ENSURE_REQUIREMENTS, [id=#100668]
                                    :     :     :     :     :     :     :     :     :     :     :     :           +- Filter (((((isnotnull(c_customer_sk#13045) AND isnotnull(c_first_sales_date_sk#13051)) AND isnotnull(c_first_shipto_date_sk#13050)) AND isnotnull(c_current_cdemo_sk#13047)) AND isnotnull(c_current_hdemo_sk#13048)) AND isnotnull(c_current_addr_sk#13049))
                                    :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet [c_customer_sk#13045,c_current_cdemo_sk#13047,c_current_hdemo_sk#13048,c_current_addr_sk#13049,c_first_shipto_date_sk#13050,c_first_sales_date_sk#13051] Batched: true, DataFilters: [isnotnull(c_customer_sk#13045), isnotnull(c_first_sales_date_sk#13051), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                                    :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100674]
                                    :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#12960)
                                    :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#12960,d_year#12966] Batched: true, DataFilters: [isnotnull(d_date_sk#12960)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100678]
                                    :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#12988)
                                    :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#12988,d_year#12994] Batched: true, DataFilters: [isnotnull(d_date_sk#12988)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100682]
                                    :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#13063) AND isnotnull(cd_marital_status#13065))
                                    :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#13063,cd_marital_status#13065] Batched: true, DataFilters: [isnotnull(cd_demo_sk#13063), isnotnull(cd_marital_status#13065)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                    :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100686]
                                    :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#13072) AND isnotnull(cd_marital_status#13074))
                                    :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#13072,cd_marital_status#13074] Batched: true, DataFilters: [isnotnull(cd_demo_sk#13072), isnotnull(cd_marital_status#13074)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                    :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100690]
                                    :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#13081)
                                    :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#13081] Batched: true, DataFilters: [isnotnull(p_promo_sk#13081)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                                    :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100694]
                                    :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#13100) AND isnotnull(hd_income_band_sk#13101))
                                    :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#13100,hd_income_band_sk#13101] Batched: true, DataFilters: [isnotnull(hd_demo_sk#13100), isnotnull(hd_income_band_sk#13101)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                    :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100698]
                                    :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#13105) AND isnotnull(hd_income_band_sk#13106))
                                    :     :     :     :     :           +- FileScan parquet [hd_demo_sk#13105,hd_income_band_sk#13106] Batched: true, DataFilters: [isnotnull(hd_demo_sk#13105), isnotnull(hd_income_band_sk#13106)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                    :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100702]
                                    :     :     :     :        +- Filter isnotnull(ca_address_sk#13110)
                                    :     :     :     :           +- FileScan parquet [ca_address_sk#13110,ca_street_number#13112,ca_street_name#13113,ca_city#13116,ca_zip#13119] Batched: true, DataFilters: [isnotnull(ca_address_sk#13110)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                    :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100706]
                                    :     :     :        +- Filter isnotnull(ca_address_sk#13123)
                                    :     :     :           +- FileScan parquet [ca_address_sk#13123,ca_street_number#13125,ca_street_name#13126,ca_city#13129,ca_zip#13132] Batched: true, DataFilters: [isnotnull(ca_address_sk#13123)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                    :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100710]
                                    :     :        +- Filter isnotnull(ib_income_band_sk#13136)
                                    :     :           +- FileScan parquet [ib_income_band_sk#13136] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#13136)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#100714]
                                    :        +- Filter isnotnull(ib_income_band_sk#13139)
                                    :           +- FileScan parquet [ib_income_band_sk#13139] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#13139)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#100718]
                                       +- Project [i_item_sk#13142, i_product_name#13163]
                                          +- Filter ((((((isnotnull(i_current_price#13147) AND i_color#13159 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#13147 >= 75.00)) AND (i_current_price#13147 <= 85.00)) AND (i_current_price#13147 >= 76.00)) AND (i_current_price#13147 <= 90.00)) AND isnotnull(i_item_sk#13142))
                                             +- FileScan parquet [i_item_sk#13142,i_current_price#13147,i_color#13159,i_product_name#13163] Batched: true, DataFilters: [isnotnull(i_current_price#13147), i_color#13159 IN (chocolate,lime,sienna,drab,goldenrod,navajo)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
