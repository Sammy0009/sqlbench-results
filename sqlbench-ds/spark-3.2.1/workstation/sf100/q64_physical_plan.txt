AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   GpuColumnarToRow false
   +- GpuProject [product_name#20957, store_name#20959, store_zip#20960, b_street_number#20961, b_street_name#20962, b_city#20963, b_zip#20964, c_street_number#20965, c_street_name#20966, c_city#20967, c_zip#20968, syear#20969, cnt#20972L, s11#20949, s21#20950, s31#20951, s12#20952, s22#20953, s32#20954, syear#21082, cnt#21085L], true
      +- GpuSort [product_name#20957 ASC NULLS FIRST, store_name#20959 ASC NULLS FIRST, cnt#21085L ASC NULLS FIRST, s1#20973 ASC NULLS FIRST, s1#21086 ASC NULLS FIRST], true, com.nvidia.spark.rapids.OutOfCoreSort$@59d99269
         +- GpuShuffleCoalesce 2147483647
            +- GpuCustomShuffleReader coalesced
               +- ShuffleQueryStage 100
                  +- GpuColumnarExchange gpurangepartitioning(product_name#20957 ASC NULLS FIRST, store_name#20959 ASC NULLS FIRST, cnt#21085L ASC NULLS FIRST, s1#20973 ASC NULLS FIRST, s1#21086 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#407923]
                     +- GpuProject [product_name#20957, store_name#20959, store_zip#20960, b_street_number#20961, b_street_name#20962, b_city#20963, b_zip#20964, c_street_number#20965, c_street_name#20966, c_city#20967, c_zip#20968, syear#20969, cnt#20972L, s1#20973 AS s11#20949, s2#20974 AS s21#20950, s3#20975 AS s31#20951, s1#21086 AS s12#20952, s2#21087 AS s22#20953, s3#21088 AS s32#20954, syear#21082, cnt#21085L, s1#20973, s1#21086], true
                        +- GpuShuffledHashJoin [item_sk#20958, store_name#20959, store_zip#20960], [item_sk#21071, store_name#21072, store_zip#21073], Inner, GpuBuildRight, (cnt#21085L <= cnt#20972L), false
                           :- GpuShuffleCoalesce 2147483647
                           :  +- GpuCustomShuffleReader coalesced
                           :     +- ShuffleQueryStage 98
                           :        +- GpuColumnarExchange gpuhashpartitioning(item_sk#20958, store_name#20959, store_zip#20960, 200), ENSURE_REQUIREMENTS, [id=#407565]
                           :           +- GpuHashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, d_year#618, d_year#20982, d_year#21010], functions=[gpucount(1, false), gpubasicsum(UnscaledValue(ss_wholesale_cost#263), LongType, false), gpubasicsum(UnscaledValue(ss_list_price#264), LongType, false), gpubasicsum(UnscaledValue(ss_coupon_amt#271), LongType, false)], output=[product_name#20957, item_sk#20958, store_name#20959, store_zip#20960, b_street_number#20961, b_street_name#20962, b_city#20963, b_zip#20964, c_street_number#20965, c_street_name#20966, c_city#20967, c_zip#20968, syear#20969, cnt#20972L, s1#20973, s2#20974, s3#20975])
                           :              +- GpuHashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, d_year#618, d_year#20982, d_year#21010], functions=[partial_gpucount(1, false), partial_gpubasicsum(UnscaledValue(ss_wholesale_cost#263), LongType, false), partial_gpubasicsum(UnscaledValue(ss_list_price#264), LongType, false), partial_gpubasicsum(UnscaledValue(ss_coupon_amt#271), LongType, false)], output=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, d_year#618, d_year#20982, d_year#21010, count#21469L, sum#21470L, sum#21471L, sum#21472L])
                           :                 +- GpuProject [ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, d_year#20982, d_year#21010, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, i_item_sk#668, i_product_name#689], true
                           :                    +- GpuShuffledHashJoin [ss_item_sk#254], [i_item_sk#668], Inner, GpuBuildRight, false
                           :                       :- GpuShuffleCoalesce 2147483647
                           :                       :  +- GpuCustomShuffleReader coalesced
                           :                       :     +- ShuffleQueryStage 96
                           :                       :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#407069]
                           :                       :           +- GpuProject [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#20982, d_year#21010, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055], true
                           :                       :              +- GpuShuffledHashJoin [hd_income_band_sk#21042], [ib_income_band_sk#21059], Inner, GpuBuildRight, false
                           :                       :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :     +- ShuffleQueryStage 94
                           :                       :                 :        +- GpuColumnarExchange gpuhashpartitioning(hd_income_band_sk#21042, 200), ENSURE_REQUIREMENTS, [id=#406443]
                           :                       :                 :           +- GpuProject [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#20982, d_year#21010, hd_income_band_sk#21042, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055], true
                           :                       :                 :              +- GpuShuffledHashJoin [hd_income_band_sk#89], [ib_income_band_sk#240], Inner, GpuBuildRight, false
                           :                       :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :     +- ShuffleQueryStage 92
                           :                       :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(hd_income_band_sk#89, 200), ENSURE_REQUIREMENTS, [id=#405673]
                           :                       :                 :                 :           +- GpuProject [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#20982, d_year#21010, hd_income_band_sk#89, hd_income_band_sk#21042, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055], true
                           :                       :                 :                 :              +- GpuShuffledHashJoin [c_current_addr_sk#404], [ca_address_sk#21046], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :     +- ShuffleQueryStage 90
                           :                       :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#404759]
                           :                       :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#20982, d_year#21010, hd_income_band_sk#89, hd_income_band_sk#21042, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71], true
                           :                       :                 :                 :                 :              +- GpuShuffledHashJoin [ss_addr_sk#258], [ca_address_sk#62], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :     +- ShuffleQueryStage 88
                           :                       :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_addr_sk#258, 200), ENSURE_REQUIREMENTS, [id=#403701]
                           :                       :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#20982, d_year#21010, hd_income_band_sk#89, hd_income_band_sk#21042], true
                           :                       :                 :                 :                 :                 :              +- GpuShuffledHashJoin [c_current_hdemo_sk#403], [hd_demo_sk#21041], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 86
                           :                       :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_current_hdemo_sk#403, 200), ENSURE_REQUIREMENTS, [id=#402499]
                           :                       :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010, hd_income_band_sk#89], true
                           :                       :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_hdemo_sk#257], [hd_demo_sk#88], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 84
                           :                       :                 :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_hdemo_sk#257, 200), ENSURE_REQUIREMENTS, [id=#401153]
                           :                       :                 :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010], true
                           :                       :                 :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_promo_sk#260], [p_promo_sk#98], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 82
                           :                       :                 :                 :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#399648]
                           :                       :                 :                 :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :              +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                 +- GpuFilter NOT (cd_marital_status#224 = cd_marital_status#21034), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                    +- GpuShuffledHashJoin [c_current_cdemo_sk#402], [cd_demo_sk#21032], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :     +- ShuffleQueryStage 80
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :        +- GpuColumnarExchange gpuhashpartitioning(c_current_cdemo_sk#402, 200), ENSURE_REQUIREMENTS, [id=#398002]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :           +- GpuProject [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010, cd_marital_status#224], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :              +- GpuShuffledHashJoin [ss_cdemo_sk#256], [cd_demo_sk#222], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :     +- ShuffleQueryStage 78
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_cdemo_sk#256, 200), ENSURE_REQUIREMENTS, [id=#396220]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :           +- GpuProject [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :              +- GpuShuffledHashJoin [c_first_shipto_date_sk#405], [d_date_sk#21004], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :     +- ShuffleQueryStage 76
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_first_shipto_date_sk#405, 200), ENSURE_REQUIREMENTS, [id=#394294]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :           +- GpuProject [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, d_year#20982], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :              +- GpuShuffledHashJoin [c_first_sales_date_sk#406], [d_date_sk#20976], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :     +- ShuffleQueryStage 74
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_first_sales_date_sk#406, 200), ENSURE_REQUIREMENTS, [id=#392224]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, c_first_sales_date_sk#406], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :              +- GpuShuffledHashJoin [ss_customer_sk#255], [c_customer_sk#400], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :     +- ShuffleQueryStage 72
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#390010]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_store_sk#259], [s_store_sk#712], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 70
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#388607]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 67
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#387071]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :           +- GpuProject [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_item_sk#254], [cs_item_sk#559], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 61
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#371879]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :           +- GpuProject [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 :  +- ShuffleQueryStage 0
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 :     +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#366546]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 :        +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 :           +- GpuFilter ((((((((gpuisnotnull(ss_item_sk#254) AND gpuisnotnull(ss_ticket_number#261L)) AND gpuisnotnull(ss_sold_date_sk#252)) AND gpuisnotnull(ss_store_sk#259)) AND gpuisnotnull(ss_customer_sk#255)) AND gpuisnotnull(ss_cdemo_sk#256)) AND gpuisnotnull(ss_promo_sk#260)) AND gpuisnotnull(ss_hdemo_sk#257)) AND gpuisnotnull(ss_addr_sk#258)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 :              +- GpuFileGpuScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_wholesale_cost#263,ss_list_price#264,ss_coupon_amt#271] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_ticket_number#261L), isnotnull(ss_sold_date_sk#252), isn..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                 +- ShuffleQueryStage 1
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                    +- GpuColumnarExchange gpuhashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#366574]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                       +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                          +- GpuFilter (gpuisnotnull(sr_item_sk#138) AND gpuisnotnull(sr_ticket_number#145L)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 :                             +- GpuFileGpuScan parquet [sr_item_sk#138,sr_ticket_number#145L] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                 +- GpuCoalesceBatches RequireSingleBatchWithFilter
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                    +- GpuProject [cs_item_sk#559], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                       +- GpuRowToColumnar targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                          +- *(3) Filter (isnotnull(sale#20955) AND (cast(sale#20955 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#20956)), DecimalType(21,2), true)))
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                             +- *(3) HashAggregate(keys=[cs_item_sk#559], functions=[sum(UnscaledValue(cs_ext_list_price#569)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sale#20955, refund#20956])
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                +- AQEShuffleRead coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                   +- ShuffleQueryStage 64
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                      +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#375863]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                         +- *(1) HashAggregate(keys=[cs_item_sk#559], functions=[partial_sum(UnscaledValue(cs_ext_list_price#569)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sum#21476L, sum#21477, isEmpty#21478])
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                            +- GpuColumnarToRow false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                               +- GpuProject [cs_item_sk#559, cs_ext_list_price#569, cr_refunded_cash#369, cr_reversed_charge#370, cr_store_credit#371], true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                  +- GpuShuffledHashJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], Inner, GpuBuildRight, false
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :- GpuShuffleCoalesce 2147483647
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :  +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :     +- ShuffleQueryStage 2
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#366606]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :           +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :              +- GpuFilter (gpuisnotnull(cs_item_sk#559) AND gpuisnotnull(cs_order_number#561L)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     :                 +- GpuFileGpuScan parquet [cs_item_sk#559,cs_order_number#561L,cs_ext_list_price#569] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_order_number#561L)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                     +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                        +- ShuffleQueryStage 3
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                           +- GpuColumnarExchange gpuhashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#366634]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                              +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                                 +- GpuFilter (gpuisnotnull(cr_item_sk#348) AND gpuisnotnull(cr_order_number#362L)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :                                                                    +- GpuFileGpuScan parquet [cr_item_sk#348,cr_order_number#362L,cr_refunded_cash#369,cr_reversed_charge#370,cr_store_credit#371] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 4
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#366674]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                             +- GpuFilter ((gpuisnotnull(d_year#618) AND (d_year#618 = 2001)) AND gpuisnotnull(d_date_sk#612)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                                +- GpuFileGpuScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 = 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                    +- ShuffleQueryStage 5
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#366706]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                             +- GpuFilter ((gpuisnotnull(s_store_sk#712) AND gpuisnotnull(s_store_name#717)) AND gpuisnotnull(s_zip#737)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                                +- GpuFileGpuScan parquet [s_store_sk#712,s_store_name#717,s_zip#737] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_name#717), isnotnull(s_zip#737)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                    +- ShuffleQueryStage 6
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#366738]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                             +- GpuFilter (((((gpuisnotnull(c_customer_sk#400) AND gpuisnotnull(c_first_sales_date_sk#406)) AND gpuisnotnull(c_first_shipto_date_sk#405)) AND gpuisnotnull(c_current_cdemo_sk#402)) AND gpuisnotnull(c_current_hdemo_sk#403)) AND gpuisnotnull(c_current_addr_sk#404)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                                +- GpuFileGpuScan parquet [c_customer_sk#400,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_first_sales_date_sk#406), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                    +- ShuffleQueryStage 7
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#20976, 200), ENSURE_REQUIREMENTS, [id=#366770]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                             +- GpuFilter gpuisnotnull(d_date_sk#20976), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                                +- GpuFileGpuScan parquet [d_date_sk#20976,d_year#20982] Batched: true, DataFilters: [isnotnull(d_date_sk#20976)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                    +- ShuffleQueryStage 9
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 :                       +- ReusedExchange [d_date_sk#21004, d_year#21010], GpuColumnarExchange gpuhashpartitioning(d_date_sk#20976, 200), ENSURE_REQUIREMENTS, [id=#366770]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                    +- ShuffleQueryStage 10
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                       +- GpuColumnarExchange gpuhashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#366836]
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                             +- GpuFilter (gpuisnotnull(cd_demo_sk#222) AND gpuisnotnull(cd_marital_status#224)), true
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       :                                +- GpuFileGpuScan parquet [cd_demo_sk#222,cd_marital_status#224] Batched: true, DataFilters: [isnotnull(cd_demo_sk#222), isnotnull(cd_marital_status#224)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                           :                       :                 :                 :                 :                 :                 :                 :                 :                       +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                 :                          +- ShuffleQueryStage 12
                           :                       :                 :                 :                 :                 :                 :                 :                 :                             +- ReusedExchange [cd_demo_sk#21032, cd_marital_status#21034], GpuColumnarExchange gpuhashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#366836]
                           :                       :                 :                 :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 13
                           :                       :                 :                 :                 :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#366902]
                           :                       :                 :                 :                 :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                 :                             +- GpuFilter gpuisnotnull(p_promo_sk#98), true
                           :                       :                 :                 :                 :                 :                 :                 :                                +- GpuFileGpuScan parquet [p_promo_sk#98] Batched: true, DataFilters: [isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                           :                       :                 :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 14
                           :                       :                 :                 :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#366934]
                           :                       :                 :                 :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                 :                 :                             +- GpuFilter (gpuisnotnull(hd_demo_sk#88) AND gpuisnotnull(hd_income_band_sk#89)), true
                           :                       :                 :                 :                 :                 :                 :                                +- GpuFileGpuScan parquet [hd_demo_sk#88,hd_income_band_sk#89] Batched: true, DataFilters: [isnotnull(hd_demo_sk#88), isnotnull(hd_income_band_sk#89)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                           :                       :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                 :                    +- ShuffleQueryStage 16
                           :                       :                 :                 :                 :                 :                       +- ReusedExchange [hd_demo_sk#21041, hd_income_band_sk#21042], GpuColumnarExchange gpuhashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#366934]
                           :                       :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                 :                    +- ShuffleQueryStage 17
                           :                       :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#367000]
                           :                       :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                 :                 :                             +- GpuFilter gpuisnotnull(ca_address_sk#62), true
                           :                       :                 :                 :                 :                                +- GpuFileGpuScan parquet [ca_address_sk#62,ca_street_number#64,ca_street_name#65,ca_city#68,ca_zip#71] Batched: true, DataFilters: [isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                           :                       :                 :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                 :                    +- ShuffleQueryStage 19
                           :                       :                 :                 :                       +- ReusedExchange [ca_address_sk#21046, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055], GpuColumnarExchange gpuhashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#367000]
                           :                       :                 :                 +- GpuCustomShuffleReader coalesced
                           :                       :                 :                    +- ShuffleQueryStage 20
                           :                       :                 :                       +- GpuColumnarExchange gpuhashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#367066]
                           :                       :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                           :                       :                 :                             +- GpuFilter gpuisnotnull(ib_income_band_sk#240), true
                           :                       :                 :                                +- GpuFileGpuScan parquet [ib_income_band_sk#240] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#240)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                           :                       :                 +- GpuCustomShuffleReader coalesced
                           :                       :                    +- ShuffleQueryStage 22
                           :                       :                       +- ReusedExchange [ib_income_band_sk#21059], GpuColumnarExchange gpuhashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#367066]
                           :                       +- GpuCustomShuffleReader coalesced
                           :                          +- ShuffleQueryStage 23
                           :                             +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#367141]
                           :                                +- GpuProject [i_item_sk#668, i_product_name#689], true
                           :                                   +- GpuCoalesceBatches targetsize(2147483647)
                           :                                      +- GpuFilter ((((((gpuisnotnull(i_current_price#673) AND i_color#685 INSET chocolate, drab, goldenrod, lime, navajo, sienna) AND (i_current_price#673 >= 75.00)) AND (i_current_price#673 <= 85.00)) AND (i_current_price#673 >= 76.00)) AND (i_current_price#673 <= 90.00)) AND gpuisnotnull(i_item_sk#668)), true
                           :                                         +- GpuFileGpuScan parquet [i_item_sk#668,i_current_price#673,i_color#685,i_product_name#689] Batched: true, DataFilters: [isnotnull(i_current_price#673), i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
                           +- GpuCustomShuffleReader coalesced
                              +- ShuffleQueryStage 99
                                 +- GpuColumnarExchange gpuhashpartitioning(item_sk#21071, store_name#21072, store_zip#21073, 200), ENSURE_REQUIREMENTS, [id=#407749]
                                    +- GpuHashAggregate(keys=[i_product_name#21445, i_item_sk#21424, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, d_year#21220, d_year#21248, d_year#21276], functions=[gpucount(1, false), gpubasicsum(UnscaledValue(ss_wholesale_cost#21121), LongType, false), gpubasicsum(UnscaledValue(ss_list_price#21122), LongType, false), gpubasicsum(UnscaledValue(ss_coupon_amt#21129), LongType, false)], output=[item_sk#21071, store_name#21072, store_zip#21073, syear#21082, cnt#21085L, s1#21086, s2#21087, s3#21088])
                                       +- GpuHashAggregate(keys=[i_product_name#21445, i_item_sk#21424, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, d_year#21220, d_year#21248, d_year#21276], functions=[partial_gpucount(1, false), partial_gpubasicsum(UnscaledValue(ss_wholesale_cost#21121), LongType, false), partial_gpubasicsum(UnscaledValue(ss_list_price#21122), LongType, false), partial_gpubasicsum(UnscaledValue(ss_coupon_amt#21129), LongType, false)], output=[i_product_name#21445, i_item_sk#21424, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, d_year#21220, d_year#21248, d_year#21276, count#21469L, sum#21482L, sum#21483L, sum#21484L])
                                          +- GpuProject [ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, d_year#21248, d_year#21276, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, i_item_sk#21424, i_product_name#21445], true
                                             +- GpuShuffledHashJoin [ss_item_sk#21112], [i_item_sk#21424], Inner, GpuBuildRight, false
                                                :- GpuShuffleCoalesce 2147483647
                                                :  +- GpuCustomShuffleReader coalesced
                                                :     +- ShuffleQueryStage 97
                                                :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#21112, 200), ENSURE_REQUIREMENTS, [id=#407325]
                                                :           +- GpuProject [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, d_year#21248, d_year#21276, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414], true
                                                :              +- GpuShuffledHashJoin [hd_income_band_sk#21388], [ib_income_band_sk#21421], Inner, GpuBuildRight, false
                                                :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :     +- ShuffleQueryStage 95
                                                :                 :        +- GpuColumnarExchange gpuhashpartitioning(hd_income_band_sk#21388, 200), ENSURE_REQUIREMENTS, [id=#406771]
                                                :                 :           +- GpuProject [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, d_year#21248, d_year#21276, hd_income_band_sk#21388, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414], true
                                                :                 :              +- GpuShuffledHashJoin [hd_income_band_sk#21383], [ib_income_band_sk#21418], Inner, GpuBuildRight, false
                                                :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :     +- ShuffleQueryStage 93
                                                :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(hd_income_band_sk#21383, 200), ENSURE_REQUIREMENTS, [id=#406073]
                                                :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, d_year#21248, d_year#21276, hd_income_band_sk#21383, hd_income_band_sk#21388, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414], true
                                                :                 :                 :              +- GpuShuffledHashJoin [c_current_addr_sk#21331], [ca_address_sk#21405], Inner, GpuBuildRight, false
                                                :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :     +- ShuffleQueryStage 91
                                                :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_current_addr_sk#21331, 200), ENSURE_REQUIREMENTS, [id=#405231]
                                                :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_addr_sk#21331, d_year#21248, d_year#21276, hd_income_band_sk#21383, hd_income_band_sk#21388, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401], true
                                                :                 :                 :                 :              +- GpuShuffledHashJoin [ss_addr_sk#21116], [ca_address_sk#21392], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :     +- ShuffleQueryStage 89
                                                :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_addr_sk#21116, 200), ENSURE_REQUIREMENTS, [id=#404245]
                                                :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_addr_sk#21116, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_addr_sk#21331, d_year#21248, d_year#21276, hd_income_band_sk#21383, hd_income_band_sk#21388], true
                                                :                 :                 :                 :                 :              +- GpuShuffledHashJoin [c_current_hdemo_sk#21330], [hd_demo_sk#21387], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 87
                                                :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_current_hdemo_sk#21330, 200), ENSURE_REQUIREMENTS, [id=#403115]
                                                :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_addr_sk#21116, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276, hd_income_band_sk#21383], true
                                                :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_hdemo_sk#21115], [hd_demo_sk#21382], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 85
                                                :                 :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_hdemo_sk#21115, 200), ENSURE_REQUIREMENTS, [id=#401841]
                                                :                 :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276], true
                                                :                 :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_promo_sk#21118], [p_promo_sk#21363], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 83
                                                :                 :                 :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_promo_sk#21118, 200), ENSURE_REQUIREMENTS, [id=#400420]
                                                :                 :                 :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276], true
                                                :                 :                 :                 :                 :                 :                 :                 :              +- GpuCoalesceBatches targetsize(2147483647)
                                                :                 :                 :                 :                 :                 :                 :                 :                 +- GpuFilter NOT (cd_marital_status#21347 = cd_marital_status#21356), true
                                                :                 :                 :                 :                 :                 :                 :                 :                    +- GpuShuffledHashJoin [c_current_cdemo_sk#21329], [cd_demo_sk#21354], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :     +- ShuffleQueryStage 81
                                                :                 :                 :                 :                 :                 :                 :                 :                       :        +- GpuColumnarExchange gpuhashpartitioning(c_current_cdemo_sk#21329, 200), ENSURE_REQUIREMENTS, [id=#398836]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :           +- GpuProject [ss_item_sk#21112, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276, cd_marital_status#21347], true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :              +- GpuShuffledHashJoin [ss_cdemo_sk#21114], [cd_demo_sk#21345], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :     +- ShuffleQueryStage 79
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_cdemo_sk#21114, 200), ENSURE_REQUIREMENTS, [id=#397126]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :           +- GpuProject [ss_item_sk#21112, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276], true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :              +- GpuShuffledHashJoin [c_first_shipto_date_sk#21332], [d_date_sk#21270], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :     +- ShuffleQueryStage 77
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_first_shipto_date_sk#21332, 200), ENSURE_REQUIREMENTS, [id=#395272]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, c_first_shipto_date_sk#21332, d_year#21248], true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :              +- GpuShuffledHashJoin [c_first_sales_date_sk#21333], [d_date_sk#21242], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :     +- ShuffleQueryStage 75
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_first_sales_date_sk#21333, 200), ENSURE_REQUIREMENTS, [id=#393274]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, c_first_shipto_date_sk#21332, c_first_sales_date_sk#21333], true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :              +- GpuShuffledHashJoin [ss_customer_sk#21113], [c_customer_sk#21327], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :     +- ShuffleQueryStage 73
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_customer_sk#21113, 200), ENSURE_REQUIREMENTS, [id=#391132]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323], true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_store_sk#21117], [s_store_sk#21298], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 71
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_store_sk#21117, 200), ENSURE_REQUIREMENTS, [id=#388728]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :           +- GpuProject [ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_store_sk#21117, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220], true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_sold_date_sk#21110], [d_date_sk#21214], Inner, GpuBuildRight, false
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 69
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 :        +- ReusedExchange [ss_sold_date_sk#21110, ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_store_sk#21117, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129], GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#387071]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 32
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#21214, 200), ENSURE_REQUIREMENTS, [id=#367313]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                             +- GpuFilter ((gpuisnotnull(d_year#21220) AND (d_year#21220 = 2002)) AND gpuisnotnull(d_date_sk#21214)), true
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 :                                +- GpuFileGpuScan parquet [d_date_sk#21214,d_year#21220] Batched: true, DataFilters: [isnotnull(d_year#21220), (d_year#21220 = 2002), isnotnull(d_date_sk#21214)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                    +- ShuffleQueryStage 34
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 :                       +- ReusedExchange [s_store_sk#21298, s_store_name#21303, s_zip#21323], GpuColumnarExchange gpuhashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#366706]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                    +- ShuffleQueryStage 36
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 :                       +- ReusedExchange [c_customer_sk#21327, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, c_first_shipto_date_sk#21332, c_first_sales_date_sk#21333], GpuColumnarExchange gpuhashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#366738]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                    +- ShuffleQueryStage 38
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 :                       +- ReusedExchange [d_date_sk#21242, d_year#21248], GpuColumnarExchange gpuhashpartitioning(d_date_sk#20976, 200), ENSURE_REQUIREMENTS, [id=#366770]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                    +- ShuffleQueryStage 40
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 :                       +- ReusedExchange [d_date_sk#21270, d_year#21276], GpuColumnarExchange gpuhashpartitioning(d_date_sk#20976, 200), ENSURE_REQUIREMENTS, [id=#366770]
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                    +- ShuffleQueryStage 42
                                                :                 :                 :                 :                 :                 :                 :                 :                       :                       +- ReusedExchange [cd_demo_sk#21345, cd_marital_status#21347], GpuColumnarExchange gpuhashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#366836]
                                                :                 :                 :                 :                 :                 :                 :                 :                       +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                 :                          +- ShuffleQueryStage 44
                                                :                 :                 :                 :                 :                 :                 :                 :                             +- ReusedExchange [cd_demo_sk#21354, cd_marital_status#21356], GpuColumnarExchange gpuhashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#366836]
                                                :                 :                 :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 46
                                                :                 :                 :                 :                 :                 :                 :                       +- ReusedExchange [p_promo_sk#21363], GpuColumnarExchange gpuhashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#366902]
                                                :                 :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 48
                                                :                 :                 :                 :                 :                 :                       +- ReusedExchange [hd_demo_sk#21382, hd_income_band_sk#21383], GpuColumnarExchange gpuhashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#366934]
                                                :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                 :                    +- ShuffleQueryStage 50
                                                :                 :                 :                 :                 :                       +- ReusedExchange [hd_demo_sk#21387, hd_income_band_sk#21388], GpuColumnarExchange gpuhashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#366934]
                                                :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                 :                    +- ShuffleQueryStage 52
                                                :                 :                 :                 :                       +- ReusedExchange [ca_address_sk#21392, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401], GpuColumnarExchange gpuhashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#367000]
                                                :                 :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                 :                    +- ShuffleQueryStage 54
                                                :                 :                 :                       +- ReusedExchange [ca_address_sk#21405, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414], GpuColumnarExchange gpuhashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#367000]
                                                :                 :                 +- GpuCustomShuffleReader coalesced
                                                :                 :                    +- ShuffleQueryStage 56
                                                :                 :                       +- ReusedExchange [ib_income_band_sk#21418], GpuColumnarExchange gpuhashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#367066]
                                                :                 +- GpuCustomShuffleReader coalesced
                                                :                    +- ShuffleQueryStage 58
                                                :                       +- ReusedExchange [ib_income_band_sk#21421], GpuColumnarExchange gpuhashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#367066]
                                                +- GpuCustomShuffleReader coalesced
                                                   +- ShuffleQueryStage 60
                                                      +- ReusedExchange [i_item_sk#21424, i_product_name#21445], GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#367141]
+- == Initial Plan ==
   Project [product_name#20957, store_name#20959, store_zip#20960, b_street_number#20961, b_street_name#20962, b_city#20963, b_zip#20964, c_street_number#20965, c_street_name#20966, c_city#20967, c_zip#20968, syear#20969, cnt#20972L, s11#20949, s21#20950, s31#20951, s12#20952, s22#20953, s32#20954, syear#21082, cnt#21085L]
   +- Sort [product_name#20957 ASC NULLS FIRST, store_name#20959 ASC NULLS FIRST, cnt#21085L ASC NULLS FIRST, s1#20973 ASC NULLS FIRST, s1#21086 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(product_name#20957 ASC NULLS FIRST, store_name#20959 ASC NULLS FIRST, cnt#21085L ASC NULLS FIRST, s1#20973 ASC NULLS FIRST, s1#21086 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#362524]
         +- Project [product_name#20957, store_name#20959, store_zip#20960, b_street_number#20961, b_street_name#20962, b_city#20963, b_zip#20964, c_street_number#20965, c_street_name#20966, c_city#20967, c_zip#20968, syear#20969, cnt#20972L, s1#20973 AS s11#20949, s2#20974 AS s21#20950, s3#20975 AS s31#20951, s1#21086 AS s12#20952, s2#21087 AS s22#20953, s3#21088 AS s32#20954, syear#21082, cnt#21085L, s1#20973, s1#21086]
            +- SortMergeJoin [item_sk#20958, store_name#20959, store_zip#20960], [item_sk#21071, store_name#21072, store_zip#21073], Inner, (cnt#21085L <= cnt#20972L)
               :- Sort [item_sk#20958 ASC NULLS FIRST, store_name#20959 ASC NULLS FIRST, store_zip#20960 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(item_sk#20958, store_name#20959, store_zip#20960, 200), ENSURE_REQUIREMENTS, [id=#362517]
               :     +- HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, d_year#618, d_year#20982, d_year#21010], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#263)), sum(UnscaledValue(ss_list_price#264)), sum(UnscaledValue(ss_coupon_amt#271))], output=[product_name#20957, item_sk#20958, store_name#20959, store_zip#20960, b_street_number#20961, b_street_name#20962, b_city#20963, b_zip#20964, c_street_number#20965, c_street_name#20966, c_city#20967, c_zip#20968, syear#20969, cnt#20972L, s1#20973, s2#20974, s3#20975])
               :        +- HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, d_year#618, d_year#20982, d_year#21010], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#263)), partial_sum(UnscaledValue(ss_list_price#264)), partial_sum(UnscaledValue(ss_coupon_amt#271))], output=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, d_year#618, d_year#20982, d_year#21010, count#21469L, sum#21470L, sum#21471L, sum#21472L])
               :           +- Project [ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, d_year#20982, d_year#21010, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055, i_item_sk#668, i_product_name#689]
               :              +- SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
               :                 :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
               :                 :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#362358]
               :                 :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#20982, d_year#21010, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055]
               :                 :        +- SortMergeJoin [hd_income_band_sk#21042], [ib_income_band_sk#21059], Inner
               :                 :           :- Sort [hd_income_band_sk#21042 ASC NULLS FIRST], false, 0
               :                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#21042, 200), ENSURE_REQUIREMENTS, [id=#362350]
               :                 :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#20982, d_year#21010, hd_income_band_sk#21042, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055]
               :                 :           :        +- SortMergeJoin [hd_income_band_sk#89], [ib_income_band_sk#240], Inner
               :                 :           :           :- Sort [hd_income_band_sk#89 ASC NULLS FIRST], false, 0
               :                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#89, 200), ENSURE_REQUIREMENTS, [id=#362342]
               :                 :           :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#20982, d_year#21010, hd_income_band_sk#89, hd_income_band_sk#21042, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#21048, ca_street_name#21049, ca_city#21052, ca_zip#21055]
               :                 :           :           :        +- SortMergeJoin [c_current_addr_sk#404], [ca_address_sk#21046], Inner
               :                 :           :           :           :- Sort [c_current_addr_sk#404 ASC NULLS FIRST], false, 0
               :                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#362334]
               :                 :           :           :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#20982, d_year#21010, hd_income_band_sk#89, hd_income_band_sk#21042, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71]
               :                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#258], [ca_address_sk#62], Inner
               :                 :           :           :           :           :- Sort [ss_addr_sk#258 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#258, 200), ENSURE_REQUIREMENTS, [id=#362326]
               :                 :           :           :           :           :     +- Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#20982, d_year#21010, hd_income_band_sk#89, hd_income_band_sk#21042]
               :                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#403], [hd_demo_sk#21041], Inner
               :                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#403 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#403, 200), ENSURE_REQUIREMENTS, [id=#362318]
               :                 :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010, hd_income_band_sk#89]
               :                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#257], [hd_demo_sk#88], Inner
               :                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#257 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#257, 200), ENSURE_REQUIREMENTS, [id=#362310]
               :                 :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010]
               :                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
               :                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#362302]
               :                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010]
               :                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#402], [cd_demo_sk#21032], Inner, NOT (cd_marital_status#224 = cd_marital_status#21034)
               :                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#402 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#402, 200), ENSURE_REQUIREMENTS, [id=#362294]
               :                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010, cd_marital_status#224]
               :                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#256], [cd_demo_sk#222], Inner
               :                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#256 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#256, 200), ENSURE_REQUIREMENTS, [id=#362286]
               :                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#20982, d_year#21010]
               :                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#405], [d_date_sk#21004], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#405 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#405, 200), ENSURE_REQUIREMENTS, [id=#362278]
               :                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, d_year#20982]
               :                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#406], [d_date_sk#20976], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#406 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#406, 200), ENSURE_REQUIREMENTS, [id=#362270]
               :                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, c_first_sales_date_sk#406]
               :                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#255], [c_customer_sk#400], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#255 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#362262]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#362254]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#362246]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#254], [cs_item_sk#559], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#362239]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST, ss_ticket_number#261L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#362218]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#254) AND isnotnull(ss_ticket_number#261L)) AND isnotnull(ss_sold_date_sk#252)) AND isnotnull(ss_store_sk#259)) AND isnotnull(ss_customer_sk#255)) AND isnotnull(ss_cdemo_sk#256)) AND isnotnull(ss_promo_sk#260)) AND isnotnull(ss_hdemo_sk#257)) AND isnotnull(ss_addr_sk#258))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_wholesale_cost#263,ss_list_price#264,ss_coupon_amt#271] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_ticket_number#261L), isnotnull(ss_sold_date_sk#252), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#138 ASC NULLS FIRST, sr_ticket_number#145L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#362219]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_ticket_number#145L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#138,sr_ticket_number#145L] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#559]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sale#20955) AND (cast(sale#20955 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#20956)), DecimalType(21,2), true)))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#559], functions=[sum(UnscaledValue(cs_ext_list_price#569)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sale#20955, refund#20956])
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#362233]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#559], functions=[partial_sum(UnscaledValue(cs_ext_list_price#569)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sum#21476L, sum#21477, isEmpty#21478])
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#559, cs_ext_list_price#569, cr_refunded_cash#369, cr_reversed_charge#370, cr_store_credit#371]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#559 ASC NULLS FIRST, cs_order_number#561L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#362225]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_order_number#561L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#559,cs_order_number#561L,cs_ext_list_price#569] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_order_number#561L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#348 ASC NULLS FIRST, cr_order_number#362L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#362226]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_order_number#362L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#348,cr_order_number#362L,cr_refunded_cash#369,cr_reversed_charge#370,cr_store_credit#371] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#362247]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2001)) AND isnotnull(d_date_sk#612))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 = 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#362255]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#712) AND isnotnull(s_store_name#717)) AND isnotnull(s_zip#737))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#712,s_store_name#717,s_zip#737] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_name#717), isnotnull(s_zip#737)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#400 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#362263]
               :                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#400) AND isnotnull(c_first_sales_date_sk#406)) AND isnotnull(c_first_shipto_date_sk#405)) AND isnotnull(c_current_cdemo_sk#402)) AND isnotnull(c_current_hdemo_sk#403)) AND isnotnull(c_current_addr_sk#404))
               :                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#400,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_first_sales_date_sk#406), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
               :                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#20976 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#20976, 200), ENSURE_REQUIREMENTS, [id=#362271]
               :                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#20976)
               :                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#20976,d_year#20982] Batched: true, DataFilters: [isnotnull(d_date_sk#20976)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#21004 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#21004, 200), ENSURE_REQUIREMENTS, [id=#362279]
               :                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#21004)
               :                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#21004,d_year#21010] Batched: true, DataFilters: [isnotnull(d_date_sk#21004)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#222 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#362287]
               :                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#222) AND isnotnull(cd_marital_status#224))
               :                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#222,cd_marital_status#224] Batched: true, DataFilters: [isnotnull(cd_demo_sk#222), isnotnull(cd_marital_status#224)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#21032 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#21032, 200), ENSURE_REQUIREMENTS, [id=#362295]
               :                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#21032) AND isnotnull(cd_marital_status#21034))
               :                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#21032,cd_marital_status#21034] Batched: true, DataFilters: [isnotnull(cd_demo_sk#21032), isnotnull(cd_marital_status#21034)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#362303]
               :                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#98)
               :                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#98] Batched: true, DataFilters: [isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
               :                 :           :           :           :           :           :           +- Sort [hd_demo_sk#88 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#362311]
               :                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#88) AND isnotnull(hd_income_band_sk#89))
               :                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#88,hd_income_band_sk#89] Batched: true, DataFilters: [isnotnull(hd_demo_sk#88), isnotnull(hd_income_band_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :           :           :           :           :           +- Sort [hd_demo_sk#21041 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#21041, 200), ENSURE_REQUIREMENTS, [id=#362319]
               :                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#21041) AND isnotnull(hd_income_band_sk#21042))
               :                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#21041,hd_income_band_sk#21042] Batched: true, DataFilters: [isnotnull(hd_demo_sk#21041), isnotnull(hd_income_band_sk#21042)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :           :           :           :           +- Sort [ca_address_sk#62 ASC NULLS FIRST], false, 0
               :                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#362327]
               :                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#62)
               :                 :           :           :           :                    +- FileScan parquet [ca_address_sk#62,ca_street_number#64,ca_street_name#65,ca_city#68,ca_zip#71] Batched: true, DataFilters: [isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :           :           :           +- Sort [ca_address_sk#21046 ASC NULLS FIRST], false, 0
               :                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#21046, 200), ENSURE_REQUIREMENTS, [id=#362335]
               :                 :           :           :                 +- Filter isnotnull(ca_address_sk#21046)
               :                 :           :           :                    +- FileScan parquet [ca_address_sk#21046,ca_street_number#21048,ca_street_name#21049,ca_city#21052,ca_zip#21055] Batched: true, DataFilters: [isnotnull(ca_address_sk#21046)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :           :           +- Sort [ib_income_band_sk#240 ASC NULLS FIRST], false, 0
               :                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#362343]
               :                 :           :                 +- Filter isnotnull(ib_income_band_sk#240)
               :                 :           :                    +- FileScan parquet [ib_income_band_sk#240] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#240)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 :           +- Sort [ib_income_band_sk#21059 ASC NULLS FIRST], false, 0
               :                 :              +- Exchange hashpartitioning(ib_income_band_sk#21059, 200), ENSURE_REQUIREMENTS, [id=#362351]
               :                 :                 +- Filter isnotnull(ib_income_band_sk#21059)
               :                 :                    +- FileScan parquet [ib_income_band_sk#21059] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#21059)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 +- Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
               :                    +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#362359]
               :                       +- Project [i_item_sk#668, i_product_name#689]
               :                          +- Filter ((((((isnotnull(i_current_price#673) AND i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#673 >= 75.00)) AND (i_current_price#673 <= 85.00)) AND (i_current_price#673 >= 76.00)) AND (i_current_price#673 <= 90.00)) AND isnotnull(i_item_sk#668))
               :                             +- FileScan parquet [i_item_sk#668,i_current_price#673,i_color#685,i_product_name#689] Batched: true, DataFilters: [isnotnull(i_current_price#673), i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
               +- Sort [item_sk#21071 ASC NULLS FIRST, store_name#21072 ASC NULLS FIRST, store_zip#21073 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(item_sk#21071, store_name#21072, store_zip#21073, 200), ENSURE_REQUIREMENTS, [id=#362518]
                     +- HashAggregate(keys=[i_product_name#21445, i_item_sk#21424, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, d_year#21220, d_year#21248, d_year#21276], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#21121)), sum(UnscaledValue(ss_list_price#21122)), sum(UnscaledValue(ss_coupon_amt#21129))], output=[item_sk#21071, store_name#21072, store_zip#21073, syear#21082, cnt#21085L, s1#21086, s2#21087, s3#21088])
                        +- HashAggregate(keys=[i_product_name#21445, i_item_sk#21424, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, d_year#21220, d_year#21248, d_year#21276], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#21121)), partial_sum(UnscaledValue(ss_list_price#21122)), partial_sum(UnscaledValue(ss_coupon_amt#21129))], output=[i_product_name#21445, i_item_sk#21424, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, d_year#21220, d_year#21248, d_year#21276, count#21469L, sum#21482L, sum#21483L, sum#21484L])
                           +- Project [ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, d_year#21248, d_year#21276, s_store_name#21303, s_zip#21323, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414, i_item_sk#21424, i_product_name#21445]
                              +- SortMergeJoin [ss_item_sk#21112], [i_item_sk#21424], Inner
                                 :- Sort [ss_item_sk#21112 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(ss_item_sk#21112, 200), ENSURE_REQUIREMENTS, [id=#362507]
                                 :     +- Project [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, d_year#21248, d_year#21276, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414]
                                 :        +- SortMergeJoin [hd_income_band_sk#21388], [ib_income_band_sk#21421], Inner
                                 :           :- Sort [hd_income_band_sk#21388 ASC NULLS FIRST], false, 0
                                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#21388, 200), ENSURE_REQUIREMENTS, [id=#362499]
                                 :           :     +- Project [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, d_year#21248, d_year#21276, hd_income_band_sk#21388, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414]
                                 :           :        +- SortMergeJoin [hd_income_band_sk#21383], [ib_income_band_sk#21418], Inner
                                 :           :           :- Sort [hd_income_band_sk#21383 ASC NULLS FIRST], false, 0
                                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#21383, 200), ENSURE_REQUIREMENTS, [id=#362491]
                                 :           :           :     +- Project [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, d_year#21248, d_year#21276, hd_income_band_sk#21383, hd_income_band_sk#21388, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401, ca_street_number#21407, ca_street_name#21408, ca_city#21411, ca_zip#21414]
                                 :           :           :        +- SortMergeJoin [c_current_addr_sk#21331], [ca_address_sk#21405], Inner
                                 :           :           :           :- Sort [c_current_addr_sk#21331 ASC NULLS FIRST], false, 0
                                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#21331, 200), ENSURE_REQUIREMENTS, [id=#362483]
                                 :           :           :           :     +- Project [ss_item_sk#21112, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_addr_sk#21331, d_year#21248, d_year#21276, hd_income_band_sk#21383, hd_income_band_sk#21388, ca_street_number#21394, ca_street_name#21395, ca_city#21398, ca_zip#21401]
                                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#21116], [ca_address_sk#21392], Inner
                                 :           :           :           :           :- Sort [ss_addr_sk#21116 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#21116, 200), ENSURE_REQUIREMENTS, [id=#362475]
                                 :           :           :           :           :     +- Project [ss_item_sk#21112, ss_addr_sk#21116, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_addr_sk#21331, d_year#21248, d_year#21276, hd_income_band_sk#21383, hd_income_band_sk#21388]
                                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#21330], [hd_demo_sk#21387], Inner
                                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#21330 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#21330, 200), ENSURE_REQUIREMENTS, [id=#362467]
                                 :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_addr_sk#21116, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276, hd_income_band_sk#21383]
                                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#21115], [hd_demo_sk#21382], Inner
                                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#21115 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#21115, 200), ENSURE_REQUIREMENTS, [id=#362459]
                                 :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276]
                                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#21118], [p_promo_sk#21363], Inner
                                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#21118 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#21118, 200), ENSURE_REQUIREMENTS, [id=#362451]
                                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276]
                                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#21329], [cd_demo_sk#21354], Inner, NOT (cd_marital_status#21347 = cd_marital_status#21356)
                                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#21329 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#21329, 200), ENSURE_REQUIREMENTS, [id=#362443]
                                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276, cd_marital_status#21347]
                                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#21114], [cd_demo_sk#21345], Inner
                                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#21114 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#21114, 200), ENSURE_REQUIREMENTS, [id=#362435]
                                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, d_year#21248, d_year#21276]
                                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#21332], [d_date_sk#21270], Inner
                                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#21332 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#21332, 200), ENSURE_REQUIREMENTS, [id=#362427]
                                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, c_first_shipto_date_sk#21332, d_year#21248]
                                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#21333], [d_date_sk#21242], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#21333 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#21333, 200), ENSURE_REQUIREMENTS, [id=#362419]
                                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323, c_current_cdemo_sk#21329, c_current_hdemo_sk#21330, c_current_addr_sk#21331, c_first_shipto_date_sk#21332, c_first_sales_date_sk#21333]
                                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#21113], [c_customer_sk#21327], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#21113 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#21113, 200), ENSURE_REQUIREMENTS, [id=#362411]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220, s_store_name#21303, s_zip#21323]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#21117], [s_store_sk#21298], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#21117 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#21117, 200), ENSURE_REQUIREMENTS, [id=#362403]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_store_sk#21117, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129, d_year#21220]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#21110], [d_date_sk#21214], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#21110 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#21110, 200), ENSURE_REQUIREMENTS, [id=#362395]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#21110, ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_store_sk#21117, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#21112], [cs_item_sk#21168], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#21112 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#21112, 200), ENSURE_REQUIREMENTS, [id=#362388]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#21110, ss_item_sk#21112, ss_customer_sk#21113, ss_cdemo_sk#21114, ss_hdemo_sk#21115, ss_addr_sk#21116, ss_store_sk#21117, ss_promo_sk#21118, ss_wholesale_cost#21121, ss_list_price#21122, ss_coupon_amt#21129]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#21112, ss_ticket_number#21119L], [sr_item_sk#21135, sr_ticket_number#21142L], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#21112 ASC NULLS FIRST, ss_ticket_number#21119L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#21112, ss_ticket_number#21119L, 200), ENSURE_REQUIREMENTS, [id=#362367]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#21112) AND isnotnull(ss_ticket_number#21119L)) AND isnotnull(ss_sold_date_sk#21110)) AND isnotnull(ss_store_sk#21117)) AND isnotnull(ss_customer_sk#21113)) AND isnotnull(ss_cdemo_sk#21114)) AND isnotnull(ss_promo_sk#21118)) AND isnotnull(ss_hdemo_sk#21115)) AND isnotnull(ss_addr_sk#21116))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#21110,ss_item_sk#21112,ss_customer_sk#21113,ss_cdemo_sk#21114,ss_hdemo_sk#21115,ss_addr_sk#21116,ss_store_sk#21117,ss_promo_sk#21118,ss_ticket_number#21119L,ss_wholesale_cost#21121,ss_list_price#21122,ss_coupon_amt#21129] Batched: true, DataFilters: [isnotnull(ss_item_sk#21112), isnotnull(ss_ticket_number#21119L), isnotnull(ss_sold_date_sk#21110..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#21135 ASC NULLS FIRST, sr_ticket_number#21142L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#21135, sr_ticket_number#21142L, 200), ENSURE_REQUIREMENTS, [id=#362368]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#21135) AND isnotnull(sr_ticket_number#21142L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#21135,sr_ticket_number#21142L] Batched: true, DataFilters: [isnotnull(sr_item_sk#21135), isnotnull(sr_ticket_number#21142L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#21168 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#21168]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sale#20955) AND (cast(sale#20955 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#20956)), DecimalType(21,2), true)))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#21168], functions=[sum(UnscaledValue(cs_ext_list_price#21178)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#21210 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#21211 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#21212 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#21168, sale#20955, refund#20956])
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#21168, 200), ENSURE_REQUIREMENTS, [id=#362382]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#21168], functions=[partial_sum(UnscaledValue(cs_ext_list_price#21178)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#21210 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#21211 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#21212 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#21168, sum#21488L, sum#21489, isEmpty#21490])
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#21168, cs_ext_list_price#21178, cr_refunded_cash#21210, cr_reversed_charge#21211, cr_store_credit#21212]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#21168, cs_order_number#21170L], [cr_item_sk#21189, cr_order_number#21203L], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#21168 ASC NULLS FIRST, cs_order_number#21170L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#21168, cs_order_number#21170L, 200), ENSURE_REQUIREMENTS, [id=#362374]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#21168) AND isnotnull(cs_order_number#21170L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#21168,cs_order_number#21170L,cs_ext_list_price#21178] Batched: true, DataFilters: [isnotnull(cs_item_sk#21168), isnotnull(cs_order_number#21170L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#21189 ASC NULLS FIRST, cr_order_number#21203L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#21189, cr_order_number#21203L, 200), ENSURE_REQUIREMENTS, [id=#362375]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#21189) AND isnotnull(cr_order_number#21203L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#21189,cr_order_number#21203L,cr_refunded_cash#21210,cr_reversed_charge#21211,cr_store_credit#21212] Batched: true, DataFilters: [isnotnull(cr_item_sk#21189), isnotnull(cr_order_number#21203L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#21214 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#21214, 200), ENSURE_REQUIREMENTS, [id=#362396]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#21220) AND (d_year#21220 = 2002)) AND isnotnull(d_date_sk#21214))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#21214,d_year#21220] Batched: true, DataFilters: [isnotnull(d_year#21220), (d_year#21220 = 2002), isnotnull(d_date_sk#21214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#21298 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#21298, 200), ENSURE_REQUIREMENTS, [id=#362404]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#21298) AND isnotnull(s_store_name#21303)) AND isnotnull(s_zip#21323))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#21298,s_store_name#21303,s_zip#21323] Batched: true, DataFilters: [isnotnull(s_store_sk#21298), isnotnull(s_store_name#21303), isnotnull(s_zip#21323)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#21327 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#21327, 200), ENSURE_REQUIREMENTS, [id=#362412]
                                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#21327) AND isnotnull(c_first_sales_date_sk#21333)) AND isnotnull(c_first_shipto_date_sk#21332)) AND isnotnull(c_current_cdemo_sk#21329)) AND isnotnull(c_current_hdemo_sk#21330)) AND isnotnull(c_current_addr_sk#21331))
                                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#21327,c_current_cdemo_sk#21329,c_current_hdemo_sk#21330,c_current_addr_sk#21331,c_first_shipto_date_sk#21332,c_first_sales_date_sk#21333] Batched: true, DataFilters: [isnotnull(c_customer_sk#21327), isnotnull(c_first_sales_date_sk#21333), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#21242 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#21242, 200), ENSURE_REQUIREMENTS, [id=#362420]
                                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#21242)
                                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#21242,d_year#21248] Batched: true, DataFilters: [isnotnull(d_date_sk#21242)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#21270 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#21270, 200), ENSURE_REQUIREMENTS, [id=#362428]
                                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#21270)
                                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#21270,d_year#21276] Batched: true, DataFilters: [isnotnull(d_date_sk#21270)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#21345 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#21345, 200), ENSURE_REQUIREMENTS, [id=#362436]
                                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#21345) AND isnotnull(cd_marital_status#21347))
                                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#21345,cd_marital_status#21347] Batched: true, DataFilters: [isnotnull(cd_demo_sk#21345), isnotnull(cd_marital_status#21347)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#21354 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#21354, 200), ENSURE_REQUIREMENTS, [id=#362444]
                                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#21354) AND isnotnull(cd_marital_status#21356))
                                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#21354,cd_marital_status#21356] Batched: true, DataFilters: [isnotnull(cd_demo_sk#21354), isnotnull(cd_marital_status#21356)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#21363 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#21363, 200), ENSURE_REQUIREMENTS, [id=#362452]
                                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#21363)
                                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#21363] Batched: true, DataFilters: [isnotnull(p_promo_sk#21363)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                                 :           :           :           :           :           :           +- Sort [hd_demo_sk#21382 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#21382, 200), ENSURE_REQUIREMENTS, [id=#362460]
                                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#21382) AND isnotnull(hd_income_band_sk#21383))
                                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#21382,hd_income_band_sk#21383] Batched: true, DataFilters: [isnotnull(hd_demo_sk#21382), isnotnull(hd_income_band_sk#21383)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :           :           :           :           :           +- Sort [hd_demo_sk#21387 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#21387, 200), ENSURE_REQUIREMENTS, [id=#362468]
                                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#21387) AND isnotnull(hd_income_band_sk#21388))
                                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#21387,hd_income_band_sk#21388] Batched: true, DataFilters: [isnotnull(hd_demo_sk#21387), isnotnull(hd_income_band_sk#21388)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :           :           :           :           +- Sort [ca_address_sk#21392 ASC NULLS FIRST], false, 0
                                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#21392, 200), ENSURE_REQUIREMENTS, [id=#362476]
                                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#21392)
                                 :           :           :           :                    +- FileScan parquet [ca_address_sk#21392,ca_street_number#21394,ca_street_name#21395,ca_city#21398,ca_zip#21401] Batched: true, DataFilters: [isnotnull(ca_address_sk#21392)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :           :           :           +- Sort [ca_address_sk#21405 ASC NULLS FIRST], false, 0
                                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#21405, 200), ENSURE_REQUIREMENTS, [id=#362484]
                                 :           :           :                 +- Filter isnotnull(ca_address_sk#21405)
                                 :           :           :                    +- FileScan parquet [ca_address_sk#21405,ca_street_number#21407,ca_street_name#21408,ca_city#21411,ca_zip#21414] Batched: true, DataFilters: [isnotnull(ca_address_sk#21405)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :           :           +- Sort [ib_income_band_sk#21418 ASC NULLS FIRST], false, 0
                                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#21418, 200), ENSURE_REQUIREMENTS, [id=#362492]
                                 :           :                 +- Filter isnotnull(ib_income_band_sk#21418)
                                 :           :                    +- FileScan parquet [ib_income_band_sk#21418] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#21418)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 :           +- Sort [ib_income_band_sk#21421 ASC NULLS FIRST], false, 0
                                 :              +- Exchange hashpartitioning(ib_income_band_sk#21421, 200), ENSURE_REQUIREMENTS, [id=#362500]
                                 :                 +- Filter isnotnull(ib_income_band_sk#21421)
                                 :                    +- FileScan parquet [ib_income_band_sk#21421] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#21421)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 +- Sort [i_item_sk#21424 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(i_item_sk#21424, 200), ENSURE_REQUIREMENTS, [id=#362508]
                                       +- Project [i_item_sk#21424, i_product_name#21445]
                                          +- Filter ((((((isnotnull(i_current_price#21429) AND i_color#21441 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#21429 >= 75.00)) AND (i_current_price#21429 <= 85.00)) AND (i_current_price#21429 >= 76.00)) AND (i_current_price#21429 <= 90.00)) AND isnotnull(i_item_sk#21424))
                                             +- FileScan parquet [i_item_sk#21424,i_current_price#21429,i_color#21441,i_product_name#21445] Batched: true, DataFilters: [isnotnull(i_current_price#21429), i_color#21441 IN (chocolate,lime,sienna,drab,goldenrod,navajo)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
