AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(65) Project [product_name#14058, store_name#14060, store_zip#14061, b_street_number#14062, b_street_name#14063, b_city#14064, b_zip#14065, c_street_number#14066, c_street_name#14067, c_city#14068, c_zip#14069, syear#14070, cnt#14073L, s11#14050, s21#14051, s31#14052, s12#14053, s22#14054, s32#14055, syear#14183, cnt#14186L]
   +- *(65) Sort [product_name#14058 ASC NULLS FIRST, store_name#14060 ASC NULLS FIRST, cnt#14186L ASC NULLS FIRST, s1#14074 ASC NULLS FIRST, s1#14187 ASC NULLS FIRST], true, 0
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 72
            +- Exchange rangepartitioning(product_name#14058 ASC NULLS FIRST, store_name#14060 ASC NULLS FIRST, cnt#14186L ASC NULLS FIRST, s1#14074 ASC NULLS FIRST, s1#14187 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#133800]
               +- *(64) Project [product_name#14058, store_name#14060, store_zip#14061, b_street_number#14062, b_street_name#14063, b_city#14064, b_zip#14065, c_street_number#14066, c_street_name#14067, c_city#14068, c_zip#14069, syear#14070, cnt#14073L, s1#14074 AS s11#14050, s2#14075 AS s21#14051, s3#14076 AS s31#14052, s1#14187 AS s12#14053, s2#14188 AS s22#14054, s3#14189 AS s32#14055, syear#14183, cnt#14186L, s1#14074, s1#14187]
                  +- *(64) BroadcastHashJoin [item_sk#14059, store_name#14060, store_zip#14061], [item_sk#14172, store_name#14173, store_zip#14174], Inner, BuildLeft, (cnt#14186L <= cnt#14073L), false
                     :- BroadcastQueryStage 71
                     :  +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, true], input[2, string, true], input[3, string, true]),false), [id=#133734]
                     :     +- *(63) HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#675)), sum(UnscaledValue(ss_list_price#676)), sum(UnscaledValue(ss_coupon_amt#683))], output=[product_name#14058, item_sk#14059, store_name#14060, store_zip#14061, b_street_number#14062, b_street_name#14063, b_city#14064, b_zip#14065, c_street_number#14066, c_street_name#14067, c_city#14068, c_zip#14069, syear#14070, cnt#14073L, s1#14074, s2#14075, s3#14076])
                     :        +- AQEShuffleRead coalesced
                     :           +- ShuffleQueryStage 69
                     :              +- Exchange hashpartitioning(i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111, 200), ENSURE_REQUIREMENTS, [id=#133254]
                     :                 +- *(59) HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#675)), partial_sum(UnscaledValue(ss_list_price#676)), partial_sum(UnscaledValue(ss_coupon_amt#683))], output=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111, count#14570L, sum#14571L, sum#14572L, sum#14573L])
                     :                    +- *(59) Project [ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, d_year#14083, d_year#14111, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, i_item_sk#500, i_product_name#521]
                     :                       +- *(59) BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
                     :                          :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#14083, d_year#14111, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156]
                     :                          :  +- *(59) BroadcastHashJoin [hd_income_band_sk#14143], [ib_income_band_sk#14160], Inner, BuildRight, false
                     :                          :     :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#14083, d_year#14111, hd_income_band_sk#14143, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156]
                     :                          :     :  +- *(59) BroadcastHashJoin [hd_income_band_sk#655], [ib_income_band_sk#302], Inner, BuildRight, false
                     :                          :     :     :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#14083, d_year#14111, hd_income_band_sk#655, hd_income_band_sk#14143, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156]
                     :                          :     :     :  +- *(59) BroadcastHashJoin [c_current_addr_sk#566], [ca_address_sk#14147], Inner, BuildRight, false
                     :                          :     :     :     :- *(59) Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#14083, d_year#14111, hd_income_band_sk#655, hd_income_band_sk#14143, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223]
                     :                          :     :     :     :  +- *(59) BroadcastHashJoin [ss_addr_sk#670], [ca_address_sk#214], Inner, BuildRight, false
                     :                          :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#14083, d_year#14111, hd_income_band_sk#655, hd_income_band_sk#14143]
                     :                          :     :     :     :     :  +- *(59) BroadcastHashJoin [c_current_hdemo_sk#565], [hd_demo_sk#14142], Inner, BuildRight, false
                     :                          :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111, hd_income_band_sk#655]
                     :                          :     :     :     :     :     :  +- *(59) BroadcastHashJoin [ss_hdemo_sk#669], [hd_demo_sk#654], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111]
                     :                          :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [ss_promo_sk#672], [p_promo_sk#750], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111]
                     :                          :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [c_current_cdemo_sk#564], [cd_demo_sk#14133], Inner, BuildRight, NOT (cd_marital_status#50 = cd_marital_status#14135), false
                     :                          :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111, cd_marital_status#50]
                     :                          :     :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [ss_cdemo_sk#668], [cd_demo_sk#48], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111]
                     :                          :     :     :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [c_first_shipto_date_sk#567], [d_date_sk#14105], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, d_year#14083]
                     :                          :     :     :     :     :     :     :     :     :     :     :  +- *(59) BroadcastHashJoin [c_first_sales_date_sk#568], [d_date_sk#14077], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :     :- *(59) Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, c_first_sales_date_sk#568]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :  +- *(59) SortMergeJoin [ss_customer_sk#667], [c_customer_sk#562], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :- *(57) Sort [ss_customer_sk#667 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :  +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :     +- ShuffleQueryStage 67
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(ss_customer_sk#667, 200), ENSURE_REQUIREMENTS, [id=#132241]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(53) Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(53) BroadcastHashJoin [ss_store_sk#671], [s_store_sk#326], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :- *(53) Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :  +- *(53) BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :- *(53) Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :  +- *(53) SortMergeJoin [ss_item_sk#666], [cs_item_sk#133], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :- *(51) Sort [ss_item_sk#666 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :  +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :     +- ShuffleQueryStage 61
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :        +- Exchange hashpartitioning(ss_item_sk#666, 200), ENSURE_REQUIREMENTS, [id=#128990]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :           +- *(41) Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :              +- *(41) SortMergeJoin [ss_item_sk#666, ss_ticket_number#673L], [sr_item_sk#712, sr_ticket_number#719L], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :- *(39) Sort [ss_item_sk#666 ASC NULLS FIRST, ss_ticket_number#673L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :  +- ShuffleQueryStage 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :     +- Exchange hashpartitioning(ss_item_sk#666, ss_ticket_number#673L, 200), ENSURE_REQUIREMENTS, [id=#123295]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :        +- *(1) Filter ((((((((isnotnull(ss_item_sk#666) AND isnotnull(ss_ticket_number#673L)) AND isnotnull(ss_sold_date_sk#664)) AND isnotnull(ss_store_sk#671)) AND isnotnull(ss_customer_sk#667)) AND isnotnull(ss_cdemo_sk#668)) AND isnotnull(ss_promo_sk#672)) AND isnotnull(ss_hdemo_sk#669)) AND isnotnull(ss_addr_sk#670))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :           +- *(1) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 :              +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_wholesale_cost#675,ss_list_price#676,ss_coupon_amt#683] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_ticket_number#673L), isnotnull(ss_sold_date_sk#664), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                 +- *(40) Sort [sr_item_sk#712 ASC NULLS FIRST, sr_ticket_number#719L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                    +- ShuffleQueryStage 1
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                       +- Exchange hashpartitioning(sr_item_sk#712, sr_ticket_number#719L, 200), ENSURE_REQUIREMENTS, [id=#123312]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                          +- *(2) Filter (isnotnull(sr_item_sk#712) AND isnotnull(sr_ticket_number#719L))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                             +- *(2) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :                                +- FileScan parquet [sr_item_sk#712,sr_ticket_number#719L] Batched: true, DataFilters: [isnotnull(sr_item_sk#712), isnotnull(sr_ticket_number#719L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     +- *(52) Sort [cs_item_sk#133 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :        +- *(52) Project [cs_item_sk#133]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :           +- *(52) Filter (isnotnull(sale#14056) AND (cast(sale#14056 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14057)), DecimalType(21,2), true)))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :              +- *(52) HashAggregate(keys=[cs_item_sk#133], functions=[sum(UnscaledValue(cs_ext_list_price#143)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sale#14056, refund#14057])
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                 +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                    +- ShuffleQueryStage 64
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                       +- Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#131084]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                          +- *(47) HashAggregate(keys=[cs_item_sk#133], functions=[partial_sum(UnscaledValue(cs_ext_list_price#143)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sum#14577L, sum#14578, isEmpty#14579])
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                             +- *(47) Project [cs_item_sk#133, cs_ext_list_price#143, cr_refunded_cash#271, cr_reversed_charge#272, cr_store_credit#273]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                +- *(47) SortMergeJoin [cs_item_sk#133, cs_order_number#135L], [cr_item_sk#250, cr_order_number#264L], Inner
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :- *(45) Sort [cs_item_sk#133 ASC NULLS FIRST, cs_order_number#135L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :  +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :     +- ShuffleQueryStage 2
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :        +- Exchange hashpartitioning(cs_item_sk#133, cs_order_number#135L, 200), ENSURE_REQUIREMENTS, [id=#123333]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :           +- *(3) Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_order_number#135L))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :              +- *(3) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   :                 +- FileScan parquet [cs_item_sk#133,cs_order_number#135L,cs_ext_list_price#143] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_order_number#135L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                   +- *(46) Sort [cr_item_sk#250 ASC NULLS FIRST, cr_order_number#264L ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                      +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                         +- ShuffleQueryStage 3
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                            +- Exchange hashpartitioning(cr_item_sk#250, cr_order_number#264L, 200), ENSURE_REQUIREMENTS, [id=#123350]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                               +- *(4) Filter (isnotnull(cr_item_sk#250) AND isnotnull(cr_order_number#264L))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                                  +- *(4) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                                                     +- FileScan parquet [cr_item_sk#250,cr_order_number#264L,cr_refunded_cash#271,cr_reversed_charge#272,cr_store_credit#273] Batched: true, DataFilters: [isnotnull(cr_item_sk#250), isnotnull(cr_order_number#264L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     +- BroadcastQueryStage 4
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123377]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :           +- *(5) Filter ((isnotnull(d_year#604) AND (d_year#604 = 2001)) AND isnotnull(d_date_sk#598))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :              +- *(5) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :                 +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                 +- BroadcastQueryStage 5
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123394]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                       +- *(6) Filter ((isnotnull(s_store_sk#326) AND isnotnull(s_store_name#331)) AND isnotnull(s_zip#351))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                          +- *(6) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     :                             +- FileScan parquet [s_store_sk#326,s_store_name#331,s_zip#351] Batched: true, DataFilters: [isnotnull(s_store_sk#326), isnotnull(s_store_name#331), isnotnull(s_zip#351)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                     :                          :     :     :     :     :     :     :     :     :     :     :     :     +- *(58) Sort [c_customer_sk#562 ASC NULLS FIRST], false, 0
                     :                          :     :     :     :     :     :     :     :     :     :     :     :        +- AQEShuffleRead coalesced
                     :                          :     :     :     :     :     :     :     :     :     :     :     :           +- ShuffleQueryStage 6
                     :                          :     :     :     :     :     :     :     :     :     :     :     :              +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#123413]
                     :                          :     :     :     :     :     :     :     :     :     :     :     :                 +- *(7) Filter (((((isnotnull(c_customer_sk#562) AND isnotnull(c_first_sales_date_sk#568)) AND isnotnull(c_first_shipto_date_sk#567)) AND isnotnull(c_current_cdemo_sk#564)) AND isnotnull(c_current_hdemo_sk#565)) AND isnotnull(c_current_addr_sk#566))
                     :                          :     :     :     :     :     :     :     :     :     :     :     :                    +- *(7) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :     :                       +- FileScan parquet [c_customer_sk#562,c_current_cdemo_sk#564,c_current_hdemo_sk#565,c_current_addr_sk#566,c_first_shipto_date_sk#567,c_first_sales_date_sk#568] Batched: true, DataFilters: [isnotnull(c_customer_sk#562), isnotnull(c_first_sales_date_sk#568), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                     :                          :     :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 7
                     :                          :     :     :     :     :     :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123432]
                     :                          :     :     :     :     :     :     :     :     :     :     :           +- *(8) Filter isnotnull(d_date_sk#14077)
                     :                          :     :     :     :     :     :     :     :     :     :     :              +- *(8) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet [d_date_sk#14077,d_year#14083] Batched: true, DataFilters: [isnotnull(d_date_sk#14077)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                          :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 9
                     :                          :     :     :     :     :     :     :     :     :     :        +- ReusedExchange [d_date_sk#14105, d_year#14111], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123432]
                     :                          :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 10
                     :                          :     :     :     :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123468]
                     :                          :     :     :     :     :     :     :     :     :           +- *(10) Filter (isnotnull(cd_demo_sk#48) AND isnotnull(cd_marital_status#50))
                     :                          :     :     :     :     :     :     :     :     :              +- *(10) ColumnarToRow
                     :                          :     :     :     :     :     :     :     :     :                 +- FileScan parquet [cd_demo_sk#48,cd_marital_status#50] Batched: true, DataFilters: [isnotnull(cd_demo_sk#48), isnotnull(cd_marital_status#50)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                     :                          :     :     :     :     :     :     :     :     +- BroadcastQueryStage 12
                     :                          :     :     :     :     :     :     :     :        +- ReusedExchange [cd_demo_sk#14133, cd_marital_status#14135], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123468]
                     :                          :     :     :     :     :     :     :     +- BroadcastQueryStage 13
                     :                          :     :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123504]
                     :                          :     :     :     :     :     :     :           +- *(12) Filter isnotnull(p_promo_sk#750)
                     :                          :     :     :     :     :     :     :              +- *(12) ColumnarToRow
                     :                          :     :     :     :     :     :     :                 +- FileScan parquet [p_promo_sk#750] Batched: true, DataFilters: [isnotnull(p_promo_sk#750)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                     :                          :     :     :     :     :     :     +- BroadcastQueryStage 14
                     :                          :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123521]
                     :                          :     :     :     :     :     :           +- *(13) Filter (isnotnull(hd_demo_sk#654) AND isnotnull(hd_income_band_sk#655))
                     :                          :     :     :     :     :     :              +- *(13) ColumnarToRow
                     :                          :     :     :     :     :     :                 +- FileScan parquet [hd_demo_sk#654,hd_income_band_sk#655] Batched: true, DataFilters: [isnotnull(hd_demo_sk#654), isnotnull(hd_income_band_sk#655)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                     :                          :     :     :     :     :     +- BroadcastQueryStage 16
                     :                          :     :     :     :     :        +- ReusedExchange [hd_demo_sk#14142, hd_income_band_sk#14143], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123521]
                     :                          :     :     :     :     +- BroadcastQueryStage 17
                     :                          :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123557]
                     :                          :     :     :     :           +- *(15) Filter isnotnull(ca_address_sk#214)
                     :                          :     :     :     :              +- *(15) ColumnarToRow
                     :                          :     :     :     :                 +- FileScan parquet [ca_address_sk#214,ca_street_number#216,ca_street_name#217,ca_city#220,ca_zip#223] Batched: true, DataFilters: [isnotnull(ca_address_sk#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                     :                          :     :     :     +- BroadcastQueryStage 19
                     :                          :     :     :        +- ReusedExchange [ca_address_sk#14147, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123557]
                     :                          :     :     +- BroadcastQueryStage 20
                     :                          :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123593]
                     :                          :     :           +- *(17) Filter isnotnull(ib_income_band_sk#302)
                     :                          :     :              +- *(17) ColumnarToRow
                     :                          :     :                 +- FileScan parquet [ib_income_band_sk#302] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#302)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                     :                          :     +- BroadcastQueryStage 22
                     :                          :        +- ReusedExchange [ib_income_band_sk#14160], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123593]
                     :                          +- BroadcastQueryStage 23
                     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#123631]
                     :                                +- *(19) Project [i_item_sk#500, i_product_name#521]
                     :                                   +- *(19) Filter ((((((isnotnull(i_current_price#505) AND i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#505 >= 75.00)) AND (i_current_price#505 <= 85.00)) AND (i_current_price#505 >= 76.00)) AND (i_current_price#505 <= 90.00)) AND isnotnull(i_item_sk#500))
                     :                                      +- *(19) ColumnarToRow
                     :                                         +- FileScan parquet [i_item_sk#500,i_current_price#505,i_color#517,i_product_name#521] Batched: true, DataFilters: [isnotnull(i_current_price#505), i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
                     +- *(64) HashAggregate(keys=[i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#14222)), sum(UnscaledValue(ss_list_price#14223)), sum(UnscaledValue(ss_coupon_amt#14230))], output=[item_sk#14172, store_name#14173, store_zip#14174, syear#14183, cnt#14186L, s1#14187, s2#14188, s3#14189])
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage 70
                              +- Exchange hashpartitioning(i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377, 200), ENSURE_REQUIREMENTS, [id=#133606]
                                 +- *(62) HashAggregate(keys=[i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#14222)), partial_sum(UnscaledValue(ss_list_price#14223)), partial_sum(UnscaledValue(ss_coupon_amt#14230))], output=[i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377, count#14570L, sum#14583L, sum#14584L, sum#14585L])
                                    +- *(62) Project [ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, d_year#14349, d_year#14377, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, i_item_sk#14525, i_product_name#14546]
                                       +- *(62) BroadcastHashJoin [ss_item_sk#14213], [i_item_sk#14525], Inner, BuildRight, false
                                          :- *(62) Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, d_year#14349, d_year#14377, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515]
                                          :  +- *(62) BroadcastHashJoin [hd_income_band_sk#14489], [ib_income_band_sk#14522], Inner, BuildRight, false
                                          :     :- *(62) Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, d_year#14349, d_year#14377, hd_income_band_sk#14489, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515]
                                          :     :  +- *(62) BroadcastHashJoin [hd_income_band_sk#14484], [ib_income_band_sk#14519], Inner, BuildRight, false
                                          :     :     :- *(62) Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, d_year#14349, d_year#14377, hd_income_band_sk#14484, hd_income_band_sk#14489, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515]
                                          :     :     :  +- *(62) BroadcastHashJoin [c_current_addr_sk#14432], [ca_address_sk#14506], Inner, BuildRight, false
                                          :     :     :     :- *(62) Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_addr_sk#14432, d_year#14349, d_year#14377, hd_income_band_sk#14484, hd_income_band_sk#14489, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502]
                                          :     :     :     :  +- *(62) BroadcastHashJoin [ss_addr_sk#14217], [ca_address_sk#14493], Inner, BuildRight, false
                                          :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_addr_sk#14217, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_addr_sk#14432, d_year#14349, d_year#14377, hd_income_band_sk#14484, hd_income_band_sk#14489]
                                          :     :     :     :     :  +- *(62) BroadcastHashJoin [c_current_hdemo_sk#14431], [hd_demo_sk#14488], Inner, BuildRight, false
                                          :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_addr_sk#14217, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377, hd_income_band_sk#14484]
                                          :     :     :     :     :     :  +- *(62) BroadcastHashJoin [ss_hdemo_sk#14216], [hd_demo_sk#14483], Inner, BuildRight, false
                                          :     :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377]
                                          :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [ss_promo_sk#14219], [p_promo_sk#14464], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377]
                                          :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [c_current_cdemo_sk#14430], [cd_demo_sk#14455], Inner, BuildRight, NOT (cd_marital_status#14448 = cd_marital_status#14457), false
                                          :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377, cd_marital_status#14448]
                                          :     :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [ss_cdemo_sk#14215], [cd_demo_sk#14446], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377]
                                          :     :     :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [c_first_shipto_date_sk#14433], [d_date_sk#14371], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, c_first_shipto_date_sk#14433, d_year#14349]
                                          :     :     :     :     :     :     :     :     :     :     :  +- *(62) BroadcastHashJoin [c_first_sales_date_sk#14434], [d_date_sk#14343], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :     :- *(62) Project [ss_item_sk#14213, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, c_first_shipto_date_sk#14433, c_first_sales_date_sk#14434]
                                          :     :     :     :     :     :     :     :     :     :     :     :  +- *(62) SortMergeJoin [ss_customer_sk#14214], [c_customer_sk#14428], Inner
                                          :     :     :     :     :     :     :     :     :     :     :     :     :- *(60) Sort [ss_customer_sk#14214 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :     :  +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :     :     +- ShuffleQueryStage 68
                                          :     :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(ss_customer_sk#14214, 200), ENSURE_REQUIREMENTS, [id=#132344]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :           +- *(56) Project [ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :              +- *(56) BroadcastHashJoin [ss_store_sk#14218], [s_store_sk#14399], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :- *(56) Project [ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_store_sk#14218, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :  +- *(56) BroadcastHashJoin [ss_sold_date_sk#14211], [d_date_sk#14315], Inner, BuildRight, false
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :- *(56) Project [ss_sold_date_sk#14211, ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_store_sk#14218, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :  +- *(56) SortMergeJoin [ss_item_sk#14213], [cs_item_sk#14269], Inner
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :- *(54) Sort [ss_item_sk#14213 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :  +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :     +- ShuffleQueryStage 63
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     :        +- ReusedExchange [ss_sold_date_sk#14211, ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_store_sk#14218, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230], Exchange hashpartitioning(ss_item_sk#666, 200), ENSURE_REQUIREMENTS, [id=#128990]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :     +- *(55) Sort [cs_item_sk#14269 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :        +- *(55) Project [cs_item_sk#14269]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :           +- *(55) Filter (isnotnull(sale#14056) AND (cast(sale#14056 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14057)), DecimalType(21,2), true)))
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :              +- *(55) HashAggregate(keys=[cs_item_sk#14269], functions=[sum(UnscaledValue(cs_ext_list_price#14279)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#14311 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#14312 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#14313 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14269, sale#14056, refund#14057])
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                 +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                    +- ShuffleQueryStage 66
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     :                       +- ReusedExchange [cs_item_sk#14269, sum#14589L, sum#14590, isEmpty#14591], Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#131084]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :     +- BroadcastQueryStage 32
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123745]
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :           +- *(24) Filter ((isnotnull(d_year#14321) AND (d_year#14321 = 2002)) AND isnotnull(d_date_sk#14315))
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :              +- *(24) ColumnarToRow
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 :                 +- FileScan parquet [d_date_sk#14315,d_year#14321] Batched: true, DataFilters: [isnotnull(d_year#14321), (d_year#14321 = 2002), isnotnull(d_date_sk#14315)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                 +- BroadcastQueryStage 34
                                          :     :     :     :     :     :     :     :     :     :     :     :     :                    +- ReusedExchange [s_store_sk#14399, s_store_name#14404, s_zip#14424], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123394]
                                          :     :     :     :     :     :     :     :     :     :     :     :     +- *(61) Sort [c_customer_sk#14428 ASC NULLS FIRST], false, 0
                                          :     :     :     :     :     :     :     :     :     :     :     :        +- AQEShuffleRead coalesced
                                          :     :     :     :     :     :     :     :     :     :     :     :           +- ShuffleQueryStage 36
                                          :     :     :     :     :     :     :     :     :     :     :     :              +- ReusedExchange [c_customer_sk#14428, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, c_first_shipto_date_sk#14433, c_first_sales_date_sk#14434], Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#123413]
                                          :     :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 38
                                          :     :     :     :     :     :     :     :     :     :     :        +- ReusedExchange [d_date_sk#14343, d_year#14349], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123432]
                                          :     :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 40
                                          :     :     :     :     :     :     :     :     :     :        +- ReusedExchange [d_date_sk#14371, d_year#14377], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123432]
                                          :     :     :     :     :     :     :     :     :     +- BroadcastQueryStage 42
                                          :     :     :     :     :     :     :     :     :        +- ReusedExchange [cd_demo_sk#14446, cd_marital_status#14448], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123468]
                                          :     :     :     :     :     :     :     :     +- BroadcastQueryStage 44
                                          :     :     :     :     :     :     :     :        +- ReusedExchange [cd_demo_sk#14455, cd_marital_status#14457], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123468]
                                          :     :     :     :     :     :     :     +- BroadcastQueryStage 46
                                          :     :     :     :     :     :     :        +- ReusedExchange [p_promo_sk#14464], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123504]
                                          :     :     :     :     :     :     +- BroadcastQueryStage 48
                                          :     :     :     :     :     :        +- ReusedExchange [hd_demo_sk#14483, hd_income_band_sk#14484], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123521]
                                          :     :     :     :     :     +- BroadcastQueryStage 50
                                          :     :     :     :     :        +- ReusedExchange [hd_demo_sk#14488, hd_income_band_sk#14489], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123521]
                                          :     :     :     :     +- BroadcastQueryStage 52
                                          :     :     :     :        +- ReusedExchange [ca_address_sk#14493, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123557]
                                          :     :     :     +- BroadcastQueryStage 54
                                          :     :     :        +- ReusedExchange [ca_address_sk#14506, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123557]
                                          :     :     +- BroadcastQueryStage 56
                                          :     :        +- ReusedExchange [ib_income_band_sk#14519], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123593]
                                          :     +- BroadcastQueryStage 58
                                          :        +- ReusedExchange [ib_income_band_sk#14522], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#123593]
                                          +- BroadcastQueryStage 60
                                             +- ReusedExchange [i_item_sk#14525, i_product_name#14546], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#123631]
+- == Initial Plan ==
   Project [product_name#14058, store_name#14060, store_zip#14061, b_street_number#14062, b_street_name#14063, b_city#14064, b_zip#14065, c_street_number#14066, c_street_name#14067, c_city#14068, c_zip#14069, syear#14070, cnt#14073L, s11#14050, s21#14051, s31#14052, s12#14053, s22#14054, s32#14055, syear#14183, cnt#14186L]
   +- Sort [product_name#14058 ASC NULLS FIRST, store_name#14060 ASC NULLS FIRST, cnt#14186L ASC NULLS FIRST, s1#14074 ASC NULLS FIRST, s1#14187 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(product_name#14058 ASC NULLS FIRST, store_name#14060 ASC NULLS FIRST, cnt#14186L ASC NULLS FIRST, s1#14074 ASC NULLS FIRST, s1#14187 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#122889]
         +- Project [product_name#14058, store_name#14060, store_zip#14061, b_street_number#14062, b_street_name#14063, b_city#14064, b_zip#14065, c_street_number#14066, c_street_name#14067, c_city#14068, c_zip#14069, syear#14070, cnt#14073L, s1#14074 AS s11#14050, s2#14075 AS s21#14051, s3#14076 AS s31#14052, s1#14187 AS s12#14053, s2#14188 AS s22#14054, s3#14189 AS s32#14055, syear#14183, cnt#14186L, s1#14074, s1#14187]
            +- SortMergeJoin [item_sk#14059, store_name#14060, store_zip#14061], [item_sk#14172, store_name#14173, store_zip#14174], Inner, (cnt#14186L <= cnt#14073L)
               :- Sort [item_sk#14059 ASC NULLS FIRST, store_name#14060 ASC NULLS FIRST, store_zip#14061 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(item_sk#14059, store_name#14060, store_zip#14061, 200), ENSURE_REQUIREMENTS, [id=#122882]
               :     +- HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#675)), sum(UnscaledValue(ss_list_price#676)), sum(UnscaledValue(ss_coupon_amt#683))], output=[product_name#14058, item_sk#14059, store_name#14060, store_zip#14061, b_street_number#14062, b_street_name#14063, b_city#14064, b_zip#14065, c_street_number#14066, c_street_name#14067, c_city#14068, c_zip#14069, syear#14070, cnt#14073L, s1#14074, s2#14075, s3#14076])
               :        +- Exchange hashpartitioning(i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111, 200), ENSURE_REQUIREMENTS, [id=#122783]
               :           +- HashAggregate(keys=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#675)), partial_sum(UnscaledValue(ss_list_price#676)), partial_sum(UnscaledValue(ss_coupon_amt#683))], output=[i_product_name#521, i_item_sk#500, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, d_year#604, d_year#14083, d_year#14111, count#14570L, sum#14571L, sum#14572L, sum#14573L])
               :              +- Project [ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, d_year#14083, d_year#14111, s_store_name#331, s_zip#351, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156, i_item_sk#500, i_product_name#521]
               :                 +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
               :                    :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#14083, d_year#14111, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156]
               :                    :  +- BroadcastHashJoin [hd_income_band_sk#14143], [ib_income_band_sk#14160], Inner, BuildRight, false
               :                    :     :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#14083, d_year#14111, hd_income_band_sk#14143, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156]
               :                    :     :  +- BroadcastHashJoin [hd_income_band_sk#655], [ib_income_band_sk#302], Inner, BuildRight, false
               :                    :     :     :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, d_year#14083, d_year#14111, hd_income_band_sk#655, hd_income_band_sk#14143, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223, ca_street_number#14149, ca_street_name#14150, ca_city#14153, ca_zip#14156]
               :                    :     :     :  +- BroadcastHashJoin [c_current_addr_sk#566], [ca_address_sk#14147], Inner, BuildRight, false
               :                    :     :     :     :- Project [ss_item_sk#666, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#14083, d_year#14111, hd_income_band_sk#655, hd_income_band_sk#14143, ca_street_number#216, ca_street_name#217, ca_city#220, ca_zip#223]
               :                    :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#670], [ca_address_sk#214], Inner, BuildRight, false
               :                    :     :     :     :     :- Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_addr_sk#566, d_year#14083, d_year#14111, hd_income_band_sk#655, hd_income_band_sk#14143]
               :                    :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#565], [hd_demo_sk#14142], Inner, BuildRight, false
               :                    :     :     :     :     :     :- Project [ss_item_sk#666, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111, hd_income_band_sk#655]
               :                    :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#669], [hd_demo_sk#654], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111]
               :                    :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#672], [p_promo_sk#750], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111]
               :                    :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#564], [cd_demo_sk#14133], Inner, BuildRight, NOT (cd_marital_status#50 = cd_marital_status#14135), false
               :                    :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111, cd_marital_status#50]
               :                    :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#668], [cd_demo_sk#48], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, d_year#14083, d_year#14111]
               :                    :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#567], [d_date_sk#14105], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, d_year#14083]
               :                    :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#568], [d_date_sk#14077], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#666, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351, c_current_cdemo_sk#564, c_current_hdemo_sk#565, c_current_addr_sk#566, c_first_shipto_date_sk#567, c_first_sales_date_sk#568]
               :                    :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_customer_sk#667], [c_customer_sk#562], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_customer_sk#667 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_customer_sk#667, 200), ENSURE_REQUIREMENTS, [id=#122727]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604, s_store_name#331, s_zip#351]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_store_sk#671], [s_store_sk#326], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :- Project [ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683, d_year#604]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :- Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :  +- SortMergeJoin [ss_item_sk#666], [cs_item_sk#133], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :- Sort [ss_item_sk#666 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :  +- Exchange hashpartitioning(ss_item_sk#666, 200), ENSURE_REQUIREMENTS, [id=#122712]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :     +- Project [ss_sold_date_sk#664, ss_item_sk#666, ss_customer_sk#667, ss_cdemo_sk#668, ss_hdemo_sk#669, ss_addr_sk#670, ss_store_sk#671, ss_promo_sk#672, ss_wholesale_cost#675, ss_list_price#676, ss_coupon_amt#683]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :        +- SortMergeJoin [ss_item_sk#666, ss_ticket_number#673L], [sr_item_sk#712, sr_ticket_number#719L], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :- Sort [ss_item_sk#666 ASC NULLS FIRST, ss_ticket_number#673L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :  +- Exchange hashpartitioning(ss_item_sk#666, ss_ticket_number#673L, 200), ENSURE_REQUIREMENTS, [id=#122691]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :     +- Filter ((((((((isnotnull(ss_item_sk#666) AND isnotnull(ss_ticket_number#673L)) AND isnotnull(ss_sold_date_sk#664)) AND isnotnull(ss_store_sk#671)) AND isnotnull(ss_customer_sk#667)) AND isnotnull(ss_cdemo_sk#668)) AND isnotnull(ss_promo_sk#672)) AND isnotnull(ss_hdemo_sk#669)) AND isnotnull(ss_addr_sk#670))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :        +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_wholesale_cost#675,ss_list_price#676,ss_coupon_amt#683] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_ticket_number#673L), isnotnull(ss_sold_date_sk#664), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           +- Sort [sr_item_sk#712 ASC NULLS FIRST, sr_ticket_number#719L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :              +- Exchange hashpartitioning(sr_item_sk#712, sr_ticket_number#719L, 200), ENSURE_REQUIREMENTS, [id=#122692]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                 +- Filter (isnotnull(sr_item_sk#712) AND isnotnull(sr_ticket_number#719L))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                    +- FileScan parquet [sr_item_sk#712,sr_ticket_number#719L] Batched: true, DataFilters: [isnotnull(sr_item_sk#712), isnotnull(sr_ticket_number#719L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     +- Sort [cs_item_sk#133 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :        +- Project [cs_item_sk#133]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :           +- Filter (isnotnull(sale#14056) AND (cast(sale#14056 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14057)), DecimalType(21,2), true)))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :              +- HashAggregate(keys=[cs_item_sk#133], functions=[sum(UnscaledValue(cs_ext_list_price#143)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sale#14056, refund#14057])
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                 +- Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#122706]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                    +- HashAggregate(keys=[cs_item_sk#133], functions=[partial_sum(UnscaledValue(cs_ext_list_price#143)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#271 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#272 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#273 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#133, sum#14577L, sum#14578, isEmpty#14579])
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                       +- Project [cs_item_sk#133, cs_ext_list_price#143, cr_refunded_cash#271, cr_reversed_charge#272, cr_store_credit#273]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                          +- SortMergeJoin [cs_item_sk#133, cs_order_number#135L], [cr_item_sk#250, cr_order_number#264L], Inner
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :- Sort [cs_item_sk#133 ASC NULLS FIRST, cs_order_number#135L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :  +- Exchange hashpartitioning(cs_item_sk#133, cs_order_number#135L, 200), ENSURE_REQUIREMENTS, [id=#122698]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :     +- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_order_number#135L))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :        +- FileScan parquet [cs_item_sk#133,cs_order_number#135L,cs_ext_list_price#143] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_order_number#135L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             +- Sort [cr_item_sk#250 ASC NULLS FIRST, cr_order_number#264L ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                +- Exchange hashpartitioning(cr_item_sk#250, cr_order_number#264L, 200), ENSURE_REQUIREMENTS, [id=#122699]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                   +- Filter (isnotnull(cr_item_sk#250) AND isnotnull(cr_order_number#264L))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                      +- FileScan parquet [cr_item_sk#250,cr_order_number#264L,cr_refunded_cash#271,cr_reversed_charge#272,cr_store_credit#273] Batched: true, DataFilters: [isnotnull(cr_item_sk#250), isnotnull(cr_order_number#264L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122718]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :        +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 2001)) AND isnotnull(d_date_sk#598))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           :           +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122722]
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(s_store_sk#326) AND isnotnull(s_store_name#331)) AND isnotnull(s_zip#351))
               :                    :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet [s_store_sk#326,s_store_name#331,s_zip#351] Batched: true, DataFilters: [isnotnull(s_store_sk#326), isnotnull(s_store_name#331), isnotnull(s_zip#351)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
               :                    :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [c_customer_sk#562 ASC NULLS FIRST], false, 0
               :                    :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#122728]
               :                    :     :     :     :     :     :     :     :     :     :     :     :           +- Filter (((((isnotnull(c_customer_sk#562) AND isnotnull(c_first_sales_date_sk#568)) AND isnotnull(c_first_shipto_date_sk#567)) AND isnotnull(c_current_cdemo_sk#564)) AND isnotnull(c_current_hdemo_sk#565)) AND isnotnull(c_current_addr_sk#566))
               :                    :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet [c_customer_sk#562,c_current_cdemo_sk#564,c_current_hdemo_sk#565,c_current_addr_sk#566,c_first_shipto_date_sk#567,c_first_sales_date_sk#568] Batched: true, DataFilters: [isnotnull(c_customer_sk#562), isnotnull(c_first_sales_date_sk#568), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
               :                    :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122734]
               :                    :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#14077)
               :                    :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#14077,d_year#14083] Batched: true, DataFilters: [isnotnull(d_date_sk#14077)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122738]
               :                    :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#14105)
               :                    :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#14105,d_year#14111] Batched: true, DataFilters: [isnotnull(d_date_sk#14105)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122742]
               :                    :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#48) AND isnotnull(cd_marital_status#50))
               :                    :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#48,cd_marital_status#50] Batched: true, DataFilters: [isnotnull(cd_demo_sk#48), isnotnull(cd_marital_status#50)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                    :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122746]
               :                    :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#14133) AND isnotnull(cd_marital_status#14135))
               :                    :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#14133,cd_marital_status#14135] Batched: true, DataFilters: [isnotnull(cd_demo_sk#14133), isnotnull(cd_marital_status#14135)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                    :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122750]
               :                    :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#750)
               :                    :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#750] Batched: true, DataFilters: [isnotnull(p_promo_sk#750)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
               :                    :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122754]
               :                    :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#654) AND isnotnull(hd_income_band_sk#655))
               :                    :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#654,hd_income_band_sk#655] Batched: true, DataFilters: [isnotnull(hd_demo_sk#654), isnotnull(hd_income_band_sk#655)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                    :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122758]
               :                    :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#14142) AND isnotnull(hd_income_band_sk#14143))
               :                    :     :     :     :     :           +- FileScan parquet [hd_demo_sk#14142,hd_income_band_sk#14143] Batched: true, DataFilters: [isnotnull(hd_demo_sk#14142), isnotnull(hd_income_band_sk#14143)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                    :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122762]
               :                    :     :     :     :        +- Filter isnotnull(ca_address_sk#214)
               :                    :     :     :     :           +- FileScan parquet [ca_address_sk#214,ca_street_number#216,ca_street_name#217,ca_city#220,ca_zip#223] Batched: true, DataFilters: [isnotnull(ca_address_sk#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                    :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122766]
               :                    :     :     :        +- Filter isnotnull(ca_address_sk#14147)
               :                    :     :     :           +- FileScan parquet [ca_address_sk#14147,ca_street_number#14149,ca_street_name#14150,ca_city#14153,ca_zip#14156] Batched: true, DataFilters: [isnotnull(ca_address_sk#14147)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                    :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122770]
               :                    :     :        +- Filter isnotnull(ib_income_band_sk#302)
               :                    :     :           +- FileScan parquet [ib_income_band_sk#302] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#302)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122774]
               :                    :        +- Filter isnotnull(ib_income_band_sk#14160)
               :                    :           +- FileScan parquet [ib_income_band_sk#14160] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#14160)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#122778]
               :                       +- Project [i_item_sk#500, i_product_name#521]
               :                          +- Filter ((((((isnotnull(i_current_price#505) AND i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#505 >= 75.00)) AND (i_current_price#505 <= 85.00)) AND (i_current_price#505 >= 76.00)) AND (i_current_price#505 <= 90.00)) AND isnotnull(i_item_sk#500))
               :                             +- FileScan parquet [i_item_sk#500,i_current_price#505,i_color#517,i_product_name#521] Batched: true, DataFilters: [isnotnull(i_current_price#505), i_color#517 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
               +- Sort [item_sk#14172 ASC NULLS FIRST, store_name#14173 ASC NULLS FIRST, store_zip#14174 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(item_sk#14172, store_name#14173, store_zip#14174, 200), ENSURE_REQUIREMENTS, [id=#122883]
                     +- HashAggregate(keys=[i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#14222)), sum(UnscaledValue(ss_list_price#14223)), sum(UnscaledValue(ss_coupon_amt#14230))], output=[item_sk#14172, store_name#14173, store_zip#14174, syear#14183, cnt#14186L, s1#14187, s2#14188, s3#14189])
                        +- Exchange hashpartitioning(i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377, 200), ENSURE_REQUIREMENTS, [id=#122878]
                           +- HashAggregate(keys=[i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#14222)), partial_sum(UnscaledValue(ss_list_price#14223)), partial_sum(UnscaledValue(ss_coupon_amt#14230))], output=[i_product_name#14546, i_item_sk#14525, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, d_year#14321, d_year#14349, d_year#14377, count#14570L, sum#14583L, sum#14584L, sum#14585L])
                              +- Project [ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, d_year#14349, d_year#14377, s_store_name#14404, s_zip#14424, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515, i_item_sk#14525, i_product_name#14546]
                                 +- BroadcastHashJoin [ss_item_sk#14213], [i_item_sk#14525], Inner, BuildRight, false
                                    :- Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, d_year#14349, d_year#14377, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515]
                                    :  +- BroadcastHashJoin [hd_income_band_sk#14489], [ib_income_band_sk#14522], Inner, BuildRight, false
                                    :     :- Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, d_year#14349, d_year#14377, hd_income_band_sk#14489, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515]
                                    :     :  +- BroadcastHashJoin [hd_income_band_sk#14484], [ib_income_band_sk#14519], Inner, BuildRight, false
                                    :     :     :- Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, d_year#14349, d_year#14377, hd_income_band_sk#14484, hd_income_band_sk#14489, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502, ca_street_number#14508, ca_street_name#14509, ca_city#14512, ca_zip#14515]
                                    :     :     :  +- BroadcastHashJoin [c_current_addr_sk#14432], [ca_address_sk#14506], Inner, BuildRight, false
                                    :     :     :     :- Project [ss_item_sk#14213, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_addr_sk#14432, d_year#14349, d_year#14377, hd_income_band_sk#14484, hd_income_band_sk#14489, ca_street_number#14495, ca_street_name#14496, ca_city#14499, ca_zip#14502]
                                    :     :     :     :  +- BroadcastHashJoin [ss_addr_sk#14217], [ca_address_sk#14493], Inner, BuildRight, false
                                    :     :     :     :     :- Project [ss_item_sk#14213, ss_addr_sk#14217, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_addr_sk#14432, d_year#14349, d_year#14377, hd_income_band_sk#14484, hd_income_band_sk#14489]
                                    :     :     :     :     :  +- BroadcastHashJoin [c_current_hdemo_sk#14431], [hd_demo_sk#14488], Inner, BuildRight, false
                                    :     :     :     :     :     :- Project [ss_item_sk#14213, ss_addr_sk#14217, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377, hd_income_band_sk#14484]
                                    :     :     :     :     :     :  +- BroadcastHashJoin [ss_hdemo_sk#14216], [hd_demo_sk#14483], Inner, BuildRight, false
                                    :     :     :     :     :     :     :- Project [ss_item_sk#14213, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377]
                                    :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_promo_sk#14219], [p_promo_sk#14464], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :- Project [ss_item_sk#14213, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377]
                                    :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_current_cdemo_sk#14430], [cd_demo_sk#14455], Inner, BuildRight, NOT (cd_marital_status#14448 = cd_marital_status#14457), false
                                    :     :     :     :     :     :     :     :     :- Project [ss_item_sk#14213, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377, cd_marital_status#14448]
                                    :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ss_cdemo_sk#14215], [cd_demo_sk#14446], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#14213, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, d_year#14349, d_year#14377]
                                    :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_shipto_date_sk#14433], [d_date_sk#14371], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#14213, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, c_first_shipto_date_sk#14433, d_year#14349]
                                    :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [c_first_sales_date_sk#14434], [d_date_sk#14343], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :     :- Project [ss_item_sk#14213, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424, c_current_cdemo_sk#14430, c_current_hdemo_sk#14431, c_current_addr_sk#14432, c_first_shipto_date_sk#14433, c_first_sales_date_sk#14434]
                                    :     :     :     :     :     :     :     :     :     :     :     :  +- SortMergeJoin [ss_customer_sk#14214], [c_customer_sk#14428], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :- Sort [ss_customer_sk#14214 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :  +- Exchange hashpartitioning(ss_customer_sk#14214, 200), ENSURE_REQUIREMENTS, [id=#122822]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :     +- Project [ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321, s_store_name#14404, s_zip#14424]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :        +- BroadcastHashJoin [ss_store_sk#14218], [s_store_sk#14399], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :- Project [ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_store_sk#14218, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230, d_year#14321]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :  +- BroadcastHashJoin [ss_sold_date_sk#14211], [d_date_sk#14315], Inner, BuildRight, false
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :- Project [ss_sold_date_sk#14211, ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_store_sk#14218, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :  +- SortMergeJoin [ss_item_sk#14213], [cs_item_sk#14269], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :- Sort [ss_item_sk#14213 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :  +- Exchange hashpartitioning(ss_item_sk#14213, 200), ENSURE_REQUIREMENTS, [id=#122807]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :     +- Project [ss_sold_date_sk#14211, ss_item_sk#14213, ss_customer_sk#14214, ss_cdemo_sk#14215, ss_hdemo_sk#14216, ss_addr_sk#14217, ss_store_sk#14218, ss_promo_sk#14219, ss_wholesale_cost#14222, ss_list_price#14223, ss_coupon_amt#14230]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :        +- SortMergeJoin [ss_item_sk#14213, ss_ticket_number#14220L], [sr_item_sk#14236, sr_ticket_number#14243L], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :- Sort [ss_item_sk#14213 ASC NULLS FIRST, ss_ticket_number#14220L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :  +- Exchange hashpartitioning(ss_item_sk#14213, ss_ticket_number#14220L, 200), ENSURE_REQUIREMENTS, [id=#122786]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :     +- Filter ((((((((isnotnull(ss_item_sk#14213) AND isnotnull(ss_ticket_number#14220L)) AND isnotnull(ss_sold_date_sk#14211)) AND isnotnull(ss_store_sk#14218)) AND isnotnull(ss_customer_sk#14214)) AND isnotnull(ss_cdemo_sk#14215)) AND isnotnull(ss_promo_sk#14219)) AND isnotnull(ss_hdemo_sk#14216)) AND isnotnull(ss_addr_sk#14217))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           :        +- FileScan parquet [ss_sold_date_sk#14211,ss_item_sk#14213,ss_customer_sk#14214,ss_cdemo_sk#14215,ss_hdemo_sk#14216,ss_addr_sk#14217,ss_store_sk#14218,ss_promo_sk#14219,ss_ticket_number#14220L,ss_wholesale_cost#14222,ss_list_price#14223,ss_coupon_amt#14230] Batched: true, DataFilters: [isnotnull(ss_item_sk#14213), isnotnull(ss_ticket_number#14220L), isnotnull(ss_sold_date_sk#14211..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :           +- Sort [sr_item_sk#14236 ASC NULLS FIRST, sr_ticket_number#14243L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :              +- Exchange hashpartitioning(sr_item_sk#14236, sr_ticket_number#14243L, 200), ENSURE_REQUIREMENTS, [id=#122787]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                 +- Filter (isnotnull(sr_item_sk#14236) AND isnotnull(sr_ticket_number#14243L))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     :                    +- FileScan parquet [sr_item_sk#14236,sr_ticket_number#14243L] Batched: true, DataFilters: [isnotnull(sr_item_sk#14236), isnotnull(sr_ticket_number#14243L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :     +- Sort [cs_item_sk#14269 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :        +- Project [cs_item_sk#14269]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :           +- Filter (isnotnull(sale#14056) AND (cast(sale#14056 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14057)), DecimalType(21,2), true)))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :              +- HashAggregate(keys=[cs_item_sk#14269], functions=[sum(UnscaledValue(cs_ext_list_price#14279)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#14311 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#14312 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#14313 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14269, sale#14056, refund#14057])
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                 +- Exchange hashpartitioning(cs_item_sk#14269, 200), ENSURE_REQUIREMENTS, [id=#122801]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                    +- HashAggregate(keys=[cs_item_sk#14269], functions=[partial_sum(UnscaledValue(cs_ext_list_price#14279)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#14311 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#14312 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#14313 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14269, sum#14589L, sum#14590, isEmpty#14591])
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                       +- Project [cs_item_sk#14269, cs_ext_list_price#14279, cr_refunded_cash#14311, cr_reversed_charge#14312, cr_store_credit#14313]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                          +- SortMergeJoin [cs_item_sk#14269, cs_order_number#14271L], [cr_item_sk#14290, cr_order_number#14304L], Inner
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :- Sort [cs_item_sk#14269 ASC NULLS FIRST, cs_order_number#14271L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :  +- Exchange hashpartitioning(cs_item_sk#14269, cs_order_number#14271L, 200), ENSURE_REQUIREMENTS, [id=#122793]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :     +- Filter (isnotnull(cs_item_sk#14269) AND isnotnull(cs_order_number#14271L))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             :        +- FileScan parquet [cs_item_sk#14269,cs_order_number#14271L,cs_ext_list_price#14279] Batched: true, DataFilters: [isnotnull(cs_item_sk#14269), isnotnull(cs_order_number#14271L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                             +- Sort [cr_item_sk#14290 ASC NULLS FIRST, cr_order_number#14304L ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                +- Exchange hashpartitioning(cr_item_sk#14290, cr_order_number#14304L, 200), ENSURE_REQUIREMENTS, [id=#122794]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                   +- Filter (isnotnull(cr_item_sk#14290) AND isnotnull(cr_order_number#14304L))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     :                                      +- FileScan parquet [cr_item_sk#14290,cr_order_number#14304L,cr_refunded_cash#14311,cr_reversed_charge#14312,cr_store_credit#14313] Batched: true, DataFilters: [isnotnull(cr_item_sk#14290), isnotnull(cr_order_number#14304L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122813]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :        +- Filter ((isnotnull(d_year#14321) AND (d_year#14321 = 2002)) AND isnotnull(d_date_sk#14315))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           :           +- FileScan parquet [d_date_sk#14315,d_year#14321] Batched: true, DataFilters: [isnotnull(d_year#14321), (d_year#14321 = 2002), isnotnull(d_date_sk#14315)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :     :     :     :     :     :     :     :     :     :     :     :     :           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122817]
                                    :     :     :     :     :     :     :     :     :     :     :     :     :              +- Filter ((isnotnull(s_store_sk#14399) AND isnotnull(s_store_name#14404)) AND isnotnull(s_zip#14424))
                                    :     :     :     :     :     :     :     :     :     :     :     :     :                 +- FileScan parquet [s_store_sk#14399,s_store_name#14404,s_zip#14424] Batched: true, DataFilters: [isnotnull(s_store_sk#14399), isnotnull(s_store_name#14404), isnotnull(s_zip#14424)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                                    :     :     :     :     :     :     :     :     :     :     :     :     +- Sort [c_customer_sk#14428 ASC NULLS FIRST], false, 0
                                    :     :     :     :     :     :     :     :     :     :     :     :        +- Exchange hashpartitioning(c_customer_sk#14428, 200), ENSURE_REQUIREMENTS, [id=#122823]
                                    :     :     :     :     :     :     :     :     :     :     :     :           +- Filter (((((isnotnull(c_customer_sk#14428) AND isnotnull(c_first_sales_date_sk#14434)) AND isnotnull(c_first_shipto_date_sk#14433)) AND isnotnull(c_current_cdemo_sk#14430)) AND isnotnull(c_current_hdemo_sk#14431)) AND isnotnull(c_current_addr_sk#14432))
                                    :     :     :     :     :     :     :     :     :     :     :     :              +- FileScan parquet [c_customer_sk#14428,c_current_cdemo_sk#14430,c_current_hdemo_sk#14431,c_current_addr_sk#14432,c_first_shipto_date_sk#14433,c_first_sales_date_sk#14434] Batched: true, DataFilters: [isnotnull(c_customer_sk#14428), isnotnull(c_first_sales_date_sk#14434), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                                    :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122829]
                                    :     :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#14343)
                                    :     :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#14343,d_year#14349] Batched: true, DataFilters: [isnotnull(d_date_sk#14343)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122833]
                                    :     :     :     :     :     :     :     :     :     :        +- Filter isnotnull(d_date_sk#14371)
                                    :     :     :     :     :     :     :     :     :     :           +- FileScan parquet [d_date_sk#14371,d_year#14377] Batched: true, DataFilters: [isnotnull(d_date_sk#14371)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122837]
                                    :     :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#14446) AND isnotnull(cd_marital_status#14448))
                                    :     :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#14446,cd_marital_status#14448] Batched: true, DataFilters: [isnotnull(cd_demo_sk#14446), isnotnull(cd_marital_status#14448)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                    :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122841]
                                    :     :     :     :     :     :     :     :        +- Filter (isnotnull(cd_demo_sk#14455) AND isnotnull(cd_marital_status#14457))
                                    :     :     :     :     :     :     :     :           +- FileScan parquet [cd_demo_sk#14455,cd_marital_status#14457] Batched: true, DataFilters: [isnotnull(cd_demo_sk#14455), isnotnull(cd_marital_status#14457)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                    :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122845]
                                    :     :     :     :     :     :     :        +- Filter isnotnull(p_promo_sk#14464)
                                    :     :     :     :     :     :     :           +- FileScan parquet [p_promo_sk#14464] Batched: true, DataFilters: [isnotnull(p_promo_sk#14464)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                                    :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122849]
                                    :     :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#14483) AND isnotnull(hd_income_band_sk#14484))
                                    :     :     :     :     :     :           +- FileScan parquet [hd_demo_sk#14483,hd_income_band_sk#14484] Batched: true, DataFilters: [isnotnull(hd_demo_sk#14483), isnotnull(hd_income_band_sk#14484)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                    :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122853]
                                    :     :     :     :     :        +- Filter (isnotnull(hd_demo_sk#14488) AND isnotnull(hd_income_band_sk#14489))
                                    :     :     :     :     :           +- FileScan parquet [hd_demo_sk#14488,hd_income_band_sk#14489] Batched: true, DataFilters: [isnotnull(hd_demo_sk#14488), isnotnull(hd_income_band_sk#14489)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                    :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122857]
                                    :     :     :     :        +- Filter isnotnull(ca_address_sk#14493)
                                    :     :     :     :           +- FileScan parquet [ca_address_sk#14493,ca_street_number#14495,ca_street_name#14496,ca_city#14499,ca_zip#14502] Batched: true, DataFilters: [isnotnull(ca_address_sk#14493)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                    :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122861]
                                    :     :     :        +- Filter isnotnull(ca_address_sk#14506)
                                    :     :     :           +- FileScan parquet [ca_address_sk#14506,ca_street_number#14508,ca_street_name#14509,ca_city#14512,ca_zip#14515] Batched: true, DataFilters: [isnotnull(ca_address_sk#14506)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                    :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122865]
                                    :     :        +- Filter isnotnull(ib_income_band_sk#14519)
                                    :     :           +- FileScan parquet [ib_income_band_sk#14519] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#14519)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#122869]
                                    :        +- Filter isnotnull(ib_income_band_sk#14522)
                                    :           +- FileScan parquet [ib_income_band_sk#14522] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#14522)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#122873]
                                       +- Project [i_item_sk#14525, i_product_name#14546]
                                          +- Filter ((((((isnotnull(i_current_price#14530) AND i_color#14542 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#14530 >= 75.00)) AND (i_current_price#14530 <= 85.00)) AND (i_current_price#14530 >= 76.00)) AND (i_current_price#14530 <= 90.00)) AND isnotnull(i_item_sk#14525))
                                             +- FileScan parquet [i_item_sk#14525,i_current_price#14530,i_color#14542,i_product_name#14546] Batched: true, DataFilters: [isnotnull(i_current_price#14530), i_color#14542 IN (chocolate,lime,sienna,drab,goldenrod,navajo)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
