GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#331 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#331], [s_store_name#331, MakeDecimal(sum(UnscaledValue(ss_net_profit#686)),17,2) AS sum(ss_net_profit)#3150]
         +- Project [ss_net_profit#686, s_store_name#331]
            +- Join Inner, (substr(s_zip#351, 1, 2) = substr(ca_zip#3131, 1, 2))
               :- Project [ss_net_profit#686, s_store_name#331, s_zip#351]
               :  +- Join Inner, (ss_store_sk#671 = s_store_sk#326)
               :     :- Project [ss_store_sk#671, ss_net_profit#686]
               :     :  +- Join Inner, (ss_sold_date_sk#664 = d_date_sk#598)
               :     :     :- Project [ss_sold_date_sk#664, ss_store_sk#671, ss_net_profit#686]
               :     :     :  +- Filter (isnotnull(ss_sold_date_sk#664) AND isnotnull(ss_store_sk#671))
               :     :     :     +- Relation [ss_sold_date_sk#664,ss_sold_time_sk#665,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_quantity#674,ss_wholesale_cost#675,ss_list_price#676,ss_sales_price#677,ss_ext_discount_amt#678,ss_ext_sales_price#679,ss_ext_wholesale_cost#680,ss_ext_list_price#681,ss_ext_tax#682,ss_coupon_amt#683,ss_net_paid#684,ss_net_paid_inc_tax#685,ss_net_profit#686] parquet
               :     :     +- Project [d_date_sk#598]
               :     :        +- Filter (((isnotnull(d_qoy#608) AND isnotnull(d_year#604)) AND ((d_qoy#608 = 1) AND (d_year#604 = 2002))) AND isnotnull(d_date_sk#598))
               :     :           +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
               :     +- Project [s_store_sk#326, s_store_name#331, s_zip#351]
               :        +- Filter (isnotnull(s_store_sk#326) AND isnotnull(s_zip#351))
               :           +- Relation [s_store_sk#326,s_store_id#327,s_rec_start_date#328,s_rec_end_date#329,s_closed_date_sk#330,s_store_name#331,s_number_employees#332,s_floor_space#333,s_hours#334,s_manager#335,s_market_id#336,s_geography_class#337,s_market_desc#338,s_market_manager#339,s_division_id#340,s_division_name#341,s_company_id#342,s_company_name#343,s_street_number#344,s_street_name#345,s_street_type#346,s_suite_number#347,s_city#348,s_county#349,... 5 more fields] parquet
               +- Aggregate [ca_zip#3131], [ca_zip#3131]
                  +- Project [substr(ca_zip#223, 1, 5) AS ca_zip#3131]
                     +- Join LeftSemi, (substr(ca_zip#223, 1, 5) <=> ca_zip#3132)
                        :- Project [ca_zip#223]
                        :  +- Filter (substr(ca_zip#223, 1, 5) INSET 10206, 10324, 10424, 10828, 11000, 11486, 11666, 11734, 12037, 12215, 12413, 12727, 12778, 13068, 13091, 13188, 13224, 13505, 13763, 13878, 13888, 14108, 14174, 14230, 14438, 14687, 15025, 15412, 15444, 15809, 15934, 16179, 16536, 16581, 17024, 17168, 17712, 17839, 18003, 18079, 18161, 18260, 18301, 18569, 18589, 18764, 18820, 19407, 19530, 19531, 19669, 19744, 19898, 19901, 19932, 20034, 20144, 20185, 20333, 20345, 20453, 20579, 20699, 20729, 20746, 20832, 20956, 21438, 21462, 21508, 21537, 22550, 22939, 23064, 23410, 23562, 23618, 23995, 24194, 24349, 24357, 24549, 24749, 24812, 25000, 25110, 25114, 25482, 25520, 25580, 26172, 26731, 27165, 27682, 27968, 28067, 28073, 28477, 28635, 28801, 28986, 29036, 29354, 29470, 29734, 30247, 30317, 30808, 30861, 30895, 31133, 31142, 31236, 31301, 31386, 31602, 31918, 31941, 32074, 32330, 32675, 32986, 33414, 34106, 34716, 35290, 35480, 35622, 35696, 35730, 35753, 35955, 36167, 36428, 36501, 36719, 36777, 36980, 37323, 37642, 38102, 38110, 38412, 38751, 39130, 39164, 39666, 39697, 39808, 39877, 40222, 40241, 40464, 41100, 41507, 42190, 42240, 42650, 42771, 42892, 43324, 43726, 43786, 43949, 44184, 44204, 44644, 44703, 44728, 44955, 45226, 45235, 45262, 45344, 46324, 46413, 46725, 46840, 47058, 47201, 47351, 47457, 47686, 47826, 47927, 48867, 49104, 49672, 49699, 49710, 50013, 50476, 50576, 50908, 51114, 51296, 51793, 52014, 52406, 52520, 52567, 52595, 52908, 53003, 53245, 53267, 53474, 53600, 53878, 53902, 53924, 54246, 54784, 55156, 55184, 55608, 55804, 55936, 56391, 56593, 56683, 56685, 56701, 56713, 56783, 56990, 57621, 57921, 58122, 58398, 58463, 58733, 58830, 58977, 58997, 59447, 59547, 59705, 60574, 60671, 60743, 61016, 61101, 61358, 61399, 61608, 61636, 61679, 61768, 62068, 62381, 62589, 62687, 63305, 63333, 63629, 63790, 64410, 64526, 64542, 64570, 64581, 64634, 65036, 65165, 65439, 65803, 66160, 66884, 67439, 67793, 67828, 67914, 68034, 68089, 68560, 68627, 68877, 68894, 68943, 69269, 69284, 69675, 69800, 69959, 69979, 70798, 70973, 71087, 71103, 71402, 71644, 71759, 72046, 72450, 72486, 72521, 72648, 73172, 73486, 73582, 73630, 73650, 74270, 74397, 74515, 74685, 74689, 74899, 75080, 75171, 75357, 75524, 75749, 75796, 76142, 76678, 76693, 76741, 77454, 77931, 78527, 78811, 79055, 79654, 79785, 79993, 80897, 80990, 81303, 81614, 81688, 81822, 82170, 82304, 82673, 82679, 83123, 83246, 83368, 83885, 85076, 85150, 85389, 85427, 85608, 85957, 86914, 87099, 87179, 87326, 87377, 87417, 87558, 87996, 88362, 88422, 88920, 88965, 89012, 89137, 89627, 89647, 89901, 89917, 90992, 91116, 91213, 91309, 91546, 91575, 92398, 92467, 93072, 93783, 94180, 94255, 94296, 94470, 94618, 95391, 95816, 96216, 96381, 97436, 97450, 97475, 97613, 97644, 97683, 97692, 97779, 97884, 98320, 98834, 99094, 99140, 99157, 99799, 99827 AND isnotnull(substr(ca_zip#223, 1, 5)))
                        :     +- Relation [ca_address_sk#214,ca_address_id#215,ca_street_number#216,ca_street_name#217,ca_street_type#218,ca_suite_number#219,ca_city#220,ca_county#221,ca_state#222,ca_zip#223,ca_country#224,ca_gmt_offset#225,ca_location_type#226] parquet
                        +- Project [ca_zip#3132]
                           +- Filter (cnt#3133L > 10)
                              +- Aggregate [ca_zip#3143], [substr(ca_zip#3143, 1, 5) AS ca_zip#3132, count(1) AS cnt#3133L]
                                 +- Project [ca_zip#3143]
                                    +- Join Inner, (ca_address_sk#3134 = c_current_addr_sk#566)
                                       :- Project [ca_address_sk#3134, ca_zip#3143]
                                       :  +- Filter isnotnull(ca_address_sk#3134)
                                       :     +- Relation [ca_address_sk#3134,ca_address_id#3135,ca_street_number#3136,ca_street_name#3137,ca_street_type#3138,ca_suite_number#3139,ca_city#3140,ca_county#3141,ca_state#3142,ca_zip#3143,ca_country#3144,ca_gmt_offset#3145,ca_location_type#3146] parquet
                                       +- Project [c_current_addr_sk#566]
                                          +- Filter ((isnotnull(c_preferred_cust_flag#572) AND (c_preferred_cust_flag#572 = Y)) AND isnotnull(c_current_addr_sk#566))
                                             +- Relation [c_customer_sk#562,c_customer_id#563,c_current_cdemo_sk#564,c_current_hdemo_sk#565,c_current_addr_sk#566,c_first_shipto_date_sk#567,c_first_sales_date_sk#568,c_salutation#569,c_first_name#570,c_last_name#571,c_preferred_cust_flag#572,c_birth_day#573,c_birth_month#574,c_birth_year#575,c_birth_country#576,c_login#577,c_email_address#578,c_last_review_date_sk#579] parquet
