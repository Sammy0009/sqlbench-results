AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   GpuColumnarToRow false
   +- GpuTopN(limit=100, orderBy=[i_brand_id#7301 ASC NULLS FIRST,i_class_id#7303 ASC NULLS FIRST,i_category_id#7305 ASC NULLS FIRST], output=[ty_channel#6951,ty_brand#6952,ty_class#6953,ty_category#6954,ty_sales#6955,ty_number_sales#6956L,ly_channel#6957,ly_brand#6958,ly_class#6959,ly_category#6960,ly_sales#6961,ly_number_sales#6962L])
      +- GpuShuffleCoalesce 2147483647
         +- GpuColumnarExchange gpusinglepartitioning$(), ENSURE_REQUIREMENTS, [id=#145545]
            +- GpuTopN(limit=100, orderBy=[i_brand_id#7301 ASC NULLS FIRST,i_class_id#7303 ASC NULLS FIRST,i_category_id#7305 ASC NULLS FIRST], output=[ty_brand#6952,ty_class#6953,ty_category#6954,ty_sales#6955,ty_number_sales#6956L,ly_brand#6958,ly_class#6959,ly_category#6960,ly_sales#6961,ly_number_sales#6962L,i_brand_id#7301,i_class_id#7303,i_category_id#7305])
               +- GpuProject [i_brand_id#7301 AS ty_brand#6952, i_class_id#7303 AS ty_class#6953, i_category_id#7305 AS ty_category#6954, sales#6940 AS ty_sales#6955, number_sales#6941L AS ty_number_sales#6956L, i_brand_id#7374 AS ly_brand#6958, i_class_id#7376 AS ly_class#6959, i_category_id#7378 AS ly_category#6960, sales#6946 AS ly_sales#6961, number_sales#6947L AS ly_number_sales#6962L, i_brand_id#7301, i_class_id#7303, i_category_id#7305], true
                  +- GpuShuffledHashJoin [i_brand_id#7301, i_class_id#7303, i_category_id#7305], [i_brand_id#7374, i_class_id#7376, i_category_id#7378], Inner, GpuBuildRight, false
                     :- GpuRowToColumnar targetsize(2147483647)
                     :  +- *(3) Filter (isnotnull(sales#6940) AND (cast(sales#6940 as decimal(32,6)) > cast(Subquery subquery#6944, [id=#120432] as decimal(32,6))))
                     :     :  +- Subquery subquery#6944, [id=#120432]
                     :     :     +- AdaptiveSparkPlan isFinalPlan=true
                                 +- == Final Plan ==
                                    *(2) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#6973])
                                    +- ShuffleQueryStage 9
                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#146437]
                                          +- *(1) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#7516, count#7517L])
                                             +- GpuColumnarToRow false
                                                +- GpuUnion
                                                   :- GpuProject [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968], true
                                                   :  +- GpuShuffledHashJoin [ss_sold_date_sk#7096], [d_date_sk#7119], Inner, GpuBuildRight, false
                                                   :     :- GpuShuffleCoalesce 2147483647
                                                   :     :  +- GpuCustomShuffleReader coalesced
                                                   :     :     +- ShuffleQueryStage 0
                                                   :     :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#7096, 200), ENSURE_REQUIREMENTS, [id=#145603]
                                                   :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                                   :     :              +- GpuFilter gpuisnotnull(ss_sold_date_sk#7096), true
                                                   :     :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#7096,ss_quantity#7106,ss_list_price#7108] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7096)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                   :     +- GpuCustomShuffleReader coalesced
                                                   :        +- ShuffleQueryStage 2
                                                   :           +- ReusedExchange [d_date_sk#7119], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                                                   :- GpuProject [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970], true
                                                   :  +- GpuShuffledHashJoin [cs_sold_date_sk#7147], [d_date_sk#7181], Inner, GpuBuildRight, false
                                                   :     :- GpuShuffleCoalesce 2147483647
                                                   :     :  +- GpuCustomShuffleReader coalesced
                                                   :     :     +- ShuffleQueryStage 3
                                                   :     :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#7147, 200), ENSURE_REQUIREMENTS, [id=#145674]
                                                   :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                                   :     :              +- GpuFilter gpuisnotnull(cs_sold_date_sk#7147), true
                                                   :     :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#7147,cs_quantity#7165,cs_list_price#7167] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#7147)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                   :     +- GpuCustomShuffleReader coalesced
                                                   :        +- ShuffleQueryStage 5
                                                   :           +- ReusedExchange [d_date_sk#7181], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                                                   +- GpuProject [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972], true
                                                      +- GpuShuffledHashJoin [ws_sold_date_sk#7209], [d_date_sk#7243], Inner, GpuBuildRight, false
                                                         :- GpuShuffleCoalesce 2147483647
                                                         :  +- GpuCustomShuffleReader coalesced
                                                         :     +- ShuffleQueryStage 6
                                                         :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#7209, 200), ENSURE_REQUIREMENTS, [id=#145745]
                                                         :           +- GpuCoalesceBatches targetsize(2147483647)
                                                         :              +- GpuFilter gpuisnotnull(ws_sold_date_sk#7209), true
                                                         :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#7209,ws_quantity#7227,ws_list_price#7229] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#7209)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                         +- GpuCustomShuffleReader coalesced
                                                            +- ShuffleQueryStage 8
                                                               +- ReusedExchange [d_date_sk#7243], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                                 +- == Initial Plan ==
                                    HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#6973])
                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#120325]
                                       +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#7516, count#7517L])
                                          +- Union
                                             :- Project [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968]
                                             :  +- SortMergeJoin [ss_sold_date_sk#7096], [d_date_sk#7119], Inner
                                             :     :- Sort [ss_sold_date_sk#7096 ASC NULLS FIRST], false, 0
                                             :     :  +- Exchange hashpartitioning(ss_sold_date_sk#7096, 200), ENSURE_REQUIREMENTS, [id=#120302]
                                             :     :     +- Filter isnotnull(ss_sold_date_sk#7096)
                                             :     :        +- FileScan parquet [ss_sold_date_sk#7096,ss_quantity#7106,ss_list_price#7108] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7096)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                             :     +- Sort [d_date_sk#7119 ASC NULLS FIRST], false, 0
                                             :        +- Exchange hashpartitioning(d_date_sk#7119, 200), ENSURE_REQUIREMENTS, [id=#120303]
                                             :           +- Project [d_date_sk#7119]
                                             :              +- Filter (((isnotnull(d_year#7125) AND (d_year#7125 >= 1999)) AND (d_year#7125 <= 2001)) AND isnotnull(d_date_sk#7119))
                                             :                 +- FileScan parquet [d_date_sk#7119,d_year#7125] Batched: true, DataFilters: [isnotnull(d_year#7125), (d_year#7125 >= 1999), (d_year#7125 <= 2001), isnotnull(d_date_sk#7119)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                             :- Project [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970]
                                             :  +- SortMergeJoin [cs_sold_date_sk#7147], [d_date_sk#7181], Inner
                                             :     :- Sort [cs_sold_date_sk#7147 ASC NULLS FIRST], false, 0
                                             :     :  +- Exchange hashpartitioning(cs_sold_date_sk#7147, 200), ENSURE_REQUIREMENTS, [id=#120309]
                                             :     :     +- Filter isnotnull(cs_sold_date_sk#7147)
                                             :     :        +- FileScan parquet [cs_sold_date_sk#7147,cs_quantity#7165,cs_list_price#7167] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#7147)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                             :     +- Sort [d_date_sk#7181 ASC NULLS FIRST], false, 0
                                             :        +- Exchange hashpartitioning(d_date_sk#7181, 200), ENSURE_REQUIREMENTS, [id=#120310]
                                             :           +- Project [d_date_sk#7181]
                                             :              +- Filter (((isnotnull(d_year#7187) AND (d_year#7187 >= 1999)) AND (d_year#7187 <= 2001)) AND isnotnull(d_date_sk#7181))
                                             :                 +- FileScan parquet [d_date_sk#7181,d_year#7187] Batched: true, DataFilters: [isnotnull(d_year#7187), (d_year#7187 >= 1999), (d_year#7187 <= 2001), isnotnull(d_date_sk#7181)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                             +- Project [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972]
                                                +- SortMergeJoin [ws_sold_date_sk#7209], [d_date_sk#7243], Inner
                                                   :- Sort [ws_sold_date_sk#7209 ASC NULLS FIRST], false, 0
                                                   :  +- Exchange hashpartitioning(ws_sold_date_sk#7209, 200), ENSURE_REQUIREMENTS, [id=#120316]
                                                   :     +- Filter isnotnull(ws_sold_date_sk#7209)
                                                   :        +- FileScan parquet [ws_sold_date_sk#7209,ws_quantity#7227,ws_list_price#7229] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#7209)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                   +- Sort [d_date_sk#7243 ASC NULLS FIRST], false, 0
                                                      +- Exchange hashpartitioning(d_date_sk#7243, 200), ENSURE_REQUIREMENTS, [id=#120317]
                                                         +- Project [d_date_sk#7243]
                                                            +- Filter (((isnotnull(d_year#7249) AND (d_year#7249 >= 1999)) AND (d_year#7249 <= 2001)) AND isnotnull(d_date_sk#7243))
                                                               +- FileScan parquet [d_date_sk#7243,d_year#7249] Batched: true, DataFilters: [isnotnull(d_year#7249), (d_year#7249 >= 1999), (d_year#7249 <= 2001), isnotnull(d_date_sk#7243)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                     :     +- *(3) HashAggregate(keys=[i_brand_id#7301, i_class_id#7303, i_category_id#7305], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7281 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7283 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#7301, i_class_id#7303, i_category_id#7305, sales#6940, number_sales#6941L])
                     :        +- AQEShuffleRead coalesced
                     :           +- ShuffleQueryStage 156
                     :              +- Exchange hashpartitioning(i_brand_id#7301, i_class_id#7303, i_category_id#7305, 200), ENSURE_REQUIREMENTS, [id=#144971]
                     :                 +- *(1) HashAggregate(keys=[i_brand_id#7301, i_class_id#7303, i_category_id#7305], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7281 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7283 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#7301, i_class_id#7303, i_category_id#7305, sum#7505, isEmpty#7506, count#7507L])
                     :                    +- GpuColumnarToRow false
                     :                       +- GpuProject [ss_quantity#7281, ss_list_price#7283, i_brand_id#7301, i_class_id#7303, i_category_id#7305], true
                     :                          +- GpuShuffledHashJoin [ss_item_sk#7273], [i_item_sk#7294], Inner, GpuBuildRight, false
                     :                             :- GpuShuffleCoalesce 2147483647
                     :                             :  +- GpuCustomShuffleReader coalesced
                     :                             :     +- ShuffleQueryStage 154
                     :                             :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#7273, 200), ENSURE_REQUIREMENTS, [id=#144592]
                     :                             :           +- GpuProject [ss_item_sk#7273, ss_quantity#7281, ss_list_price#7283], true
                     :                             :              +- GpuShuffledHashJoin [ss_sold_date_sk#7271], [d_date_sk#7316], Inner, GpuBuildRight, false
                     :                             :                 :- GpuShuffleCoalesce 2147483647
                     :                             :                 :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :     +- ShuffleQueryStage 151
                     :                             :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#7271, 200), ENSURE_REQUIREMENTS, [id=#144172]
                     :                             :                 :           +- GpuShuffledHashJoin [ss_item_sk#7273], [ss_item_sk#6966], LeftSemi, GpuBuildRight, false
                     :                             :                 :              :- GpuShuffleCoalesce 2147483647
                     :                             :                 :              :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :              :     +- ShuffleQueryStage 0
                     :                             :                 :              :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#7273, 200), ENSURE_REQUIREMENTS, [id=#125708]
                     :                             :                 :              :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :              :              +- GpuFilter (gpuisnotnull(ss_sold_date_sk#7271) AND gpuisnotnull(ss_item_sk#7273)), true
                     :                             :                 :              :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#7271,ss_item_sk#7273,ss_quantity#7281,ss_list_price#7283] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7271), isnotnull(ss_item_sk#7273)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                     :                             :                 :              +- GpuCustomShuffleReader coalesced
                     :                             :                 :                 +- ShuffleQueryStage 144
                     :                             :                 :                    +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#143512]
                     :                             :                 :                       +- GpuProject [i_item_sk#668 AS ss_item_sk#6966], true
                     :                             :                 :                          +- GpuShuffledHashJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#6963, class_id#6964, category_id#6965], Inner, GpuBuildRight, false
                     :                             :                 :                             :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                             :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                             :     +- ShuffleQueryStage 1
                     :                             :                 :                             :        +- GpuColumnarExchange gpuhashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#125736]
                     :                             :                 :                             :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                             :              +- GpuFilter ((gpuisnotnull(i_brand_id#675) AND gpuisnotnull(i_class_id#677)) AND gpuisnotnull(i_category_id#679)), true
                     :                             :                 :                             :                 +- GpuFileGpuScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                     :                             :                 :                             +- GpuCoalesceBatches RequireSingleBatchWithFilter
                     :                             :                 :                                +- GpuHashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                     :                             :                 :                                   +- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                      +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                         +- ShuffleQueryStage 137
                     :                             :                 :                                            +- GpuColumnarExchange gpuhashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#142677]
                     :                             :                 :                                               +- GpuHashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                     :                             :                 :                                                  +- GpuShuffledHashJoin [gpucoalesce(brand_id#6963, 0), gpuisnull(brand_id#6963), gpucoalesce(class_id#6964, 0), gpuisnull(class_id#6964), gpucoalesce(category_id#6965, 0), gpuisnull(category_id#6965)], [gpucoalesce(i_brand_id#7053, 0), gpuisnull(i_brand_id#7053), gpucoalesce(i_class_id#7055, 0), gpuisnull(i_class_id#7055), gpucoalesce(i_category_id#7057, 0), gpuisnull(i_category_id#7057)], LeftSemi, GpuBuildRight, false
                     :                             :                 :                                                     :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :     +- ShuffleQueryStage 130
                     :                             :                 :                                                     :        +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(brand_id#6963, 0), gpuisnull(brand_id#6963), gpucoalesce(class_id#6964, 0), gpuisnull(class_id#6964), gpucoalesce(category_id#6965, 0), gpuisnull(category_id#6965), 200), ENSURE_REQUIREMENTS, [id=#141761]
                     :                             :                 :                                                     :           +- GpuHashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                     :                             :                 :                                                     :              +- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :                 +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                    +- ShuffleQueryStage 123
                     :                             :                 :                                                     :                       +- GpuColumnarExchange gpuhashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#140778]
                     :                             :                 :                                                     :                          +- GpuHashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                     :                             :                 :                                                     :                             +- GpuProject [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965], true
                     :                             :                 :                                                     :                                +- GpuShuffledHashJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner, GpuBuildRight, false
                     :                             :                 :                                                     :                                   :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :                                   :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :     +- ShuffleQueryStage 116
                     :                             :                 :                                                     :                                   :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#138756]
                     :                             :                 :                                                     :                                   :           +- GpuProject [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985], true
                     :                             :                 :                                                     :                                   :              +- GpuShuffledHashJoin [ss_item_sk#254], [i_item_sk#6974], Inner, GpuBuildRight, false
                     :                             :                 :                                                     :                                   :                 :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :                                   :                 :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                 :     +- ShuffleQueryStage 2
                     :                             :                 :                                                     :                                   :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#125764]
                     :                             :                 :                                                     :                                   :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                                                     :                                   :                 :              +- GpuFilter (gpuisnotnull(ss_item_sk#254) AND gpuisnotnull(ss_sold_date_sk#252)), true
                     :                             :                 :                                                     :                                   :                 :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                     :                             :                 :                                                     :                                   :                 +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                    +- ShuffleQueryStage 109
                     :                             :                 :                                                     :                                   :                       +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#6974, 200), ENSURE_REQUIREMENTS, [id=#136418]
                     :                             :                 :                                                     :                                   :                          +- GpuShuffledHashJoin [gpucoalesce(i_brand_id#6981, 0), gpuisnull(i_brand_id#6981), gpucoalesce(i_class_id#6983, 0), gpuisnull(i_class_id#6983), gpucoalesce(i_category_id#6985, 0), gpuisnull(i_category_id#6985)], [gpucoalesce(i_brand_id#7003, 0), gpuisnull(i_brand_id#7003), gpucoalesce(i_class_id#7005, 0), gpuisnull(i_class_id#7005), gpucoalesce(i_category_id#7007, 0), gpuisnull(i_category_id#7007)], LeftSemi, GpuBuildRight, false
                     :                             :                 :                                                     :                                   :                             :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :                                   :                             :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                             :     +- ShuffleQueryStage 3
                     :                             :                 :                                                     :                                   :                             :        +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(i_brand_id#6981, 0), gpuisnull(i_brand_id#6981), gpucoalesce(i_class_id#6983, 0), gpuisnull(i_class_id#6983), gpucoalesce(i_category_id#6985, 0), gpuisnull(i_category_id#6985), 200), ENSURE_REQUIREMENTS, [id=#125792]
                     :                             :                 :                                                     :                                   :                             :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                                                     :                                   :                             :              +- GpuFilter (((gpuisnotnull(i_item_sk#6974) AND gpuisnotnull(i_brand_id#6981)) AND gpuisnotnull(i_class_id#6983)) AND gpuisnotnull(i_category_id#6985)), true
                     :                             :                 :                                                     :                                   :                             :                 +- GpuFileGpuScan parquet [i_item_sk#6974,i_brand_id#6981,i_class_id#6983,i_category_id#6985] Batched: true, DataFilters: [isnotnull(i_item_sk#6974), isnotnull(i_brand_id#6981), isnotnull(i_class_id#6983), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                     :                             :                 :                                                     :                                   :                             +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                                +- ShuffleQueryStage 95
                     :                             :                 :                                                     :                                   :                                   +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(i_brand_id#7003, 0), gpuisnull(i_brand_id#7003), gpucoalesce(i_class_id#7005, 0), gpuisnull(i_class_id#7005), gpucoalesce(i_category_id#7007, 0), gpuisnull(i_category_id#7007), 200), ENSURE_REQUIREMENTS, [id=#133315]
                     :                             :                 :                                                     :                                   :                                      +- GpuProject [i_brand_id#7003, i_class_id#7005, i_category_id#7007], true
                     :                             :                 :                                                     :                                   :                                         +- GpuShuffledHashJoin [cs_item_sk#559], [i_item_sk#6996], Inner, GpuBuildRight, false
                     :                             :                 :                                                     :                                   :                                            :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :                                   :                                            :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                                            :     +- ShuffleQueryStage 81
                     :                             :                 :                                                     :                                   :                                            :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#129503]
                     :                             :                 :                                                     :                                   :                                            :           +- GpuProject [cs_item_sk#559], true
                     :                             :                 :                                                     :                                   :                                            :              +- GpuShuffledHashJoin [cs_sold_date_sk#544], [d_date_sk#7018], Inner, GpuBuildRight, false
                     :                             :                 :                                                     :                                   :                                            :                 :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                     :                                   :                                            :                 :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                                            :                 :     +- ShuffleQueryStage 4
                     :                             :                 :                                                     :                                   :                                            :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#125820]
                     :                             :                 :                                                     :                                   :                                            :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                                                     :                                   :                                            :                 :              +- GpuFilter (gpuisnotnull(cs_sold_date_sk#544) AND gpuisnotnull(cs_item_sk#559)), true
                     :                             :                 :                                                     :                                   :                                            :                 :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                     :                             :                 :                                                     :                                   :                                            :                 +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                                            :                    +- ShuffleQueryStage 5
                     :                             :                 :                                                     :                                   :                                            :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                     :                             :                 :                                                     :                                   :                                            :                          +- GpuProject [d_date_sk#7018], true
                     :                             :                 :                                                     :                                   :                                            :                             +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                                                     :                                   :                                            :                                +- GpuFilter (((gpuisnotnull(d_year#7024) AND (d_year#7024 >= 1999)) AND (d_year#7024 <= 2001)) AND gpuisnotnull(d_date_sk#7018)), true
                     :                             :                 :                                                     :                                   :                                            :                                   +- GpuFileGpuScan parquet [d_date_sk#7018,d_year#7024] Batched: true, DataFilters: [isnotnull(d_year#7024), (d_year#7024 >= 1999), (d_year#7024 <= 2001), isnotnull(d_date_sk#7018)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                             :                 :                                                     :                                   :                                            +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                   :                                               +- ShuffleQueryStage 6
                     :                             :                 :                                                     :                                   :                                                  +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#6996, 200), ENSURE_REQUIREMENTS, [id=#125891]
                     :                             :                 :                                                     :                                   :                                                     +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                                                     :                                   :                                                        +- GpuFilter gpuisnotnull(i_item_sk#6996), true
                     :                             :                 :                                                     :                                   :                                                           +- GpuFileGpuScan parquet [i_item_sk#6996,i_brand_id#7003,i_class_id#7005,i_category_id#7007] Batched: true, DataFilters: [isnotnull(i_item_sk#6996)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                     :                             :                 :                                                     :                                   +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                     :                                      +- ShuffleQueryStage 8
                     :                             :                 :                                                     :                                         +- ReusedExchange [d_date_sk#612], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                     :                             :                 :                                                     +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                        +- ShuffleQueryStage 102
                     :                             :                 :                                                           +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(i_brand_id#7053, 0), gpuisnull(i_brand_id#7053), gpucoalesce(i_class_id#7055, 0), gpuisnull(i_class_id#7055), gpucoalesce(i_category_id#7057, 0), gpuisnull(i_category_id#7057), 200), ENSURE_REQUIREMENTS, [id=#134964]
                     :                             :                 :                                                              +- GpuProject [i_brand_id#7053, i_class_id#7055, i_category_id#7057], true
                     :                             :                 :                                                                 +- GpuShuffledHashJoin [ws_item_sk#479], [i_item_sk#7046], Inner, GpuBuildRight, false
                     :                             :                 :                                                                    :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                                    :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                                    :     +- ShuffleQueryStage 88
                     :                             :                 :                                                                    :        +- GpuColumnarExchange gpuhashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#131570]
                     :                             :                 :                                                                    :           +- GpuProject [ws_item_sk#479], true
                     :                             :                 :                                                                    :              +- GpuShuffledHashJoin [ws_sold_date_sk#476], [d_date_sk#7068], Inner, GpuBuildRight, false
                     :                             :                 :                                                                    :                 :- GpuShuffleCoalesce 2147483647
                     :                             :                 :                                                                    :                 :  +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                                    :                 :     +- ShuffleQueryStage 9
                     :                             :                 :                                                                    :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#125978]
                     :                             :                 :                                                                    :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                 :                                                                    :                 :              +- GpuFilter (gpuisnotnull(ws_sold_date_sk#476) AND gpuisnotnull(ws_item_sk#479)), true
                     :                             :                 :                                                                    :                 :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                     :                             :                 :                                                                    :                 +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                                    :                    +- ShuffleQueryStage 11
                     :                             :                 :                                                                    :                       +- ReusedExchange [d_date_sk#7068], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                     :                             :                 :                                                                    +- GpuCustomShuffleReader coalesced
                     :                             :                 :                                                                       +- ShuffleQueryStage 13
                     :                             :                 :                                                                          +- ReusedExchange [i_item_sk#7046, i_brand_id#7053, i_class_id#7055, i_category_id#7057], GpuColumnarExchange gpuhashpartitioning(i_item_sk#6996, 200), ENSURE_REQUIREMENTS, [id=#125891]
                     :                             :                 +- GpuCustomShuffleReader coalesced
                     :                             :                    +- ShuffleQueryStage 14
                     :                             :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#7316, 200), ENSURE_REQUIREMENTS, [id=#126106]
                     :                             :                          +- GpuProject [d_date_sk#7316], true
                     :                             :                             +- GpuCoalesceBatches targetsize(2147483647)
                     :                             :                                +- GpuFilter ((gpuisnotnull(d_week_seq#7320) AND (d_week_seq#7320 = Subquery subquery#6943, [id=#120447])) AND gpuisnotnull(d_date_sk#7316)), true
                     :                             :                                   :  +- Subquery subquery#6943, [id=#120447]
                     :                             :                                   :     +- AdaptiveSparkPlan isFinalPlan=true
                                                                                             +- == Final Plan ==
                                                                                                GpuColumnarToRow false
                                                                                                +- GpuProject [d_week_seq#7423], true
                                                                                                   +- GpuCoalesceBatches targetsize(2147483647)
                                                                                                      +- GpuFilter (((((gpuisnotnull(d_year#7425) AND gpuisnotnull(d_moy#7427)) AND gpuisnotnull(d_dom#7428)) AND (d_year#7425 = 2000)) AND (d_moy#7427 = 12)) AND (d_dom#7428 = 12)), true
                                                                                                         +- GpuFileGpuScan parquet [d_week_seq#7423,d_year#7425,d_moy#7427,d_dom#7428] Batched: true, DataFilters: [isnotnull(d_year#7425), isnotnull(d_moy#7427), isnotnull(d_dom#7428), (d_year#7425 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                                                             +- == Initial Plan ==
                                                                                                Project [d_week_seq#7423]
                                                                                                +- Filter (((((isnotnull(d_year#7425) AND isnotnull(d_moy#7427)) AND isnotnull(d_dom#7428)) AND (d_year#7425 = 2000)) AND (d_moy#7427 = 12)) AND (d_dom#7428 = 12))
                                                                                                   +- FileScan parquet [d_week_seq#7423,d_year#7425,d_moy#7427,d_dom#7428] Batched: true, DataFilters: [isnotnull(d_year#7425), isnotnull(d_moy#7427), isnotnull(d_dom#7428), (d_year#7425 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                     :                             :                                   +- GpuFileGpuScan parquet [d_date_sk#7316,d_week_seq#7320] Batched: true, DataFilters: [isnotnull(d_week_seq#7320), isnotnull(d_date_sk#7316)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
                     :                             +- GpuCoalesceBatches RequireSingleBatchWithFilter
                     :                                +- GpuShuffledHashJoin [i_item_sk#7294], [ss_item_sk#6966], LeftSemi, GpuBuildRight, false
                     :                                   :- GpuShuffleCoalesce 2147483647
                     :                                   :  +- GpuCustomShuffleReader coalesced
                     :                                   :     +- ShuffleQueryStage 15
                     :                                   :        +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#7294, 200), ENSURE_REQUIREMENTS, [id=#126140]
                     :                                   :           +- GpuCoalesceBatches targetsize(2147483647)
                     :                                   :              +- GpuFilter (((gpuisnotnull(i_item_sk#7294) AND gpuisnotnull(i_brand_id#7301)) AND gpuisnotnull(i_class_id#7303)) AND gpuisnotnull(i_category_id#7305)), true
                     :                                   :                 +- GpuFileGpuScan parquet [i_item_sk#7294,i_brand_id#7301,i_class_id#7303,i_category_id#7305] Batched: true, DataFilters: [isnotnull(i_item_sk#7294), isnotnull(i_brand_id#7301), isnotnull(i_class_id#7303), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                     :                                   +- GpuCustomShuffleReader coalesced
                     :                                      +- ShuffleQueryStage 146
                     :                                         +- ReusedExchange [ss_item_sk#6966], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#143512]
                     +- GpuCoalesceBatches RequireSingleBatchWithFilter
                        +- GpuRowToColumnar targetsize(2147483647)
                           +- *(4) Filter (isnotnull(sales#6946) AND (cast(sales#6946 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#6944, [id=#120432] as decimal(32,6))))
                              :  +- ReusedSubquery Subquery subquery#6944, [id=#120432]
                              +- *(4) HashAggregate(keys=[i_brand_id#7374, i_class_id#7376, i_category_id#7378], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7354 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7356 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#7374, i_class_id#7376, i_category_id#7378, sales#6946, number_sales#6947L])
                                 +- AQEShuffleRead coalesced
                                    +- ShuffleQueryStage 157
                                       +- Exchange hashpartitioning(i_brand_id#7374, i_class_id#7376, i_category_id#7378, 200), ENSURE_REQUIREMENTS, [id=#145208]
                                          +- *(2) HashAggregate(keys=[i_brand_id#7374, i_class_id#7376, i_category_id#7378], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7354 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7356 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#7374, i_class_id#7376, i_category_id#7378, sum#7511, isEmpty#7512, count#7513L])
                                             +- GpuColumnarToRow false
                                                +- GpuProject [ss_quantity#7354, ss_list_price#7356, i_brand_id#7374, i_class_id#7376, i_category_id#7378], true
                                                   +- GpuShuffledHashJoin [ss_item_sk#7346], [i_item_sk#7367], Inner, GpuBuildRight, false
                                                      :- GpuShuffleCoalesce 2147483647
                                                      :  +- GpuCustomShuffleReader coalesced
                                                      :     +- ShuffleQueryStage 155
                                                      :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#7346, 200), ENSURE_REQUIREMENTS, [id=#144680]
                                                      :           +- GpuProject [ss_item_sk#7346, ss_quantity#7354, ss_list_price#7356], true
                                                      :              +- GpuShuffledHashJoin [ss_sold_date_sk#7344], [d_date_sk#7389], Inner, GpuBuildRight, false
                                                      :                 :- GpuShuffleCoalesce 2147483647
                                                      :                 :  +- GpuCustomShuffleReader coalesced
                                                      :                 :     +- ShuffleQueryStage 153
                                                      :                 :        +- ReusedExchange [ss_sold_date_sk#7344, ss_item_sk#7346, ss_quantity#7354, ss_list_price#7356], GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#7271, 200), ENSURE_REQUIREMENTS, [id=#144172]
                                                      :                 +- GpuCustomShuffleReader coalesced
                                                      :                    +- ShuffleQueryStage 58
                                                      :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#7389, 200), ENSURE_REQUIREMENTS, [id=#127323]
                                                      :                          +- GpuProject [d_date_sk#7389], true
                                                      :                             +- GpuCoalesceBatches targetsize(2147483647)
                                                      :                                +- GpuFilter ((gpuisnotnull(d_week_seq#7393) AND (d_week_seq#7393 = Subquery subquery#6949, [id=#120659])) AND gpuisnotnull(d_date_sk#7389)), true
                                                      :                                   :  +- Subquery subquery#6949, [id=#120659]
                                                      :                                   :     +- AdaptiveSparkPlan isFinalPlan=true
                                                                                                +- == Final Plan ==
                                                                                                   GpuColumnarToRow false
                                                                                                   +- GpuProject [d_week_seq#7451], true
                                                                                                      +- GpuCoalesceBatches targetsize(2147483647)
                                                                                                         +- GpuFilter (((((gpuisnotnull(d_year#7453) AND gpuisnotnull(d_moy#7455)) AND gpuisnotnull(d_dom#7456)) AND (d_year#7453 = 1999)) AND (d_moy#7455 = 12)) AND (d_dom#7456 = 12)), true
                                                                                                            +- GpuFileGpuScan parquet [d_week_seq#7451,d_year#7453,d_moy#7455,d_dom#7456] Batched: true, DataFilters: [isnotnull(d_year#7453), isnotnull(d_moy#7455), isnotnull(d_dom#7456), (d_year#7453 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                                                                +- == Initial Plan ==
                                                                                                   Project [d_week_seq#7451]
                                                                                                   +- Filter (((((isnotnull(d_year#7453) AND isnotnull(d_moy#7455)) AND isnotnull(d_dom#7456)) AND (d_year#7453 = 1999)) AND (d_moy#7455 = 12)) AND (d_dom#7456 = 12))
                                                                                                      +- FileScan parquet [d_week_seq#7451,d_year#7453,d_moy#7455,d_dom#7456] Batched: true, DataFilters: [isnotnull(d_year#7453), isnotnull(d_moy#7455), isnotnull(d_dom#7456), (d_year#7453 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                      :                                   +- GpuFileGpuScan parquet [d_date_sk#7389,d_week_seq#7393] Batched: true, DataFilters: [isnotnull(d_week_seq#7393), isnotnull(d_date_sk#7389)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
                                                      +- GpuCoalesceBatches RequireSingleBatchWithFilter
                                                         +- GpuShuffledHashJoin [i_item_sk#7367], [ss_item_sk#6966], LeftSemi, GpuBuildRight, false
                                                            :- GpuShuffleCoalesce 2147483647
                                                            :  +- GpuCustomShuffleReader coalesced
                                                            :     +- ShuffleQueryStage 60
                                                            :        +- ReusedExchange [i_item_sk#7367, i_brand_id#7374, i_class_id#7376, i_category_id#7378], GpuColumnarExchange gpuhashpartitioning(i_item_sk#7294, 200), ENSURE_REQUIREMENTS, [id=#126140]
                                                            +- GpuCustomShuffleReader coalesced
                                                               +- ShuffleQueryStage 150
                                                                  +- ReusedExchange [ss_item_sk#6966], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#143512]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_brand_id#7301 ASC NULLS FIRST,i_class_id#7303 ASC NULLS FIRST,i_category_id#7305 ASC NULLS FIRST], output=[ty_channel#6951,ty_brand#6952,ty_class#6953,ty_category#6954,ty_sales#6955,ty_number_sales#6956L,ly_channel#6957,ly_brand#6958,ly_class#6959,ly_category#6960,ly_sales#6961,ly_number_sales#6962L])
   +- Project [i_brand_id#7301 AS ty_brand#6952, i_class_id#7303 AS ty_class#6953, i_category_id#7305 AS ty_category#6954, sales#6940 AS ty_sales#6955, number_sales#6941L AS ty_number_sales#6956L, i_brand_id#7374 AS ly_brand#6958, i_class_id#7376 AS ly_class#6959, i_category_id#7378 AS ly_category#6960, sales#6946 AS ly_sales#6961, number_sales#6947L AS ly_number_sales#6962L, i_brand_id#7301, i_class_id#7303, i_category_id#7305]
      +- SortMergeJoin [i_brand_id#7301, i_class_id#7303, i_category_id#7305], [i_brand_id#7374, i_class_id#7376, i_category_id#7378], Inner
         :- Sort [i_brand_id#7301 ASC NULLS FIRST, i_class_id#7303 ASC NULLS FIRST, i_category_id#7305 ASC NULLS FIRST], false, 0
         :  +- Filter (isnotnull(sales#6940) AND (cast(sales#6940 as decimal(32,6)) > cast(Subquery subquery#6944, [id=#120432] as decimal(32,6))))
         :     :  +- Subquery subquery#6944, [id=#120432]
         :     :     +- AdaptiveSparkPlan isFinalPlan=true
                     +- == Final Plan ==
                        *(2) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#6973])
                        +- ShuffleQueryStage 9
                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#146437]
                              +- *(1) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#7516, count#7517L])
                                 +- GpuColumnarToRow false
                                    +- GpuUnion
                                       :- GpuProject [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968], true
                                       :  +- GpuShuffledHashJoin [ss_sold_date_sk#7096], [d_date_sk#7119], Inner, GpuBuildRight, false
                                       :     :- GpuShuffleCoalesce 2147483647
                                       :     :  +- GpuCustomShuffleReader coalesced
                                       :     :     +- ShuffleQueryStage 0
                                       :     :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#7096, 200), ENSURE_REQUIREMENTS, [id=#145603]
                                       :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :     :              +- GpuFilter gpuisnotnull(ss_sold_date_sk#7096), true
                                       :     :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#7096,ss_quantity#7106,ss_list_price#7108] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7096)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                       :     +- GpuCustomShuffleReader coalesced
                                       :        +- ShuffleQueryStage 2
                                       :           +- ReusedExchange [d_date_sk#7119], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                                       :- GpuProject [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970], true
                                       :  +- GpuShuffledHashJoin [cs_sold_date_sk#7147], [d_date_sk#7181], Inner, GpuBuildRight, false
                                       :     :- GpuShuffleCoalesce 2147483647
                                       :     :  +- GpuCustomShuffleReader coalesced
                                       :     :     +- ShuffleQueryStage 3
                                       :     :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#7147, 200), ENSURE_REQUIREMENTS, [id=#145674]
                                       :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :     :              +- GpuFilter gpuisnotnull(cs_sold_date_sk#7147), true
                                       :     :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#7147,cs_quantity#7165,cs_list_price#7167] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#7147)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                       :     +- GpuCustomShuffleReader coalesced
                                       :        +- ShuffleQueryStage 5
                                       :           +- ReusedExchange [d_date_sk#7181], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                                       +- GpuProject [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972], true
                                          +- GpuShuffledHashJoin [ws_sold_date_sk#7209], [d_date_sk#7243], Inner, GpuBuildRight, false
                                             :- GpuShuffleCoalesce 2147483647
                                             :  +- GpuCustomShuffleReader coalesced
                                             :     +- ShuffleQueryStage 6
                                             :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#7209, 200), ENSURE_REQUIREMENTS, [id=#145745]
                                             :           +- GpuCoalesceBatches targetsize(2147483647)
                                             :              +- GpuFilter gpuisnotnull(ws_sold_date_sk#7209), true
                                             :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#7209,ws_quantity#7227,ws_list_price#7229] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#7209)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                             +- GpuCustomShuffleReader coalesced
                                                +- ShuffleQueryStage 8
                                                   +- ReusedExchange [d_date_sk#7243], GpuColumnarExchange gpuhashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#125857]
                     +- == Initial Plan ==
                        HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#6973])
                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#120325]
                           +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#7516, count#7517L])
                              +- Union
                                 :- Project [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968]
                                 :  +- SortMergeJoin [ss_sold_date_sk#7096], [d_date_sk#7119], Inner
                                 :     :- Sort [ss_sold_date_sk#7096 ASC NULLS FIRST], false, 0
                                 :     :  +- Exchange hashpartitioning(ss_sold_date_sk#7096, 200), ENSURE_REQUIREMENTS, [id=#120302]
                                 :     :     +- Filter isnotnull(ss_sold_date_sk#7096)
                                 :     :        +- FileScan parquet [ss_sold_date_sk#7096,ss_quantity#7106,ss_list_price#7108] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7096)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                 :     +- Sort [d_date_sk#7119 ASC NULLS FIRST], false, 0
                                 :        +- Exchange hashpartitioning(d_date_sk#7119, 200), ENSURE_REQUIREMENTS, [id=#120303]
                                 :           +- Project [d_date_sk#7119]
                                 :              +- Filter (((isnotnull(d_year#7125) AND (d_year#7125 >= 1999)) AND (d_year#7125 <= 2001)) AND isnotnull(d_date_sk#7119))
                                 :                 +- FileScan parquet [d_date_sk#7119,d_year#7125] Batched: true, DataFilters: [isnotnull(d_year#7125), (d_year#7125 >= 1999), (d_year#7125 <= 2001), isnotnull(d_date_sk#7119)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :- Project [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970]
                                 :  +- SortMergeJoin [cs_sold_date_sk#7147], [d_date_sk#7181], Inner
                                 :     :- Sort [cs_sold_date_sk#7147 ASC NULLS FIRST], false, 0
                                 :     :  +- Exchange hashpartitioning(cs_sold_date_sk#7147, 200), ENSURE_REQUIREMENTS, [id=#120309]
                                 :     :     +- Filter isnotnull(cs_sold_date_sk#7147)
                                 :     :        +- FileScan parquet [cs_sold_date_sk#7147,cs_quantity#7165,cs_list_price#7167] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#7147)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                 :     +- Sort [d_date_sk#7181 ASC NULLS FIRST], false, 0
                                 :        +- Exchange hashpartitioning(d_date_sk#7181, 200), ENSURE_REQUIREMENTS, [id=#120310]
                                 :           +- Project [d_date_sk#7181]
                                 :              +- Filter (((isnotnull(d_year#7187) AND (d_year#7187 >= 1999)) AND (d_year#7187 <= 2001)) AND isnotnull(d_date_sk#7181))
                                 :                 +- FileScan parquet [d_date_sk#7181,d_year#7187] Batched: true, DataFilters: [isnotnull(d_year#7187), (d_year#7187 >= 1999), (d_year#7187 <= 2001), isnotnull(d_date_sk#7181)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 +- Project [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972]
                                    +- SortMergeJoin [ws_sold_date_sk#7209], [d_date_sk#7243], Inner
                                       :- Sort [ws_sold_date_sk#7209 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(ws_sold_date_sk#7209, 200), ENSURE_REQUIREMENTS, [id=#120316]
                                       :     +- Filter isnotnull(ws_sold_date_sk#7209)
                                       :        +- FileScan parquet [ws_sold_date_sk#7209,ws_quantity#7227,ws_list_price#7229] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#7209)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       +- Sort [d_date_sk#7243 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date_sk#7243, 200), ENSURE_REQUIREMENTS, [id=#120317]
                                             +- Project [d_date_sk#7243]
                                                +- Filter (((isnotnull(d_year#7249) AND (d_year#7249 >= 1999)) AND (d_year#7249 <= 2001)) AND isnotnull(d_date_sk#7243))
                                                   +- FileScan parquet [d_date_sk#7243,d_year#7249] Batched: true, DataFilters: [isnotnull(d_year#7249), (d_year#7249 >= 1999), (d_year#7249 <= 2001), isnotnull(d_date_sk#7243)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     +- HashAggregate(keys=[i_brand_id#7301, i_class_id#7303, i_category_id#7305], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7281 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7283 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#7301, i_class_id#7303, i_category_id#7305, sales#6940, number_sales#6941L])
         :        +- Exchange hashpartitioning(i_brand_id#7301, i_class_id#7303, i_category_id#7305, 200), ENSURE_REQUIREMENTS, [id=#120965]
         :           +- HashAggregate(keys=[i_brand_id#7301, i_class_id#7303, i_category_id#7305], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7281 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7283 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#7301, i_class_id#7303, i_category_id#7305, sum#7505, isEmpty#7506, count#7507L])
         :              +- Project [ss_quantity#7281, ss_list_price#7283, i_brand_id#7301, i_class_id#7303, i_category_id#7305]
         :                 +- SortMergeJoin [ss_item_sk#7273], [i_item_sk#7294], Inner
         :                    :- Sort [ss_item_sk#7273 ASC NULLS FIRST], false, 0
         :                    :  +- Exchange hashpartitioning(ss_item_sk#7273, 200), ENSURE_REQUIREMENTS, [id=#120959]
         :                    :     +- Project [ss_item_sk#7273, ss_quantity#7281, ss_list_price#7283]
         :                    :        +- SortMergeJoin [ss_sold_date_sk#7271], [d_date_sk#7316], Inner
         :                    :           :- Sort [ss_sold_date_sk#7271 ASC NULLS FIRST], false, 0
         :                    :           :  +- Exchange hashpartitioning(ss_sold_date_sk#7271, 200), ENSURE_REQUIREMENTS, [id=#120869]
         :                    :           :     +- SortMergeJoin [ss_item_sk#7273], [ss_item_sk#6966], LeftSemi
         :                    :           :        :- Sort [ss_item_sk#7273 ASC NULLS FIRST], false, 0
         :                    :           :        :  +- Exchange hashpartitioning(ss_item_sk#7273, 200), ENSURE_REQUIREMENTS, [id=#120862]
         :                    :           :        :     +- Filter (isnotnull(ss_sold_date_sk#7271) AND isnotnull(ss_item_sk#7273))
         :                    :           :        :        +- FileScan parquet [ss_sold_date_sk#7271,ss_item_sk#7273,ss_quantity#7281,ss_list_price#7283] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7271), isnotnull(ss_item_sk#7273)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
         :                    :           :        +- Sort [ss_item_sk#6966 ASC NULLS FIRST], false, 0
         :                    :           :           +- Exchange hashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#120863]
         :                    :           :              +- Project [i_item_sk#668 AS ss_item_sk#6966]
         :                    :           :                 +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#6963, class_id#6964, category_id#6965], Inner
         :                    :           :                    :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
         :                    :           :                    :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#120855]
         :                    :           :                    :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
         :                    :           :                    :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :                    +- Sort [brand_id#6963 ASC NULLS FIRST, class_id#6964 ASC NULLS FIRST, category_id#6965 ASC NULLS FIRST], false, 0
         :                    :           :                       +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                    :           :                          +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#120851]
         :                    :           :                             +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                    :           :                                +- SortMergeJoin [coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965)], [coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057)], LeftSemi
         :                    :           :                                   :- Sort [coalesce(brand_id#6963, 0) ASC NULLS FIRST, isnull(brand_id#6963) ASC NULLS FIRST, coalesce(class_id#6964, 0) ASC NULLS FIRST, isnull(class_id#6964) ASC NULLS FIRST, coalesce(category_id#6965, 0) ASC NULLS FIRST, isnull(category_id#6965) ASC NULLS FIRST], false, 0
         :                    :           :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965), 200), ENSURE_REQUIREMENTS, [id=#120844]
         :                    :           :                                   :     +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                    :           :                                   :        +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#120825]
         :                    :           :                                   :           +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                    :           :                                   :              +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
         :                    :           :                                   :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
         :                    :           :                                   :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#120817]
         :                    :           :                                   :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
         :                    :           :                                   :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#6974], Inner
         :                    :           :                                   :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#120809]
         :                    :           :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
         :                    :           :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :           :                                   :                    :           +- Sort [i_item_sk#6974 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#6974, 200), ENSURE_REQUIREMENTS, [id=#120810]
         :                    :           :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985)], [coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007)], LeftSemi
         :                    :           :                                   :                    :                    :- Sort [coalesce(i_brand_id#6981, 0) ASC NULLS FIRST, isnull(i_brand_id#6981) ASC NULLS FIRST, coalesce(i_class_id#6983, 0) ASC NULLS FIRST, isnull(i_class_id#6983) ASC NULLS FIRST, coalesce(i_category_id#6985, 0) ASC NULLS FIRST, isnull(i_category_id#6985) ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985), 200), ENSURE_REQUIREMENTS, [id=#120802]
         :                    :           :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#6974) AND isnotnull(i_brand_id#6981)) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985))
         :                    :           :                                   :                    :                    :        +- FileScan parquet [i_item_sk#6974,i_brand_id#6981,i_class_id#6983,i_category_id#6985] Batched: true, DataFilters: [isnotnull(i_item_sk#6974), isnotnull(i_brand_id#6981), isnotnull(i_class_id#6983), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :                                   :                    :                    +- Sort [coalesce(i_brand_id#7003, 0) ASC NULLS FIRST, isnull(i_brand_id#7003) ASC NULLS FIRST, coalesce(i_class_id#7005, 0) ASC NULLS FIRST, isnull(i_class_id#7005) ASC NULLS FIRST, coalesce(i_category_id#7007, 0) ASC NULLS FIRST, isnull(i_category_id#7007) ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007), 200), ENSURE_REQUIREMENTS, [id=#120803]
         :                    :           :                                   :                    :                          +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
         :                    :           :                                   :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#6996], Inner
         :                    :           :                                   :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#120794]
         :                    :           :                                   :                    :                                :     +- Project [cs_item_sk#559]
         :                    :           :                                   :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#7018], Inner
         :                    :           :                                   :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#120786]
         :                    :           :                                   :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
         :                    :           :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :           :                                   :                    :                                :           +- Sort [d_date_sk#7018 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :                                :              +- Exchange hashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#120787]
         :                    :           :                                   :                    :                                :                 +- Project [d_date_sk#7018]
         :                    :           :                                   :                    :                                :                    +- Filter (((isnotnull(d_year#7024) AND (d_year#7024 >= 1999)) AND (d_year#7024 <= 2001)) AND isnotnull(d_date_sk#7018))
         :                    :           :                                   :                    :                                :                       +- FileScan parquet [d_date_sk#7018,d_year#7024] Batched: true, DataFilters: [isnotnull(d_year#7024), (d_year#7024 >= 1999), (d_year#7024 <= 2001), isnotnull(d_date_sk#7018)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :           :                                   :                    :                                +- Sort [i_item_sk#6996 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                    :                                   +- Exchange hashpartitioning(i_item_sk#6996, 200), ENSURE_REQUIREMENTS, [id=#120795]
         :                    :           :                                   :                    :                                      +- Filter isnotnull(i_item_sk#6996)
         :                    :           :                                   :                    :                                         +- FileScan parquet [i_item_sk#6996,i_brand_id#7003,i_class_id#7005,i_category_id#7007] Batched: true, DataFilters: [isnotnull(i_item_sk#6996)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :                                   :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :                    :           :                                   :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#120818]
         :                    :           :                                   :                          +- Project [d_date_sk#612]
         :                    :           :                                   :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
         :                    :           :                                   :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :           :                                   +- Sort [coalesce(i_brand_id#7053, 0) ASC NULLS FIRST, isnull(i_brand_id#7053) ASC NULLS FIRST, coalesce(i_class_id#7055, 0) ASC NULLS FIRST, isnull(i_class_id#7055) ASC NULLS FIRST, coalesce(i_category_id#7057, 0) ASC NULLS FIRST, isnull(i_category_id#7057) ASC NULLS FIRST], false, 0
         :                    :           :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057), 200), ENSURE_REQUIREMENTS, [id=#120845]
         :                    :           :                                         +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
         :                    :           :                                            +- SortMergeJoin [ws_item_sk#479], [i_item_sk#7046], Inner
         :                    :           :                                               :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
         :                    :           :                                               :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#120836]
         :                    :           :                                               :     +- Project [ws_item_sk#479]
         :                    :           :                                               :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#7068], Inner
         :                    :           :                                               :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
         :                    :           :                                               :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#120828]
         :                    :           :                                               :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
         :                    :           :                                               :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :           :                                               :           +- Sort [d_date_sk#7068 ASC NULLS FIRST], false, 0
         :                    :           :                                               :              +- Exchange hashpartitioning(d_date_sk#7068, 200), ENSURE_REQUIREMENTS, [id=#120829]
         :                    :           :                                               :                 +- Project [d_date_sk#7068]
         :                    :           :                                               :                    +- Filter (((isnotnull(d_year#7074) AND (d_year#7074 >= 1999)) AND (d_year#7074 <= 2001)) AND isnotnull(d_date_sk#7068))
         :                    :           :                                               :                       +- FileScan parquet [d_date_sk#7068,d_year#7074] Batched: true, DataFilters: [isnotnull(d_year#7074), (d_year#7074 >= 1999), (d_year#7074 <= 2001), isnotnull(d_date_sk#7068)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :           :                                               +- Sort [i_item_sk#7046 ASC NULLS FIRST], false, 0
         :                    :           :                                                  +- Exchange hashpartitioning(i_item_sk#7046, 200), ENSURE_REQUIREMENTS, [id=#120837]
         :                    :           :                                                     +- Filter isnotnull(i_item_sk#7046)
         :                    :           :                                                        +- FileScan parquet [i_item_sk#7046,i_brand_id#7053,i_class_id#7055,i_category_id#7057] Batched: true, DataFilters: [isnotnull(i_item_sk#7046)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           +- Sort [d_date_sk#7316 ASC NULLS FIRST], false, 0
         :                    :              +- Exchange hashpartitioning(d_date_sk#7316, 200), ENSURE_REQUIREMENTS, [id=#120870]
         :                    :                 +- Project [d_date_sk#7316]
         :                    :                    +- Filter ((isnotnull(d_week_seq#7320) AND (d_week_seq#7320 = Subquery subquery#6943, [id=#120447])) AND isnotnull(d_date_sk#7316))
         :                    :                       :  +- Subquery subquery#6943, [id=#120447]
         :                    :                       :     +- AdaptiveSparkPlan isFinalPlan=true
                                                            +- == Final Plan ==
                                                               GpuColumnarToRow false
                                                               +- GpuProject [d_week_seq#7423], true
                                                                  +- GpuCoalesceBatches targetsize(2147483647)
                                                                     +- GpuFilter (((((gpuisnotnull(d_year#7425) AND gpuisnotnull(d_moy#7427)) AND gpuisnotnull(d_dom#7428)) AND (d_year#7425 = 2000)) AND (d_moy#7427 = 12)) AND (d_dom#7428 = 12)), true
                                                                        +- GpuFileGpuScan parquet [d_week_seq#7423,d_year#7425,d_moy#7427,d_dom#7428] Batched: true, DataFilters: [isnotnull(d_year#7425), isnotnull(d_moy#7427), isnotnull(d_dom#7428), (d_year#7425 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                            +- == Initial Plan ==
                                                               Project [d_week_seq#7423]
                                                               +- Filter (((((isnotnull(d_year#7425) AND isnotnull(d_moy#7427)) AND isnotnull(d_dom#7428)) AND (d_year#7425 = 2000)) AND (d_moy#7427 = 12)) AND (d_dom#7428 = 12))
                                                                  +- FileScan parquet [d_week_seq#7423,d_year#7425,d_moy#7427,d_dom#7428] Batched: true, DataFilters: [isnotnull(d_year#7425), isnotnull(d_moy#7427), isnotnull(d_dom#7428), (d_year#7425 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
         :                    :                       +- FileScan parquet [d_date_sk#7316,d_week_seq#7320] Batched: true, DataFilters: [isnotnull(d_week_seq#7320), isnotnull(d_date_sk#7316)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
         :                    +- SortMergeJoin [i_item_sk#7294], [ss_item_sk#6966], LeftSemi
         :                       :- Sort [i_item_sk#7294 ASC NULLS FIRST], false, 0
         :                       :  +- Exchange hashpartitioning(i_item_sk#7294, 200), ENSURE_REQUIREMENTS, [id=#120952]
         :                       :     +- Filter (((isnotnull(i_item_sk#7294) AND isnotnull(i_brand_id#7301)) AND isnotnull(i_class_id#7303)) AND isnotnull(i_category_id#7305))
         :                       :        +- FileScan parquet [i_item_sk#7294,i_brand_id#7301,i_class_id#7303,i_category_id#7305] Batched: true, DataFilters: [isnotnull(i_item_sk#7294), isnotnull(i_brand_id#7301), isnotnull(i_class_id#7303), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                       +- Sort [ss_item_sk#6966 ASC NULLS FIRST], false, 0
         :                          +- Exchange hashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#120953]
         :                             +- Project [i_item_sk#668 AS ss_item_sk#6966]
         :                                +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#6963, class_id#6964, category_id#6965], Inner
         :                                   :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
         :                                   :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#120945]
         :                                   :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
         :                                   :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                                   +- Sort [brand_id#6963 ASC NULLS FIRST, class_id#6964 ASC NULLS FIRST, category_id#6965 ASC NULLS FIRST], false, 0
         :                                      +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                                         +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#120941]
         :                                            +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                                               +- SortMergeJoin [coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965)], [coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057)], LeftSemi
         :                                                  :- Sort [coalesce(brand_id#6963, 0) ASC NULLS FIRST, isnull(brand_id#6963) ASC NULLS FIRST, coalesce(class_id#6964, 0) ASC NULLS FIRST, isnull(class_id#6964) ASC NULLS FIRST, coalesce(category_id#6965, 0) ASC NULLS FIRST, isnull(category_id#6965) ASC NULLS FIRST], false, 0
         :                                                  :  +- Exchange hashpartitioning(coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965), 200), ENSURE_REQUIREMENTS, [id=#120934]
         :                                                  :     +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                                                  :        +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#120915]
         :                                                  :           +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
         :                                                  :              +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
         :                                                  :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
         :                                                  :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
         :                                                  :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#120907]
         :                                                  :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
         :                                                  :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#6974], Inner
         :                                                  :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
         :                                                  :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#120899]
         :                                                  :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
         :                                                  :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                                                  :                    :           +- Sort [i_item_sk#6974 ASC NULLS FIRST], false, 0
         :                                                  :                    :              +- Exchange hashpartitioning(i_item_sk#6974, 200), ENSURE_REQUIREMENTS, [id=#120900]
         :                                                  :                    :                 +- SortMergeJoin [coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985)], [coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007)], LeftSemi
         :                                                  :                    :                    :- Sort [coalesce(i_brand_id#6981, 0) ASC NULLS FIRST, isnull(i_brand_id#6981) ASC NULLS FIRST, coalesce(i_class_id#6983, 0) ASC NULLS FIRST, isnull(i_class_id#6983) ASC NULLS FIRST, coalesce(i_category_id#6985, 0) ASC NULLS FIRST, isnull(i_category_id#6985) ASC NULLS FIRST], false, 0
         :                                                  :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985), 200), ENSURE_REQUIREMENTS, [id=#120892]
         :                                                  :                    :                    :     +- Filter (((isnotnull(i_item_sk#6974) AND isnotnull(i_brand_id#6981)) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985))
         :                                                  :                    :                    :        +- FileScan parquet [i_item_sk#6974,i_brand_id#6981,i_class_id#6983,i_category_id#6985] Batched: true, DataFilters: [isnotnull(i_item_sk#6974), isnotnull(i_brand_id#6981), isnotnull(i_class_id#6983), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                                                  :                    :                    +- Sort [coalesce(i_brand_id#7003, 0) ASC NULLS FIRST, isnull(i_brand_id#7003) ASC NULLS FIRST, coalesce(i_class_id#7005, 0) ASC NULLS FIRST, isnull(i_class_id#7005) ASC NULLS FIRST, coalesce(i_category_id#7007, 0) ASC NULLS FIRST, isnull(i_category_id#7007) ASC NULLS FIRST], false, 0
         :                                                  :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007), 200), ENSURE_REQUIREMENTS, [id=#120893]
         :                                                  :                    :                          +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
         :                                                  :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#6996], Inner
         :                                                  :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
         :                                                  :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#120884]
         :                                                  :                    :                                :     +- Project [cs_item_sk#559]
         :                                                  :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#7018], Inner
         :                                                  :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
         :                                                  :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#120876]
         :                                                  :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
         :                                                  :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                                                  :                    :                                :           +- Sort [d_date_sk#7018 ASC NULLS FIRST], false, 0
         :                                                  :                    :                                :              +- Exchange hashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#120877]
         :                                                  :                    :                                :                 +- Project [d_date_sk#7018]
         :                                                  :                    :                                :                    +- Filter (((isnotnull(d_year#7024) AND (d_year#7024 >= 1999)) AND (d_year#7024 <= 2001)) AND isnotnull(d_date_sk#7018))
         :                                                  :                    :                                :                       +- FileScan parquet [d_date_sk#7018,d_year#7024] Batched: true, DataFilters: [isnotnull(d_year#7024), (d_year#7024 >= 1999), (d_year#7024 <= 2001), isnotnull(d_date_sk#7018)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                                                  :                    :                                +- Sort [i_item_sk#6996 ASC NULLS FIRST], false, 0
         :                                                  :                    :                                   +- Exchange hashpartitioning(i_item_sk#6996, 200), ENSURE_REQUIREMENTS, [id=#120885]
         :                                                  :                    :                                      +- Filter isnotnull(i_item_sk#6996)
         :                                                  :                    :                                         +- FileScan parquet [i_item_sk#6996,i_brand_id#7003,i_class_id#7005,i_category_id#7007] Batched: true, DataFilters: [isnotnull(i_item_sk#6996)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                                                  :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :                                                  :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#120908]
         :                                                  :                          +- Project [d_date_sk#612]
         :                                                  :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
         :                                                  :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                                                  +- Sort [coalesce(i_brand_id#7053, 0) ASC NULLS FIRST, isnull(i_brand_id#7053) ASC NULLS FIRST, coalesce(i_class_id#7055, 0) ASC NULLS FIRST, isnull(i_class_id#7055) ASC NULLS FIRST, coalesce(i_category_id#7057, 0) ASC NULLS FIRST, isnull(i_category_id#7057) ASC NULLS FIRST], false, 0
         :                                                     +- Exchange hashpartitioning(coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057), 200), ENSURE_REQUIREMENTS, [id=#120935]
         :                                                        +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
         :                                                           +- SortMergeJoin [ws_item_sk#479], [i_item_sk#7046], Inner
         :                                                              :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
         :                                                              :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#120926]
         :                                                              :     +- Project [ws_item_sk#479]
         :                                                              :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#7068], Inner
         :                                                              :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
         :                                                              :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#120918]
         :                                                              :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
         :                                                              :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                                                              :           +- Sort [d_date_sk#7068 ASC NULLS FIRST], false, 0
         :                                                              :              +- Exchange hashpartitioning(d_date_sk#7068, 200), ENSURE_REQUIREMENTS, [id=#120919]
         :                                                              :                 +- Project [d_date_sk#7068]
         :                                                              :                    +- Filter (((isnotnull(d_year#7074) AND (d_year#7074 >= 1999)) AND (d_year#7074 <= 2001)) AND isnotnull(d_date_sk#7068))
         :                                                              :                       +- FileScan parquet [d_date_sk#7068,d_year#7074] Batched: true, DataFilters: [isnotnull(d_year#7074), (d_year#7074 >= 1999), (d_year#7074 <= 2001), isnotnull(d_date_sk#7068)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                                                              +- Sort [i_item_sk#7046 ASC NULLS FIRST], false, 0
         :                                                                 +- Exchange hashpartitioning(i_item_sk#7046, 200), ENSURE_REQUIREMENTS, [id=#120927]
         :                                                                    +- Filter isnotnull(i_item_sk#7046)
         :                                                                       +- FileScan parquet [i_item_sk#7046,i_brand_id#7053,i_class_id#7055,i_category_id#7057] Batched: true, DataFilters: [isnotnull(i_item_sk#7046)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         +- Sort [i_brand_id#7374 ASC NULLS FIRST, i_class_id#7376 ASC NULLS FIRST, i_category_id#7378 ASC NULLS FIRST], false, 0
            +- Filter (isnotnull(sales#6946) AND (cast(sales#6946 as decimal(32,6)) > cast(Subquery subquery#6950, [id=#120644] as decimal(32,6))))
               :  +- Subquery subquery#6950, [id=#120644]
               :     +- AdaptiveSparkPlan isFinalPlan=false
               :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#6973])
               :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#120537]
               :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#7516, count#7517L])
               :                 +- Union
               :                    :- Project [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968]
               :                    :  +- SortMergeJoin [ss_sold_date_sk#7096], [d_date_sk#7119], Inner
               :                    :     :- Sort [ss_sold_date_sk#7096 ASC NULLS FIRST], false, 0
               :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#7096, 200), ENSURE_REQUIREMENTS, [id=#120514]
               :                    :     :     +- Filter isnotnull(ss_sold_date_sk#7096)
               :                    :     :        +- FileScan parquet [ss_sold_date_sk#7096,ss_quantity#7106,ss_list_price#7108] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7096)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
               :                    :     +- Sort [d_date_sk#7119 ASC NULLS FIRST], false, 0
               :                    :        +- Exchange hashpartitioning(d_date_sk#7119, 200), ENSURE_REQUIREMENTS, [id=#120515]
               :                    :           +- Project [d_date_sk#7119]
               :                    :              +- Filter (((isnotnull(d_year#7125) AND (d_year#7125 >= 1999)) AND (d_year#7125 <= 2001)) AND isnotnull(d_date_sk#7119))
               :                    :                 +- FileScan parquet [d_date_sk#7119,d_year#7125] Batched: true, DataFilters: [isnotnull(d_year#7125), (d_year#7125 >= 1999), (d_year#7125 <= 2001), isnotnull(d_date_sk#7119)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :- Project [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970]
               :                    :  +- SortMergeJoin [cs_sold_date_sk#7147], [d_date_sk#7181], Inner
               :                    :     :- Sort [cs_sold_date_sk#7147 ASC NULLS FIRST], false, 0
               :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#7147, 200), ENSURE_REQUIREMENTS, [id=#120521]
               :                    :     :     +- Filter isnotnull(cs_sold_date_sk#7147)
               :                    :     :        +- FileScan parquet [cs_sold_date_sk#7147,cs_quantity#7165,cs_list_price#7167] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#7147)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
               :                    :     +- Sort [d_date_sk#7181 ASC NULLS FIRST], false, 0
               :                    :        +- Exchange hashpartitioning(d_date_sk#7181, 200), ENSURE_REQUIREMENTS, [id=#120522]
               :                    :           +- Project [d_date_sk#7181]
               :                    :              +- Filter (((isnotnull(d_year#7187) AND (d_year#7187 >= 1999)) AND (d_year#7187 <= 2001)) AND isnotnull(d_date_sk#7181))
               :                    :                 +- FileScan parquet [d_date_sk#7181,d_year#7187] Batched: true, DataFilters: [isnotnull(d_year#7187), (d_year#7187 >= 1999), (d_year#7187 <= 2001), isnotnull(d_date_sk#7181)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    +- Project [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972]
               :                       +- SortMergeJoin [ws_sold_date_sk#7209], [d_date_sk#7243], Inner
               :                          :- Sort [ws_sold_date_sk#7209 ASC NULLS FIRST], false, 0
               :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#7209, 200), ENSURE_REQUIREMENTS, [id=#120528]
               :                          :     +- Filter isnotnull(ws_sold_date_sk#7209)
               :                          :        +- FileScan parquet [ws_sold_date_sk#7209,ws_quantity#7227,ws_list_price#7229] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#7209)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
               :                          +- Sort [d_date_sk#7243 ASC NULLS FIRST], false, 0
               :                             +- Exchange hashpartitioning(d_date_sk#7243, 200), ENSURE_REQUIREMENTS, [id=#120529]
               :                                +- Project [d_date_sk#7243]
               :                                   +- Filter (((isnotnull(d_year#7249) AND (d_year#7249 >= 1999)) AND (d_year#7249 <= 2001)) AND isnotnull(d_date_sk#7243))
               :                                      +- FileScan parquet [d_date_sk#7243,d_year#7249] Batched: true, DataFilters: [isnotnull(d_year#7249), (d_year#7249 >= 1999), (d_year#7249 <= 2001), isnotnull(d_date_sk#7243)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               +- HashAggregate(keys=[i_brand_id#7374, i_class_id#7376, i_category_id#7378], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7354 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7356 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#7374, i_class_id#7376, i_category_id#7378, sales#6946, number_sales#6947L])
                  +- Exchange hashpartitioning(i_brand_id#7374, i_class_id#7376, i_category_id#7378, 200), ENSURE_REQUIREMENTS, [id=#121148]
                     +- HashAggregate(keys=[i_brand_id#7374, i_class_id#7376, i_category_id#7378], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7354 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7356 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#7374, i_class_id#7376, i_category_id#7378, sum#7511, isEmpty#7512, count#7513L])
                        +- Project [ss_quantity#7354, ss_list_price#7356, i_brand_id#7374, i_class_id#7376, i_category_id#7378]
                           +- SortMergeJoin [ss_item_sk#7346], [i_item_sk#7367], Inner
                              :- Sort [ss_item_sk#7346 ASC NULLS FIRST], false, 0
                              :  +- Exchange hashpartitioning(ss_item_sk#7346, 200), ENSURE_REQUIREMENTS, [id=#121142]
                              :     +- Project [ss_item_sk#7346, ss_quantity#7354, ss_list_price#7356]
                              :        +- SortMergeJoin [ss_sold_date_sk#7344], [d_date_sk#7389], Inner
                              :           :- Sort [ss_sold_date_sk#7344 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(ss_sold_date_sk#7344, 200), ENSURE_REQUIREMENTS, [id=#121052]
                              :           :     +- SortMergeJoin [ss_item_sk#7346], [ss_item_sk#6966], LeftSemi
                              :           :        :- Sort [ss_item_sk#7346 ASC NULLS FIRST], false, 0
                              :           :        :  +- Exchange hashpartitioning(ss_item_sk#7346, 200), ENSURE_REQUIREMENTS, [id=#121045]
                              :           :        :     +- Filter (isnotnull(ss_sold_date_sk#7344) AND isnotnull(ss_item_sk#7346))
                              :           :        :        +- FileScan parquet [ss_sold_date_sk#7344,ss_item_sk#7346,ss_quantity#7354,ss_list_price#7356] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#7344), isnotnull(ss_item_sk#7346)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                              :           :        +- Sort [ss_item_sk#6966 ASC NULLS FIRST], false, 0
                              :           :           +- Exchange hashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#121046]
                              :           :              +- Project [i_item_sk#668 AS ss_item_sk#6966]
                              :           :                 +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#6963, class_id#6964, category_id#6965], Inner
                              :           :                    :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                              :           :                    :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#121038]
                              :           :                    :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                              :           :                    :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :                    +- Sort [brand_id#6963 ASC NULLS FIRST, class_id#6964 ASC NULLS FIRST, category_id#6965 ASC NULLS FIRST], false, 0
                              :           :                       +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                              :           :                          +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#121034]
                              :           :                             +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                              :           :                                +- SortMergeJoin [coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965)], [coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057)], LeftSemi
                              :           :                                   :- Sort [coalesce(brand_id#6963, 0) ASC NULLS FIRST, isnull(brand_id#6963) ASC NULLS FIRST, coalesce(class_id#6964, 0) ASC NULLS FIRST, isnull(class_id#6964) ASC NULLS FIRST, coalesce(category_id#6965, 0) ASC NULLS FIRST, isnull(category_id#6965) ASC NULLS FIRST], false, 0
                              :           :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965), 200), ENSURE_REQUIREMENTS, [id=#121027]
                              :           :                                   :     +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                              :           :                                   :        +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#121008]
                              :           :                                   :           +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                              :           :                                   :              +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
                              :           :                                   :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                              :           :                                   :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#121000]
                              :           :                                   :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
                              :           :                                   :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#6974], Inner
                              :           :                                   :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#120992]
                              :           :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                              :           :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :           :                                   :                    :           +- Sort [i_item_sk#6974 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#6974, 200), ENSURE_REQUIREMENTS, [id=#120993]
                              :           :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985)], [coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007)], LeftSemi
                              :           :                                   :                    :                    :- Sort [coalesce(i_brand_id#6981, 0) ASC NULLS FIRST, isnull(i_brand_id#6981) ASC NULLS FIRST, coalesce(i_class_id#6983, 0) ASC NULLS FIRST, isnull(i_class_id#6983) ASC NULLS FIRST, coalesce(i_category_id#6985, 0) ASC NULLS FIRST, isnull(i_category_id#6985) ASC NULLS FIRST], false, 0
                              :           :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985), 200), ENSURE_REQUIREMENTS, [id=#120985]
                              :           :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#6974) AND isnotnull(i_brand_id#6981)) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985))
                              :           :                                   :                    :                    :        +- FileScan parquet [i_item_sk#6974,i_brand_id#6981,i_class_id#6983,i_category_id#6985] Batched: true, DataFilters: [isnotnull(i_item_sk#6974), isnotnull(i_brand_id#6981), isnotnull(i_class_id#6983), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :                                   :                    :                    +- Sort [coalesce(i_brand_id#7003, 0) ASC NULLS FIRST, isnull(i_brand_id#7003) ASC NULLS FIRST, coalesce(i_class_id#7005, 0) ASC NULLS FIRST, isnull(i_class_id#7005) ASC NULLS FIRST, coalesce(i_category_id#7007, 0) ASC NULLS FIRST, isnull(i_category_id#7007) ASC NULLS FIRST], false, 0
                              :           :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007), 200), ENSURE_REQUIREMENTS, [id=#120986]
                              :           :                                   :                    :                          +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
                              :           :                                   :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#6996], Inner
                              :           :                                   :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#120977]
                              :           :                                   :                    :                                :     +- Project [cs_item_sk#559]
                              :           :                                   :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#7018], Inner
                              :           :                                   :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#120969]
                              :           :                                   :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                              :           :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :           :                                   :                    :                                :           +- Sort [d_date_sk#7018 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :                                :              +- Exchange hashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#120970]
                              :           :                                   :                    :                                :                 +- Project [d_date_sk#7018]
                              :           :                                   :                    :                                :                    +- Filter (((isnotnull(d_year#7024) AND (d_year#7024 >= 1999)) AND (d_year#7024 <= 2001)) AND isnotnull(d_date_sk#7018))
                              :           :                                   :                    :                                :                       +- FileScan parquet [d_date_sk#7018,d_year#7024] Batched: true, DataFilters: [isnotnull(d_year#7024), (d_year#7024 >= 1999), (d_year#7024 <= 2001), isnotnull(d_date_sk#7018)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :                                   :                    :                                +- Sort [i_item_sk#6996 ASC NULLS FIRST], false, 0
                              :           :                                   :                    :                                   +- Exchange hashpartitioning(i_item_sk#6996, 200), ENSURE_REQUIREMENTS, [id=#120978]
                              :           :                                   :                    :                                      +- Filter isnotnull(i_item_sk#6996)
                              :           :                                   :                    :                                         +- FileScan parquet [i_item_sk#6996,i_brand_id#7003,i_class_id#7005,i_category_id#7007] Batched: true, DataFilters: [isnotnull(i_item_sk#6996)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :                                   :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                              :           :                                   :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#121001]
                              :           :                                   :                          +- Project [d_date_sk#612]
                              :           :                                   :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                              :           :                                   :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :                                   +- Sort [coalesce(i_brand_id#7053, 0) ASC NULLS FIRST, isnull(i_brand_id#7053) ASC NULLS FIRST, coalesce(i_class_id#7055, 0) ASC NULLS FIRST, isnull(i_class_id#7055) ASC NULLS FIRST, coalesce(i_category_id#7057, 0) ASC NULLS FIRST, isnull(i_category_id#7057) ASC NULLS FIRST], false, 0
                              :           :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057), 200), ENSURE_REQUIREMENTS, [id=#121028]
                              :           :                                         +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
                              :           :                                            +- SortMergeJoin [ws_item_sk#479], [i_item_sk#7046], Inner
                              :           :                                               :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                              :           :                                               :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#121019]
                              :           :                                               :     +- Project [ws_item_sk#479]
                              :           :                                               :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#7068], Inner
                              :           :                                               :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                              :           :                                               :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#121011]
                              :           :                                               :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                              :           :                                               :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :           :                                               :           +- Sort [d_date_sk#7068 ASC NULLS FIRST], false, 0
                              :           :                                               :              +- Exchange hashpartitioning(d_date_sk#7068, 200), ENSURE_REQUIREMENTS, [id=#121012]
                              :           :                                               :                 +- Project [d_date_sk#7068]
                              :           :                                               :                    +- Filter (((isnotnull(d_year#7074) AND (d_year#7074 >= 1999)) AND (d_year#7074 <= 2001)) AND isnotnull(d_date_sk#7068))
                              :           :                                               :                       +- FileScan parquet [d_date_sk#7068,d_year#7074] Batched: true, DataFilters: [isnotnull(d_year#7074), (d_year#7074 >= 1999), (d_year#7074 <= 2001), isnotnull(d_date_sk#7068)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :                                               +- Sort [i_item_sk#7046 ASC NULLS FIRST], false, 0
                              :           :                                                  +- Exchange hashpartitioning(i_item_sk#7046, 200), ENSURE_REQUIREMENTS, [id=#121020]
                              :           :                                                     +- Filter isnotnull(i_item_sk#7046)
                              :           :                                                        +- FileScan parquet [i_item_sk#7046,i_brand_id#7053,i_class_id#7055,i_category_id#7057] Batched: true, DataFilters: [isnotnull(i_item_sk#7046)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           +- Sort [d_date_sk#7389 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(d_date_sk#7389, 200), ENSURE_REQUIREMENTS, [id=#121053]
                              :                 +- Project [d_date_sk#7389]
                              :                    +- Filter ((isnotnull(d_week_seq#7393) AND (d_week_seq#7393 = Subquery subquery#6949, [id=#120659])) AND isnotnull(d_date_sk#7389))
                              :                       :  +- Subquery subquery#6949, [id=#120659]
                              :                       :     +- AdaptiveSparkPlan isFinalPlan=true
                                                            +- == Final Plan ==
                                                               GpuColumnarToRow false
                                                               +- GpuProject [d_week_seq#7451], true
                                                                  +- GpuCoalesceBatches targetsize(2147483647)
                                                                     +- GpuFilter (((((gpuisnotnull(d_year#7453) AND gpuisnotnull(d_moy#7455)) AND gpuisnotnull(d_dom#7456)) AND (d_year#7453 = 1999)) AND (d_moy#7455 = 12)) AND (d_dom#7456 = 12)), true
                                                                        +- GpuFileGpuScan parquet [d_week_seq#7451,d_year#7453,d_moy#7455,d_dom#7456] Batched: true, DataFilters: [isnotnull(d_year#7453), isnotnull(d_moy#7455), isnotnull(d_dom#7456), (d_year#7453 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                            +- == Initial Plan ==
                                                               Project [d_week_seq#7451]
                                                               +- Filter (((((isnotnull(d_year#7453) AND isnotnull(d_moy#7455)) AND isnotnull(d_dom#7456)) AND (d_year#7453 = 1999)) AND (d_moy#7455 = 12)) AND (d_dom#7456 = 12))
                                                                  +- FileScan parquet [d_week_seq#7451,d_year#7453,d_moy#7455,d_dom#7456] Batched: true, DataFilters: [isnotnull(d_year#7453), isnotnull(d_moy#7455), isnotnull(d_dom#7456), (d_year#7453 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                              :                       +- FileScan parquet [d_date_sk#7389,d_week_seq#7393] Batched: true, DataFilters: [isnotnull(d_week_seq#7393), isnotnull(d_date_sk#7389)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
                              +- SortMergeJoin [i_item_sk#7367], [ss_item_sk#6966], LeftSemi
                                 :- Sort [i_item_sk#7367 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(i_item_sk#7367, 200), ENSURE_REQUIREMENTS, [id=#121135]
                                 :     +- Filter (((isnotnull(i_item_sk#7367) AND isnotnull(i_brand_id#7374)) AND isnotnull(i_class_id#7376)) AND isnotnull(i_category_id#7378))
                                 :        +- FileScan parquet [i_item_sk#7367,i_brand_id#7374,i_class_id#7376,i_category_id#7378] Batched: true, DataFilters: [isnotnull(i_item_sk#7367), isnotnull(i_brand_id#7374), isnotnull(i_class_id#7376), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                 +- Sort [ss_item_sk#6966 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(ss_item_sk#6966, 200), ENSURE_REQUIREMENTS, [id=#121136]
                                       +- Project [i_item_sk#668 AS ss_item_sk#6966]
                                          +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#6963, class_id#6964, category_id#6965], Inner
                                             :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                                             :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#121128]
                                             :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                                             :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                             +- Sort [brand_id#6963 ASC NULLS FIRST, class_id#6964 ASC NULLS FIRST, category_id#6965 ASC NULLS FIRST], false, 0
                                                +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                                                   +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#121124]
                                                      +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                                                         +- SortMergeJoin [coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965)], [coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057)], LeftSemi
                                                            :- Sort [coalesce(brand_id#6963, 0) ASC NULLS FIRST, isnull(brand_id#6963) ASC NULLS FIRST, coalesce(class_id#6964, 0) ASC NULLS FIRST, isnull(class_id#6964) ASC NULLS FIRST, coalesce(category_id#6965, 0) ASC NULLS FIRST, isnull(category_id#6965) ASC NULLS FIRST], false, 0
                                                            :  +- Exchange hashpartitioning(coalesce(brand_id#6963, 0), isnull(brand_id#6963), coalesce(class_id#6964, 0), isnull(class_id#6964), coalesce(category_id#6965, 0), isnull(category_id#6965), 200), ENSURE_REQUIREMENTS, [id=#121117]
                                                            :     +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                                                            :        +- Exchange hashpartitioning(brand_id#6963, class_id#6964, category_id#6965, 200), ENSURE_REQUIREMENTS, [id=#121098]
                                                            :           +- HashAggregate(keys=[brand_id#6963, class_id#6964, category_id#6965], functions=[], output=[brand_id#6963, class_id#6964, category_id#6965])
                                                            :              +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
                                                            :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                                                            :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                                                            :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#121090]
                                                            :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
                                                            :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#6974], Inner
                                                            :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                                                            :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#121082]
                                                            :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                                                            :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                                            :                    :           +- Sort [i_item_sk#6974 ASC NULLS FIRST], false, 0
                                                            :                    :              +- Exchange hashpartitioning(i_item_sk#6974, 200), ENSURE_REQUIREMENTS, [id=#121083]
                                                            :                    :                 +- SortMergeJoin [coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985)], [coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007)], LeftSemi
                                                            :                    :                    :- Sort [coalesce(i_brand_id#6981, 0) ASC NULLS FIRST, isnull(i_brand_id#6981) ASC NULLS FIRST, coalesce(i_class_id#6983, 0) ASC NULLS FIRST, isnull(i_class_id#6983) ASC NULLS FIRST, coalesce(i_category_id#6985, 0) ASC NULLS FIRST, isnull(i_category_id#6985) ASC NULLS FIRST], false, 0
                                                            :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#6981, 0), isnull(i_brand_id#6981), coalesce(i_class_id#6983, 0), isnull(i_class_id#6983), coalesce(i_category_id#6985, 0), isnull(i_category_id#6985), 200), ENSURE_REQUIREMENTS, [id=#121075]
                                                            :                    :                    :     +- Filter (((isnotnull(i_item_sk#6974) AND isnotnull(i_brand_id#6981)) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985))
                                                            :                    :                    :        +- FileScan parquet [i_item_sk#6974,i_brand_id#6981,i_class_id#6983,i_category_id#6985] Batched: true, DataFilters: [isnotnull(i_item_sk#6974), isnotnull(i_brand_id#6981), isnotnull(i_class_id#6983), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                                            :                    :                    +- Sort [coalesce(i_brand_id#7003, 0) ASC NULLS FIRST, isnull(i_brand_id#7003) ASC NULLS FIRST, coalesce(i_class_id#7005, 0) ASC NULLS FIRST, isnull(i_class_id#7005) ASC NULLS FIRST, coalesce(i_category_id#7007, 0) ASC NULLS FIRST, isnull(i_category_id#7007) ASC NULLS FIRST], false, 0
                                                            :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#7003, 0), isnull(i_brand_id#7003), coalesce(i_class_id#7005, 0), isnull(i_class_id#7005), coalesce(i_category_id#7007, 0), isnull(i_category_id#7007), 200), ENSURE_REQUIREMENTS, [id=#121076]
                                                            :                    :                          +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
                                                            :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#6996], Inner
                                                            :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                                                            :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#121067]
                                                            :                    :                                :     +- Project [cs_item_sk#559]
                                                            :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#7018], Inner
                                                            :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                                                            :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#121059]
                                                            :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                                                            :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                                            :                    :                                :           +- Sort [d_date_sk#7018 ASC NULLS FIRST], false, 0
                                                            :                    :                                :              +- Exchange hashpartitioning(d_date_sk#7018, 200), ENSURE_REQUIREMENTS, [id=#121060]
                                                            :                    :                                :                 +- Project [d_date_sk#7018]
                                                            :                    :                                :                    +- Filter (((isnotnull(d_year#7024) AND (d_year#7024 >= 1999)) AND (d_year#7024 <= 2001)) AND isnotnull(d_date_sk#7018))
                                                            :                    :                                :                       +- FileScan parquet [d_date_sk#7018,d_year#7024] Batched: true, DataFilters: [isnotnull(d_year#7024), (d_year#7024 >= 1999), (d_year#7024 <= 2001), isnotnull(d_date_sk#7018)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                            :                    :                                +- Sort [i_item_sk#6996 ASC NULLS FIRST], false, 0
                                                            :                    :                                   +- Exchange hashpartitioning(i_item_sk#6996, 200), ENSURE_REQUIREMENTS, [id=#121068]
                                                            :                    :                                      +- Filter isnotnull(i_item_sk#6996)
                                                            :                    :                                         +- FileScan parquet [i_item_sk#6996,i_brand_id#7003,i_class_id#7005,i_category_id#7007] Batched: true, DataFilters: [isnotnull(i_item_sk#6996)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                                            :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                                                            :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#121091]
                                                            :                          +- Project [d_date_sk#612]
                                                            :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                                                            :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                            +- Sort [coalesce(i_brand_id#7053, 0) ASC NULLS FIRST, isnull(i_brand_id#7053) ASC NULLS FIRST, coalesce(i_class_id#7055, 0) ASC NULLS FIRST, isnull(i_class_id#7055) ASC NULLS FIRST, coalesce(i_category_id#7057, 0) ASC NULLS FIRST, isnull(i_category_id#7057) ASC NULLS FIRST], false, 0
                                                               +- Exchange hashpartitioning(coalesce(i_brand_id#7053, 0), isnull(i_brand_id#7053), coalesce(i_class_id#7055, 0), isnull(i_class_id#7055), coalesce(i_category_id#7057, 0), isnull(i_category_id#7057), 200), ENSURE_REQUIREMENTS, [id=#121118]
                                                                  +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
                                                                     +- SortMergeJoin [ws_item_sk#479], [i_item_sk#7046], Inner
                                                                        :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                                                                        :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#121109]
                                                                        :     +- Project [ws_item_sk#479]
                                                                        :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#7068], Inner
                                                                        :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                                                                        :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#121101]
                                                                        :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                                                                        :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                                                        :           +- Sort [d_date_sk#7068 ASC NULLS FIRST], false, 0
                                                                        :              +- Exchange hashpartitioning(d_date_sk#7068, 200), ENSURE_REQUIREMENTS, [id=#121102]
                                                                        :                 +- Project [d_date_sk#7068]
                                                                        :                    +- Filter (((isnotnull(d_year#7074) AND (d_year#7074 >= 1999)) AND (d_year#7074 <= 2001)) AND isnotnull(d_date_sk#7068))
                                                                        :                       +- FileScan parquet [d_date_sk#7068,d_year#7074] Batched: true, DataFilters: [isnotnull(d_year#7074), (d_year#7074 >= 1999), (d_year#7074 <= 2001), isnotnull(d_date_sk#7068)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                                        +- Sort [i_item_sk#7046 ASC NULLS FIRST], false, 0
                                                                           +- Exchange hashpartitioning(i_item_sk#7046, 200), ENSURE_REQUIREMENTS, [id=#121110]
                                                                              +- Filter isnotnull(i_item_sk#7046)
                                                                                 +- FileScan parquet [i_item_sk#7046,i_brand_id#7053,i_class_id#7055,i_category_id#7057] Batched: true, DataFilters: [isnotnull(i_item_sk#7046)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
