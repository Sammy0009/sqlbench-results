AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_brand_id#5682 ASC NULLS FIRST,i_class_id#5684 ASC NULLS FIRST,i_category_id#5686 ASC NULLS FIRST], output=[ty_channel#5332,ty_brand#5333,ty_class#5334,ty_category#5335,ty_sales#5336,ty_number_sales#5337L,ly_channel#5338,ly_brand#5339,ly_class#5340,ly_category#5341,ly_sales#5342,ly_number_sales#5343L])
   +- *(84) Project [i_brand_id#5682 AS ty_brand#5333, i_class_id#5684 AS ty_class#5334, i_category_id#5686 AS ty_category#5335, sales#5321 AS ty_sales#5336, number_sales#5322L AS ty_number_sales#5337L, i_brand_id#5755 AS ly_brand#5339, i_class_id#5757 AS ly_class#5340, i_category_id#5759 AS ly_category#5341, sales#5327 AS ly_sales#5342, number_sales#5328L AS ly_number_sales#5343L, i_brand_id#5682, i_class_id#5684, i_category_id#5686]
      +- *(84) BroadcastHashJoin [i_brand_id#5682, i_class_id#5684, i_category_id#5686], [i_brand_id#5755, i_class_id#5757, i_category_id#5759], Inner, BuildRight, false
         :- *(84) Filter (isnotnull(sales#5321) AND (cast(sales#5321 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#5331, [id=#41868] as decimal(32,6))))
         :  :  +- ReusedSubquery Subquery subquery#5331, [id=#41868]
         :  +- *(84) HashAggregate(keys=[i_brand_id#5682, i_class_id#5684, i_category_id#5686], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5662 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5664 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5682, i_class_id#5684, i_category_id#5686, sales#5321, number_sales#5322L])
         :     +- AQEShuffleRead coalesced
         :        +- ShuffleQueryStage 119
         :           +- Exchange hashpartitioning(i_brand_id#5682, i_class_id#5684, i_category_id#5686, 200), ENSURE_REQUIREMENTS, [id=#53562]
         :              +- *(81) HashAggregate(keys=[i_brand_id#5682, i_class_id#5684, i_category_id#5686], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5662 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5664 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5682, i_class_id#5684, i_category_id#5686, sum#5886, isEmpty#5887, count#5888L])
         :                 +- *(81) Project [ss_quantity#5662, ss_list_price#5664, i_brand_id#5682, i_class_id#5684, i_category_id#5686]
         :                    +- *(81) BroadcastHashJoin [ss_sold_date_sk#5652], [d_date_sk#5697], Inner, BuildRight, false
         :                       :- *(81) Project [ss_sold_date_sk#5652, ss_quantity#5662, ss_list_price#5664, i_brand_id#5682, i_class_id#5684, i_category_id#5686]
         :                       :  +- *(81) BroadcastHashJoin [ss_item_sk#5654], [i_item_sk#5675], Inner, BuildRight, false
         :                       :     :- *(81) BroadcastHashJoin [ss_item_sk#5654], [ss_item_sk#5347], LeftSemi, BuildRight, false
         :                       :     :  :- AQEShuffleRead local
         :                       :     :  :  +- ShuffleQueryStage 0
         :                       :     :  :     +- Exchange hashpartitioning(ss_item_sk#5654, 200), ENSURE_REQUIREMENTS, [id=#42513]
         :                       :     :  :        +- *(1) Filter (isnotnull(ss_item_sk#5654) AND isnotnull(ss_sold_date_sk#5652))
         :                       :     :  :           +- *(1) ColumnarToRow
         :                       :     :  :              +- FileScan parquet [ss_sold_date_sk#5652,ss_item_sk#5654,ss_quantity#5662,ss_list_price#5664] Batched: true, DataFilters: [isnotnull(ss_item_sk#5654), isnotnull(ss_sold_date_sk#5652)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
         :                       :     :  +- BroadcastQueryStage 109
         :                       :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#53159]
         :                       :     :        +- AQEShuffleRead local
         :                       :     :           +- ShuffleQueryStage 102
         :                       :     :              +- Exchange hashpartitioning(ss_item_sk#5347, 200), ENSURE_REQUIREMENTS, [id=#52891]
         :                       :     :                 +- *(75) Project [i_item_sk#500 AS ss_item_sk#5347]
         :                       :     :                    +- *(75) BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#5344, class_id#5345, category_id#5346], Inner, BuildLeft, false
         :                       :     :                       :- BroadcastQueryStage 1
         :                       :     :                       :  +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#42530]
         :                       :     :                       :     +- *(2) Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
         :                       :     :                       :        +- *(2) ColumnarToRow
         :                       :     :                       :           +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                       :     :                       +- *(75) HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                       :     :                          +- AQEShuffleRead coalesced
         :                       :     :                             +- ShuffleQueryStage 95
         :                       :     :                                +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#52285]
         :                       :     :                                   +- *(65) HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                       :     :                                      +- *(65) SortMergeJoin [coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346)], [coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438)], LeftSemi
         :                       :     :                                         :- *(63) Sort [coalesce(brand_id#5344, 0) ASC NULLS FIRST, isnull(brand_id#5344) ASC NULLS FIRST, coalesce(class_id#5345, 0) ASC NULLS FIRST, isnull(class_id#5345) ASC NULLS FIRST, coalesce(category_id#5346, 0) ASC NULLS FIRST, isnull(category_id#5346) ASC NULLS FIRST], false, 0
         :                       :     :                                         :  +- AQEShuffleRead coalesced
         :                       :     :                                         :     +- ShuffleQueryStage 88
         :                       :     :                                         :        +- Exchange hashpartitioning(coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346), 200), ENSURE_REQUIREMENTS, [id=#51479]
         :                       :     :                                         :           +- *(59) HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                       :     :                                         :              +- AQEShuffleRead coalesced
         :                       :     :                                         :                 +- ShuffleQueryStage 81
         :                       :     :                                         :                    +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#50941]
         :                       :     :                                         :                       +- *(55) HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                       :     :                                         :                          +- *(55) Project [i_brand_id#5362 AS brand_id#5344, i_class_id#5364 AS class_id#5345, i_category_id#5366 AS category_id#5346]
         :                       :     :                                         :                             +- *(55) BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
         :                       :     :                                         :                                :- *(55) Project [ss_sold_date_sk#664, i_brand_id#5362, i_class_id#5364, i_category_id#5366]
         :                       :     :                                         :                                :  +- *(55) BroadcastHashJoin [ss_item_sk#666], [i_item_sk#5355], Inner, BuildRight, false
         :                       :     :                                         :                                :     :- *(55) Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
         :                       :     :                                         :                                :     :  +- *(55) ColumnarToRow
         :                       :     :                                         :                                :     :     +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                       :     :                                         :                                :     +- BroadcastQueryStage 74
         :                       :     :                                         :                                :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#48827]
         :                       :     :                                         :                                :           +- *(45) SortMergeJoin [coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366)], [coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388)], LeftSemi
         :                       :     :                                         :                                :              :- *(43) Sort [coalesce(i_brand_id#5362, 0) ASC NULLS FIRST, isnull(i_brand_id#5362) ASC NULLS FIRST, coalesce(i_class_id#5364, 0) ASC NULLS FIRST, isnull(i_class_id#5364) ASC NULLS FIRST, coalesce(i_category_id#5366, 0) ASC NULLS FIRST, isnull(i_category_id#5366) ASC NULLS FIRST], false, 0
         :                       :     :                                         :                                :              :  +- AQEShuffleRead coalesced
         :                       :     :                                         :                                :              :     +- ShuffleQueryStage 2
         :                       :     :                                         :                                :              :        +- Exchange hashpartitioning(coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366), 200), ENSURE_REQUIREMENTS, [id=#42545]
         :                       :     :                                         :                                :              :           +- *(3) Filter (((isnotnull(i_item_sk#5355) AND isnotnull(i_brand_id#5362)) AND isnotnull(i_class_id#5364)) AND isnotnull(i_category_id#5366))
         :                       :     :                                         :                                :              :              +- *(3) ColumnarToRow
         :                       :     :                                         :                                :              :                 +- FileScan parquet [i_item_sk#5355,i_brand_id#5362,i_class_id#5364,i_category_id#5366] Batched: true, DataFilters: [isnotnull(i_item_sk#5355), isnotnull(i_brand_id#5362), isnotnull(i_class_id#5364), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                       :     :                                         :                                :              +- *(44) Sort [coalesce(i_brand_id#5384, 0) ASC NULLS FIRST, isnull(i_brand_id#5384) ASC NULLS FIRST, coalesce(i_class_id#5386, 0) ASC NULLS FIRST, isnull(i_class_id#5386) ASC NULLS FIRST, coalesce(i_category_id#5388, 0) ASC NULLS FIRST, isnull(i_category_id#5388) ASC NULLS FIRST], false, 0
         :                       :     :                                         :                                :                 +- AQEShuffleRead coalesced
         :                       :     :                                         :                                :                    +- ShuffleQueryStage 60
         :                       :     :                                         :                                :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388), 200), ENSURE_REQUIREMENTS, [id=#45255]
         :                       :     :                                         :                                :                          +- *(35) Project [i_brand_id#5384, i_class_id#5386, i_category_id#5388]
         :                       :     :                                         :                                :                             +- *(35) BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#5399], Inner, BuildRight, false
         :                       :     :                                         :                                :                                :- *(35) Project [cs_sold_date_sk#118, i_brand_id#5384, i_class_id#5386, i_category_id#5388]
         :                       :     :                                         :                                :                                :  +- *(35) BroadcastHashJoin [cs_item_sk#133], [i_item_sk#5377], Inner, BuildRight, false
         :                       :     :                                         :                                :                                :     :- *(35) Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
         :                       :     :                                         :                                :                                :     :  +- *(35) ColumnarToRow
         :                       :     :                                         :                                :                                :     :     +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                       :     :                                         :                                :                                :     +- BroadcastQueryStage 3
         :                       :     :                                         :                                :                                :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42562]
         :                       :     :                                         :                                :                                :           +- *(4) Filter isnotnull(i_item_sk#5377)
         :                       :     :                                         :                                :                                :              +- *(4) ColumnarToRow
         :                       :     :                                         :                                :                                :                 +- FileScan parquet [i_item_sk#5377,i_brand_id#5384,i_class_id#5386,i_category_id#5388] Batched: true, DataFilters: [isnotnull(i_item_sk#5377)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                       :     :                                         :                                :                                +- BroadcastQueryStage 4
         :                       :     :                                         :                                :                                   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
         :                       :     :                                         :                                :                                      +- *(5) Project [d_date_sk#5399]
         :                       :     :                                         :                                :                                         +- *(5) Filter (((isnotnull(d_year#5405) AND (d_year#5405 >= 1999)) AND (d_year#5405 <= 2001)) AND isnotnull(d_date_sk#5399))
         :                       :     :                                         :                                :                                            +- *(5) ColumnarToRow
         :                       :     :                                         :                                :                                               +- FileScan parquet [d_date_sk#5399,d_year#5405] Batched: true, DataFilters: [isnotnull(d_year#5405), (d_year#5405 >= 1999), (d_year#5405 <= 2001), isnotnull(d_date_sk#5399)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                       :     :                                         :                                +- BroadcastQueryStage 6
         :                       :     :                                         :                                   +- ReusedExchange [d_date_sk#598], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
         :                       :     :                                         +- *(64) Sort [coalesce(i_brand_id#5434, 0) ASC NULLS FIRST, isnull(i_brand_id#5434) ASC NULLS FIRST, coalesce(i_class_id#5436, 0) ASC NULLS FIRST, isnull(i_class_id#5436) ASC NULLS FIRST, coalesce(i_category_id#5438, 0) ASC NULLS FIRST, isnull(i_category_id#5438) ASC NULLS FIRST], false, 0
         :                       :     :                                            +- AQEShuffleRead coalesced
         :                       :     :                                               +- ShuffleQueryStage 61
         :                       :     :                                                  +- Exchange hashpartitioning(coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438), 200), ENSURE_REQUIREMENTS, [id=#45303]
         :                       :     :                                                     +- *(36) Project [i_brand_id#5434, i_class_id#5436, i_category_id#5438]
         :                       :     :                                                        +- *(36) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#5449], Inner, BuildRight, false
         :                       :     :                                                           :- *(36) Project [ws_sold_date_sk#384, i_brand_id#5434, i_class_id#5436, i_category_id#5438]
         :                       :     :                                                           :  +- *(36) BroadcastHashJoin [ws_item_sk#387], [i_item_sk#5427], Inner, BuildRight, false
         :                       :     :                                                           :     :- *(36) Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
         :                       :     :                                                           :     :  +- *(36) ColumnarToRow
         :                       :     :                                                           :     :     +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                       :     :                                                           :     +- BroadcastQueryStage 8
         :                       :     :                                                           :        +- ReusedExchange [i_item_sk#5427, i_brand_id#5434, i_class_id#5436, i_category_id#5438], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42562]
         :                       :     :                                                           +- BroadcastQueryStage 10
         :                       :     :                                                              +- ReusedExchange [d_date_sk#5449], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
         :                       :     +- BroadcastQueryStage 116
         :                       :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#53370]
         :                       :           +- *(79) BroadcastHashJoin [i_item_sk#5675], [ss_item_sk#5347], LeftSemi, BuildRight, false
         :                       :              :- AQEShuffleRead local
         :                       :              :  +- ShuffleQueryStage 11
         :                       :              :     +- Exchange hashpartitioning(i_item_sk#5675, 200), ENSURE_REQUIREMENTS, [id=#42687]
         :                       :              :        +- *(9) Filter (((isnotnull(i_item_sk#5675) AND isnotnull(i_brand_id#5682)) AND isnotnull(i_class_id#5684)) AND isnotnull(i_category_id#5686))
         :                       :              :           +- *(9) ColumnarToRow
         :                       :              :              +- FileScan parquet [i_item_sk#5675,i_brand_id#5682,i_class_id#5684,i_category_id#5686] Batched: true, DataFilters: [isnotnull(i_item_sk#5675), isnotnull(i_brand_id#5682), isnotnull(i_class_id#5684), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                       :              +- BroadcastQueryStage 111
         :                       :                 +- ReusedExchange [ss_item_sk#5347], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#53159]
         :                       +- BroadcastQueryStage 26
         :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42874]
         :                             +- *(17) Project [d_date_sk#5697]
         :                                +- *(17) Filter ((isnotnull(d_week_seq#5701) AND (d_week_seq#5701 = Subquery subquery#5324, [id=#41788])) AND isnotnull(d_date_sk#5697))
         :                                   :  +- Subquery subquery#5324, [id=#41788]
         :                                   :     +- AdaptiveSparkPlan isFinalPlan=true
                                                   +- == Final Plan ==
                                                      *(1) Project [d_week_seq#5804]
                                                      +- *(1) Filter (((((isnotnull(d_year#5806) AND isnotnull(d_moy#5808)) AND isnotnull(d_dom#5809)) AND (d_year#5806 = 2000)) AND (d_moy#5808 = 12)) AND (d_dom#5809 = 12))
                                                         +- *(1) ColumnarToRow
                                                            +- FileScan parquet [d_week_seq#5804,d_year#5806,d_moy#5808,d_dom#5809] Batched: true, DataFilters: [isnotnull(d_year#5806), isnotnull(d_moy#5808), isnotnull(d_dom#5809), (d_year#5806 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                   +- == Initial Plan ==
                                                      Project [d_week_seq#5804]
                                                      +- Filter (((((isnotnull(d_year#5806) AND isnotnull(d_moy#5808)) AND isnotnull(d_dom#5809)) AND (d_year#5806 = 2000)) AND (d_moy#5808 = 12)) AND (d_dom#5809 = 12))
                                                         +- FileScan parquet [d_week_seq#5804,d_year#5806,d_moy#5808,d_dom#5809] Batched: true, DataFilters: [isnotnull(d_year#5806), isnotnull(d_moy#5808), isnotnull(d_dom#5809), (d_year#5806 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
         :                                   +- *(17) ColumnarToRow
         :                                      +- FileScan parquet [d_date_sk#5697,d_week_seq#5701] Batched: true, DataFilters: [isnotnull(d_week_seq#5701), isnotnull(d_date_sk#5697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
         +- BroadcastQueryStage 121
            +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, true], input[1, int, true], input[2, int, true]),false), [id=#53768]
               +- *(83) Filter (isnotnull(sales#5327) AND (cast(sales#5327 as decimal(32,6)) > cast(Subquery subquery#5331, [id=#41868] as decimal(32,6))))
                  :  +- Subquery subquery#5331, [id=#41868]
                  :     +- AdaptiveSparkPlan isFinalPlan=true
                        +- == Final Plan ==
                           *(8) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5354])
                           +- ShuffleQueryStage 6
                              +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#53912]
                                 +- *(7) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5897, count#5898L])
                                    +- Union
                                       :- *(4) Project [ss_quantity#5487 AS quantity#5348, ss_list_price#5489 AS list_price#5349]
                                       :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#5477], [d_date_sk#5500], Inner, BuildRight, false
                                       :     :- *(4) Filter isnotnull(ss_sold_date_sk#5477)
                                       :     :  +- *(4) ColumnarToRow
                                       :     :     +- FileScan parquet [ss_sold_date_sk#5477,ss_quantity#5487,ss_list_price#5489] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5477)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                       :     +- BroadcastQueryStage 1
                                       :        +- ReusedExchange [d_date_sk#5500], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
                                       :- *(5) Project [cs_quantity#5546 AS quantity#5350, cs_list_price#5548 AS list_price#5351]
                                       :  +- *(5) BroadcastHashJoin [cs_sold_date_sk#5528], [d_date_sk#5562], Inner, BuildRight, false
                                       :     :- *(5) Filter isnotnull(cs_sold_date_sk#5528)
                                       :     :  +- *(5) ColumnarToRow
                                       :     :     +- FileScan parquet [cs_sold_date_sk#5528,cs_quantity#5546,cs_list_price#5548] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                       :     +- BroadcastQueryStage 3
                                       :        +- ReusedExchange [d_date_sk#5562], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
                                       +- *(6) Project [ws_quantity#5608 AS quantity#5352, ws_list_price#5610 AS list_price#5353]
                                          +- *(6) BroadcastHashJoin [ws_sold_date_sk#5590], [d_date_sk#5624], Inner, BuildRight, false
                                             :- *(6) Filter isnotnull(ws_sold_date_sk#5590)
                                             :  +- *(6) ColumnarToRow
                                             :     +- FileScan parquet [ws_sold_date_sk#5590,ws_quantity#5608,ws_list_price#5610] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5590)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                             +- BroadcastQueryStage 5
                                                +- ReusedExchange [d_date_sk#5624], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
                        +- == Initial Plan ==
                           HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5354])
                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#41866]
                              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5897, count#5898L])
                                 +- Union
                                    :- Project [ss_quantity#5487 AS quantity#5348, ss_list_price#5489 AS list_price#5349]
                                    :  +- BroadcastHashJoin [ss_sold_date_sk#5477], [d_date_sk#5500], Inner, BuildRight, false
                                    :     :- Filter isnotnull(ss_sold_date_sk#5477)
                                    :     :  +- FileScan parquet [ss_sold_date_sk#5477,ss_quantity#5487,ss_list_price#5489] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5477)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41854]
                                    :        +- Project [d_date_sk#5500]
                                    :           +- Filter (((isnotnull(d_year#5506) AND (d_year#5506 >= 1999)) AND (d_year#5506 <= 2001)) AND isnotnull(d_date_sk#5500))
                                    :              +- FileScan parquet [d_date_sk#5500,d_year#5506] Batched: true, DataFilters: [isnotnull(d_year#5506), (d_year#5506 >= 1999), (d_year#5506 <= 2001), isnotnull(d_date_sk#5500)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                    :- Project [cs_quantity#5546 AS quantity#5350, cs_list_price#5548 AS list_price#5351]
                                    :  +- BroadcastHashJoin [cs_sold_date_sk#5528], [d_date_sk#5562], Inner, BuildRight, false
                                    :     :- Filter isnotnull(cs_sold_date_sk#5528)
                                    :     :  +- FileScan parquet [cs_sold_date_sk#5528,cs_quantity#5546,cs_list_price#5548] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41857]
                                    :        +- Project [d_date_sk#5562]
                                    :           +- Filter (((isnotnull(d_year#5568) AND (d_year#5568 >= 1999)) AND (d_year#5568 <= 2001)) AND isnotnull(d_date_sk#5562))
                                    :              +- FileScan parquet [d_date_sk#5562,d_year#5568] Batched: true, DataFilters: [isnotnull(d_year#5568), (d_year#5568 >= 1999), (d_year#5568 <= 2001), isnotnull(d_date_sk#5562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                    +- Project [ws_quantity#5608 AS quantity#5352, ws_list_price#5610 AS list_price#5353]
                                       +- BroadcastHashJoin [ws_sold_date_sk#5590], [d_date_sk#5624], Inner, BuildRight, false
                                          :- Filter isnotnull(ws_sold_date_sk#5590)
                                          :  +- FileScan parquet [ws_sold_date_sk#5590,ws_quantity#5608,ws_list_price#5610] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5590)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41860]
                                             +- Project [d_date_sk#5624]
                                                +- Filter (((isnotnull(d_year#5630) AND (d_year#5630 >= 1999)) AND (d_year#5630 <= 2001)) AND isnotnull(d_date_sk#5624))
                                                   +- FileScan parquet [d_date_sk#5624,d_year#5630] Batched: true, DataFilters: [isnotnull(d_year#5630), (d_year#5630 >= 1999), (d_year#5630 <= 2001), isnotnull(d_date_sk#5624)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  +- *(83) HashAggregate(keys=[i_brand_id#5755, i_class_id#5757, i_category_id#5759], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5735 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5737 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5755, i_class_id#5757, i_category_id#5759, sales#5327, number_sales#5328L])
                     +- AQEShuffleRead coalesced
                        +- ShuffleQueryStage 120
                           +- Exchange hashpartitioning(i_brand_id#5755, i_class_id#5757, i_category_id#5759, 200), ENSURE_REQUIREMENTS, [id=#53625]
                              +- *(82) HashAggregate(keys=[i_brand_id#5755, i_class_id#5757, i_category_id#5759], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5735 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5737 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5755, i_class_id#5757, i_category_id#5759, sum#5892, isEmpty#5893, count#5894L])
                                 +- *(82) Project [ss_quantity#5735, ss_list_price#5737, i_brand_id#5755, i_class_id#5757, i_category_id#5759]
                                    +- *(82) BroadcastHashJoin [ss_sold_date_sk#5725], [d_date_sk#5770], Inner, BuildRight, false
                                       :- *(82) Project [ss_sold_date_sk#5725, ss_quantity#5735, ss_list_price#5737, i_brand_id#5755, i_class_id#5757, i_category_id#5759]
                                       :  +- *(82) BroadcastHashJoin [ss_item_sk#5727], [i_item_sk#5748], Inner, BuildRight, false
                                       :     :- *(82) BroadcastHashJoin [ss_item_sk#5727], [ss_item_sk#5347], LeftSemi, BuildRight, false
                                       :     :  :- AQEShuffleRead local
                                       :     :  :  +- ShuffleQueryStage 28
                                       :     :  :     +- ReusedExchange [ss_sold_date_sk#5725, ss_item_sk#5727, ss_quantity#5735, ss_list_price#5737], Exchange hashpartitioning(ss_item_sk#5654, 200), ENSURE_REQUIREMENTS, [id=#42513]
                                       :     :  +- BroadcastQueryStage 113
                                       :     :     +- ReusedExchange [ss_item_sk#5347], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#53159]
                                       :     +- BroadcastQueryStage 118
                                       :        +- ReusedExchange [i_item_sk#5748, i_brand_id#5755, i_class_id#5757, i_category_id#5759], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#53370]
                                       +- BroadcastQueryStage 59
                                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#43528]
                                             +- *(34) Project [d_date_sk#5770]
                                                +- *(34) Filter ((isnotnull(d_week_seq#5774) AND (d_week_seq#5774 = Subquery subquery#5330, [id=#41874])) AND isnotnull(d_date_sk#5770))
                                                   :  +- Subquery subquery#5330, [id=#41874]
                                                   :     +- AdaptiveSparkPlan isFinalPlan=true
                                                         +- == Final Plan ==
                                                            *(1) Project [d_week_seq#5832]
                                                            +- *(1) Filter (((((isnotnull(d_year#5834) AND isnotnull(d_moy#5836)) AND isnotnull(d_dom#5837)) AND (d_year#5834 = 1999)) AND (d_moy#5836 = 12)) AND (d_dom#5837 = 12))
                                                               +- *(1) ColumnarToRow
                                                                  +- FileScan parquet [d_week_seq#5832,d_year#5834,d_moy#5836,d_dom#5837] Batched: true, DataFilters: [isnotnull(d_year#5834), isnotnull(d_moy#5836), isnotnull(d_dom#5837), (d_year#5834 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                         +- == Initial Plan ==
                                                            Project [d_week_seq#5832]
                                                            +- Filter (((((isnotnull(d_year#5834) AND isnotnull(d_moy#5836)) AND isnotnull(d_dom#5837)) AND (d_year#5834 = 1999)) AND (d_moy#5836 = 12)) AND (d_dom#5837 = 12))
                                                               +- FileScan parquet [d_week_seq#5832,d_year#5834,d_moy#5836,d_dom#5837] Batched: true, DataFilters: [isnotnull(d_year#5834), isnotnull(d_moy#5836), isnotnull(d_dom#5837), (d_year#5834 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                   +- *(34) ColumnarToRow
                                                      +- FileScan parquet [d_date_sk#5770,d_week_seq#5774] Batched: true, DataFilters: [isnotnull(d_week_seq#5774), isnotnull(d_date_sk#5770)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_brand_id#5682 ASC NULLS FIRST,i_class_id#5684 ASC NULLS FIRST,i_category_id#5686 ASC NULLS FIRST], output=[ty_channel#5332,ty_brand#5333,ty_class#5334,ty_category#5335,ty_sales#5336,ty_number_sales#5337L,ly_channel#5338,ly_brand#5339,ly_class#5340,ly_category#5341,ly_sales#5342,ly_number_sales#5343L])
   +- Project [i_brand_id#5682 AS ty_brand#5333, i_class_id#5684 AS ty_class#5334, i_category_id#5686 AS ty_category#5335, sales#5321 AS ty_sales#5336, number_sales#5322L AS ty_number_sales#5337L, i_brand_id#5755 AS ly_brand#5339, i_class_id#5757 AS ly_class#5340, i_category_id#5759 AS ly_category#5341, sales#5327 AS ly_sales#5342, number_sales#5328L AS ly_number_sales#5343L, i_brand_id#5682, i_class_id#5684, i_category_id#5686]
      +- SortMergeJoin [i_brand_id#5682, i_class_id#5684, i_category_id#5686], [i_brand_id#5755, i_class_id#5757, i_category_id#5759], Inner
         :- Sort [i_brand_id#5682 ASC NULLS FIRST, i_class_id#5684 ASC NULLS FIRST, i_category_id#5686 ASC NULLS FIRST], false, 0
         :  +- Filter (isnotnull(sales#5321) AND (cast(sales#5321 as decimal(32,6)) > cast(Subquery subquery#5325, [id=#41782] as decimal(32,6))))
         :     :  +- Subquery subquery#5325, [id=#41782]
         :     :     +- AdaptiveSparkPlan isFinalPlan=false
         :     :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5354])
         :     :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#41780]
         :     :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5897, count#5898L])
         :     :                 +- Union
         :     :                    :- Project [ss_quantity#5487 AS quantity#5348, ss_list_price#5489 AS list_price#5349]
         :     :                    :  +- BroadcastHashJoin [ss_sold_date_sk#5477], [d_date_sk#5500], Inner, BuildRight, false
         :     :                    :     :- Filter isnotnull(ss_sold_date_sk#5477)
         :     :                    :     :  +- FileScan parquet [ss_sold_date_sk#5477,ss_quantity#5487,ss_list_price#5489] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5477)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
         :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41768]
         :     :                    :        +- Project [d_date_sk#5500]
         :     :                    :           +- Filter (((isnotnull(d_year#5506) AND (d_year#5506 >= 1999)) AND (d_year#5506 <= 2001)) AND isnotnull(d_date_sk#5500))
         :     :                    :              +- FileScan parquet [d_date_sk#5500,d_year#5506] Batched: true, DataFilters: [isnotnull(d_year#5506), (d_year#5506 >= 1999), (d_year#5506 <= 2001), isnotnull(d_date_sk#5500)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :                    :- Project [cs_quantity#5546 AS quantity#5350, cs_list_price#5548 AS list_price#5351]
         :     :                    :  +- BroadcastHashJoin [cs_sold_date_sk#5528], [d_date_sk#5562], Inner, BuildRight, false
         :     :                    :     :- Filter isnotnull(cs_sold_date_sk#5528)
         :     :                    :     :  +- FileScan parquet [cs_sold_date_sk#5528,cs_quantity#5546,cs_list_price#5548] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
         :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41771]
         :     :                    :        +- Project [d_date_sk#5562]
         :     :                    :           +- Filter (((isnotnull(d_year#5568) AND (d_year#5568 >= 1999)) AND (d_year#5568 <= 2001)) AND isnotnull(d_date_sk#5562))
         :     :                    :              +- FileScan parquet [d_date_sk#5562,d_year#5568] Batched: true, DataFilters: [isnotnull(d_year#5568), (d_year#5568 >= 1999), (d_year#5568 <= 2001), isnotnull(d_date_sk#5562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     :                    +- Project [ws_quantity#5608 AS quantity#5352, ws_list_price#5610 AS list_price#5353]
         :     :                       +- BroadcastHashJoin [ws_sold_date_sk#5590], [d_date_sk#5624], Inner, BuildRight, false
         :     :                          :- Filter isnotnull(ws_sold_date_sk#5590)
         :     :                          :  +- FileScan parquet [ws_sold_date_sk#5590,ws_quantity#5608,ws_list_price#5610] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5590)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
         :     :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41774]
         :     :                             +- Project [d_date_sk#5624]
         :     :                                +- Filter (((isnotnull(d_year#5630) AND (d_year#5630 >= 1999)) AND (d_year#5630 <= 2001)) AND isnotnull(d_date_sk#5624))
         :     :                                   +- FileScan parquet [d_date_sk#5624,d_year#5630] Batched: true, DataFilters: [isnotnull(d_year#5630), (d_year#5630 >= 1999), (d_year#5630 <= 2001), isnotnull(d_date_sk#5624)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     +- HashAggregate(keys=[i_brand_id#5682, i_class_id#5684, i_category_id#5686], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5662 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5664 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5682, i_class_id#5684, i_category_id#5686, sales#5321, number_sales#5322L])
         :        +- Exchange hashpartitioning(i_brand_id#5682, i_class_id#5684, i_category_id#5686, 200), ENSURE_REQUIREMENTS, [id=#42116]
         :           +- HashAggregate(keys=[i_brand_id#5682, i_class_id#5684, i_category_id#5686], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5662 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5664 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5682, i_class_id#5684, i_category_id#5686, sum#5886, isEmpty#5887, count#5888L])
         :              +- Project [ss_quantity#5662, ss_list_price#5664, i_brand_id#5682, i_class_id#5684, i_category_id#5686]
         :                 +- BroadcastHashJoin [ss_sold_date_sk#5652], [d_date_sk#5697], Inner, BuildRight, false
         :                    :- Project [ss_sold_date_sk#5652, ss_quantity#5662, ss_list_price#5664, i_brand_id#5682, i_class_id#5684, i_category_id#5686]
         :                    :  +- BroadcastHashJoin [ss_item_sk#5654], [i_item_sk#5675], Inner, BuildRight, false
         :                    :     :- SortMergeJoin [ss_item_sk#5654], [ss_item_sk#5347], LeftSemi
         :                    :     :  :- Sort [ss_item_sk#5654 ASC NULLS FIRST], false, 0
         :                    :     :  :  +- Exchange hashpartitioning(ss_item_sk#5654, 200), ENSURE_REQUIREMENTS, [id=#42046]
         :                    :     :  :     +- Filter (isnotnull(ss_item_sk#5654) AND isnotnull(ss_sold_date_sk#5652))
         :                    :     :  :        +- FileScan parquet [ss_sold_date_sk#5652,ss_item_sk#5654,ss_quantity#5662,ss_list_price#5664] Batched: true, DataFilters: [isnotnull(ss_item_sk#5654), isnotnull(ss_sold_date_sk#5652)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
         :                    :     :  +- Sort [ss_item_sk#5347 ASC NULLS FIRST], false, 0
         :                    :     :     +- Exchange hashpartitioning(ss_item_sk#5347, 200), ENSURE_REQUIREMENTS, [id=#42047]
         :                    :     :        +- Project [i_item_sk#500 AS ss_item_sk#5347]
         :                    :     :           +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#5344, class_id#5345, category_id#5346], Inner, BuildLeft, false
         :                    :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#42041]
         :                    :     :              :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
         :                    :     :              :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :              +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :     :                 +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42038]
         :                    :     :                    +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :     :                       +- SortMergeJoin [coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346)], [coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438)], LeftSemi
         :                    :     :                          :- Sort [coalesce(brand_id#5344, 0) ASC NULLS FIRST, isnull(brand_id#5344) ASC NULLS FIRST, coalesce(class_id#5345, 0) ASC NULLS FIRST, isnull(class_id#5345) ASC NULLS FIRST, coalesce(category_id#5346, 0) ASC NULLS FIRST, isnull(category_id#5346) ASC NULLS FIRST], false, 0
         :                    :     :                          :  +- Exchange hashpartitioning(coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346), 200), ENSURE_REQUIREMENTS, [id=#42031]
         :                    :     :                          :     +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :     :                          :        +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42020]
         :                    :     :                          :           +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :     :                          :              +- Project [i_brand_id#5362 AS brand_id#5344, i_class_id#5364 AS class_id#5345, i_category_id#5366 AS category_id#5346]
         :                    :     :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
         :                    :     :                          :                    :- Project [ss_sold_date_sk#664, i_brand_id#5362, i_class_id#5364, i_category_id#5366]
         :                    :     :                          :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#5355], Inner, BuildRight, false
         :                    :     :                          :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
         :                    :     :                          :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :     :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42011]
         :                    :     :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366)], [coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388)], LeftSemi
         :                    :     :                          :                    :           :- Sort [coalesce(i_brand_id#5362, 0) ASC NULLS FIRST, isnull(i_brand_id#5362) ASC NULLS FIRST, coalesce(i_class_id#5364, 0) ASC NULLS FIRST, isnull(i_class_id#5364) ASC NULLS FIRST, coalesce(i_category_id#5366, 0) ASC NULLS FIRST, isnull(i_category_id#5366) ASC NULLS FIRST], false, 0
         :                    :     :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366), 200), ENSURE_REQUIREMENTS, [id=#42005]
         :                    :     :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#5355) AND isnotnull(i_brand_id#5362)) AND isnotnull(i_class_id#5364)) AND isnotnull(i_category_id#5366))
         :                    :     :                          :                    :           :        +- FileScan parquet [i_item_sk#5355,i_brand_id#5362,i_class_id#5364,i_category_id#5366] Batched: true, DataFilters: [isnotnull(i_item_sk#5355), isnotnull(i_brand_id#5362), isnotnull(i_class_id#5364), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :                          :                    :           +- Sort [coalesce(i_brand_id#5384, 0) ASC NULLS FIRST, isnull(i_brand_id#5384) ASC NULLS FIRST, coalesce(i_class_id#5386, 0) ASC NULLS FIRST, isnull(i_class_id#5386) ASC NULLS FIRST, coalesce(i_category_id#5388, 0) ASC NULLS FIRST, isnull(i_category_id#5388) ASC NULLS FIRST], false, 0
         :                    :     :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388), 200), ENSURE_REQUIREMENTS, [id=#42006]
         :                    :     :                          :                    :                 +- Project [i_brand_id#5384, i_class_id#5386, i_category_id#5388]
         :                    :     :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#5399], Inner, BuildRight, false
         :                    :     :                          :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#5384, i_class_id#5386, i_category_id#5388]
         :                    :     :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#5377], Inner, BuildRight, false
         :                    :     :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
         :                    :     :                          :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :     :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#41996]
         :                    :     :                          :                    :                       :        +- Filter isnotnull(i_item_sk#5377)
         :                    :     :                          :                    :                       :           +- FileScan parquet [i_item_sk#5377,i_brand_id#5384,i_class_id#5386,i_category_id#5388] Batched: true, DataFilters: [isnotnull(i_item_sk#5377)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42000]
         :                    :     :                          :                    :                          +- Project [d_date_sk#5399]
         :                    :     :                          :                    :                             +- Filter (((isnotnull(d_year#5405) AND (d_year#5405 >= 1999)) AND (d_year#5405 <= 2001)) AND isnotnull(d_date_sk#5399))
         :                    :     :                          :                    :                                +- FileScan parquet [d_date_sk#5399,d_year#5405] Batched: true, DataFilters: [isnotnull(d_year#5405), (d_year#5405 >= 1999), (d_year#5405 <= 2001), isnotnull(d_date_sk#5399)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42015]
         :                    :     :                          :                       +- Project [d_date_sk#598]
         :                    :     :                          :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
         :                    :     :                          :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     :                          +- Sort [coalesce(i_brand_id#5434, 0) ASC NULLS FIRST, isnull(i_brand_id#5434) ASC NULLS FIRST, coalesce(i_class_id#5436, 0) ASC NULLS FIRST, isnull(i_class_id#5436) ASC NULLS FIRST, coalesce(i_category_id#5438, 0) ASC NULLS FIRST, isnull(i_category_id#5438) ASC NULLS FIRST], false, 0
         :                    :     :                             +- Exchange hashpartitioning(coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438), 200), ENSURE_REQUIREMENTS, [id=#42032]
         :                    :     :                                +- Project [i_brand_id#5434, i_class_id#5436, i_category_id#5438]
         :                    :     :                                   +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#5449], Inner, BuildRight, false
         :                    :     :                                      :- Project [ws_sold_date_sk#384, i_brand_id#5434, i_class_id#5436, i_category_id#5438]
         :                    :     :                                      :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#5427], Inner, BuildRight, false
         :                    :     :                                      :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
         :                    :     :                                      :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42022]
         :                    :     :                                      :        +- Filter isnotnull(i_item_sk#5427)
         :                    :     :                                      :           +- FileScan parquet [i_item_sk#5427,i_brand_id#5434,i_class_id#5436,i_category_id#5438] Batched: true, DataFilters: [isnotnull(i_item_sk#5427)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42026]
         :                    :     :                                         +- Project [d_date_sk#5449]
         :                    :     :                                            +- Filter (((isnotnull(d_year#5455) AND (d_year#5455 >= 1999)) AND (d_year#5455 <= 2001)) AND isnotnull(d_date_sk#5449))
         :                    :     :                                               +- FileScan parquet [d_date_sk#5449,d_year#5455] Batched: true, DataFilters: [isnotnull(d_year#5455), (d_year#5455 >= 1999), (d_year#5455 <= 2001), isnotnull(d_date_sk#5449)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42107]
         :                    :        +- SortMergeJoin [i_item_sk#5675], [ss_item_sk#5347], LeftSemi
         :                    :           :- Sort [i_item_sk#5675 ASC NULLS FIRST], false, 0
         :                    :           :  +- Exchange hashpartitioning(i_item_sk#5675, 200), ENSURE_REQUIREMENTS, [id=#42101]
         :                    :           :     +- Filter (((isnotnull(i_item_sk#5675) AND isnotnull(i_brand_id#5682)) AND isnotnull(i_class_id#5684)) AND isnotnull(i_category_id#5686))
         :                    :           :        +- FileScan parquet [i_item_sk#5675,i_brand_id#5682,i_class_id#5684,i_category_id#5686] Batched: true, DataFilters: [isnotnull(i_item_sk#5675), isnotnull(i_brand_id#5682), isnotnull(i_class_id#5684), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           +- Sort [ss_item_sk#5347 ASC NULLS FIRST], false, 0
         :                    :              +- Exchange hashpartitioning(ss_item_sk#5347, 200), ENSURE_REQUIREMENTS, [id=#42102]
         :                    :                 +- Project [i_item_sk#500 AS ss_item_sk#5347]
         :                    :                    +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#5344, class_id#5345, category_id#5346], Inner, BuildLeft, false
         :                    :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#42096]
         :                    :                       :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
         :                    :                       :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                       +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :                          +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42093]
         :                    :                             +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :                                +- SortMergeJoin [coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346)], [coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438)], LeftSemi
         :                    :                                   :- Sort [coalesce(brand_id#5344, 0) ASC NULLS FIRST, isnull(brand_id#5344) ASC NULLS FIRST, coalesce(class_id#5345, 0) ASC NULLS FIRST, isnull(class_id#5345) ASC NULLS FIRST, coalesce(category_id#5346, 0) ASC NULLS FIRST, isnull(category_id#5346) ASC NULLS FIRST], false, 0
         :                    :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346), 200), ENSURE_REQUIREMENTS, [id=#42086]
         :                    :                                   :     +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :                                   :        +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42075]
         :                    :                                   :           +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
         :                    :                                   :              +- Project [i_brand_id#5362 AS brand_id#5344, i_class_id#5364 AS class_id#5345, i_category_id#5366 AS category_id#5346]
         :                    :                                   :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
         :                    :                                   :                    :- Project [ss_sold_date_sk#664, i_brand_id#5362, i_class_id#5364, i_category_id#5366]
         :                    :                                   :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#5355], Inner, BuildRight, false
         :                    :                                   :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
         :                    :                                   :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :                                   :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42066]
         :                    :                                   :                    :        +- SortMergeJoin [coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366)], [coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388)], LeftSemi
         :                    :                                   :                    :           :- Sort [coalesce(i_brand_id#5362, 0) ASC NULLS FIRST, isnull(i_brand_id#5362) ASC NULLS FIRST, coalesce(i_class_id#5364, 0) ASC NULLS FIRST, isnull(i_class_id#5364) ASC NULLS FIRST, coalesce(i_category_id#5366, 0) ASC NULLS FIRST, isnull(i_category_id#5366) ASC NULLS FIRST], false, 0
         :                    :                                   :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366), 200), ENSURE_REQUIREMENTS, [id=#42060]
         :                    :                                   :                    :           :     +- Filter (((isnotnull(i_item_sk#5355) AND isnotnull(i_brand_id#5362)) AND isnotnull(i_class_id#5364)) AND isnotnull(i_category_id#5366))
         :                    :                                   :                    :           :        +- FileScan parquet [i_item_sk#5355,i_brand_id#5362,i_class_id#5364,i_category_id#5366] Batched: true, DataFilters: [isnotnull(i_item_sk#5355), isnotnull(i_brand_id#5362), isnotnull(i_class_id#5364), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                   :                    :           +- Sort [coalesce(i_brand_id#5384, 0) ASC NULLS FIRST, isnull(i_brand_id#5384) ASC NULLS FIRST, coalesce(i_class_id#5386, 0) ASC NULLS FIRST, isnull(i_class_id#5386) ASC NULLS FIRST, coalesce(i_category_id#5388, 0) ASC NULLS FIRST, isnull(i_category_id#5388) ASC NULLS FIRST], false, 0
         :                    :                                   :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388), 200), ENSURE_REQUIREMENTS, [id=#42061]
         :                    :                                   :                    :                 +- Project [i_brand_id#5384, i_class_id#5386, i_category_id#5388]
         :                    :                                   :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#5399], Inner, BuildRight, false
         :                    :                                   :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#5384, i_class_id#5386, i_category_id#5388]
         :                    :                                   :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#5377], Inner, BuildRight, false
         :                    :                                   :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
         :                    :                                   :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :                                   :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42051]
         :                    :                                   :                    :                       :        +- Filter isnotnull(i_item_sk#5377)
         :                    :                                   :                    :                       :           +- FileScan parquet [i_item_sk#5377,i_brand_id#5384,i_class_id#5386,i_category_id#5388] Batched: true, DataFilters: [isnotnull(i_item_sk#5377)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                   :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42055]
         :                    :                                   :                    :                          +- Project [d_date_sk#5399]
         :                    :                                   :                    :                             +- Filter (((isnotnull(d_year#5405) AND (d_year#5405 >= 1999)) AND (d_year#5405 <= 2001)) AND isnotnull(d_date_sk#5399))
         :                    :                                   :                    :                                +- FileScan parquet [d_date_sk#5399,d_year#5405] Batched: true, DataFilters: [isnotnull(d_year#5405), (d_year#5405 >= 1999), (d_year#5405 <= 2001), isnotnull(d_date_sk#5399)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :                                   :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42070]
         :                    :                                   :                       +- Project [d_date_sk#598]
         :                    :                                   :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
         :                    :                                   :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :                                   +- Sort [coalesce(i_brand_id#5434, 0) ASC NULLS FIRST, isnull(i_brand_id#5434) ASC NULLS FIRST, coalesce(i_class_id#5436, 0) ASC NULLS FIRST, isnull(i_class_id#5436) ASC NULLS FIRST, coalesce(i_category_id#5438, 0) ASC NULLS FIRST, isnull(i_category_id#5438) ASC NULLS FIRST], false, 0
         :                    :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438), 200), ENSURE_REQUIREMENTS, [id=#42087]
         :                    :                                         +- Project [i_brand_id#5434, i_class_id#5436, i_category_id#5438]
         :                    :                                            +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#5449], Inner, BuildRight, false
         :                    :                                               :- Project [ws_sold_date_sk#384, i_brand_id#5434, i_class_id#5436, i_category_id#5438]
         :                    :                                               :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#5427], Inner, BuildRight, false
         :                    :                                               :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
         :                    :                                               :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42077]
         :                    :                                               :        +- Filter isnotnull(i_item_sk#5427)
         :                    :                                               :           +- FileScan parquet [i_item_sk#5427,i_brand_id#5434,i_class_id#5436,i_category_id#5438] Batched: true, DataFilters: [isnotnull(i_item_sk#5427)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42081]
         :                    :                                                  +- Project [d_date_sk#5449]
         :                    :                                                     +- Filter (((isnotnull(d_year#5455) AND (d_year#5455 >= 1999)) AND (d_year#5455 <= 2001)) AND isnotnull(d_date_sk#5449))
         :                    :                                                        +- FileScan parquet [d_date_sk#5449,d_year#5455] Batched: true, DataFilters: [isnotnull(d_year#5455), (d_year#5455 >= 1999), (d_year#5455 <= 2001), isnotnull(d_date_sk#5449)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42111]
         :                       +- Project [d_date_sk#5697]
         :                          +- Filter ((isnotnull(d_week_seq#5701) AND (d_week_seq#5701 = Subquery subquery#5324, [id=#41788])) AND isnotnull(d_date_sk#5697))
         :                             :  +- Subquery subquery#5324, [id=#41788]
         :                             :     +- AdaptiveSparkPlan isFinalPlan=true
                                             +- == Final Plan ==
                                                *(1) Project [d_week_seq#5804]
                                                +- *(1) Filter (((((isnotnull(d_year#5806) AND isnotnull(d_moy#5808)) AND isnotnull(d_dom#5809)) AND (d_year#5806 = 2000)) AND (d_moy#5808 = 12)) AND (d_dom#5809 = 12))
                                                   +- *(1) ColumnarToRow
                                                      +- FileScan parquet [d_week_seq#5804,d_year#5806,d_moy#5808,d_dom#5809] Batched: true, DataFilters: [isnotnull(d_year#5806), isnotnull(d_moy#5808), isnotnull(d_dom#5809), (d_year#5806 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                             +- == Initial Plan ==
                                                Project [d_week_seq#5804]
                                                +- Filter (((((isnotnull(d_year#5806) AND isnotnull(d_moy#5808)) AND isnotnull(d_dom#5809)) AND (d_year#5806 = 2000)) AND (d_moy#5808 = 12)) AND (d_dom#5809 = 12))
                                                   +- FileScan parquet [d_week_seq#5804,d_year#5806,d_moy#5808,d_dom#5809] Batched: true, DataFilters: [isnotnull(d_year#5806), isnotnull(d_moy#5808), isnotnull(d_dom#5809), (d_year#5806 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
         :                             +- FileScan parquet [d_date_sk#5697,d_week_seq#5701] Batched: true, DataFilters: [isnotnull(d_week_seq#5701), isnotnull(d_date_sk#5697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
         +- Sort [i_brand_id#5755 ASC NULLS FIRST, i_class_id#5757 ASC NULLS FIRST, i_category_id#5759 ASC NULLS FIRST], false, 0
            +- Filter (isnotnull(sales#5327) AND (cast(sales#5327 as decimal(32,6)) > cast(Subquery subquery#5331, [id=#41868] as decimal(32,6))))
               :  +- Subquery subquery#5331, [id=#41868]
               :     +- AdaptiveSparkPlan isFinalPlan=true
                     +- == Final Plan ==
                        *(8) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5354])
                        +- ShuffleQueryStage 6
                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#53912]
                              +- *(7) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5897, count#5898L])
                                 +- Union
                                    :- *(4) Project [ss_quantity#5487 AS quantity#5348, ss_list_price#5489 AS list_price#5349]
                                    :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#5477], [d_date_sk#5500], Inner, BuildRight, false
                                    :     :- *(4) Filter isnotnull(ss_sold_date_sk#5477)
                                    :     :  +- *(4) ColumnarToRow
                                    :     :     +- FileScan parquet [ss_sold_date_sk#5477,ss_quantity#5487,ss_list_price#5489] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5477)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                    :     +- BroadcastQueryStage 1
                                    :        +- ReusedExchange [d_date_sk#5500], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
                                    :- *(5) Project [cs_quantity#5546 AS quantity#5350, cs_list_price#5548 AS list_price#5351]
                                    :  +- *(5) BroadcastHashJoin [cs_sold_date_sk#5528], [d_date_sk#5562], Inner, BuildRight, false
                                    :     :- *(5) Filter isnotnull(cs_sold_date_sk#5528)
                                    :     :  +- *(5) ColumnarToRow
                                    :     :     +- FileScan parquet [cs_sold_date_sk#5528,cs_quantity#5546,cs_list_price#5548] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                    :     +- BroadcastQueryStage 3
                                    :        +- ReusedExchange [d_date_sk#5562], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
                                    +- *(6) Project [ws_quantity#5608 AS quantity#5352, ws_list_price#5610 AS list_price#5353]
                                       +- *(6) BroadcastHashJoin [ws_sold_date_sk#5590], [d_date_sk#5624], Inner, BuildRight, false
                                          :- *(6) Filter isnotnull(ws_sold_date_sk#5590)
                                          :  +- *(6) ColumnarToRow
                                          :     +- FileScan parquet [ws_sold_date_sk#5590,ws_quantity#5608,ws_list_price#5610] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5590)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                          +- BroadcastQueryStage 5
                                             +- ReusedExchange [d_date_sk#5624], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42581]
                     +- == Initial Plan ==
                        HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5354])
                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#41866]
                           +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5348 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5349 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5897, count#5898L])
                              +- Union
                                 :- Project [ss_quantity#5487 AS quantity#5348, ss_list_price#5489 AS list_price#5349]
                                 :  +- BroadcastHashJoin [ss_sold_date_sk#5477], [d_date_sk#5500], Inner, BuildRight, false
                                 :     :- Filter isnotnull(ss_sold_date_sk#5477)
                                 :     :  +- FileScan parquet [ss_sold_date_sk#5477,ss_quantity#5487,ss_list_price#5489] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5477)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41854]
                                 :        +- Project [d_date_sk#5500]
                                 :           +- Filter (((isnotnull(d_year#5506) AND (d_year#5506 >= 1999)) AND (d_year#5506 <= 2001)) AND isnotnull(d_date_sk#5500))
                                 :              +- FileScan parquet [d_date_sk#5500,d_year#5506] Batched: true, DataFilters: [isnotnull(d_year#5506), (d_year#5506 >= 1999), (d_year#5506 <= 2001), isnotnull(d_date_sk#5500)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :- Project [cs_quantity#5546 AS quantity#5350, cs_list_price#5548 AS list_price#5351]
                                 :  +- BroadcastHashJoin [cs_sold_date_sk#5528], [d_date_sk#5562], Inner, BuildRight, false
                                 :     :- Filter isnotnull(cs_sold_date_sk#5528)
                                 :     :  +- FileScan parquet [cs_sold_date_sk#5528,cs_quantity#5546,cs_list_price#5548] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                 :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41857]
                                 :        +- Project [d_date_sk#5562]
                                 :           +- Filter (((isnotnull(d_year#5568) AND (d_year#5568 >= 1999)) AND (d_year#5568 <= 2001)) AND isnotnull(d_date_sk#5562))
                                 :              +- FileScan parquet [d_date_sk#5562,d_year#5568] Batched: true, DataFilters: [isnotnull(d_year#5568), (d_year#5568 >= 1999), (d_year#5568 <= 2001), isnotnull(d_date_sk#5562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 +- Project [ws_quantity#5608 AS quantity#5352, ws_list_price#5610 AS list_price#5353]
                                    +- BroadcastHashJoin [ws_sold_date_sk#5590], [d_date_sk#5624], Inner, BuildRight, false
                                       :- Filter isnotnull(ws_sold_date_sk#5590)
                                       :  +- FileScan parquet [ws_sold_date_sk#5590,ws_quantity#5608,ws_list_price#5610] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5590)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#41860]
                                          +- Project [d_date_sk#5624]
                                             +- Filter (((isnotnull(d_year#5630) AND (d_year#5630 >= 1999)) AND (d_year#5630 <= 2001)) AND isnotnull(d_date_sk#5624))
                                                +- FileScan parquet [d_date_sk#5624,d_year#5630] Batched: true, DataFilters: [isnotnull(d_year#5630), (d_year#5630 >= 1999), (d_year#5630 <= 2001), isnotnull(d_date_sk#5624)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               +- HashAggregate(keys=[i_brand_id#5755, i_class_id#5757, i_category_id#5759], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5735 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5737 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5755, i_class_id#5757, i_category_id#5759, sales#5327, number_sales#5328L])
                  +- Exchange hashpartitioning(i_brand_id#5755, i_class_id#5757, i_category_id#5759, 200), ENSURE_REQUIREMENTS, [id=#42239]
                     +- HashAggregate(keys=[i_brand_id#5755, i_class_id#5757, i_category_id#5759], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5735 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5737 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5755, i_class_id#5757, i_category_id#5759, sum#5892, isEmpty#5893, count#5894L])
                        +- Project [ss_quantity#5735, ss_list_price#5737, i_brand_id#5755, i_class_id#5757, i_category_id#5759]
                           +- BroadcastHashJoin [ss_sold_date_sk#5725], [d_date_sk#5770], Inner, BuildRight, false
                              :- Project [ss_sold_date_sk#5725, ss_quantity#5735, ss_list_price#5737, i_brand_id#5755, i_class_id#5757, i_category_id#5759]
                              :  +- BroadcastHashJoin [ss_item_sk#5727], [i_item_sk#5748], Inner, BuildRight, false
                              :     :- SortMergeJoin [ss_item_sk#5727], [ss_item_sk#5347], LeftSemi
                              :     :  :- Sort [ss_item_sk#5727 ASC NULLS FIRST], false, 0
                              :     :  :  +- Exchange hashpartitioning(ss_item_sk#5727, 200), ENSURE_REQUIREMENTS, [id=#42169]
                              :     :  :     +- Filter (isnotnull(ss_item_sk#5727) AND isnotnull(ss_sold_date_sk#5725))
                              :     :  :        +- FileScan parquet [ss_sold_date_sk#5725,ss_item_sk#5727,ss_quantity#5735,ss_list_price#5737] Batched: true, DataFilters: [isnotnull(ss_item_sk#5727), isnotnull(ss_sold_date_sk#5725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                              :     :  +- Sort [ss_item_sk#5347 ASC NULLS FIRST], false, 0
                              :     :     +- Exchange hashpartitioning(ss_item_sk#5347, 200), ENSURE_REQUIREMENTS, [id=#42170]
                              :     :        +- Project [i_item_sk#500 AS ss_item_sk#5347]
                              :     :           +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#5344, class_id#5345, category_id#5346], Inner, BuildLeft, false
                              :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#42164]
                              :     :              :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                              :     :              :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :              +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :     :                 +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42161]
                              :     :                    +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :     :                       +- SortMergeJoin [coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346)], [coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438)], LeftSemi
                              :     :                          :- Sort [coalesce(brand_id#5344, 0) ASC NULLS FIRST, isnull(brand_id#5344) ASC NULLS FIRST, coalesce(class_id#5345, 0) ASC NULLS FIRST, isnull(class_id#5345) ASC NULLS FIRST, coalesce(category_id#5346, 0) ASC NULLS FIRST, isnull(category_id#5346) ASC NULLS FIRST], false, 0
                              :     :                          :  +- Exchange hashpartitioning(coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346), 200), ENSURE_REQUIREMENTS, [id=#42154]
                              :     :                          :     +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :     :                          :        +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42143]
                              :     :                          :           +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :     :                          :              +- Project [i_brand_id#5362 AS brand_id#5344, i_class_id#5364 AS class_id#5345, i_category_id#5366 AS category_id#5346]
                              :     :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                              :     :                          :                    :- Project [ss_sold_date_sk#664, i_brand_id#5362, i_class_id#5364, i_category_id#5366]
                              :     :                          :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#5355], Inner, BuildRight, false
                              :     :                          :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                              :     :                          :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :     :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42134]
                              :     :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366)], [coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388)], LeftSemi
                              :     :                          :                    :           :- Sort [coalesce(i_brand_id#5362, 0) ASC NULLS FIRST, isnull(i_brand_id#5362) ASC NULLS FIRST, coalesce(i_class_id#5364, 0) ASC NULLS FIRST, isnull(i_class_id#5364) ASC NULLS FIRST, coalesce(i_category_id#5366, 0) ASC NULLS FIRST, isnull(i_category_id#5366) ASC NULLS FIRST], false, 0
                              :     :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366), 200), ENSURE_REQUIREMENTS, [id=#42128]
                              :     :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#5355) AND isnotnull(i_brand_id#5362)) AND isnotnull(i_class_id#5364)) AND isnotnull(i_category_id#5366))
                              :     :                          :                    :           :        +- FileScan parquet [i_item_sk#5355,i_brand_id#5362,i_class_id#5364,i_category_id#5366] Batched: true, DataFilters: [isnotnull(i_item_sk#5355), isnotnull(i_brand_id#5362), isnotnull(i_class_id#5364), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :                          :                    :           +- Sort [coalesce(i_brand_id#5384, 0) ASC NULLS FIRST, isnull(i_brand_id#5384) ASC NULLS FIRST, coalesce(i_class_id#5386, 0) ASC NULLS FIRST, isnull(i_class_id#5386) ASC NULLS FIRST, coalesce(i_category_id#5388, 0) ASC NULLS FIRST, isnull(i_category_id#5388) ASC NULLS FIRST], false, 0
                              :     :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388), 200), ENSURE_REQUIREMENTS, [id=#42129]
                              :     :                          :                    :                 +- Project [i_brand_id#5384, i_class_id#5386, i_category_id#5388]
                              :     :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#5399], Inner, BuildRight, false
                              :     :                          :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#5384, i_class_id#5386, i_category_id#5388]
                              :     :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#5377], Inner, BuildRight, false
                              :     :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                              :     :                          :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :     :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42119]
                              :     :                          :                    :                       :        +- Filter isnotnull(i_item_sk#5377)
                              :     :                          :                    :                       :           +- FileScan parquet [i_item_sk#5377,i_brand_id#5384,i_class_id#5386,i_category_id#5388] Batched: true, DataFilters: [isnotnull(i_item_sk#5377)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42123]
                              :     :                          :                    :                          +- Project [d_date_sk#5399]
                              :     :                          :                    :                             +- Filter (((isnotnull(d_year#5405) AND (d_year#5405 >= 1999)) AND (d_year#5405 <= 2001)) AND isnotnull(d_date_sk#5399))
                              :     :                          :                    :                                +- FileScan parquet [d_date_sk#5399,d_year#5405] Batched: true, DataFilters: [isnotnull(d_year#5405), (d_year#5405 >= 1999), (d_year#5405 <= 2001), isnotnull(d_date_sk#5399)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42138]
                              :     :                          :                       +- Project [d_date_sk#598]
                              :     :                          :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                              :     :                          :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     :                          +- Sort [coalesce(i_brand_id#5434, 0) ASC NULLS FIRST, isnull(i_brand_id#5434) ASC NULLS FIRST, coalesce(i_class_id#5436, 0) ASC NULLS FIRST, isnull(i_class_id#5436) ASC NULLS FIRST, coalesce(i_category_id#5438, 0) ASC NULLS FIRST, isnull(i_category_id#5438) ASC NULLS FIRST], false, 0
                              :     :                             +- Exchange hashpartitioning(coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438), 200), ENSURE_REQUIREMENTS, [id=#42155]
                              :     :                                +- Project [i_brand_id#5434, i_class_id#5436, i_category_id#5438]
                              :     :                                   +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#5449], Inner, BuildRight, false
                              :     :                                      :- Project [ws_sold_date_sk#384, i_brand_id#5434, i_class_id#5436, i_category_id#5438]
                              :     :                                      :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#5427], Inner, BuildRight, false
                              :     :                                      :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                              :     :                                      :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42145]
                              :     :                                      :        +- Filter isnotnull(i_item_sk#5427)
                              :     :                                      :           +- FileScan parquet [i_item_sk#5427,i_brand_id#5434,i_class_id#5436,i_category_id#5438] Batched: true, DataFilters: [isnotnull(i_item_sk#5427)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42149]
                              :     :                                         +- Project [d_date_sk#5449]
                              :     :                                            +- Filter (((isnotnull(d_year#5455) AND (d_year#5455 >= 1999)) AND (d_year#5455 <= 2001)) AND isnotnull(d_date_sk#5449))
                              :     :                                               +- FileScan parquet [d_date_sk#5449,d_year#5455] Batched: true, DataFilters: [isnotnull(d_year#5455), (d_year#5455 >= 1999), (d_year#5455 <= 2001), isnotnull(d_date_sk#5449)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42230]
                              :        +- SortMergeJoin [i_item_sk#5748], [ss_item_sk#5347], LeftSemi
                              :           :- Sort [i_item_sk#5748 ASC NULLS FIRST], false, 0
                              :           :  +- Exchange hashpartitioning(i_item_sk#5748, 200), ENSURE_REQUIREMENTS, [id=#42224]
                              :           :     +- Filter (((isnotnull(i_item_sk#5748) AND isnotnull(i_brand_id#5755)) AND isnotnull(i_class_id#5757)) AND isnotnull(i_category_id#5759))
                              :           :        +- FileScan parquet [i_item_sk#5748,i_brand_id#5755,i_class_id#5757,i_category_id#5759] Batched: true, DataFilters: [isnotnull(i_item_sk#5748), isnotnull(i_brand_id#5755), isnotnull(i_class_id#5757), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           +- Sort [ss_item_sk#5347 ASC NULLS FIRST], false, 0
                              :              +- Exchange hashpartitioning(ss_item_sk#5347, 200), ENSURE_REQUIREMENTS, [id=#42225]
                              :                 +- Project [i_item_sk#500 AS ss_item_sk#5347]
                              :                    +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#5344, class_id#5345, category_id#5346], Inner, BuildLeft, false
                              :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#42219]
                              :                       :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                              :                       :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                       +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :                          +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42216]
                              :                             +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :                                +- SortMergeJoin [coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346)], [coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438)], LeftSemi
                              :                                   :- Sort [coalesce(brand_id#5344, 0) ASC NULLS FIRST, isnull(brand_id#5344) ASC NULLS FIRST, coalesce(class_id#5345, 0) ASC NULLS FIRST, isnull(class_id#5345) ASC NULLS FIRST, coalesce(category_id#5346, 0) ASC NULLS FIRST, isnull(category_id#5346) ASC NULLS FIRST], false, 0
                              :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#5344, 0), isnull(brand_id#5344), coalesce(class_id#5345, 0), isnull(class_id#5345), coalesce(category_id#5346, 0), isnull(category_id#5346), 200), ENSURE_REQUIREMENTS, [id=#42209]
                              :                                   :     +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :                                   :        +- Exchange hashpartitioning(brand_id#5344, class_id#5345, category_id#5346, 200), ENSURE_REQUIREMENTS, [id=#42198]
                              :                                   :           +- HashAggregate(keys=[brand_id#5344, class_id#5345, category_id#5346], functions=[], output=[brand_id#5344, class_id#5345, category_id#5346])
                              :                                   :              +- Project [i_brand_id#5362 AS brand_id#5344, i_class_id#5364 AS class_id#5345, i_category_id#5366 AS category_id#5346]
                              :                                   :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                              :                                   :                    :- Project [ss_sold_date_sk#664, i_brand_id#5362, i_class_id#5364, i_category_id#5366]
                              :                                   :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#5355], Inner, BuildRight, false
                              :                                   :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                              :                                   :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :                                   :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42189]
                              :                                   :                    :        +- SortMergeJoin [coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366)], [coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388)], LeftSemi
                              :                                   :                    :           :- Sort [coalesce(i_brand_id#5362, 0) ASC NULLS FIRST, isnull(i_brand_id#5362) ASC NULLS FIRST, coalesce(i_class_id#5364, 0) ASC NULLS FIRST, isnull(i_class_id#5364) ASC NULLS FIRST, coalesce(i_category_id#5366, 0) ASC NULLS FIRST, isnull(i_category_id#5366) ASC NULLS FIRST], false, 0
                              :                                   :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#5362, 0), isnull(i_brand_id#5362), coalesce(i_class_id#5364, 0), isnull(i_class_id#5364), coalesce(i_category_id#5366, 0), isnull(i_category_id#5366), 200), ENSURE_REQUIREMENTS, [id=#42183]
                              :                                   :                    :           :     +- Filter (((isnotnull(i_item_sk#5355) AND isnotnull(i_brand_id#5362)) AND isnotnull(i_class_id#5364)) AND isnotnull(i_category_id#5366))
                              :                                   :                    :           :        +- FileScan parquet [i_item_sk#5355,i_brand_id#5362,i_class_id#5364,i_category_id#5366] Batched: true, DataFilters: [isnotnull(i_item_sk#5355), isnotnull(i_brand_id#5362), isnotnull(i_class_id#5364), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                   :                    :           +- Sort [coalesce(i_brand_id#5384, 0) ASC NULLS FIRST, isnull(i_brand_id#5384) ASC NULLS FIRST, coalesce(i_class_id#5386, 0) ASC NULLS FIRST, isnull(i_class_id#5386) ASC NULLS FIRST, coalesce(i_category_id#5388, 0) ASC NULLS FIRST, isnull(i_category_id#5388) ASC NULLS FIRST], false, 0
                              :                                   :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#5384, 0), isnull(i_brand_id#5384), coalesce(i_class_id#5386, 0), isnull(i_class_id#5386), coalesce(i_category_id#5388, 0), isnull(i_category_id#5388), 200), ENSURE_REQUIREMENTS, [id=#42184]
                              :                                   :                    :                 +- Project [i_brand_id#5384, i_class_id#5386, i_category_id#5388]
                              :                                   :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#5399], Inner, BuildRight, false
                              :                                   :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#5384, i_class_id#5386, i_category_id#5388]
                              :                                   :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#5377], Inner, BuildRight, false
                              :                                   :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                              :                                   :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :                                   :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42174]
                              :                                   :                    :                       :        +- Filter isnotnull(i_item_sk#5377)
                              :                                   :                    :                       :           +- FileScan parquet [i_item_sk#5377,i_brand_id#5384,i_class_id#5386,i_category_id#5388] Batched: true, DataFilters: [isnotnull(i_item_sk#5377)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                   :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42178]
                              :                                   :                    :                          +- Project [d_date_sk#5399]
                              :                                   :                    :                             +- Filter (((isnotnull(d_year#5405) AND (d_year#5405 >= 1999)) AND (d_year#5405 <= 2001)) AND isnotnull(d_date_sk#5399))
                              :                                   :                    :                                +- FileScan parquet [d_date_sk#5399,d_year#5405] Batched: true, DataFilters: [isnotnull(d_year#5405), (d_year#5405 >= 1999), (d_year#5405 <= 2001), isnotnull(d_date_sk#5399)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :                                   :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42193]
                              :                                   :                       +- Project [d_date_sk#598]
                              :                                   :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                              :                                   :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :                                   +- Sort [coalesce(i_brand_id#5434, 0) ASC NULLS FIRST, isnull(i_brand_id#5434) ASC NULLS FIRST, coalesce(i_class_id#5436, 0) ASC NULLS FIRST, isnull(i_class_id#5436) ASC NULLS FIRST, coalesce(i_category_id#5438, 0) ASC NULLS FIRST, isnull(i_category_id#5438) ASC NULLS FIRST], false, 0
                              :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#5434, 0), isnull(i_brand_id#5434), coalesce(i_class_id#5436, 0), isnull(i_class_id#5436), coalesce(i_category_id#5438, 0), isnull(i_category_id#5438), 200), ENSURE_REQUIREMENTS, [id=#42210]
                              :                                         +- Project [i_brand_id#5434, i_class_id#5436, i_category_id#5438]
                              :                                            +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#5449], Inner, BuildRight, false
                              :                                               :- Project [ws_sold_date_sk#384, i_brand_id#5434, i_class_id#5436, i_category_id#5438]
                              :                                               :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#5427], Inner, BuildRight, false
                              :                                               :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                              :                                               :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#42200]
                              :                                               :        +- Filter isnotnull(i_item_sk#5427)
                              :                                               :           +- FileScan parquet [i_item_sk#5427,i_brand_id#5434,i_class_id#5436,i_category_id#5438] Batched: true, DataFilters: [isnotnull(i_item_sk#5427)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42204]
                              :                                                  +- Project [d_date_sk#5449]
                              :                                                     +- Filter (((isnotnull(d_year#5455) AND (d_year#5455 >= 1999)) AND (d_year#5455 <= 2001)) AND isnotnull(d_date_sk#5449))
                              :                                                        +- FileScan parquet [d_date_sk#5449,d_year#5455] Batched: true, DataFilters: [isnotnull(d_year#5455), (d_year#5455 >= 1999), (d_year#5455 <= 2001), isnotnull(d_date_sk#5449)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#42234]
                                 +- Project [d_date_sk#5770]
                                    +- Filter ((isnotnull(d_week_seq#5774) AND (d_week_seq#5774 = Subquery subquery#5330, [id=#41874])) AND isnotnull(d_date_sk#5770))
                                       :  +- Subquery subquery#5330, [id=#41874]
                                       :     +- AdaptiveSparkPlan isFinalPlan=true
                                             +- == Final Plan ==
                                                *(1) Project [d_week_seq#5832]
                                                +- *(1) Filter (((((isnotnull(d_year#5834) AND isnotnull(d_moy#5836)) AND isnotnull(d_dom#5837)) AND (d_year#5834 = 1999)) AND (d_moy#5836 = 12)) AND (d_dom#5837 = 12))
                                                   +- *(1) ColumnarToRow
                                                      +- FileScan parquet [d_week_seq#5832,d_year#5834,d_moy#5836,d_dom#5837] Batched: true, DataFilters: [isnotnull(d_year#5834), isnotnull(d_moy#5836), isnotnull(d_dom#5837), (d_year#5834 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                             +- == Initial Plan ==
                                                Project [d_week_seq#5832]
                                                +- Filter (((((isnotnull(d_year#5834) AND isnotnull(d_moy#5836)) AND isnotnull(d_dom#5837)) AND (d_year#5834 = 1999)) AND (d_moy#5836 = 12)) AND (d_dom#5837 = 12))
                                                   +- FileScan parquet [d_week_seq#5832,d_year#5834,d_moy#5836,d_dom#5837] Batched: true, DataFilters: [isnotnull(d_year#5834), isnotnull(d_moy#5836), isnotnull(d_dom#5837), (d_year#5834 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                       +- FileScan parquet [d_date_sk#5770,d_week_seq#5774] Batched: true, DataFilters: [isnotnull(d_week_seq#5774), isnotnull(d_date_sk#5770)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
