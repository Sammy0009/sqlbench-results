Sort [d_week_seq1#985 ASC NULLS FIRST], true
+- Project [d_week_seq1#985, round(CheckOverflow((promote_precision(sun_sales1#986) / promote_precision(sun_sales2#994)), DecimalType(37,20), true), 2) AS round((sun_sales1 / sun_sales2), 2)#1075, round(CheckOverflow((promote_precision(mon_sales1#987) / promote_precision(mon_sales2#995)), DecimalType(37,20), true), 2) AS round((mon_sales1 / mon_sales2), 2)#1076, round(CheckOverflow((promote_precision(tue_sales1#988) / promote_precision(tue_sales2#996)), DecimalType(37,20), true), 2) AS round((tue_sales1 / tue_sales2), 2)#1077, round(CheckOverflow((promote_precision(wed_sales1#989) / promote_precision(wed_sales2#997)), DecimalType(37,20), true), 2) AS round((wed_sales1 / wed_sales2), 2)#1078, round(CheckOverflow((promote_precision(thu_sales1#990) / promote_precision(thu_sales2#998)), DecimalType(37,20), true), 2) AS round((thu_sales1 / thu_sales2), 2)#1079, round(CheckOverflow((promote_precision(fri_sales1#991) / promote_precision(fri_sales2#999)), DecimalType(37,20), true), 2) AS round((fri_sales1 / fri_sales2), 2)#1080, round(CheckOverflow((promote_precision(sat_sales1#992) / promote_precision(sat_sales2#1000)), DecimalType(37,20), true), 2) AS round((sat_sales1 / sat_sales2), 2)#1081]
   +- Join Inner, (d_week_seq1#985 = (d_week_seq2#993 - 53))
      :- Project [d_week_seq#616 AS d_week_seq1#985, sun_sales#1005 AS sun_sales1#986, mon_sales#1006 AS mon_sales1#987, tue_sales#1007 AS tue_sales1#988, wed_sales#1008 AS wed_sales1#989, thu_sales#1009 AS thu_sales1#990, fri_sales#1010 AS fri_sales1#991, sat_sales#1011 AS sat_sales1#992]
      :  +- Join Inner, (d_week_seq#1016 = d_week_seq#616)
      :     :- Aggregate [d_week_seq#616], [d_week_seq#616, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN sales_price#1002 END)),17,2) AS sun_sales#1005, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN sales_price#1002 END)),17,2) AS mon_sales#1006, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN sales_price#1002 END)),17,2) AS tue_sales#1007, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN sales_price#1002 END)),17,2) AS wed_sales#1008, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN sales_price#1002 END)),17,2) AS thu_sales#1009, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN sales_price#1002 END)),17,2) AS fri_sales#1010, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN sales_price#1002 END)),17,2) AS sat_sales#1011]
      :     :  +- Project [sales_price#1002, d_week_seq#616, d_day_name#626]
      :     :     +- Join Inner, (d_date_sk#612 = sold_date_sk#1001)
      :     :        :- Union false, false
      :     :        :  :- Project [ws_sold_date_sk#476 AS sold_date_sk#1001, ws_ext_sales_price#499 AS sales_price#1002]
      :     :        :  :  +- Filter isnotnull(ws_sold_date_sk#476)
      :     :        :  :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
      :     :        :  +- Project [cs_sold_date_sk#544 AS sold_date_sk#1003, cs_ext_sales_price#567 AS sales_price#1004]
      :     :        :     +- Filter isnotnull(cs_sold_date_sk#544)
      :     :        :        +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
      :     :        +- Project [d_date_sk#612, d_week_seq#616, d_day_name#626]
      :     :           +- Filter (isnotnull(d_date_sk#612) AND isnotnull(d_week_seq#616))
      :     :              +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
      :     +- Project [d_week_seq#1016]
      :        +- Filter ((isnotnull(d_year#1018) AND (d_year#1018 = 1999)) AND isnotnull(d_week_seq#1016))
      :           +- Relation [d_date_sk#1012,d_date_id#1013,d_date#1014,d_month_seq#1015,d_week_seq#1016,d_quarter_seq#1017,d_year#1018,d_dow#1019,d_moy#1020,d_dom#1021,d_qoy#1022,d_fy_year#1023,d_fy_quarter_seq#1024,d_fy_week_seq#1025,d_day_name#1026,d_quarter_name#1027,d_holiday#1028,d_weekend#1029,d_following_holiday#1030,d_first_dom#1031,d_last_dom#1032,d_same_day_ly#1033,d_same_day_lq#1034,d_current_day#1035,... 4 more fields] parquet
      +- Project [d_week_seq#616 AS d_week_seq2#993, sun_sales#1005 AS sun_sales2#994, mon_sales#1006 AS mon_sales2#995, tue_sales#1007 AS tue_sales2#996, wed_sales#1008 AS wed_sales2#997, thu_sales#1009 AS thu_sales2#998, fri_sales#1010 AS fri_sales2#999, sat_sales#1011 AS sat_sales2#1000]
         +- Join Inner, (d_week_seq#1044 = d_week_seq#616)
            :- Aggregate [d_week_seq#616], [d_week_seq#616, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Sunday) THEN sales_price#1002 END)),17,2) AS sun_sales#1005, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Monday) THEN sales_price#1002 END)),17,2) AS mon_sales#1006, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Tuesday) THEN sales_price#1002 END)),17,2) AS tue_sales#1007, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Wednesday) THEN sales_price#1002 END)),17,2) AS wed_sales#1008, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Thursday) THEN sales_price#1002 END)),17,2) AS thu_sales#1009, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Friday) THEN sales_price#1002 END)),17,2) AS fri_sales#1010, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#626 = Saturday) THEN sales_price#1002 END)),17,2) AS sat_sales#1011]
            :  +- Project [sales_price#1002, d_week_seq#616, d_day_name#626]
            :     +- Join Inner, (d_date_sk#612 = sold_date_sk#1001)
            :        :- Union false, false
            :        :  :- Project [ws_sold_date_sk#476 AS sold_date_sk#1001, ws_ext_sales_price#499 AS sales_price#1002]
            :        :  :  +- Filter isnotnull(ws_sold_date_sk#476)
            :        :  :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
            :        :  +- Project [cs_sold_date_sk#544 AS sold_date_sk#1003, cs_ext_sales_price#567 AS sales_price#1004]
            :        :     +- Filter isnotnull(cs_sold_date_sk#544)
            :        :        +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
            :        +- Project [d_date_sk#612, d_week_seq#616, d_day_name#626]
            :           +- Filter (isnotnull(d_date_sk#612) AND isnotnull(d_week_seq#616))
            :              +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            +- Project [d_week_seq#1044]
               +- Filter ((isnotnull(d_year#1046) AND (d_year#1046 = 2000)) AND isnotnull(d_week_seq#1044))
                  +- Relation [d_date_sk#1040,d_date_id#1041,d_date#1042,d_month_seq#1043,d_week_seq#1044,d_quarter_seq#1045,d_year#1046,d_dow#1047,d_moy#1048,d_dom#1049,d_qoy#1050,d_fy_year#1051,d_fy_quarter_seq#1052,d_fy_week_seq#1053,d_day_name#1054,d_quarter_name#1055,d_holiday#1056,d_weekend#1057,d_following_holiday#1058,d_first_dom#1059,d_last_dom#1060,d_same_day_ly#1061,d_same_day_lq#1062,d_current_day#1063,... 4 more fields] parquet
