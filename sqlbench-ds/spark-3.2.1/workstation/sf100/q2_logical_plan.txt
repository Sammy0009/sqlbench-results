Sort [d_week_seq1#891 ASC NULLS FIRST], true
+- Project [d_week_seq1#891, round(CheckOverflow((promote_precision(sun_sales1#892) / promote_precision(sun_sales2#900)), DecimalType(37,20), true), 2) AS round((sun_sales1 / sun_sales2), 2)#981, round(CheckOverflow((promote_precision(mon_sales1#893) / promote_precision(mon_sales2#901)), DecimalType(37,20), true), 2) AS round((mon_sales1 / mon_sales2), 2)#982, round(CheckOverflow((promote_precision(tue_sales1#894) / promote_precision(tue_sales2#902)), DecimalType(37,20), true), 2) AS round((tue_sales1 / tue_sales2), 2)#983, round(CheckOverflow((promote_precision(wed_sales1#895) / promote_precision(wed_sales2#903)), DecimalType(37,20), true), 2) AS round((wed_sales1 / wed_sales2), 2)#984, round(CheckOverflow((promote_precision(thu_sales1#896) / promote_precision(thu_sales2#904)), DecimalType(37,20), true), 2) AS round((thu_sales1 / thu_sales2), 2)#985, round(CheckOverflow((promote_precision(fri_sales1#897) / promote_precision(fri_sales2#905)), DecimalType(37,20), true), 2) AS round((fri_sales1 / fri_sales2), 2)#986, round(CheckOverflow((promote_precision(sat_sales1#898) / promote_precision(sat_sales2#906)), DecimalType(37,20), true), 2) AS round((sat_sales1 / sat_sales2), 2)#987]
   +- Join Inner, (d_week_seq1#891 = (d_week_seq2#899 - 53))
      :- Project [d_week_seq#602 AS d_week_seq1#891, sun_sales#911 AS sun_sales1#892, mon_sales#912 AS mon_sales1#893, tue_sales#913 AS tue_sales1#894, wed_sales#914 AS wed_sales1#895, thu_sales#915 AS thu_sales1#896, fri_sales#916 AS fri_sales1#897, sat_sales#917 AS sat_sales1#898]
      :  +- Join Inner, (d_week_seq#922 = d_week_seq#602)
      :     :- Aggregate [d_week_seq#602], [d_week_seq#602, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Sunday) THEN sales_price#908 END)),17,2) AS sun_sales#911, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Monday) THEN sales_price#908 END)),17,2) AS mon_sales#912, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Tuesday) THEN sales_price#908 END)),17,2) AS tue_sales#913, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Wednesday) THEN sales_price#908 END)),17,2) AS wed_sales#914, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Thursday) THEN sales_price#908 END)),17,2) AS thu_sales#915, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Friday) THEN sales_price#908 END)),17,2) AS fri_sales#916, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Saturday) THEN sales_price#908 END)),17,2) AS sat_sales#917]
      :     :  +- Project [sales_price#908, d_week_seq#602, d_day_name#612]
      :     :     +- Join Inner, (d_date_sk#598 = sold_date_sk#907)
      :     :        :- Union false, false
      :     :        :  :- Project [ws_sold_date_sk#384 AS sold_date_sk#907, ws_ext_sales_price#407 AS sales_price#908]
      :     :        :  :  +- Filter isnotnull(ws_sold_date_sk#384)
      :     :        :  :     +- Relation [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_date_sk#386,ws_item_sk#387,ws_bill_customer_sk#388,ws_bill_cdemo_sk#389,ws_bill_hdemo_sk#390,ws_bill_addr_sk#391,ws_ship_customer_sk#392,ws_ship_cdemo_sk#393,ws_ship_hdemo_sk#394,ws_ship_addr_sk#395,ws_web_page_sk#396,ws_web_site_sk#397,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_promo_sk#400,ws_order_number#401L,ws_quantity#402,ws_wholesale_cost#403,ws_list_price#404,ws_sales_price#405,ws_ext_discount_amt#406,ws_ext_sales_price#407,... 10 more fields] parquet
      :     :        :  +- Project [cs_sold_date_sk#118 AS sold_date_sk#909, cs_ext_sales_price#141 AS sales_price#910]
      :     :        :     +- Filter isnotnull(cs_sold_date_sk#118)
      :     :        :        +- Relation [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_date_sk#120,cs_bill_customer_sk#121,cs_bill_cdemo_sk#122,cs_bill_hdemo_sk#123,cs_bill_addr_sk#124,cs_ship_customer_sk#125,cs_ship_cdemo_sk#126,cs_ship_hdemo_sk#127,cs_ship_addr_sk#128,cs_call_center_sk#129,cs_catalog_page_sk#130,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_item_sk#133,cs_promo_sk#134,cs_order_number#135L,cs_quantity#136,cs_wholesale_cost#137,cs_list_price#138,cs_sales_price#139,cs_ext_discount_amt#140,cs_ext_sales_price#141,... 10 more fields] parquet
      :     :        +- Project [d_date_sk#598, d_week_seq#602, d_day_name#612]
      :     :           +- Filter (isnotnull(d_date_sk#598) AND isnotnull(d_week_seq#602))
      :     :              +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
      :     +- Project [d_week_seq#922]
      :        +- Filter ((isnotnull(d_year#924) AND (d_year#924 = 1999)) AND isnotnull(d_week_seq#922))
      :           +- Relation [d_date_sk#918,d_date_id#919,d_date#920,d_month_seq#921,d_week_seq#922,d_quarter_seq#923,d_year#924,d_dow#925,d_moy#926,d_dom#927,d_qoy#928,d_fy_year#929,d_fy_quarter_seq#930,d_fy_week_seq#931,d_day_name#932,d_quarter_name#933,d_holiday#934,d_weekend#935,d_following_holiday#936,d_first_dom#937,d_last_dom#938,d_same_day_ly#939,d_same_day_lq#940,d_current_day#941,... 4 more fields] parquet
      +- Project [d_week_seq#602 AS d_week_seq2#899, sun_sales#911 AS sun_sales2#900, mon_sales#912 AS mon_sales2#901, tue_sales#913 AS tue_sales2#902, wed_sales#914 AS wed_sales2#903, thu_sales#915 AS thu_sales2#904, fri_sales#916 AS fri_sales2#905, sat_sales#917 AS sat_sales2#906]
         +- Join Inner, (d_week_seq#950 = d_week_seq#602)
            :- Aggregate [d_week_seq#602], [d_week_seq#602, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Sunday) THEN sales_price#908 END)),17,2) AS sun_sales#911, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Monday) THEN sales_price#908 END)),17,2) AS mon_sales#912, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Tuesday) THEN sales_price#908 END)),17,2) AS tue_sales#913, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Wednesday) THEN sales_price#908 END)),17,2) AS wed_sales#914, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Thursday) THEN sales_price#908 END)),17,2) AS thu_sales#915, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Friday) THEN sales_price#908 END)),17,2) AS fri_sales#916, MakeDecimal(sum(UnscaledValue(CASE WHEN (d_day_name#612 = Saturday) THEN sales_price#908 END)),17,2) AS sat_sales#917]
            :  +- Project [sales_price#908, d_week_seq#602, d_day_name#612]
            :     +- Join Inner, (d_date_sk#598 = sold_date_sk#907)
            :        :- Union false, false
            :        :  :- Project [ws_sold_date_sk#384 AS sold_date_sk#907, ws_ext_sales_price#407 AS sales_price#908]
            :        :  :  +- Filter isnotnull(ws_sold_date_sk#384)
            :        :  :     +- Relation [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_date_sk#386,ws_item_sk#387,ws_bill_customer_sk#388,ws_bill_cdemo_sk#389,ws_bill_hdemo_sk#390,ws_bill_addr_sk#391,ws_ship_customer_sk#392,ws_ship_cdemo_sk#393,ws_ship_hdemo_sk#394,ws_ship_addr_sk#395,ws_web_page_sk#396,ws_web_site_sk#397,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_promo_sk#400,ws_order_number#401L,ws_quantity#402,ws_wholesale_cost#403,ws_list_price#404,ws_sales_price#405,ws_ext_discount_amt#406,ws_ext_sales_price#407,... 10 more fields] parquet
            :        :  +- Project [cs_sold_date_sk#118 AS sold_date_sk#909, cs_ext_sales_price#141 AS sales_price#910]
            :        :     +- Filter isnotnull(cs_sold_date_sk#118)
            :        :        +- Relation [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_date_sk#120,cs_bill_customer_sk#121,cs_bill_cdemo_sk#122,cs_bill_hdemo_sk#123,cs_bill_addr_sk#124,cs_ship_customer_sk#125,cs_ship_cdemo_sk#126,cs_ship_hdemo_sk#127,cs_ship_addr_sk#128,cs_call_center_sk#129,cs_catalog_page_sk#130,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_item_sk#133,cs_promo_sk#134,cs_order_number#135L,cs_quantity#136,cs_wholesale_cost#137,cs_list_price#138,cs_sales_price#139,cs_ext_discount_amt#140,cs_ext_sales_price#141,... 10 more fields] parquet
            :        +- Project [d_date_sk#598, d_week_seq#602, d_day_name#612]
            :           +- Filter (isnotnull(d_date_sk#598) AND isnotnull(d_week_seq#602))
            :              +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
            +- Project [d_week_seq#950]
               +- Filter ((isnotnull(d_year#952) AND (d_year#952 = 2000)) AND isnotnull(d_week_seq#950))
                  +- Relation [d_date_sk#946,d_date_id#947,d_date#948,d_month_seq#949,d_week_seq#950,d_quarter_seq#951,d_year#952,d_dow#953,d_moy#954,d_dom#955,d_qoy#956,d_fy_year#957,d_fy_quarter_seq#958,d_fy_week_seq#959,d_day_name#960,d_quarter_name#961,d_holiday#962,d_weekend#963,d_following_holiday#964,d_first_dom#965,d_last_dom#966,d_same_day_ly#967,d_same_day_lq#968,d_current_day#969,... 4 more fields] parquet
