GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#16036 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#16037 as decimal(22,6)))), DecimalType(22,6), true) ASC NULLS FIRST, psum#16039 ASC NULLS FIRST], true
      +- Project [i_category#680, i_brand#676, d_year#618, d_moy#620, avg_monthly_sales#16037, sum_sales#16036, sum_sales#16057 AS psum#16039, sum_sales#16066 AS nsum#16040]
         +- Join Inner, (((((i_category#680 = i_category#16200) AND (i_brand#676 = i_brand#16196)) AND (s_store_name#717 = s_store_name#16266)) AND (s_company_name#729 = s_company_name#16278)) AND (rn#16038 = (rn#16294 - 1)))
            :- Project [i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618, d_moy#620, sum_sales#16036, avg_monthly_sales#16037, rn#16038, sum_sales#16057]
            :  +- Join Inner, (((((i_category#680 = i_category#16093) AND (i_brand#676 = i_brand#16089)) AND (s_store_name#717 = s_store_name#16159)) AND (s_company_name#729 = s_company_name#16171)) AND (rn#16038 = (rn#16187 + 1)))
            :     :- Project [i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618, d_moy#620, sum_sales#16036, avg_monthly_sales#16037, rn#16038]
            :     :  +- Filter ((isnotnull(avg_monthly_sales#16037) AND (avg_monthly_sales#16037 > 0.000000)) AND (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#16036 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#16037 as decimal(22,6)))), DecimalType(22,6), true), false)) / promote_precision(cast(avg_monthly_sales#16037 as decimal(22,6)))), DecimalType(38,16), true) > 0.1000000000000000))
            :     :     +- Window [avg(_w0#16050) windowspecdefinition(i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#16037], [i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618]
            :     :        +- Filter (isnotnull(d_year#618) AND (d_year#618 = 2000))
            :     :           +- Window [rank(d_year#618, d_moy#620) windowspecdefinition(i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618 ASC NULLS FIRST, d_moy#620 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#16038], [i_category#680, i_brand#676, s_store_name#717, s_company_name#729], [d_year#618 ASC NULLS FIRST, d_moy#620 ASC NULLS FIRST]
            :     :              +- Aggregate [i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618, d_moy#620], [i_category#680, i_brand#676, s_store_name#717, s_company_name#729, d_year#618, d_moy#620, MakeDecimal(sum(UnscaledValue(ss_sales_price#265)),17,2) AS sum_sales#16036, MakeDecimal(sum(UnscaledValue(ss_sales_price#265)),17,2) AS _w0#16050]
            :     :                 +- Project [ss_sales_price#265, d_year#618, d_moy#620, i_brand#676, i_category#680, s_store_name#717, s_company_name#729]
            :     :                    +- Join Inner, (ss_store_sk#259 = s_store_sk#712)
            :     :                       :- Project [ss_store_sk#259, ss_sales_price#265, d_year#618, d_moy#620, i_brand#676, i_category#680]
            :     :                       :  +- Join Inner, (ss_item_sk#254 = i_item_sk#668)
            :     :                       :     :- Project [ss_item_sk#254, ss_store_sk#259, ss_sales_price#265, d_year#618, d_moy#620]
            :     :                       :     :  +- Join Inner, (ss_sold_date_sk#252 = d_date_sk#612)
            :     :                       :     :     :- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_store_sk#259, ss_sales_price#265]
            :     :                       :     :     :  +- Filter (isnotnull(ss_sold_date_sk#252) AND (isnotnull(ss_item_sk#254) AND isnotnull(ss_store_sk#259)))
            :     :                       :     :     :     +- Relation [ss_sold_date_sk#252,ss_sold_time_sk#253,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_quantity#262,ss_wholesale_cost#263,ss_list_price#264,ss_sales_price#265,ss_ext_discount_amt#266,ss_ext_sales_price#267,ss_ext_wholesale_cost#268,ss_ext_list_price#269,ss_ext_tax#270,ss_coupon_amt#271,ss_net_paid#272,ss_net_paid_inc_tax#273,ss_net_profit#274] parquet
            :     :                       :     :     +- Project [d_date_sk#612, d_year#618, d_moy#620]
            :     :                       :     :        +- Filter ((((d_year#618 = 2000) OR ((d_year#618 = 1999) AND (d_moy#620 = 12))) OR ((d_year#618 = 2001) AND (d_moy#620 = 1))) AND isnotnull(d_date_sk#612))
            :     :                       :     :           +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :     :                       :     +- Project [i_item_sk#668, i_brand#676, i_category#680]
            :     :                       :        +- Filter (isnotnull(i_item_sk#668) AND (isnotnull(i_category#680) AND isnotnull(i_brand#676)))
            :     :                       :           +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
            :     :                       +- Project [s_store_sk#712, s_store_name#717, s_company_name#729]
            :     :                          +- Filter (isnotnull(s_store_sk#712) AND (isnotnull(s_store_name#717) AND isnotnull(s_company_name#729)))
            :     :                             +- Relation [s_store_sk#712,s_store_id#713,s_rec_start_date#714,s_rec_end_date#715,s_closed_date_sk#716,s_store_name#717,s_number_employees#718,s_floor_space#719,s_hours#720,s_manager#721,s_market_id#722,s_geography_class#723,s_market_desc#724,s_market_manager#725,s_division_id#726,s_division_name#727,s_company_id#728,s_company_name#729,s_street_number#730,s_street_name#731,s_street_type#732,s_suite_number#733,s_city#734,s_county#735,... 5 more fields] parquet
            :     +- Project [i_category#16093, i_brand#16089, s_store_name#16159, s_company_name#16171, sum_sales#16036 AS sum_sales#16057, rn#16187]
            :        +- Window [rank(d_year#16132, d_moy#16134) windowspecdefinition(i_category#16093, i_brand#16089, s_store_name#16159, s_company_name#16171, d_year#16132 ASC NULLS FIRST, d_moy#16134 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#16187], [i_category#16093, i_brand#16089, s_store_name#16159, s_company_name#16171], [d_year#16132 ASC NULLS FIRST, d_moy#16134 ASC NULLS FIRST]
            :           +- Aggregate [i_category#16093, i_brand#16089, s_store_name#16159, s_company_name#16171, d_year#16132, d_moy#16134], [i_category#16093, i_brand#16089, s_store_name#16159, s_company_name#16171, d_year#16132, d_moy#16134, MakeDecimal(sum(UnscaledValue(ss_sales_price#16116)),17,2) AS sum_sales#16036]
            :              +- Project [ss_sales_price#16116, d_year#16132, d_moy#16134, i_brand#16089, i_category#16093, s_store_name#16159, s_company_name#16171]
            :                 +- Join Inner, (ss_store_sk#16110 = s_store_sk#16154)
            :                    :- Project [ss_store_sk#16110, ss_sales_price#16116, d_year#16132, d_moy#16134, i_brand#16089, i_category#16093]
            :                    :  +- Join Inner, (ss_item_sk#16105 = i_item_sk#16081)
            :                    :     :- Project [ss_item_sk#16105, ss_store_sk#16110, ss_sales_price#16116, d_year#16132, d_moy#16134]
            :                    :     :  +- Join Inner, (ss_sold_date_sk#16103 = d_date_sk#16126)
            :                    :     :     :- Project [ss_sold_date_sk#16103, ss_item_sk#16105, ss_store_sk#16110, ss_sales_price#16116]
            :                    :     :     :  +- Filter (isnotnull(ss_sold_date_sk#16103) AND (isnotnull(ss_item_sk#16105) AND isnotnull(ss_store_sk#16110)))
            :                    :     :     :     +- Relation [ss_sold_date_sk#16103,ss_sold_time_sk#16104,ss_item_sk#16105,ss_customer_sk#16106,ss_cdemo_sk#16107,ss_hdemo_sk#16108,ss_addr_sk#16109,ss_store_sk#16110,ss_promo_sk#16111,ss_ticket_number#16112L,ss_quantity#16113,ss_wholesale_cost#16114,ss_list_price#16115,ss_sales_price#16116,ss_ext_discount_amt#16117,ss_ext_sales_price#16118,ss_ext_wholesale_cost#16119,ss_ext_list_price#16120,ss_ext_tax#16121,ss_coupon_amt#16122,ss_net_paid#16123,ss_net_paid_inc_tax#16124,ss_net_profit#16125] parquet
            :                    :     :     +- Project [d_date_sk#16126, d_year#16132, d_moy#16134]
            :                    :     :        +- Filter ((((d_year#16132 = 2000) OR ((d_year#16132 = 1999) AND (d_moy#16134 = 12))) OR ((d_year#16132 = 2001) AND (d_moy#16134 = 1))) AND isnotnull(d_date_sk#16126))
            :                    :     :           +- Relation [d_date_sk#16126,d_date_id#16127,d_date#16128,d_month_seq#16129,d_week_seq#16130,d_quarter_seq#16131,d_year#16132,d_dow#16133,d_moy#16134,d_dom#16135,d_qoy#16136,d_fy_year#16137,d_fy_quarter_seq#16138,d_fy_week_seq#16139,d_day_name#16140,d_quarter_name#16141,d_holiday#16142,d_weekend#16143,d_following_holiday#16144,d_first_dom#16145,d_last_dom#16146,d_same_day_ly#16147,d_same_day_lq#16148,d_current_day#16149,... 4 more fields] parquet
            :                    :     +- Project [i_item_sk#16081, i_brand#16089, i_category#16093]
            :                    :        +- Filter (isnotnull(i_item_sk#16081) AND (isnotnull(i_category#16093) AND isnotnull(i_brand#16089)))
            :                    :           +- Relation [i_item_sk#16081,i_item_id#16082,i_rec_start_date#16083,i_rec_end_date#16084,i_item_desc#16085,i_current_price#16086,i_wholesale_cost#16087,i_brand_id#16088,i_brand#16089,i_class_id#16090,i_class#16091,i_category_id#16092,i_category#16093,i_manufact_id#16094,i_manufact#16095,i_size#16096,i_formulation#16097,i_color#16098,i_units#16099,i_container#16100,i_manager_id#16101,i_product_name#16102] parquet
            :                    +- Project [s_store_sk#16154, s_store_name#16159, s_company_name#16171]
            :                       +- Filter (isnotnull(s_store_sk#16154) AND (isnotnull(s_store_name#16159) AND isnotnull(s_company_name#16171)))
            :                          +- Relation [s_store_sk#16154,s_store_id#16155,s_rec_start_date#16156,s_rec_end_date#16157,s_closed_date_sk#16158,s_store_name#16159,s_number_employees#16160,s_floor_space#16161,s_hours#16162,s_manager#16163,s_market_id#16164,s_geography_class#16165,s_market_desc#16166,s_market_manager#16167,s_division_id#16168,s_division_name#16169,s_company_id#16170,s_company_name#16171,s_street_number#16172,s_street_name#16173,s_street_type#16174,s_suite_number#16175,s_city#16176,s_county#16177,... 5 more fields] parquet
            +- Project [i_category#16200, i_brand#16196, s_store_name#16266, s_company_name#16278, sum_sales#16036 AS sum_sales#16066, rn#16294]
               +- Window [rank(d_year#16239, d_moy#16241) windowspecdefinition(i_category#16200, i_brand#16196, s_store_name#16266, s_company_name#16278, d_year#16239 ASC NULLS FIRST, d_moy#16241 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#16294], [i_category#16200, i_brand#16196, s_store_name#16266, s_company_name#16278], [d_year#16239 ASC NULLS FIRST, d_moy#16241 ASC NULLS FIRST]
                  +- Aggregate [i_category#16200, i_brand#16196, s_store_name#16266, s_company_name#16278, d_year#16239, d_moy#16241], [i_category#16200, i_brand#16196, s_store_name#16266, s_company_name#16278, d_year#16239, d_moy#16241, MakeDecimal(sum(UnscaledValue(ss_sales_price#16223)),17,2) AS sum_sales#16036]
                     +- Project [ss_sales_price#16223, d_year#16239, d_moy#16241, i_brand#16196, i_category#16200, s_store_name#16266, s_company_name#16278]
                        +- Join Inner, (ss_store_sk#16217 = s_store_sk#16261)
                           :- Project [ss_store_sk#16217, ss_sales_price#16223, d_year#16239, d_moy#16241, i_brand#16196, i_category#16200]
                           :  +- Join Inner, (ss_item_sk#16212 = i_item_sk#16188)
                           :     :- Project [ss_item_sk#16212, ss_store_sk#16217, ss_sales_price#16223, d_year#16239, d_moy#16241]
                           :     :  +- Join Inner, (ss_sold_date_sk#16210 = d_date_sk#16233)
                           :     :     :- Project [ss_sold_date_sk#16210, ss_item_sk#16212, ss_store_sk#16217, ss_sales_price#16223]
                           :     :     :  +- Filter (isnotnull(ss_sold_date_sk#16210) AND (isnotnull(ss_item_sk#16212) AND isnotnull(ss_store_sk#16217)))
                           :     :     :     +- Relation [ss_sold_date_sk#16210,ss_sold_time_sk#16211,ss_item_sk#16212,ss_customer_sk#16213,ss_cdemo_sk#16214,ss_hdemo_sk#16215,ss_addr_sk#16216,ss_store_sk#16217,ss_promo_sk#16218,ss_ticket_number#16219L,ss_quantity#16220,ss_wholesale_cost#16221,ss_list_price#16222,ss_sales_price#16223,ss_ext_discount_amt#16224,ss_ext_sales_price#16225,ss_ext_wholesale_cost#16226,ss_ext_list_price#16227,ss_ext_tax#16228,ss_coupon_amt#16229,ss_net_paid#16230,ss_net_paid_inc_tax#16231,ss_net_profit#16232] parquet
                           :     :     +- Project [d_date_sk#16233, d_year#16239, d_moy#16241]
                           :     :        +- Filter ((((d_year#16239 = 2000) OR ((d_year#16239 = 1999) AND (d_moy#16241 = 12))) OR ((d_year#16239 = 2001) AND (d_moy#16241 = 1))) AND isnotnull(d_date_sk#16233))
                           :     :           +- Relation [d_date_sk#16233,d_date_id#16234,d_date#16235,d_month_seq#16236,d_week_seq#16237,d_quarter_seq#16238,d_year#16239,d_dow#16240,d_moy#16241,d_dom#16242,d_qoy#16243,d_fy_year#16244,d_fy_quarter_seq#16245,d_fy_week_seq#16246,d_day_name#16247,d_quarter_name#16248,d_holiday#16249,d_weekend#16250,d_following_holiday#16251,d_first_dom#16252,d_last_dom#16253,d_same_day_ly#16254,d_same_day_lq#16255,d_current_day#16256,... 4 more fields] parquet
                           :     +- Project [i_item_sk#16188, i_brand#16196, i_category#16200]
                           :        +- Filter (isnotnull(i_item_sk#16188) AND (isnotnull(i_category#16200) AND isnotnull(i_brand#16196)))
                           :           +- Relation [i_item_sk#16188,i_item_id#16189,i_rec_start_date#16190,i_rec_end_date#16191,i_item_desc#16192,i_current_price#16193,i_wholesale_cost#16194,i_brand_id#16195,i_brand#16196,i_class_id#16197,i_class#16198,i_category_id#16199,i_category#16200,i_manufact_id#16201,i_manufact#16202,i_size#16203,i_formulation#16204,i_color#16205,i_units#16206,i_container#16207,i_manager_id#16208,i_product_name#16209] parquet
                           +- Project [s_store_sk#16261, s_store_name#16266, s_company_name#16278]
                              +- Filter (isnotnull(s_store_sk#16261) AND (isnotnull(s_store_name#16266) AND isnotnull(s_company_name#16278)))
                                 +- Relation [s_store_sk#16261,s_store_id#16262,s_rec_start_date#16263,s_rec_end_date#16264,s_closed_date_sk#16265,s_store_name#16266,s_number_employees#16267,s_floor_space#16268,s_hours#16269,s_manager#16270,s_market_id#16271,s_geography_class#16272,s_market_desc#16273,s_market_manager#16274,s_division_id#16275,s_division_name#16276,s_company_id#16277,s_company_name#16278,s_street_number#16279,s_street_name#16280,s_street_type#16281,s_suite_number#16282,s_city#16283,s_county#16284,... 5 more fields] parquet
