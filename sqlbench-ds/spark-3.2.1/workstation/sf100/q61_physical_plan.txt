AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(1) Project [promotions#20445, total#20446, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(promotions#20445 as decimal(15,4))) / promote_precision(cast(total#20446 as decimal(15,4)))), DecimalType(35,20), true)) * 100.00000000000000000000), DecimalType(38,19), true) AS ((CAST(promotions AS DECIMAL(15,4)) / CAST(total AS DECIMAL(15,4))) * 100)#20582]
   +- GpuColumnarToRow false
      +- GpuCartesianProduct 2147483647
         :- GpuHashAggregate(keys=[], functions=[gpubasicsum(UnscaledValue(ss_ext_sales_price#267), LongType, false)], output=[promotions#20445])
         :  +- GpuShuffleCoalesce 2147483647
         :     +- ShuffleQueryStage 28
         :        +- GpuColumnarExchange gpusinglepartitioning$(), ENSURE_REQUIREMENTS, [id=#357321]
         :           +- GpuHashAggregate(keys=[], functions=[partial_gpubasicsum(UnscaledValue(ss_ext_sales_price#267), LongType, false)], output=[sum#20587L])
         :              +- GpuProject [ss_ext_sales_price#267], true
         :                 +- GpuShuffledHashJoin [ss_item_sk#254], [i_item_sk#668], Inner, GpuBuildRight, false
         :                    :- GpuShuffleCoalesce 2147483647
         :                    :  +- GpuCustomShuffleReader coalesced
         :                    :     +- ShuffleQueryStage 26
         :                    :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#356912]
         :                    :           +- GpuProject [ss_item_sk#254, ss_ext_sales_price#267], true
         :                    :              +- GpuShuffledHashJoin [c_current_addr_sk#404], [ca_address_sk#62], Inner, GpuBuildRight, false
         :                    :                 :- GpuShuffleCoalesce 2147483647
         :                    :                 :  +- GpuCustomShuffleReader coalesced
         :                    :                 :     +- ShuffleQueryStage 24
         :                    :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#356430]
         :                    :                 :           +- GpuProject [ss_item_sk#254, ss_ext_sales_price#267, c_current_addr_sk#404], true
         :                    :                 :              +- GpuShuffledHashJoin [ss_customer_sk#255], [c_customer_sk#400], Inner, GpuBuildRight, false
         :                    :                 :                 :- GpuShuffleCoalesce 2147483647
         :                    :                 :                 :  +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :     +- ShuffleQueryStage 22
         :                    :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#355804]
         :                    :                 :                 :           +- GpuProject [ss_item_sk#254, ss_customer_sk#255, ss_ext_sales_price#267], true
         :                    :                 :                 :              +- GpuShuffledHashJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner, GpuBuildRight, false
         :                    :                 :                 :                 :- GpuShuffleCoalesce 2147483647
         :                    :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :                 :     +- ShuffleQueryStage 20
         :                    :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#355034]
         :                    :                 :                 :                 :           +- GpuProject [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_ext_sales_price#267], true
         :                    :                 :                 :                 :              +- GpuShuffledHashJoin [ss_promo_sk#260], [p_promo_sk#98], Inner, GpuBuildRight, false
         :                    :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
         :                    :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :                 :                 :     +- ShuffleQueryStage 18
         :                    :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#354161]
         :                    :                 :                 :                 :                 :           +- GpuProject [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_promo_sk#260, ss_ext_sales_price#267], true
         :                    :                 :                 :                 :                 :              +- GpuShuffledHashJoin [ss_store_sk#259], [s_store_sk#712], Inner, GpuBuildRight, false
         :                    :                 :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
         :                    :                 :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 0
         :                    :                 :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#350763]
         :                    :                 :                 :                 :                 :                 :           +- GpuCoalesceBatches targetsize(2147483647)
         :                    :                 :                 :                 :                 :                 :              +- GpuFilter ((((gpuisnotnull(ss_store_sk#259) AND gpuisnotnull(ss_item_sk#254)) AND gpuisnotnull(ss_promo_sk#260)) AND gpuisnotnull(ss_sold_date_sk#252)) AND gpuisnotnull(ss_customer_sk#255)), true
         :                    :                 :                 :                 :                 :                 :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_store_sk#259,ss_promo_sk#260,ss_ext_sales_price#267] Batched: true, DataFilters: [isnotnull(ss_store_sk#259), isnotnull(ss_item_sk#254), isnotnull(ss_promo_sk#260), isnotnull(ss_..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_promo_sk), IsNotNull(ss_sold_date_sk..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_e...
         :                    :                 :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :                 :                 :                    +- ShuffleQueryStage 1
         :                    :                 :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#350800]
         :                    :                 :                 :                 :                 :                          +- GpuProject [s_store_sk#712], true
         :                    :                 :                 :                 :                 :                             +- GpuCoalesceBatches targetsize(2147483647)
         :                    :                 :                 :                 :                 :                                +- GpuFilter ((gpuisnotnull(s_gmt_offset#739) AND (s_gmt_offset#739 = -6.00)) AND gpuisnotnull(s_store_sk#712)), true
         :                    :                 :                 :                 :                 :                                   +- GpuFileGpuScan parquet [s_store_sk#712,s_gmt_offset#739] Batched: true, DataFilters: [isnotnull(s_gmt_offset#739), (s_gmt_offset#739 = -6.00), isnotnull(s_store_sk#712)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_gmt_offset), EqualTo(s_gmt_offset,-6.00), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_gmt_offset:decimal(5,2)>
         :                    :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :                 :                    +- ShuffleQueryStage 2
         :                    :                 :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#350843]
         :                    :                 :                 :                 :                          +- GpuProject [p_promo_sk#98], true
         :                    :                 :                 :                 :                             +- GpuCoalesceBatches targetsize(2147483647)
         :                    :                 :                 :                 :                                +- GpuFilter ((((p_channel_dmail#106 = Y) OR (p_channel_email#107 = Y)) OR (p_channel_tv#109 = Y)) AND gpuisnotnull(p_promo_sk#98)), true
         :                    :                 :                 :                 :                                   +- GpuFileGpuScan parquet [p_promo_sk#98,p_channel_dmail#106,p_channel_email#107,p_channel_tv#109] Batched: true, DataFilters: [(((p_channel_dmail#106 = Y) OR (p_channel_email#107 = Y)) OR (p_channel_tv#109 = Y)), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(p_channel_dmail,Y),EqualTo(p_channel_email,Y)),EqualTo(p_channel_tv,Y)), IsNotNull..., ReadSchema: struct<p_promo_sk:int,p_channel_dmail:string,p_channel_email:string,p_channel_tv:string>
         :                    :                 :                 :                 +- GpuCustomShuffleReader coalesced
         :                    :                 :                 :                    +- ShuffleQueryStage 3
         :                    :                 :                 :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#350886]
         :                    :                 :                 :                          +- GpuProject [d_date_sk#612], true
         :                    :                 :                 :                             +- GpuCoalesceBatches targetsize(2147483647)
         :                    :                 :                 :                                +- GpuFilter ((((gpuisnotnull(d_year#618) AND gpuisnotnull(d_moy#620)) AND (d_year#618 = 2001)) AND (d_moy#620 = 12)) AND gpuisnotnull(d_date_sk#612)), true
         :                    :                 :                 :                                   +- GpuFileGpuScan parquet [d_date_sk#612,d_year#618,d_moy#620] Batched: true, DataFilters: [isnotnull(d_year#618), isnotnull(d_moy#620), (d_year#618 = 2001), (d_moy#620 = 12), isnotnull(d_..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,12), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
         :                    :                 :                 +- GpuCustomShuffleReader coalesced
         :                    :                 :                    +- ShuffleQueryStage 4
         :                    :                 :                       +- GpuColumnarExchange gpuhashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#350920]
         :                    :                 :                          +- GpuCoalesceBatches targetsize(2147483647)
         :                    :                 :                             +- GpuFilter (gpuisnotnull(c_customer_sk#400) AND gpuisnotnull(c_current_addr_sk#404)), true
         :                    :                 :                                +- GpuFileGpuScan parquet [c_customer_sk#400,c_current_addr_sk#404] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_current_addr_sk#404)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int>
         :                    :                 +- GpuCustomShuffleReader coalesced
         :                    :                    +- ShuffleQueryStage 5
         :                    :                       +- GpuColumnarExchange gpuhashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#350961]
         :                    :                          +- GpuProject [ca_address_sk#62], true
         :                    :                             +- GpuCoalesceBatches targetsize(2147483647)
         :                    :                                +- GpuFilter ((gpuisnotnull(ca_gmt_offset#73) AND (ca_gmt_offset#73 = -6.00)) AND gpuisnotnull(ca_address_sk#62)), true
         :                    :                                   +- GpuFileGpuScan parquet [ca_address_sk#62,ca_gmt_offset#73] Batched: true, DataFilters: [isnotnull(ca_gmt_offset#73), (ca_gmt_offset#73 = -6.00), isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_gmt_offset), EqualTo(ca_gmt_offset,-6.00), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_gmt_offset:decimal(5,2)>
         :                    +- GpuCustomShuffleReader coalesced
         :                       +- ShuffleQueryStage 6
         :                          +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#351004]
         :                             +- GpuProject [i_item_sk#668], true
         :                                +- GpuCoalesceBatches targetsize(2147483647)
         :                                   +- GpuFilter ((gpuisnotnull(i_category#680) AND (i_category#680 = Jewelry)) AND gpuisnotnull(i_item_sk#668)), true
         :                                      +- GpuFileGpuScan parquet [i_item_sk#668,i_category#680] Batched: true, DataFilters: [isnotnull(i_category#680), (i_category#680 = Jewelry), isnotnull(i_item_sk#668)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Jewelry), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_category:string>
         +- GpuHashAggregate(keys=[], functions=[gpubasicsum(UnscaledValue(ss_ext_sales_price#20462), LongType, false)], output=[total#20446])
            +- GpuShuffleCoalesce 2147483647
               +- ShuffleQueryStage 27
                  +- GpuColumnarExchange gpusinglepartitioning$(), ENSURE_REQUIREMENTS, [id=#357114]
                     +- GpuHashAggregate(keys=[], functions=[partial_gpubasicsum(UnscaledValue(ss_ext_sales_price#20462), LongType, false)], output=[sum#20589L])
                        +- GpuProject [ss_ext_sales_price#20462], true
                           +- GpuShuffledHashJoin [ss_item_sk#20449], [i_item_sk#20558], Inner, GpuBuildRight, false
                              :- GpuShuffleCoalesce 2147483647
                              :  +- GpuCustomShuffleReader coalesced
                              :     +- ShuffleQueryStage 25
                              :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#20449, 200), ENSURE_REQUIREMENTS, [id=#356705]
                              :           +- GpuProject [ss_item_sk#20449, ss_ext_sales_price#20462], true
                              :              +- GpuShuffledHashJoin [c_current_addr_sk#20531], [ca_address_sk#20545], Inner, GpuBuildRight, false
                              :                 :- GpuShuffleCoalesce 2147483647
                              :                 :  +- GpuCustomShuffleReader coalesced
                              :                 :     +- ShuffleQueryStage 23
                              :                 :        +- GpuColumnarExchange gpuhashpartitioning(c_current_addr_sk#20531, 200), ENSURE_REQUIREMENTS, [id=#356159]
                              :                 :           +- GpuProject [ss_item_sk#20449, ss_ext_sales_price#20462, c_current_addr_sk#20531], true
                              :                 :              +- GpuShuffledHashJoin [ss_customer_sk#20450], [c_customer_sk#20527], Inner, GpuBuildRight, false
                              :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                 :                 :     +- ShuffleQueryStage 21
                              :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_customer_sk#20450, 200), ENSURE_REQUIREMENTS, [id=#355469]
                              :                 :                 :           +- GpuProject [ss_item_sk#20449, ss_customer_sk#20450, ss_ext_sales_price#20462], true
                              :                 :                 :              +- GpuShuffledHashJoin [ss_sold_date_sk#20447], [d_date_sk#20499], Inner, GpuBuildRight, false
                              :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                 :                 :                 :     +- ShuffleQueryStage 19
                              :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#20447, 200), ENSURE_REQUIREMENTS, [id=#354635]
                              :                 :                 :                 :           +- GpuProject [ss_sold_date_sk#20447, ss_item_sk#20449, ss_customer_sk#20450, ss_ext_sales_price#20462], true
                              :                 :                 :                 :              +- GpuShuffledHashJoin [ss_store_sk#20454], [s_store_sk#20470], Inner, GpuBuildRight, false
                              :                 :                 :                 :                 :- GpuShuffleCoalesce 2147483647
                              :                 :                 :                 :                 :  +- GpuCustomShuffleReader coalesced
                              :                 :                 :                 :                 :     +- ShuffleQueryStage 7
                              :                 :                 :                 :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_store_sk#20454, 200), ENSURE_REQUIREMENTS, [id=#351128]
                              :                 :                 :                 :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                              :                 :                 :                 :                 :              +- GpuFilter (((gpuisnotnull(ss_store_sk#20454) AND gpuisnotnull(ss_item_sk#20449)) AND gpuisnotnull(ss_sold_date_sk#20447)) AND gpuisnotnull(ss_customer_sk#20450)), true
                              :                 :                 :                 :                 :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#20447,ss_item_sk#20449,ss_customer_sk#20450,ss_store_sk#20454,ss_ext_sales_price#20462] Batched: true, DataFilters: [isnotnull(ss_store_sk#20454), isnotnull(ss_item_sk#20449), isnotnull(ss_sold_date_sk#20447), isn..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk), IsNotNull(ss_customer..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ext_sales_price:d...
                              :                 :                 :                 :                 +- GpuCustomShuffleReader coalesced
                              :                 :                 :                 :                    +- ShuffleQueryStage 9
                              :                 :                 :                 :                       +- ReusedExchange [s_store_sk#20470], GpuColumnarExchange gpuhashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#350800]
                              :                 :                 :                 +- GpuCustomShuffleReader coalesced
                              :                 :                 :                    +- ShuffleQueryStage 11
                              :                 :                 :                       +- ReusedExchange [d_date_sk#20499], GpuColumnarExchange gpuhashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#350886]
                              :                 :                 +- GpuCustomShuffleReader coalesced
                              :                 :                    +- ShuffleQueryStage 13
                              :                 :                       +- ReusedExchange [c_customer_sk#20527, c_current_addr_sk#20531], GpuColumnarExchange gpuhashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#350920]
                              :                 +- GpuCustomShuffleReader coalesced
                              :                    +- ShuffleQueryStage 15
                              :                       +- ReusedExchange [ca_address_sk#20545], GpuColumnarExchange gpuhashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#350961]
                              +- GpuCustomShuffleReader coalesced
                                 +- ShuffleQueryStage 17
                                    +- ReusedExchange [i_item_sk#20558], GpuColumnarExchange gpuhashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#351004]
+- == Initial Plan ==
   Project [promotions#20445, total#20446, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(promotions#20445 as decimal(15,4))) / promote_precision(cast(total#20446 as decimal(15,4)))), DecimalType(35,20), true)) * 100.00000000000000000000), DecimalType(38,19), true) AS ((CAST(promotions AS DECIMAL(15,4)) / CAST(total AS DECIMAL(15,4))) * 100)#20582]
   +- CartesianProduct
      :- HashAggregate(keys=[], functions=[sum(UnscaledValue(ss_ext_sales_price#267))], output=[promotions#20445])
      :  +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#349431]
      :     +- HashAggregate(keys=[], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#267))], output=[sum#20587L])
      :        +- Project [ss_ext_sales_price#267]
      :           +- SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
      :              :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
      :              :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#349423]
      :              :     +- Project [ss_item_sk#254, ss_ext_sales_price#267]
      :              :        +- SortMergeJoin [c_current_addr_sk#404], [ca_address_sk#62], Inner
      :              :           :- Sort [c_current_addr_sk#404 ASC NULLS FIRST], false, 0
      :              :           :  +- Exchange hashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#349415]
      :              :           :     +- Project [ss_item_sk#254, ss_ext_sales_price#267, c_current_addr_sk#404]
      :              :           :        +- SortMergeJoin [ss_customer_sk#255], [c_customer_sk#400], Inner
      :              :           :           :- Sort [ss_customer_sk#255 ASC NULLS FIRST], false, 0
      :              :           :           :  +- Exchange hashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#349407]
      :              :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_ext_sales_price#267]
      :              :           :           :        +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
      :              :           :           :           :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
      :              :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#349399]
      :              :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_ext_sales_price#267]
      :              :           :           :           :        +- SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
      :              :           :           :           :           :- Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
      :              :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#349391]
      :              :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_promo_sk#260, ss_ext_sales_price#267]
      :              :           :           :           :           :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
      :              :           :           :           :           :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
      :              :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#349383]
      :              :           :           :           :           :           :     +- Filter ((((isnotnull(ss_store_sk#259) AND isnotnull(ss_item_sk#254)) AND isnotnull(ss_promo_sk#260)) AND isnotnull(ss_sold_date_sk#252)) AND isnotnull(ss_customer_sk#255))
      :              :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_store_sk#259,ss_promo_sk#260,ss_ext_sales_price#267] Batched: true, DataFilters: [isnotnull(ss_store_sk#259), isnotnull(ss_item_sk#254), isnotnull(ss_promo_sk#260), isnotnull(ss_..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_promo_sk), IsNotNull(ss_sold_date_sk..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_promo_sk:int,ss_e...
      :              :           :           :           :           :           +- Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
      :              :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#349384]
      :              :           :           :           :           :                 +- Project [s_store_sk#712]
      :              :           :           :           :           :                    +- Filter ((isnotnull(s_gmt_offset#739) AND (s_gmt_offset#739 = -6.00)) AND isnotnull(s_store_sk#712))
      :              :           :           :           :           :                       +- FileScan parquet [s_store_sk#712,s_gmt_offset#739] Batched: true, DataFilters: [isnotnull(s_gmt_offset#739), (s_gmt_offset#739 = -6.00), isnotnull(s_store_sk#712)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_gmt_offset), EqualTo(s_gmt_offset,-6.00), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_gmt_offset:decimal(5,2)>
      :              :           :           :           :           +- Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
      :              :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#349392]
      :              :           :           :           :                 +- Project [p_promo_sk#98]
      :              :           :           :           :                    +- Filter ((((p_channel_dmail#106 = Y) OR (p_channel_email#107 = Y)) OR (p_channel_tv#109 = Y)) AND isnotnull(p_promo_sk#98))
      :              :           :           :           :                       +- FileScan parquet [p_promo_sk#98,p_channel_dmail#106,p_channel_email#107,p_channel_tv#109] Batched: true, DataFilters: [(((p_channel_dmail#106 = Y) OR (p_channel_email#107 = Y)) OR (p_channel_tv#109 = Y)), isnotnull(..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(p_channel_dmail,Y),EqualTo(p_channel_email,Y)),EqualTo(p_channel_tv,Y)), IsNotNull..., ReadSchema: struct<p_promo_sk:int,p_channel_dmail:string,p_channel_email:string,p_channel_tv:string>
      :              :           :           :           +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
      :              :           :           :              +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#349400]
      :              :           :           :                 +- Project [d_date_sk#612]
      :              :           :           :                    +- Filter ((((isnotnull(d_year#618) AND isnotnull(d_moy#620)) AND (d_year#618 = 2001)) AND (d_moy#620 = 12)) AND isnotnull(d_date_sk#612))
      :              :           :           :                       +- FileScan parquet [d_date_sk#612,d_year#618,d_moy#620] Batched: true, DataFilters: [isnotnull(d_year#618), isnotnull(d_moy#620), (d_year#618 = 2001), (d_moy#620 = 12), isnotnull(d_..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,12), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
      :              :           :           +- Sort [c_customer_sk#400 ASC NULLS FIRST], false, 0
      :              :           :              +- Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#349408]
      :              :           :                 +- Filter (isnotnull(c_customer_sk#400) AND isnotnull(c_current_addr_sk#404))
      :              :           :                    +- FileScan parquet [c_customer_sk#400,c_current_addr_sk#404] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_current_addr_sk#404)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int>
      :              :           +- Sort [ca_address_sk#62 ASC NULLS FIRST], false, 0
      :              :              +- Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#349416]
      :              :                 +- Project [ca_address_sk#62]
      :              :                    +- Filter ((isnotnull(ca_gmt_offset#73) AND (ca_gmt_offset#73 = -6.00)) AND isnotnull(ca_address_sk#62))
      :              :                       +- FileScan parquet [ca_address_sk#62,ca_gmt_offset#73] Batched: true, DataFilters: [isnotnull(ca_gmt_offset#73), (ca_gmt_offset#73 = -6.00), isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_gmt_offset), EqualTo(ca_gmt_offset,-6.00), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_gmt_offset:decimal(5,2)>
      :              +- Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
      :                 +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#349424]
      :                    +- Project [i_item_sk#668]
      :                       +- Filter ((isnotnull(i_category#680) AND (i_category#680 = Jewelry)) AND isnotnull(i_item_sk#668))
      :                          +- FileScan parquet [i_item_sk#668,i_category#680] Batched: true, DataFilters: [isnotnull(i_category#680), (i_category#680 = Jewelry), isnotnull(i_item_sk#668)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Jewelry), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_category:string>
      +- HashAggregate(keys=[], functions=[sum(UnscaledValue(ss_ext_sales_price#20462))], output=[total#20446])
         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#349474]
            +- HashAggregate(keys=[], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#20462))], output=[sum#20589L])
               +- Project [ss_ext_sales_price#20462]
                  +- SortMergeJoin [ss_item_sk#20449], [i_item_sk#20558], Inner
                     :- Sort [ss_item_sk#20449 ASC NULLS FIRST], false, 0
                     :  +- Exchange hashpartitioning(ss_item_sk#20449, 200), ENSURE_REQUIREMENTS, [id=#349466]
                     :     +- Project [ss_item_sk#20449, ss_ext_sales_price#20462]
                     :        +- SortMergeJoin [c_current_addr_sk#20531], [ca_address_sk#20545], Inner
                     :           :- Sort [c_current_addr_sk#20531 ASC NULLS FIRST], false, 0
                     :           :  +- Exchange hashpartitioning(c_current_addr_sk#20531, 200), ENSURE_REQUIREMENTS, [id=#349458]
                     :           :     +- Project [ss_item_sk#20449, ss_ext_sales_price#20462, c_current_addr_sk#20531]
                     :           :        +- SortMergeJoin [ss_customer_sk#20450], [c_customer_sk#20527], Inner
                     :           :           :- Sort [ss_customer_sk#20450 ASC NULLS FIRST], false, 0
                     :           :           :  +- Exchange hashpartitioning(ss_customer_sk#20450, 200), ENSURE_REQUIREMENTS, [id=#349450]
                     :           :           :     +- Project [ss_item_sk#20449, ss_customer_sk#20450, ss_ext_sales_price#20462]
                     :           :           :        +- SortMergeJoin [ss_sold_date_sk#20447], [d_date_sk#20499], Inner
                     :           :           :           :- Sort [ss_sold_date_sk#20447 ASC NULLS FIRST], false, 0
                     :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#20447, 200), ENSURE_REQUIREMENTS, [id=#349442]
                     :           :           :           :     +- Project [ss_sold_date_sk#20447, ss_item_sk#20449, ss_customer_sk#20450, ss_ext_sales_price#20462]
                     :           :           :           :        +- SortMergeJoin [ss_store_sk#20454], [s_store_sk#20470], Inner
                     :           :           :           :           :- Sort [ss_store_sk#20454 ASC NULLS FIRST], false, 0
                     :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#20454, 200), ENSURE_REQUIREMENTS, [id=#349434]
                     :           :           :           :           :     +- Filter (((isnotnull(ss_store_sk#20454) AND isnotnull(ss_item_sk#20449)) AND isnotnull(ss_sold_date_sk#20447)) AND isnotnull(ss_customer_sk#20450))
                     :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#20447,ss_item_sk#20449,ss_customer_sk#20450,ss_store_sk#20454,ss_ext_sales_price#20462] Batched: true, DataFilters: [isnotnull(ss_store_sk#20454), isnotnull(ss_item_sk#20449), isnotnull(ss_sold_date_sk#20447), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_store_sk), IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk), IsNotNull(ss_customer..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_store_sk:int,ss_ext_sales_price:d...
                     :           :           :           :           +- Sort [s_store_sk#20470 ASC NULLS FIRST], false, 0
                     :           :           :           :              +- Exchange hashpartitioning(s_store_sk#20470, 200), ENSURE_REQUIREMENTS, [id=#349435]
                     :           :           :           :                 +- Project [s_store_sk#20470]
                     :           :           :           :                    +- Filter ((isnotnull(s_gmt_offset#20497) AND (s_gmt_offset#20497 = -6.00)) AND isnotnull(s_store_sk#20470))
                     :           :           :           :                       +- FileScan parquet [s_store_sk#20470,s_gmt_offset#20497] Batched: true, DataFilters: [isnotnull(s_gmt_offset#20497), (s_gmt_offset#20497 = -6.00), isnotnull(s_store_sk#20470)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_gmt_offset), EqualTo(s_gmt_offset,-6.00), IsNotNull(s_store_sk)], ReadSchema: struct<s_store_sk:int,s_gmt_offset:decimal(5,2)>
                     :           :           :           +- Sort [d_date_sk#20499 ASC NULLS FIRST], false, 0
                     :           :           :              +- Exchange hashpartitioning(d_date_sk#20499, 200), ENSURE_REQUIREMENTS, [id=#349443]
                     :           :           :                 +- Project [d_date_sk#20499]
                     :           :           :                    +- Filter ((((isnotnull(d_year#20505) AND isnotnull(d_moy#20507)) AND (d_year#20505 = 2001)) AND (d_moy#20507 = 12)) AND isnotnull(d_date_sk#20499))
                     :           :           :                       +- FileScan parquet [d_date_sk#20499,d_year#20505,d_moy#20507] Batched: true, DataFilters: [isnotnull(d_year#20505), isnotnull(d_moy#20507), (d_year#20505 = 2001), (d_moy#20507 = 12), isno..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,12), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                     :           :           +- Sort [c_customer_sk#20527 ASC NULLS FIRST], false, 0
                     :           :              +- Exchange hashpartitioning(c_customer_sk#20527, 200), ENSURE_REQUIREMENTS, [id=#349451]
                     :           :                 +- Filter (isnotnull(c_customer_sk#20527) AND isnotnull(c_current_addr_sk#20531))
                     :           :                    +- FileScan parquet [c_customer_sk#20527,c_current_addr_sk#20531] Batched: true, DataFilters: [isnotnull(c_customer_sk#20527), isnotnull(c_current_addr_sk#20531)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_current_addr_sk)], ReadSchema: struct<c_customer_sk:int,c_current_addr_sk:int>
                     :           +- Sort [ca_address_sk#20545 ASC NULLS FIRST], false, 0
                     :              +- Exchange hashpartitioning(ca_address_sk#20545, 200), ENSURE_REQUIREMENTS, [id=#349459]
                     :                 +- Project [ca_address_sk#20545]
                     :                    +- Filter ((isnotnull(ca_gmt_offset#20556) AND (ca_gmt_offset#20556 = -6.00)) AND isnotnull(ca_address_sk#20545))
                     :                       +- FileScan parquet [ca_address_sk#20545,ca_gmt_offset#20556] Batched: true, DataFilters: [isnotnull(ca_gmt_offset#20556), (ca_gmt_offset#20556 = -6.00), isnotnull(ca_address_sk#20545)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_gmt_offset), EqualTo(ca_gmt_offset,-6.00), IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_gmt_offset:decimal(5,2)>
                     +- Sort [i_item_sk#20558 ASC NULLS FIRST], false, 0
                        +- Exchange hashpartitioning(i_item_sk#20558, 200), ENSURE_REQUIREMENTS, [id=#349467]
                           +- Project [i_item_sk#20558]
                              +- Filter ((isnotnull(i_category#20570) AND (i_category#20570 = Jewelry)) AND isnotnull(i_item_sk#20558))
                                 +- FileScan parquet [i_item_sk#20558,i_category#20570] Batched: true, DataFilters: [isnotnull(i_category#20570), (i_category#20570 = Jewelry), isnotnull(i_item_sk#20558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_category), EqualTo(i_category,Jewelry), IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_category:string>
