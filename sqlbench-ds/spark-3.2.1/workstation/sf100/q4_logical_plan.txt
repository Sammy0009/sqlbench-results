GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#1638 ASC NULLS FIRST, customer_first_name#1639 ASC NULLS FIRST, customer_last_name#1640 ASC NULLS FIRST, customer_login#1643 ASC NULLS FIRST], true
      +- Project [customer_id#1638, customer_first_name#1639, customer_last_name#1640, customer_login#1643]
         +- Join Inner, ((customer_id#1513 = customer_id#1678) AND (CASE WHEN (year_total#2168 > 0.000000) THEN CheckOverflow((promote_precision(year_total#1666) / promote_precision(year_total#2168)), DecimalType(38,14), true) END > CASE WHEN (year_total#2646 > 0.000000) THEN CheckOverflow((promote_precision(year_total#1686) / promote_precision(year_total#2646)), DecimalType(38,14), true) END))
            :- Project [customer_id#1513, customer_id#1638, customer_first_name#1639, customer_last_name#1640, customer_login#1643, year_total#2168, year_total#1666, year_total#2646]
            :  +- Join Inner, (customer_id#1513 = customer_id#2638)
            :     :- Project [customer_id#1513, customer_id#1638, customer_first_name#1639, customer_last_name#1640, customer_login#1643, year_total#2168, year_total#1666]
            :     :  +- Join Inner, ((customer_id#1513 = customer_id#1658) AND (CASE WHEN (year_total#2168 > 0.000000) THEN CheckOverflow((promote_precision(year_total#1666) / promote_precision(year_total#2168)), DecimalType(38,14), true) END > CASE WHEN (year_total#1521 > 0.000000) THEN CheckOverflow((promote_precision(year_total#1646) / promote_precision(year_total#1521)), DecimalType(38,14), true) END))
            :     :     :- Project [customer_id#1513, year_total#1521, customer_id#1638, customer_first_name#1639, customer_last_name#1640, customer_login#1643, year_total#1646, year_total#2168]
            :     :     :  +- Join Inner, (customer_id#1513 = customer_id#2160)
            :     :     :     :- Join Inner, (customer_id#1638 = customer_id#1513)
            :     :     :     :  :- Filter (isnotnull(year_total#1521) AND (year_total#1521 > 0.000000))
            :     :     :     :  :  +- Aggregate [c_customer_id#401, c_first_name#408, c_last_name#409, c_preferred_cust_flag#410, c_birth_country#414, c_login#415, c_email_address#416, d_year#618], [c_customer_id#401 AS customer_id#1513, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#269 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#268 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#266 as decimal(9,2)))), DecimalType(9,2), true) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#267 as decimal(10,2)))), DecimalType(10,2), true)) / 2.00), DecimalType(14,6), true)) AS year_total#1521]
            :     :     :     :  :     +- Project [ss_ext_discount_amt#266, ss_ext_sales_price#267, ss_ext_wholesale_cost#268, ss_ext_list_price#269, d_year#618, c_customer_id#401, c_first_name#408, c_last_name#409, c_preferred_cust_flag#410, c_birth_country#414, c_login#415, c_email_address#416]
            :     :     :     :  :        +- Join Inner, (c_customer_sk#400 = ss_customer_sk#255)
            :     :     :     :  :           :- Project [ss_customer_sk#255, ss_ext_discount_amt#266, ss_ext_sales_price#267, ss_ext_wholesale_cost#268, ss_ext_list_price#269, d_year#618]
            :     :     :     :  :           :  +- Join Inner, (ss_sold_date_sk#252 = d_date_sk#612)
            :     :     :     :  :           :     :- Project [ss_sold_date_sk#252, ss_customer_sk#255, ss_ext_discount_amt#266, ss_ext_sales_price#267, ss_ext_wholesale_cost#268, ss_ext_list_price#269]
            :     :     :     :  :           :     :  +- Filter (isnotnull(ss_sold_date_sk#252) AND isnotnull(ss_customer_sk#255))
            :     :     :     :  :           :     :     +- Relation [ss_sold_date_sk#252,ss_sold_time_sk#253,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_quantity#262,ss_wholesale_cost#263,ss_list_price#264,ss_sales_price#265,ss_ext_discount_amt#266,ss_ext_sales_price#267,ss_ext_wholesale_cost#268,ss_ext_list_price#269,ss_ext_tax#270,ss_coupon_amt#271,ss_net_paid#272,ss_net_paid_inc_tax#273,ss_net_profit#274] parquet
            :     :     :     :  :           :     +- Project [d_date_sk#612, d_year#618]
            :     :     :     :  :           :        +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2001)) AND isnotnull(d_date_sk#612))
            :     :     :     :  :           :           +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :     :     :     :  :           +- Project [c_customer_sk#400, c_customer_id#401, c_first_name#408, c_last_name#409, c_preferred_cust_flag#410, c_birth_country#414, c_login#415, c_email_address#416]
            :     :     :     :  :              +- Filter (isnotnull(c_customer_sk#400) AND isnotnull(c_customer_id#401))
            :     :     :     :  :                 +- Relation [c_customer_sk#400,c_customer_id#401,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406,c_salutation#407,c_first_name#408,c_last_name#409,c_preferred_cust_flag#410,c_birth_day#411,c_birth_month#412,c_birth_year#413,c_birth_country#414,c_login#415,c_email_address#416,c_last_review_date_sk#417] parquet
            :     :     :     :  +- Aggregate [c_customer_id#1693, c_first_name#1700, c_last_name#1701, c_preferred_cust_flag#1702, c_birth_country#1706, c_login#1707, c_email_address#1708, d_year#1739], [c_customer_id#1693 AS customer_id#1638, c_first_name#1700 AS customer_first_name#1639, c_last_name#1701 AS customer_last_name#1640, c_login#1707 AS customer_login#1643, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#1727 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#1726 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#1724 as decimal(9,2)))), DecimalType(9,2), true) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#1725 as decimal(10,2)))), DecimalType(10,2), true)) / 2.00), DecimalType(14,6), true)) AS year_total#1646]
            :     :     :     :     +- Project [ss_ext_discount_amt#1724, ss_ext_sales_price#1725, ss_ext_wholesale_cost#1726, ss_ext_list_price#1727, d_year#1739, c_customer_id#1693, c_first_name#1700, c_last_name#1701, c_preferred_cust_flag#1702, c_birth_country#1706, c_login#1707, c_email_address#1708]
            :     :     :     :        +- Join Inner, (c_customer_sk#1692 = ss_customer_sk#1713)
            :     :     :     :           :- Project [ss_customer_sk#1713, ss_ext_discount_amt#1724, ss_ext_sales_price#1725, ss_ext_wholesale_cost#1726, ss_ext_list_price#1727, d_year#1739]
            :     :     :     :           :  +- Join Inner, (ss_sold_date_sk#1710 = d_date_sk#1733)
            :     :     :     :           :     :- Project [ss_sold_date_sk#1710, ss_customer_sk#1713, ss_ext_discount_amt#1724, ss_ext_sales_price#1725, ss_ext_wholesale_cost#1726, ss_ext_list_price#1727]
            :     :     :     :           :     :  +- Filter (isnotnull(ss_sold_date_sk#1710) AND isnotnull(ss_customer_sk#1713))
            :     :     :     :           :     :     +- Relation [ss_sold_date_sk#1710,ss_sold_time_sk#1711,ss_item_sk#1712,ss_customer_sk#1713,ss_cdemo_sk#1714,ss_hdemo_sk#1715,ss_addr_sk#1716,ss_store_sk#1717,ss_promo_sk#1718,ss_ticket_number#1719L,ss_quantity#1720,ss_wholesale_cost#1721,ss_list_price#1722,ss_sales_price#1723,ss_ext_discount_amt#1724,ss_ext_sales_price#1725,ss_ext_wholesale_cost#1726,ss_ext_list_price#1727,ss_ext_tax#1728,ss_coupon_amt#1729,ss_net_paid#1730,ss_net_paid_inc_tax#1731,ss_net_profit#1732] parquet
            :     :     :     :           :     +- Project [d_date_sk#1733, d_year#1739]
            :     :     :     :           :        +- Filter ((isnotnull(d_year#1739) AND (d_year#1739 = 2002)) AND isnotnull(d_date_sk#1733))
            :     :     :     :           :           +- Relation [d_date_sk#1733,d_date_id#1734,d_date#1735,d_month_seq#1736,d_week_seq#1737,d_quarter_seq#1738,d_year#1739,d_dow#1740,d_moy#1741,d_dom#1742,d_qoy#1743,d_fy_year#1744,d_fy_quarter_seq#1745,d_fy_week_seq#1746,d_day_name#1747,d_quarter_name#1748,d_holiday#1749,d_weekend#1750,d_following_holiday#1751,d_first_dom#1752,d_last_dom#1753,d_same_day_ly#1754,d_same_day_lq#1755,d_current_day#1756,... 4 more fields] parquet
            :     :     :     :           +- Project [c_customer_sk#1692, c_customer_id#1693, c_first_name#1700, c_last_name#1701, c_preferred_cust_flag#1702, c_birth_country#1706, c_login#1707, c_email_address#1708]
            :     :     :     :              +- Filter (isnotnull(c_customer_sk#1692) AND isnotnull(c_customer_id#1693))
            :     :     :     :                 +- Relation [c_customer_sk#1692,c_customer_id#1693,c_current_cdemo_sk#1694,c_current_hdemo_sk#1695,c_current_addr_sk#1696,c_first_shipto_date_sk#1697,c_first_sales_date_sk#1698,c_salutation#1699,c_first_name#1700,c_last_name#1701,c_preferred_cust_flag#1702,c_birth_day#1703,c_birth_month#1704,c_birth_year#1705,c_birth_country#1706,c_login#1707,c_email_address#1708,c_last_review_date_sk#1709] parquet
            :     :     :     +- Project [customer_id#1523 AS customer_id#2160, year_total#1531 AS year_total#2168]
            :     :     :        +- Filter (isnotnull(year_total#1531) AND (year_total#1531 > 0.000000))
            :     :     :           +- Aggregate [c_customer_id#2001, c_first_name#2008, c_last_name#2009, c_preferred_cust_flag#2010, c_birth_country#2014, c_login#2015, c_email_address#2016, d_year#2058], [c_customer_id#2001 AS customer_id#1523, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#2043 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#2042 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#2040 as decimal(9,2)))), DecimalType(9,2), true) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#2041 as decimal(10,2)))), DecimalType(10,2), true)) / 2.00), DecimalType(14,6), true)) AS year_total#1531]
            :     :     :              +- Project [cs_ext_discount_amt#2040, cs_ext_sales_price#2041, cs_ext_wholesale_cost#2042, cs_ext_list_price#2043, d_year#2058, c_customer_id#2001, c_first_name#2008, c_last_name#2009, c_preferred_cust_flag#2010, c_birth_country#2014, c_login#2015, c_email_address#2016]
            :     :     :                 +- Join Inner, (c_customer_sk#2000 = cs_bill_customer_sk#2021)
            :     :     :                    :- Project [cs_bill_customer_sk#2021, cs_ext_discount_amt#2040, cs_ext_sales_price#2041, cs_ext_wholesale_cost#2042, cs_ext_list_price#2043, d_year#2058]
            :     :     :                    :  +- Join Inner, (cs_sold_date_sk#2018 = d_date_sk#2052)
            :     :     :                    :     :- Project [cs_sold_date_sk#2018, cs_bill_customer_sk#2021, cs_ext_discount_amt#2040, cs_ext_sales_price#2041, cs_ext_wholesale_cost#2042, cs_ext_list_price#2043]
            :     :     :                    :     :  +- Filter (isnotnull(cs_sold_date_sk#2018) AND isnotnull(cs_bill_customer_sk#2021))
            :     :     :                    :     :     +- Relation [cs_sold_date_sk#2018,cs_sold_time_sk#2019,cs_ship_date_sk#2020,cs_bill_customer_sk#2021,cs_bill_cdemo_sk#2022,cs_bill_hdemo_sk#2023,cs_bill_addr_sk#2024,cs_ship_customer_sk#2025,cs_ship_cdemo_sk#2026,cs_ship_hdemo_sk#2027,cs_ship_addr_sk#2028,cs_call_center_sk#2029,cs_catalog_page_sk#2030,cs_ship_mode_sk#2031,cs_warehouse_sk#2032,cs_item_sk#2033,cs_promo_sk#2034,cs_order_number#2035L,cs_quantity#2036,cs_wholesale_cost#2037,cs_list_price#2038,cs_sales_price#2039,cs_ext_discount_amt#2040,cs_ext_sales_price#2041,... 10 more fields] parquet
            :     :     :                    :     +- Project [d_date_sk#2052, d_year#2058]
            :     :     :                    :        +- Filter ((isnotnull(d_year#2058) AND (d_year#2058 = 2001)) AND isnotnull(d_date_sk#2052))
            :     :     :                    :           +- Relation [d_date_sk#2052,d_date_id#2053,d_date#2054,d_month_seq#2055,d_week_seq#2056,d_quarter_seq#2057,d_year#2058,d_dow#2059,d_moy#2060,d_dom#2061,d_qoy#2062,d_fy_year#2063,d_fy_quarter_seq#2064,d_fy_week_seq#2065,d_day_name#2066,d_quarter_name#2067,d_holiday#2068,d_weekend#2069,d_following_holiday#2070,d_first_dom#2071,d_last_dom#2072,d_same_day_ly#2073,d_same_day_lq#2074,d_current_day#2075,... 4 more fields] parquet
            :     :     :                    +- Project [c_customer_sk#2000, c_customer_id#2001, c_first_name#2008, c_last_name#2009, c_preferred_cust_flag#2010, c_birth_country#2014, c_login#2015, c_email_address#2016]
            :     :     :                       +- Filter (isnotnull(c_customer_sk#2000) AND isnotnull(c_customer_id#2001))
            :     :     :                          +- Relation [c_customer_sk#2000,c_customer_id#2001,c_current_cdemo_sk#2002,c_current_hdemo_sk#2003,c_current_addr_sk#2004,c_first_shipto_date_sk#2005,c_first_sales_date_sk#2006,c_salutation#2007,c_first_name#2008,c_last_name#2009,c_preferred_cust_flag#2010,c_birth_day#2011,c_birth_month#2012,c_birth_year#2013,c_birth_country#2014,c_login#2015,c_email_address#2016,c_last_review_date_sk#2017] parquet
            :     :     +- Aggregate [c_customer_id#2240, c_first_name#2247, c_last_name#2248, c_preferred_cust_flag#2249, c_birth_country#2253, c_login#2254, c_email_address#2255, d_year#2297], [c_customer_id#2240 AS customer_id#1658, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#2282 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#2281 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#2279 as decimal(9,2)))), DecimalType(9,2), true) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#2280 as decimal(10,2)))), DecimalType(10,2), true)) / 2.00), DecimalType(14,6), true)) AS year_total#1666]
            :     :        +- Project [cs_ext_discount_amt#2279, cs_ext_sales_price#2280, cs_ext_wholesale_cost#2281, cs_ext_list_price#2282, d_year#2297, c_customer_id#2240, c_first_name#2247, c_last_name#2248, c_preferred_cust_flag#2249, c_birth_country#2253, c_login#2254, c_email_address#2255]
            :     :           +- Join Inner, (c_customer_sk#2239 = cs_bill_customer_sk#2260)
            :     :              :- Project [cs_bill_customer_sk#2260, cs_ext_discount_amt#2279, cs_ext_sales_price#2280, cs_ext_wholesale_cost#2281, cs_ext_list_price#2282, d_year#2297]
            :     :              :  +- Join Inner, (cs_sold_date_sk#2257 = d_date_sk#2291)
            :     :              :     :- Project [cs_sold_date_sk#2257, cs_bill_customer_sk#2260, cs_ext_discount_amt#2279, cs_ext_sales_price#2280, cs_ext_wholesale_cost#2281, cs_ext_list_price#2282]
            :     :              :     :  +- Filter (isnotnull(cs_sold_date_sk#2257) AND isnotnull(cs_bill_customer_sk#2260))
            :     :              :     :     +- Relation [cs_sold_date_sk#2257,cs_sold_time_sk#2258,cs_ship_date_sk#2259,cs_bill_customer_sk#2260,cs_bill_cdemo_sk#2261,cs_bill_hdemo_sk#2262,cs_bill_addr_sk#2263,cs_ship_customer_sk#2264,cs_ship_cdemo_sk#2265,cs_ship_hdemo_sk#2266,cs_ship_addr_sk#2267,cs_call_center_sk#2268,cs_catalog_page_sk#2269,cs_ship_mode_sk#2270,cs_warehouse_sk#2271,cs_item_sk#2272,cs_promo_sk#2273,cs_order_number#2274L,cs_quantity#2275,cs_wholesale_cost#2276,cs_list_price#2277,cs_sales_price#2278,cs_ext_discount_amt#2279,cs_ext_sales_price#2280,... 10 more fields] parquet
            :     :              :     +- Project [d_date_sk#2291, d_year#2297]
            :     :              :        +- Filter ((isnotnull(d_year#2297) AND (d_year#2297 = 2002)) AND isnotnull(d_date_sk#2291))
            :     :              :           +- Relation [d_date_sk#2291,d_date_id#2292,d_date#2293,d_month_seq#2294,d_week_seq#2295,d_quarter_seq#2296,d_year#2297,d_dow#2298,d_moy#2299,d_dom#2300,d_qoy#2301,d_fy_year#2302,d_fy_quarter_seq#2303,d_fy_week_seq#2304,d_day_name#2305,d_quarter_name#2306,d_holiday#2307,d_weekend#2308,d_following_holiday#2309,d_first_dom#2310,d_last_dom#2311,d_same_day_ly#2312,d_same_day_lq#2313,d_current_day#2314,... 4 more fields] parquet
            :     :              +- Project [c_customer_sk#2239, c_customer_id#2240, c_first_name#2247, c_last_name#2248, c_preferred_cust_flag#2249, c_birth_country#2253, c_login#2254, c_email_address#2255]
            :     :                 +- Filter (isnotnull(c_customer_sk#2239) AND isnotnull(c_customer_id#2240))
            :     :                    +- Relation [c_customer_sk#2239,c_customer_id#2240,c_current_cdemo_sk#2241,c_current_hdemo_sk#2242,c_current_addr_sk#2243,c_first_shipto_date_sk#2244,c_first_sales_date_sk#2245,c_salutation#2246,c_first_name#2247,c_last_name#2248,c_preferred_cust_flag#2249,c_birth_day#2250,c_birth_month#2251,c_birth_year#2252,c_birth_country#2253,c_login#2254,c_email_address#2255,c_last_review_date_sk#2256] parquet
            :     +- Project [customer_id#1533 AS customer_id#2638, year_total#1541 AS year_total#2646]
            :        +- Filter (isnotnull(year_total#1541) AND (year_total#1541 > 0.000000))
            :           +- Aggregate [c_customer_id#2559, c_first_name#2566, c_last_name#2567, c_preferred_cust_flag#2568, c_birth_country#2572, c_login#2573, c_email_address#2574, d_year#2616], [c_customer_id#2559 AS customer_id#1533, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#2601 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#2600 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#2598 as decimal(9,2)))), DecimalType(9,2), true) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#2599 as decimal(10,2)))), DecimalType(10,2), true)) / 2.00), DecimalType(14,6), true)) AS year_total#1541]
            :              +- Project [ws_ext_discount_amt#2598, ws_ext_sales_price#2599, ws_ext_wholesale_cost#2600, ws_ext_list_price#2601, d_year#2616, c_customer_id#2559, c_first_name#2566, c_last_name#2567, c_preferred_cust_flag#2568, c_birth_country#2572, c_login#2573, c_email_address#2574]
            :                 +- Join Inner, (c_customer_sk#2558 = ws_bill_customer_sk#2580)
            :                    :- Project [ws_bill_customer_sk#2580, ws_ext_discount_amt#2598, ws_ext_sales_price#2599, ws_ext_wholesale_cost#2600, ws_ext_list_price#2601, d_year#2616]
            :                    :  +- Join Inner, (ws_sold_date_sk#2576 = d_date_sk#2610)
            :                    :     :- Project [ws_sold_date_sk#2576, ws_bill_customer_sk#2580, ws_ext_discount_amt#2598, ws_ext_sales_price#2599, ws_ext_wholesale_cost#2600, ws_ext_list_price#2601]
            :                    :     :  +- Filter (isnotnull(ws_sold_date_sk#2576) AND isnotnull(ws_bill_customer_sk#2580))
            :                    :     :     +- Relation [ws_sold_date_sk#2576,ws_sold_time_sk#2577,ws_ship_date_sk#2578,ws_item_sk#2579,ws_bill_customer_sk#2580,ws_bill_cdemo_sk#2581,ws_bill_hdemo_sk#2582,ws_bill_addr_sk#2583,ws_ship_customer_sk#2584,ws_ship_cdemo_sk#2585,ws_ship_hdemo_sk#2586,ws_ship_addr_sk#2587,ws_web_page_sk#2588,ws_web_site_sk#2589,ws_ship_mode_sk#2590,ws_warehouse_sk#2591,ws_promo_sk#2592,ws_order_number#2593L,ws_quantity#2594,ws_wholesale_cost#2595,ws_list_price#2596,ws_sales_price#2597,ws_ext_discount_amt#2598,ws_ext_sales_price#2599,... 10 more fields] parquet
            :                    :     +- Project [d_date_sk#2610, d_year#2616]
            :                    :        +- Filter ((isnotnull(d_year#2616) AND (d_year#2616 = 2001)) AND isnotnull(d_date_sk#2610))
            :                    :           +- Relation [d_date_sk#2610,d_date_id#2611,d_date#2612,d_month_seq#2613,d_week_seq#2614,d_quarter_seq#2615,d_year#2616,d_dow#2617,d_moy#2618,d_dom#2619,d_qoy#2620,d_fy_year#2621,d_fy_quarter_seq#2622,d_fy_week_seq#2623,d_day_name#2624,d_quarter_name#2625,d_holiday#2626,d_weekend#2627,d_following_holiday#2628,d_first_dom#2629,d_last_dom#2630,d_same_day_ly#2631,d_same_day_lq#2632,d_current_day#2633,... 4 more fields] parquet
            :                    +- Project [c_customer_sk#2558, c_customer_id#2559, c_first_name#2566, c_last_name#2567, c_preferred_cust_flag#2568, c_birth_country#2572, c_login#2573, c_email_address#2574]
            :                       +- Filter (isnotnull(c_customer_sk#2558) AND isnotnull(c_customer_id#2559))
            :                          +- Relation [c_customer_sk#2558,c_customer_id#2559,c_current_cdemo_sk#2560,c_current_hdemo_sk#2561,c_current_addr_sk#2562,c_first_shipto_date_sk#2563,c_first_sales_date_sk#2564,c_salutation#2565,c_first_name#2566,c_last_name#2567,c_preferred_cust_flag#2568,c_birth_day#2569,c_birth_month#2570,c_birth_year#2571,c_birth_country#2572,c_login#2573,c_email_address#2574,c_last_review_date_sk#2575] parquet
            +- Aggregate [c_customer_id#2798, c_first_name#2805, c_last_name#2806, c_preferred_cust_flag#2807, c_birth_country#2811, c_login#2812, c_email_address#2813, d_year#2855], [c_customer_id#2798 AS customer_id#1678, sum(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#2840 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#2839 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#2837 as decimal(9,2)))), DecimalType(9,2), true) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#2838 as decimal(10,2)))), DecimalType(10,2), true)) / 2.00), DecimalType(14,6), true)) AS year_total#1686]
               +- Project [ws_ext_discount_amt#2837, ws_ext_sales_price#2838, ws_ext_wholesale_cost#2839, ws_ext_list_price#2840, d_year#2855, c_customer_id#2798, c_first_name#2805, c_last_name#2806, c_preferred_cust_flag#2807, c_birth_country#2811, c_login#2812, c_email_address#2813]
                  +- Join Inner, (c_customer_sk#2797 = ws_bill_customer_sk#2819)
                     :- Project [ws_bill_customer_sk#2819, ws_ext_discount_amt#2837, ws_ext_sales_price#2838, ws_ext_wholesale_cost#2839, ws_ext_list_price#2840, d_year#2855]
                     :  +- Join Inner, (ws_sold_date_sk#2815 = d_date_sk#2849)
                     :     :- Project [ws_sold_date_sk#2815, ws_bill_customer_sk#2819, ws_ext_discount_amt#2837, ws_ext_sales_price#2838, ws_ext_wholesale_cost#2839, ws_ext_list_price#2840]
                     :     :  +- Filter (isnotnull(ws_sold_date_sk#2815) AND isnotnull(ws_bill_customer_sk#2819))
                     :     :     +- Relation [ws_sold_date_sk#2815,ws_sold_time_sk#2816,ws_ship_date_sk#2817,ws_item_sk#2818,ws_bill_customer_sk#2819,ws_bill_cdemo_sk#2820,ws_bill_hdemo_sk#2821,ws_bill_addr_sk#2822,ws_ship_customer_sk#2823,ws_ship_cdemo_sk#2824,ws_ship_hdemo_sk#2825,ws_ship_addr_sk#2826,ws_web_page_sk#2827,ws_web_site_sk#2828,ws_ship_mode_sk#2829,ws_warehouse_sk#2830,ws_promo_sk#2831,ws_order_number#2832L,ws_quantity#2833,ws_wholesale_cost#2834,ws_list_price#2835,ws_sales_price#2836,ws_ext_discount_amt#2837,ws_ext_sales_price#2838,... 10 more fields] parquet
                     :     +- Project [d_date_sk#2849, d_year#2855]
                     :        +- Filter ((isnotnull(d_year#2855) AND (d_year#2855 = 2002)) AND isnotnull(d_date_sk#2849))
                     :           +- Relation [d_date_sk#2849,d_date_id#2850,d_date#2851,d_month_seq#2852,d_week_seq#2853,d_quarter_seq#2854,d_year#2855,d_dow#2856,d_moy#2857,d_dom#2858,d_qoy#2859,d_fy_year#2860,d_fy_quarter_seq#2861,d_fy_week_seq#2862,d_day_name#2863,d_quarter_name#2864,d_holiday#2865,d_weekend#2866,d_following_holiday#2867,d_first_dom#2868,d_last_dom#2869,d_same_day_ly#2870,d_same_day_lq#2871,d_current_day#2872,... 4 more fields] parquet
                     +- Project [c_customer_sk#2797, c_customer_id#2798, c_first_name#2805, c_last_name#2806, c_preferred_cust_flag#2807, c_birth_country#2811, c_login#2812, c_email_address#2813]
                        +- Filter (isnotnull(c_customer_sk#2797) AND isnotnull(c_customer_id#2798))
                           +- Relation [c_customer_sk#2797,c_customer_id#2798,c_current_cdemo_sk#2799,c_current_hdemo_sk#2800,c_current_addr_sk#2801,c_first_shipto_date_sk#2802,c_first_sales_date_sk#2803,c_salutation#2804,c_first_name#2805,c_last_name#2806,c_preferred_cust_flag#2807,c_birth_day#2808,c_birth_month#2809,c_birth_year#2810,c_birth_country#2811,c_login#2812,c_email_address#2813,c_last_review_date_sk#2814] parquet
