AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[w_warehouse_name#188 ASC NULLS FIRST], output=[w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198,ship_carriers#14792,year#14793,jan_sales#14844,feb_sales#14845,mar_sales#14846,apr_sales#14847,may_sales#14848,jun_sales#14849,jul_sales#14850,aug_sales#14851,sep_sales#14852,oct_sales#14853,nov_sales#14854,dec_sales#14855,jan_sales_per_sq_foot#14856,feb_sales_per_sq_foot#14857,mar_sales_per_sq_foot#14858,apr_sales_per_sq_foot#14859,... 20 more fields])
   +- *(14) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793], functions=[sum(jan_sales#14794), sum(feb_sales#14795), sum(mar_sales#14796), sum(apr_sales#14797), sum(may_sales#14798), sum(jun_sales#14799), sum(jul_sales#14800), sum(aug_sales#14801), sum(sep_sales#14802), sum(oct_sales#14803), sum(nov_sales#14804), sum(dec_sales#14805), sum(CheckOverflow((promote_precision(jan_sales#14794) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(feb_sales#14795) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(mar_sales#14796) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(apr_sales#14797) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(may_sales#14798) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jun_sales#14799) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jul_sales#14800) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(aug_sales#14801) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(sep_sales#14802) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(oct_sales#14803) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(nov_sales#14804) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(dec_sales#14805) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, jan_sales#14844, feb_sales#14845, mar_sales#14846, apr_sales#14847, may_sales#14848, jun_sales#14849, jul_sales#14850, aug_sales#14851, sep_sales#14852, oct_sales#14853, nov_sales#14854, dec_sales#14855, jan_sales_per_sq_foot#14856, feb_sales_per_sq_foot#14857, mar_sales_per_sq_foot#14858, apr_sales_per_sq_foot#14859, ... 20 more fields])
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 14
            +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, 200), ENSURE_REQUIREMENTS, [id=#135879]
               +- *(13) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793], functions=[partial_sum(jan_sales#14794), partial_sum(feb_sales#14795), partial_sum(mar_sales#14796), partial_sum(apr_sales#14797), partial_sum(may_sales#14798), partial_sum(jun_sales#14799), partial_sum(jul_sales#14800), partial_sum(aug_sales#14801), partial_sum(sep_sales#14802), partial_sum(oct_sales#14803), partial_sum(nov_sales#14804), partial_sum(dec_sales#14805), partial_sum(CheckOverflow((promote_precision(jan_sales#14794) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(feb_sales#14795) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(mar_sales#14796) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(apr_sales#14797) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(may_sales#14798) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jun_sales#14799) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jul_sales#14800) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(aug_sales#14801) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(sep_sales#14802) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(oct_sales#14803) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(nov_sales#14804) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(dec_sales#14805) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, sum#15138, isEmpty#15139, sum#15140, isEmpty#15141, sum#15142, isEmpty#15143, sum#15144, isEmpty#15145, sum#15146, isEmpty#15147, sum#15148, isEmpty#15149, sum#15150, isEmpty#15151, sum#15152, isEmpty#15153, ... 56 more fields])
                  +- Union
                     :- *(11) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, jan_sales#14794, feb_sales#14795, mar_sales#14796, apr_sales#14797, may_sales#14798, jun_sales#14799, jul_sales#14800, aug_sales#14801, sep_sales#14802, oct_sales#14803, nov_sales#14804, dec_sales#14805, jan_net#14806, feb_net#14807, mar_net#14808, apr_net#14809, ... 8 more fields])
                     :  +- AQEShuffleRead coalesced
                     :     +- ShuffleQueryStage 12
                     :        +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, 200), ENSURE_REQUIREMENTS, [id=#135723]
                     :           +- *(9) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, sum#15258, isEmpty#15259, sum#15260, isEmpty#15261, sum#15262, isEmpty#15263, sum#15264, isEmpty#15265, sum#15266, isEmpty#15267, sum#15268, isEmpty#15269, sum#15270, isEmpty#15271, sum#15272, isEmpty#15273, sum#15274, ... 31 more fields])
                     :              +- *(9) Project [ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
                     :                 +- *(9) BroadcastHashJoin [ws_ship_mode_sk#398], [sm_ship_mode_sk#550], Inner, BuildRight, false
                     :                    :- *(9) Project [ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
                     :                    :  +- *(9) BroadcastHashJoin [ws_sold_time_sk#385], [t_time_sk#28], Inner, BuildRight, false
                     :                    :     :- *(9) Project [ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
                     :                    :     :  +- *(9) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#598], Inner, BuildRight, false
                     :                    :     :     :- *(9) Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
                     :                    :     :     :  +- *(9) BroadcastHashJoin [ws_warehouse_sk#399], [w_warehouse_sk#186], Inner, BuildRight, false
                     :                    :     :     :     :- *(9) Filter (((isnotnull(ws_warehouse_sk#399) AND isnotnull(ws_sold_date_sk#384)) AND isnotnull(ws_sold_time_sk#385)) AND isnotnull(ws_ship_mode_sk#398))
                     :                    :     :     :     :  +- *(9) ColumnarToRow
                     :                    :     :     :     :     +- FileScan parquet [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_quantity#402,ws_sales_price#405,ws_net_paid_inc_tax#414] Batched: true, DataFilters: [isnotnull(ws_warehouse_sk#399), isnotnull(ws_sold_date_sk#384), isnotnull(ws_sold_time_sk#385), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_warehouse_sk), IsNotNull(ws_sold_date_sk), IsNotNull(ws_sold_time_sk), IsNotNull(ws..., ReadSchema: struct<ws_sold_date_sk:int,ws_sold_time_sk:int,ws_ship_mode_sk:int,ws_warehouse_sk:int,ws_quantit...
                     :                    :     :     :     +- BroadcastQueryStage 0
                     :                    :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#135100]
                     :                    :     :     :           +- *(1) Filter isnotnull(w_warehouse_sk#186)
                     :                    :     :     :              +- *(1) ColumnarToRow
                     :                    :     :     :                 +- FileScan parquet [w_warehouse_sk#186,w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#186)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/warehouse.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
                     :                    :     :     +- BroadcastQueryStage 1
                     :                    :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#135117]
                     :                    :     :           +- *(2) Filter ((isnotnull(d_year#604) AND (d_year#604 = 2000)) AND isnotnull(d_date_sk#598))
                     :                    :     :              +- *(2) ColumnarToRow
                     :                    :     :                 +- FileScan parquet [d_date_sk#598,d_year#604,d_moy#606] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2000), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                     :                    :     +- BroadcastQueryStage 2
                     :                    :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#135136]
                     :                    :           +- *(3) Project [t_time_sk#28]
                     :                    :              +- *(3) Filter (((isnotnull(t_time#30) AND (t_time#30 >= 12143)) AND (t_time#30 <= 40943)) AND isnotnull(t_time_sk#28))
                     :                    :                 +- *(3) ColumnarToRow
                     :                    :                    +- FileScan parquet [t_time_sk#28,t_time#30] Batched: true, DataFilters: [isnotnull(t_time#30), (t_time#30 >= 12143), (t_time#30 <= 40943), isnotnull(t_time_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/time_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,12143), LessThanOrEqual(t_time,40943), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
                     :                    +- BroadcastQueryStage 3
                     :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#135157]
                     :                          +- *(4) Project [sm_ship_mode_sk#550]
                     :                             +- *(4) Filter (sm_carrier#554 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#550))
                     :                                +- *(4) ColumnarToRow
                     :                                   +- FileScan parquet [sm_ship_mode_sk#550,sm_carrier#554] Batched: true, DataFilters: [sm_carrier#554 IN (ZHOU,MSC), isnotnull(sm_ship_mode_sk#550)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/ship_mode.parquet], PartitionFilters: [], PushedFilters: [In(sm_carrier, [MSC,ZHOU]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
                     +- *(12) HashAggregate(keys=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900], functions=[sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, ship_carriers#14818, year#14819, jan_sales#14820, feb_sales#14821, mar_sales#14822, apr_sales#14823, may_sales#14824, jun_sales#14825, jul_sales#14826, aug_sales#14827, sep_sales#14828, oct_sales#14829, nov_sales#14830, dec_sales#14831, jan_net#14832, feb_net#14833, mar_net#14834, apr_net#14835, ... 8 more fields])
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage 13
                              +- Exchange hashpartitioning(w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, 200), ENSURE_REQUIREMENTS, [id=#135784]
                                 +- *(10) HashAggregate(keys=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900], functions=[partial_sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, sum#15354, isEmpty#15355, sum#15356, isEmpty#15357, sum#15358, isEmpty#15359, sum#15360, isEmpty#15361, sum#15362, isEmpty#15363, sum#15364, isEmpty#15365, sum#15366, isEmpty#15367, sum#15368, isEmpty#15369, sum#15370, ... 31 more fields])
                                    +- *(10) Project [cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                                       +- *(10) BroadcastHashJoin [cs_ship_mode_sk#131], [sm_ship_mode_sk#14932], Inner, BuildRight, false
                                          :- *(10) Project [cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                                          :  +- *(10) BroadcastHashJoin [cs_sold_time_sk#119], [t_time_sk#14922], Inner, BuildRight, false
                                          :     :- *(10) Project [cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                                          :     :  +- *(10) BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#14894], Inner, BuildRight, false
                                          :     :     :- *(10) Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892]
                                          :     :     :  +- *(10) BroadcastHashJoin [cs_warehouse_sk#132], [w_warehouse_sk#14880], Inner, BuildRight, false
                                          :     :     :     :- *(10) Filter (((isnotnull(cs_warehouse_sk#132) AND isnotnull(cs_sold_date_sk#118)) AND isnotnull(cs_sold_time_sk#119)) AND isnotnull(cs_ship_mode_sk#131))
                                          :     :     :     :  +- *(10) ColumnarToRow
                                          :     :     :     :     +- FileScan parquet [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_quantity#136,cs_ext_list_price#143,cs_net_paid_inc_tax#148] Batched: true, DataFilters: [isnotnull(cs_warehouse_sk#132), isnotnull(cs_sold_date_sk#118), isnotnull(cs_sold_time_sk#119), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_sold_time_sk), IsNotNull(cs..., ReadSchema: struct<cs_sold_date_sk:int,cs_sold_time_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_quantit...
                                          :     :     :     +- BroadcastQueryStage 5
                                          :     :     :        +- ReusedExchange [w_warehouse_sk#14880, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#135100]
                                          :     :     +- BroadcastQueryStage 7
                                          :     :        +- ReusedExchange [d_date_sk#14894, d_year#14900, d_moy#14902], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#135117]
                                          :     +- BroadcastQueryStage 9
                                          :        +- ReusedExchange [t_time_sk#14922], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#135136]
                                          +- BroadcastQueryStage 11
                                             +- ReusedExchange [sm_ship_mode_sk#14932], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#135157]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[w_warehouse_name#188 ASC NULLS FIRST], output=[w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198,ship_carriers#14792,year#14793,jan_sales#14844,feb_sales#14845,mar_sales#14846,apr_sales#14847,may_sales#14848,jun_sales#14849,jul_sales#14850,aug_sales#14851,sep_sales#14852,oct_sales#14853,nov_sales#14854,dec_sales#14855,jan_sales_per_sq_foot#14856,feb_sales_per_sq_foot#14857,mar_sales_per_sq_foot#14858,apr_sales_per_sq_foot#14859,... 20 more fields])
   +- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793], functions=[sum(jan_sales#14794), sum(feb_sales#14795), sum(mar_sales#14796), sum(apr_sales#14797), sum(may_sales#14798), sum(jun_sales#14799), sum(jul_sales#14800), sum(aug_sales#14801), sum(sep_sales#14802), sum(oct_sales#14803), sum(nov_sales#14804), sum(dec_sales#14805), sum(CheckOverflow((promote_precision(jan_sales#14794) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(feb_sales#14795) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(mar_sales#14796) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(apr_sales#14797) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(may_sales#14798) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jun_sales#14799) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jul_sales#14800) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(aug_sales#14801) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(sep_sales#14802) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(oct_sales#14803) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(nov_sales#14804) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(dec_sales#14805) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, jan_sales#14844, feb_sales#14845, mar_sales#14846, apr_sales#14847, may_sales#14848, jun_sales#14849, jul_sales#14850, aug_sales#14851, sep_sales#14852, oct_sales#14853, nov_sales#14854, dec_sales#14855, jan_sales_per_sq_foot#14856, feb_sales_per_sq_foot#14857, mar_sales_per_sq_foot#14858, apr_sales_per_sq_foot#14859, ... 20 more fields])
      +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, 200), ENSURE_REQUIREMENTS, [id=#134995]
         +- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793], functions=[partial_sum(jan_sales#14794), partial_sum(feb_sales#14795), partial_sum(mar_sales#14796), partial_sum(apr_sales#14797), partial_sum(may_sales#14798), partial_sum(jun_sales#14799), partial_sum(jul_sales#14800), partial_sum(aug_sales#14801), partial_sum(sep_sales#14802), partial_sum(oct_sales#14803), partial_sum(nov_sales#14804), partial_sum(dec_sales#14805), partial_sum(CheckOverflow((promote_precision(jan_sales#14794) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(feb_sales#14795) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(mar_sales#14796) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(apr_sales#14797) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(may_sales#14798) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jun_sales#14799) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jul_sales#14800) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(aug_sales#14801) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(sep_sales#14802) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(oct_sales#14803) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(nov_sales#14804) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(dec_sales#14805) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, sum#15138, isEmpty#15139, sum#15140, isEmpty#15141, sum#15142, isEmpty#15143, sum#15144, isEmpty#15145, sum#15146, isEmpty#15147, sum#15148, isEmpty#15149, sum#15150, isEmpty#15151, sum#15152, isEmpty#15153, ... 56 more fields])
            +- Union
               :- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, jan_sales#14794, feb_sales#14795, mar_sales#14796, apr_sales#14797, may_sales#14798, jun_sales#14799, jul_sales#14800, aug_sales#14801, sep_sales#14802, oct_sales#14803, nov_sales#14804, dec_sales#14805, jan_net#14806, feb_net#14807, mar_net#14808, apr_net#14809, ... 8 more fields])
               :  +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, 200), ENSURE_REQUIREMENTS, [id=#134971]
               :     +- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, sum#15258, isEmpty#15259, sum#15260, isEmpty#15261, sum#15262, isEmpty#15263, sum#15264, isEmpty#15265, sum#15266, isEmpty#15267, sum#15268, isEmpty#15269, sum#15270, isEmpty#15271, sum#15272, isEmpty#15273, sum#15274, ... 31 more fields])
               :        +- Project [ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
               :           +- BroadcastHashJoin [ws_ship_mode_sk#398], [sm_ship_mode_sk#550], Inner, BuildRight, false
               :              :- Project [ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
               :              :  +- BroadcastHashJoin [ws_sold_time_sk#385], [t_time_sk#28], Inner, BuildRight, false
               :              :     :- Project [ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
               :              :     :  +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#598], Inner, BuildRight, false
               :              :     :     :- Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
               :              :     :     :  +- BroadcastHashJoin [ws_warehouse_sk#399], [w_warehouse_sk#186], Inner, BuildRight, false
               :              :     :     :     :- Filter (((isnotnull(ws_warehouse_sk#399) AND isnotnull(ws_sold_date_sk#384)) AND isnotnull(ws_sold_time_sk#385)) AND isnotnull(ws_ship_mode_sk#398))
               :              :     :     :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_quantity#402,ws_sales_price#405,ws_net_paid_inc_tax#414] Batched: true, DataFilters: [isnotnull(ws_warehouse_sk#399), isnotnull(ws_sold_date_sk#384), isnotnull(ws_sold_time_sk#385), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_warehouse_sk), IsNotNull(ws_sold_date_sk), IsNotNull(ws_sold_time_sk), IsNotNull(ws..., ReadSchema: struct<ws_sold_date_sk:int,ws_sold_time_sk:int,ws_ship_mode_sk:int,ws_warehouse_sk:int,ws_quantit...
               :              :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#134954]
               :              :     :     :        +- Filter isnotnull(w_warehouse_sk#186)
               :              :     :     :           +- FileScan parquet [w_warehouse_sk#186,w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#186)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/warehouse.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
               :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#134958]
               :              :     :        +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 2000)) AND isnotnull(d_date_sk#598))
               :              :     :           +- FileScan parquet [d_date_sk#598,d_year#604,d_moy#606] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2000), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#134962]
               :              :        +- Project [t_time_sk#28]
               :              :           +- Filter (((isnotnull(t_time#30) AND (t_time#30 >= 12143)) AND (t_time#30 <= 40943)) AND isnotnull(t_time_sk#28))
               :              :              +- FileScan parquet [t_time_sk#28,t_time#30] Batched: true, DataFilters: [isnotnull(t_time#30), (t_time#30 >= 12143), (t_time#30 <= 40943), isnotnull(t_time_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/time_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,12143), LessThanOrEqual(t_time,40943), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
               :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#134966]
               :                 +- Project [sm_ship_mode_sk#550]
               :                    +- Filter (sm_carrier#554 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#550))
               :                       +- FileScan parquet [sm_ship_mode_sk#550,sm_carrier#554] Batched: true, DataFilters: [sm_carrier#554 IN (ZHOU,MSC), isnotnull(sm_ship_mode_sk#550)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/ship_mode.parquet], PartitionFilters: [], PushedFilters: [In(sm_carrier, [MSC,ZHOU]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
               +- HashAggregate(keys=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900], functions=[sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, ship_carriers#14818, year#14819, jan_sales#14820, feb_sales#14821, mar_sales#14822, apr_sales#14823, may_sales#14824, jun_sales#14825, jul_sales#14826, aug_sales#14827, sep_sales#14828, oct_sales#14829, nov_sales#14830, dec_sales#14831, jan_net#14832, feb_net#14833, mar_net#14834, apr_net#14835, ... 8 more fields])
                  +- Exchange hashpartitioning(w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, 200), ENSURE_REQUIREMENTS, [id=#134990]
                     +- HashAggregate(keys=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900], functions=[partial_sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, sum#15354, isEmpty#15355, sum#15356, isEmpty#15357, sum#15358, isEmpty#15359, sum#15360, isEmpty#15361, sum#15362, isEmpty#15363, sum#15364, isEmpty#15365, sum#15366, isEmpty#15367, sum#15368, isEmpty#15369, sum#15370, ... 31 more fields])
                        +- Project [cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                           +- BroadcastHashJoin [cs_ship_mode_sk#131], [sm_ship_mode_sk#14932], Inner, BuildRight, false
                              :- Project [cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                              :  +- BroadcastHashJoin [cs_sold_time_sk#119], [t_time_sk#14922], Inner, BuildRight, false
                              :     :- Project [cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                              :     :  +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#14894], Inner, BuildRight, false
                              :     :     :- Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892]
                              :     :     :  +- BroadcastHashJoin [cs_warehouse_sk#132], [w_warehouse_sk#14880], Inner, BuildRight, false
                              :     :     :     :- Filter (((isnotnull(cs_warehouse_sk#132) AND isnotnull(cs_sold_date_sk#118)) AND isnotnull(cs_sold_time_sk#119)) AND isnotnull(cs_ship_mode_sk#131))
                              :     :     :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_quantity#136,cs_ext_list_price#143,cs_net_paid_inc_tax#148] Batched: true, DataFilters: [isnotnull(cs_warehouse_sk#132), isnotnull(cs_sold_date_sk#118), isnotnull(cs_sold_time_sk#119), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_sold_time_sk), IsNotNull(cs..., ReadSchema: struct<cs_sold_date_sk:int,cs_sold_time_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_quantit...
                              :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#134973]
                              :     :     :        +- Filter isnotnull(w_warehouse_sk#14880)
                              :     :     :           +- FileScan parquet [w_warehouse_sk#14880,w_warehouse_name#14882,w_warehouse_sq_ft#14883,w_city#14888,w_county#14889,w_state#14890,w_country#14892] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#14880)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/warehouse.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
                              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#134977]
                              :     :        +- Filter ((isnotnull(d_year#14900) AND (d_year#14900 = 2000)) AND isnotnull(d_date_sk#14894))
                              :     :           +- FileScan parquet [d_date_sk#14894,d_year#14900,d_moy#14902] Batched: true, DataFilters: [isnotnull(d_year#14900), (d_year#14900 = 2000), isnotnull(d_date_sk#14894)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#134981]
                              :        +- Project [t_time_sk#14922]
                              :           +- Filter (((isnotnull(t_time#14924) AND (t_time#14924 >= 12143)) AND (t_time#14924 <= 40943)) AND isnotnull(t_time_sk#14922))
                              :              +- FileScan parquet [t_time_sk#14922,t_time#14924] Batched: true, DataFilters: [isnotnull(t_time#14924), (t_time#14924 >= 12143), (t_time#14924 <= 40943), isnotnull(t_time_sk#1..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/time_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,12143), LessThanOrEqual(t_time,40943), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#134985]
                                 +- Project [sm_ship_mode_sk#14932]
                                    +- Filter (sm_carrier#14936 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#14932))
                                       +- FileScan parquet [sm_ship_mode_sk#14932,sm_carrier#14936] Batched: true, DataFilters: [sm_carrier#14936 IN (ZHOU,MSC), isnotnull(sm_ship_mode_sk#14932)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/ship_mode.parquet], PartitionFilters: [], PushedFilters: [In(sm_carrier, [MSC,ZHOU]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
