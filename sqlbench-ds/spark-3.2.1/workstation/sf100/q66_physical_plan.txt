AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[w_warehouse_name#188 ASC NULLS FIRST], output=[w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198,ship_carriers#13409,year#13410,jan_sales#13461,feb_sales#13462,mar_sales#13463,apr_sales#13464,may_sales#13465,jun_sales#13466,jul_sales#13467,aug_sales#13468,sep_sales#13469,oct_sales#13470,nov_sales#13471,dec_sales#13472,jan_sales_per_sq_foot#13473,feb_sales_per_sq_foot#13474,mar_sales_per_sq_foot#13475,apr_sales_per_sq_foot#13476,... 20 more fields])
   +- *(14) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410], functions=[sum(jan_sales#13411), sum(feb_sales#13412), sum(mar_sales#13413), sum(apr_sales#13414), sum(may_sales#13415), sum(jun_sales#13416), sum(jul_sales#13417), sum(aug_sales#13418), sum(sep_sales#13419), sum(oct_sales#13420), sum(nov_sales#13421), sum(dec_sales#13422), sum(CheckOverflow((promote_precision(jan_sales#13411) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(feb_sales#13412) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(mar_sales#13413) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(apr_sales#13414) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(may_sales#13415) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jun_sales#13416) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jul_sales#13417) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(aug_sales#13418) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(sep_sales#13419) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(oct_sales#13420) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(nov_sales#13421) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(dec_sales#13422) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, jan_sales#13461, feb_sales#13462, mar_sales#13463, apr_sales#13464, may_sales#13465, jun_sales#13466, jul_sales#13467, aug_sales#13468, sep_sales#13469, oct_sales#13470, nov_sales#13471, dec_sales#13472, jan_sales_per_sq_foot#13473, feb_sales_per_sq_foot#13474, mar_sales_per_sq_foot#13475, apr_sales_per_sq_foot#13476, ... 20 more fields])
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 14
            +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, 200), ENSURE_REQUIREMENTS, [id=#113441]
               +- *(13) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410], functions=[partial_sum(jan_sales#13411), partial_sum(feb_sales#13412), partial_sum(mar_sales#13413), partial_sum(apr_sales#13414), partial_sum(may_sales#13415), partial_sum(jun_sales#13416), partial_sum(jul_sales#13417), partial_sum(aug_sales#13418), partial_sum(sep_sales#13419), partial_sum(oct_sales#13420), partial_sum(nov_sales#13421), partial_sum(dec_sales#13422), partial_sum(CheckOverflow((promote_precision(jan_sales#13411) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(feb_sales#13412) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(mar_sales#13413) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(apr_sales#13414) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(may_sales#13415) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jun_sales#13416) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jul_sales#13417) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(aug_sales#13418) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(sep_sales#13419) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(oct_sales#13420) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(nov_sales#13421) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(dec_sales#13422) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, sum#13755, isEmpty#13756, sum#13757, isEmpty#13758, sum#13759, isEmpty#13760, sum#13761, isEmpty#13762, sum#13763, isEmpty#13764, sum#13765, isEmpty#13766, sum#13767, isEmpty#13768, sum#13769, isEmpty#13770, ... 56 more fields])
                  +- Union
                     :- *(11) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, jan_sales#13411, feb_sales#13412, mar_sales#13413, apr_sales#13414, may_sales#13415, jun_sales#13416, jul_sales#13417, aug_sales#13418, sep_sales#13419, oct_sales#13420, nov_sales#13421, dec_sales#13422, jan_net#13423, feb_net#13424, mar_net#13425, apr_net#13426, ... 8 more fields])
                     :  +- AQEShuffleRead coalesced
                     :     +- ShuffleQueryStage 12
                     :        +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, 200), ENSURE_REQUIREMENTS, [id=#113285]
                     :           +- *(9) HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, sum#13875, isEmpty#13876, sum#13877, isEmpty#13878, sum#13879, isEmpty#13880, sum#13881, isEmpty#13882, sum#13883, isEmpty#13884, sum#13885, isEmpty#13886, sum#13887, isEmpty#13888, sum#13889, isEmpty#13890, sum#13891, ... 31 more fields])
                     :              +- *(9) Project [ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
                     :                 +- *(9) BroadcastHashJoin [ws_ship_mode_sk#398], [sm_ship_mode_sk#550], Inner, BuildRight, false
                     :                    :- *(9) Project [ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
                     :                    :  +- *(9) BroadcastHashJoin [ws_sold_time_sk#385], [t_time_sk#28], Inner, BuildRight, false
                     :                    :     :- *(9) Project [ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
                     :                    :     :  +- *(9) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#598], Inner, BuildRight, false
                     :                    :     :     :- *(9) Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
                     :                    :     :     :  +- *(9) BroadcastHashJoin [ws_warehouse_sk#399], [w_warehouse_sk#186], Inner, BuildRight, false
                     :                    :     :     :     :- *(9) Filter (((isnotnull(ws_warehouse_sk#399) AND isnotnull(ws_sold_date_sk#384)) AND isnotnull(ws_sold_time_sk#385)) AND isnotnull(ws_ship_mode_sk#398))
                     :                    :     :     :     :  +- *(9) ColumnarToRow
                     :                    :     :     :     :     +- FileScan parquet [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_quantity#402,ws_sales_price#405,ws_net_paid_inc_tax#414] Batched: true, DataFilters: [isnotnull(ws_warehouse_sk#399), isnotnull(ws_sold_date_sk#384), isnotnull(ws_sold_time_sk#385), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_warehouse_sk), IsNotNull(ws_sold_date_sk), IsNotNull(ws_sold_time_sk), IsNotNull(ws..., ReadSchema: struct<ws_sold_date_sk:int,ws_sold_time_sk:int,ws_ship_mode_sk:int,ws_warehouse_sk:int,ws_quantit...
                     :                    :     :     :     +- BroadcastQueryStage 0
                     :                    :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112662]
                     :                    :     :     :           +- *(1) Filter isnotnull(w_warehouse_sk#186)
                     :                    :     :     :              +- *(1) ColumnarToRow
                     :                    :     :     :                 +- FileScan parquet [w_warehouse_sk#186,w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#186)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/warehouse.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
                     :                    :     :     +- BroadcastQueryStage 1
                     :                    :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112679]
                     :                    :     :           +- *(2) Filter ((isnotnull(d_year#604) AND (d_year#604 = 2000)) AND isnotnull(d_date_sk#598))
                     :                    :     :              +- *(2) ColumnarToRow
                     :                    :     :                 +- FileScan parquet [d_date_sk#598,d_year#604,d_moy#606] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2000), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                     :                    :     +- BroadcastQueryStage 2
                     :                    :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112698]
                     :                    :           +- *(3) Project [t_time_sk#28]
                     :                    :              +- *(3) Filter (((isnotnull(t_time#30) AND (t_time#30 >= 12143)) AND (t_time#30 <= 40943)) AND isnotnull(t_time_sk#28))
                     :                    :                 +- *(3) ColumnarToRow
                     :                    :                    +- FileScan parquet [t_time_sk#28,t_time#30] Batched: true, DataFilters: [isnotnull(t_time#30), (t_time#30 >= 12143), (t_time#30 <= 40943), isnotnull(t_time_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/time_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,12143), LessThanOrEqual(t_time,40943), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
                     :                    +- BroadcastQueryStage 3
                     :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112719]
                     :                          +- *(4) Project [sm_ship_mode_sk#550]
                     :                             +- *(4) Filter (sm_carrier#554 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#550))
                     :                                +- *(4) ColumnarToRow
                     :                                   +- FileScan parquet [sm_ship_mode_sk#550,sm_carrier#554] Batched: true, DataFilters: [sm_carrier#554 IN (ZHOU,MSC), isnotnull(sm_ship_mode_sk#550)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/ship_mode.parquet], PartitionFilters: [], PushedFilters: [In(sm_carrier, [MSC,ZHOU]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
                     +- *(12) HashAggregate(keys=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517], functions=[sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, ship_carriers#13435, year#13436, jan_sales#13437, feb_sales#13438, mar_sales#13439, apr_sales#13440, may_sales#13441, jun_sales#13442, jul_sales#13443, aug_sales#13444, sep_sales#13445, oct_sales#13446, nov_sales#13447, dec_sales#13448, jan_net#13449, feb_net#13450, mar_net#13451, apr_net#13452, ... 8 more fields])
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage 13
                              +- Exchange hashpartitioning(w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, 200), ENSURE_REQUIREMENTS, [id=#113346]
                                 +- *(10) HashAggregate(keys=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517], functions=[partial_sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, sum#13971, isEmpty#13972, sum#13973, isEmpty#13974, sum#13975, isEmpty#13976, sum#13977, isEmpty#13978, sum#13979, isEmpty#13980, sum#13981, isEmpty#13982, sum#13983, isEmpty#13984, sum#13985, isEmpty#13986, sum#13987, ... 31 more fields])
                                    +- *(10) Project [cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                                       +- *(10) BroadcastHashJoin [cs_ship_mode_sk#131], [sm_ship_mode_sk#13549], Inner, BuildRight, false
                                          :- *(10) Project [cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                                          :  +- *(10) BroadcastHashJoin [cs_sold_time_sk#119], [t_time_sk#13539], Inner, BuildRight, false
                                          :     :- *(10) Project [cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                                          :     :  +- *(10) BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#13511], Inner, BuildRight, false
                                          :     :     :- *(10) Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509]
                                          :     :     :  +- *(10) BroadcastHashJoin [cs_warehouse_sk#132], [w_warehouse_sk#13497], Inner, BuildRight, false
                                          :     :     :     :- *(10) Filter (((isnotnull(cs_warehouse_sk#132) AND isnotnull(cs_sold_date_sk#118)) AND isnotnull(cs_sold_time_sk#119)) AND isnotnull(cs_ship_mode_sk#131))
                                          :     :     :     :  +- *(10) ColumnarToRow
                                          :     :     :     :     +- FileScan parquet [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_quantity#136,cs_ext_list_price#143,cs_net_paid_inc_tax#148] Batched: true, DataFilters: [isnotnull(cs_warehouse_sk#132), isnotnull(cs_sold_date_sk#118), isnotnull(cs_sold_time_sk#119), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_sold_time_sk), IsNotNull(cs..., ReadSchema: struct<cs_sold_date_sk:int,cs_sold_time_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_quantit...
                                          :     :     :     +- BroadcastQueryStage 5
                                          :     :     :        +- ReusedExchange [w_warehouse_sk#13497, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112662]
                                          :     :     +- BroadcastQueryStage 7
                                          :     :        +- ReusedExchange [d_date_sk#13511, d_year#13517, d_moy#13519], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112679]
                                          :     +- BroadcastQueryStage 9
                                          :        +- ReusedExchange [t_time_sk#13539], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112698]
                                          +- BroadcastQueryStage 11
                                             +- ReusedExchange [sm_ship_mode_sk#13549], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112719]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[w_warehouse_name#188 ASC NULLS FIRST], output=[w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198,ship_carriers#13409,year#13410,jan_sales#13461,feb_sales#13462,mar_sales#13463,apr_sales#13464,may_sales#13465,jun_sales#13466,jul_sales#13467,aug_sales#13468,sep_sales#13469,oct_sales#13470,nov_sales#13471,dec_sales#13472,jan_sales_per_sq_foot#13473,feb_sales_per_sq_foot#13474,mar_sales_per_sq_foot#13475,apr_sales_per_sq_foot#13476,... 20 more fields])
   +- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410], functions=[sum(jan_sales#13411), sum(feb_sales#13412), sum(mar_sales#13413), sum(apr_sales#13414), sum(may_sales#13415), sum(jun_sales#13416), sum(jul_sales#13417), sum(aug_sales#13418), sum(sep_sales#13419), sum(oct_sales#13420), sum(nov_sales#13421), sum(dec_sales#13422), sum(CheckOverflow((promote_precision(jan_sales#13411) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(feb_sales#13412) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(mar_sales#13413) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(apr_sales#13414) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(may_sales#13415) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jun_sales#13416) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(jul_sales#13417) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(aug_sales#13418) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(sep_sales#13419) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(oct_sales#13420) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(nov_sales#13421) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), sum(CheckOverflow((promote_precision(dec_sales#13422) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, jan_sales#13461, feb_sales#13462, mar_sales#13463, apr_sales#13464, may_sales#13465, jun_sales#13466, jul_sales#13467, aug_sales#13468, sep_sales#13469, oct_sales#13470, nov_sales#13471, dec_sales#13472, jan_sales_per_sq_foot#13473, feb_sales_per_sq_foot#13474, mar_sales_per_sq_foot#13475, apr_sales_per_sq_foot#13476, ... 20 more fields])
      +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, 200), ENSURE_REQUIREMENTS, [id=#112557]
         +- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410], functions=[partial_sum(jan_sales#13411), partial_sum(feb_sales#13412), partial_sum(mar_sales#13413), partial_sum(apr_sales#13414), partial_sum(may_sales#13415), partial_sum(jun_sales#13416), partial_sum(jul_sales#13417), partial_sum(aug_sales#13418), partial_sum(sep_sales#13419), partial_sum(oct_sales#13420), partial_sum(nov_sales#13421), partial_sum(dec_sales#13422), partial_sum(CheckOverflow((promote_precision(jan_sales#13411) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(feb_sales#13412) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(mar_sales#13413) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(apr_sales#13414) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(may_sales#13415) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jun_sales#13416) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(jul_sales#13417) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(aug_sales#13418) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(sep_sales#13419) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(oct_sales#13420) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(nov_sales#13421) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), partial_sum(CheckOverflow((promote_precision(dec_sales#13422) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)), ... 12 more fields], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, sum#13755, isEmpty#13756, sum#13757, isEmpty#13758, sum#13759, isEmpty#13760, sum#13761, isEmpty#13762, sum#13763, isEmpty#13764, sum#13765, isEmpty#13766, sum#13767, isEmpty#13768, sum#13769, isEmpty#13770, ... 56 more fields])
            +- Union
               :- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, jan_sales#13411, feb_sales#13412, mar_sales#13413, apr_sales#13414, may_sales#13415, jun_sales#13416, jul_sales#13417, aug_sales#13418, sep_sales#13419, oct_sales#13420, nov_sales#13421, dec_sales#13422, jan_net#13423, feb_net#13424, mar_net#13425, apr_net#13426, ... 8 more fields])
               :  +- Exchange hashpartitioning(w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, 200), ENSURE_REQUIREMENTS, [id=#112533]
               :     +- HashAggregate(keys=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], functions=[partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, sum#13875, isEmpty#13876, sum#13877, isEmpty#13878, sum#13879, isEmpty#13880, sum#13881, isEmpty#13882, sum#13883, isEmpty#13884, sum#13885, isEmpty#13886, sum#13887, isEmpty#13888, sum#13889, isEmpty#13890, sum#13891, ... 31 more fields])
               :        +- Project [ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
               :           +- BroadcastHashJoin [ws_ship_mode_sk#398], [sm_ship_mode_sk#550], Inner, BuildRight, false
               :              :- Project [ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
               :              :  +- BroadcastHashJoin [ws_sold_time_sk#385], [t_time_sk#28], Inner, BuildRight, false
               :              :     :- Project [ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
               :              :     :  +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#598], Inner, BuildRight, false
               :              :     :     :- Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
               :              :     :     :  +- BroadcastHashJoin [ws_warehouse_sk#399], [w_warehouse_sk#186], Inner, BuildRight, false
               :              :     :     :     :- Filter (((isnotnull(ws_warehouse_sk#399) AND isnotnull(ws_sold_date_sk#384)) AND isnotnull(ws_sold_time_sk#385)) AND isnotnull(ws_ship_mode_sk#398))
               :              :     :     :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_quantity#402,ws_sales_price#405,ws_net_paid_inc_tax#414] Batched: true, DataFilters: [isnotnull(ws_warehouse_sk#399), isnotnull(ws_sold_date_sk#384), isnotnull(ws_sold_time_sk#385), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_warehouse_sk), IsNotNull(ws_sold_date_sk), IsNotNull(ws_sold_time_sk), IsNotNull(ws..., ReadSchema: struct<ws_sold_date_sk:int,ws_sold_time_sk:int,ws_ship_mode_sk:int,ws_warehouse_sk:int,ws_quantit...
               :              :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112516]
               :              :     :     :        +- Filter isnotnull(w_warehouse_sk#186)
               :              :     :     :           +- FileScan parquet [w_warehouse_sk#186,w_warehouse_name#188,w_warehouse_sq_ft#189,w_city#194,w_county#195,w_state#196,w_country#198] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#186)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/warehouse.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
               :              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112520]
               :              :     :        +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 2000)) AND isnotnull(d_date_sk#598))
               :              :     :           +- FileScan parquet [d_date_sk#598,d_year#604,d_moy#606] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 2000), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               :              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112524]
               :              :        +- Project [t_time_sk#28]
               :              :           +- Filter (((isnotnull(t_time#30) AND (t_time#30 >= 12143)) AND (t_time#30 <= 40943)) AND isnotnull(t_time_sk#28))
               :              :              +- FileScan parquet [t_time_sk#28,t_time#30] Batched: true, DataFilters: [isnotnull(t_time#30), (t_time#30 >= 12143), (t_time#30 <= 40943), isnotnull(t_time_sk#28)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/time_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,12143), LessThanOrEqual(t_time,40943), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
               :              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112528]
               :                 +- Project [sm_ship_mode_sk#550]
               :                    +- Filter (sm_carrier#554 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#550))
               :                       +- FileScan parquet [sm_ship_mode_sk#550,sm_carrier#554] Batched: true, DataFilters: [sm_carrier#554 IN (ZHOU,MSC), isnotnull(sm_ship_mode_sk#550)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/ship_mode.parquet], PartitionFilters: [], PushedFilters: [In(sm_carrier, [MSC,ZHOU]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
               +- HashAggregate(keys=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517], functions=[sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, ship_carriers#13435, year#13436, jan_sales#13437, feb_sales#13438, mar_sales#13439, apr_sales#13440, may_sales#13441, jun_sales#13442, jul_sales#13443, aug_sales#13444, sep_sales#13445, oct_sales#13446, nov_sales#13447, dec_sales#13448, jan_net#13449, feb_net#13450, mar_net#13451, apr_net#13452, ... 8 more fields])
                  +- Exchange hashpartitioning(w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, 200), ENSURE_REQUIREMENTS, [id=#112552]
                     +- HashAggregate(keys=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517], functions=[partial_sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END), partial_sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END)], output=[w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, sum#13971, isEmpty#13972, sum#13973, isEmpty#13974, sum#13975, isEmpty#13976, sum#13977, isEmpty#13978, sum#13979, isEmpty#13980, sum#13981, isEmpty#13982, sum#13983, isEmpty#13984, sum#13985, isEmpty#13986, sum#13987, ... 31 more fields])
                        +- Project [cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                           +- BroadcastHashJoin [cs_ship_mode_sk#131], [sm_ship_mode_sk#13549], Inner, BuildRight, false
                              :- Project [cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                              :  +- BroadcastHashJoin [cs_sold_time_sk#119], [t_time_sk#13539], Inner, BuildRight, false
                              :     :- Project [cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                              :     :  +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#13511], Inner, BuildRight, false
                              :     :     :- Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509]
                              :     :     :  +- BroadcastHashJoin [cs_warehouse_sk#132], [w_warehouse_sk#13497], Inner, BuildRight, false
                              :     :     :     :- Filter (((isnotnull(cs_warehouse_sk#132) AND isnotnull(cs_sold_date_sk#118)) AND isnotnull(cs_sold_time_sk#119)) AND isnotnull(cs_ship_mode_sk#131))
                              :     :     :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_quantity#136,cs_ext_list_price#143,cs_net_paid_inc_tax#148] Batched: true, DataFilters: [isnotnull(cs_warehouse_sk#132), isnotnull(cs_sold_date_sk#118), isnotnull(cs_sold_time_sk#119), ..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_warehouse_sk), IsNotNull(cs_sold_date_sk), IsNotNull(cs_sold_time_sk), IsNotNull(cs..., ReadSchema: struct<cs_sold_date_sk:int,cs_sold_time_sk:int,cs_ship_mode_sk:int,cs_warehouse_sk:int,cs_quantit...
                              :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112535]
                              :     :     :        +- Filter isnotnull(w_warehouse_sk#13497)
                              :     :     :           +- FileScan parquet [w_warehouse_sk#13497,w_warehouse_name#13499,w_warehouse_sq_ft#13500,w_city#13505,w_county#13506,w_state#13507,w_country#13509] Batched: true, DataFilters: [isnotnull(w_warehouse_sk#13497)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/warehouse.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(w_warehouse_sk)], ReadSchema: struct<w_warehouse_sk:int,w_warehouse_name:string,w_warehouse_sq_ft:int,w_city:string,w_county:st...
                              :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#112539]
                              :     :        +- Filter ((isnotnull(d_year#13517) AND (d_year#13517 = 2000)) AND isnotnull(d_date_sk#13511))
                              :     :           +- FileScan parquet [d_date_sk#13511,d_year#13517,d_moy#13519] Batched: true, DataFilters: [isnotnull(d_year#13517), (d_year#13517 = 2000), isnotnull(d_date_sk#13511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112543]
                              :        +- Project [t_time_sk#13539]
                              :           +- Filter (((isnotnull(t_time#13541) AND (t_time#13541 >= 12143)) AND (t_time#13541 <= 40943)) AND isnotnull(t_time_sk#13539))
                              :              +- FileScan parquet [t_time_sk#13539,t_time#13541] Batched: true, DataFilters: [isnotnull(t_time#13541), (t_time#13541 >= 12143), (t_time#13541 <= 40943), isnotnull(t_time_sk#1..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/time_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(t_time), GreaterThanOrEqual(t_time,12143), LessThanOrEqual(t_time,40943), IsNotNull(t_..., ReadSchema: struct<t_time_sk:int,t_time:int>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#112547]
                                 +- Project [sm_ship_mode_sk#13549]
                                    +- Filter (sm_carrier#13553 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#13549))
                                       +- FileScan parquet [sm_ship_mode_sk#13549,sm_carrier#13553] Batched: true, DataFilters: [sm_carrier#13553 IN (ZHOU,MSC), isnotnull(sm_ship_mode_sk#13549)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/ship_mode.parquet], PartitionFilters: [], PushedFilters: [In(sm_carrier, [MSC,ZHOU]), IsNotNull(sm_ship_mode_sk)], ReadSchema: struct<sm_ship_mode_sk:int,sm_carrier:string>
