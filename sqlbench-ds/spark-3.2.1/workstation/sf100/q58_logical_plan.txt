GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#11625 ASC NULLS FIRST, ss_item_rev#11626 ASC NULLS FIRST], true
      +- Project [item_id#11625, ss_item_rev#11626, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS ss_dev#11621, cs_item_rev#11630, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(cs_item_rev#11630 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS cs_dev#11622, ws_item_rev#11634, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ws_item_rev#11634 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS ws_dev#11623, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true) AS average#11624]
         +- Join Inner, (((((((((item_id#11625 = item_id#11633) AND (cast(ss_item_rev#11626 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#11634)), DecimalType(19,3), true))) AND (cast(ss_item_rev#11626 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#11634)), DecimalType(20,3), true))) AND (cast(cs_item_rev#11630 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#11634)), DecimalType(19,3), true))) AND (cast(cs_item_rev#11630 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#11634)), DecimalType(20,3), true))) AND (cast(ws_item_rev#11634 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#11626)), DecimalType(19,3), true))) AND (cast(ws_item_rev#11634 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#11626)), DecimalType(20,3), true))) AND (cast(ws_item_rev#11634 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#11630)), DecimalType(19,3), true))) AND (cast(ws_item_rev#11634 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#11630)), DecimalType(20,3), true)))
            :- Project [item_id#11625, ss_item_rev#11626, cs_item_rev#11630]
            :  +- Join Inner, (((((item_id#11625 = item_id#11629) AND (cast(ss_item_rev#11626 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#11630)), DecimalType(19,3), true))) AND (cast(ss_item_rev#11626 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#11630)), DecimalType(20,3), true))) AND (cast(cs_item_rev#11630 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#11626)), DecimalType(19,3), true))) AND (cast(cs_item_rev#11630 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#11626)), DecimalType(20,3), true)))
            :     :- Filter isnotnull(ss_item_rev#11626)
            :     :  +- Aggregate [i_item_id#501], [i_item_id#501 AS item_id#11625, MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#679)),17,2) AS ss_item_rev#11626]
            :     :     +- Project [ss_ext_sales_price#679, i_item_id#501]
            :     :        +- Join Inner, (ss_sold_date_sk#664 = d_date_sk#598)
            :     :           :- Project [ss_sold_date_sk#664, ss_ext_sales_price#679, i_item_id#501]
            :     :           :  +- Join Inner, (ss_item_sk#666 = i_item_sk#500)
            :     :           :     :- Project [ss_sold_date_sk#664, ss_item_sk#666, ss_ext_sales_price#679]
            :     :           :     :  +- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
            :     :           :     :     +- Relation [ss_sold_date_sk#664,ss_sold_time_sk#665,ss_item_sk#666,ss_customer_sk#667,ss_cdemo_sk#668,ss_hdemo_sk#669,ss_addr_sk#670,ss_store_sk#671,ss_promo_sk#672,ss_ticket_number#673L,ss_quantity#674,ss_wholesale_cost#675,ss_list_price#676,ss_sales_price#677,ss_ext_discount_amt#678,ss_ext_sales_price#679,ss_ext_wholesale_cost#680,ss_ext_list_price#681,ss_ext_tax#682,ss_coupon_amt#683,ss_net_paid#684,ss_net_paid_inc_tax#685,ss_net_profit#686] parquet
            :     :           :     +- Project [i_item_sk#500, i_item_id#501]
            :     :           :        +- Filter (isnotnull(i_item_sk#500) AND isnotnull(i_item_id#501))
            :     :           :           +- Relation [i_item_sk#500,i_item_id#501,i_rec_start_date#502,i_rec_end_date#503,i_item_desc#504,i_current_price#505,i_wholesale_cost#506,i_brand_id#507,i_brand#508,i_class_id#509,i_class#510,i_category_id#511,i_category#512,i_manufact_id#513,i_manufact#514,i_size#515,i_formulation#516,i_color#517,i_units#518,i_container#519,i_manager_id#520,i_product_name#521] parquet
            :     :           +- Project [d_date_sk#598]
            :     :              +- Join LeftSemi, (d_date#600 = d_date#11823)
            :     :                 :- Project [d_date_sk#598, d_date#600]
            :     :                 :  +- Filter isnotnull(d_date_sk#598)
            :     :                 :     +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
            :     :                 +- Project [d_date#11823]
            :     :                    +- Filter (isnotnull(d_week_seq#11825) AND (d_week_seq#11825 = scalar-subquery#11627 []))
            :     :                       :  +- Project [d_week_seq#11741]
            :     :                       :     +- Filter (isnotnull(d_date#11739) AND (d_date#11739 = 2000-07-21))
            :     :                       :        +- Relation [d_date_sk#11737,d_date_id#11738,d_date#11739,d_month_seq#11740,d_week_seq#11741,d_quarter_seq#11742,d_year#11743,d_dow#11744,d_moy#11745,d_dom#11746,d_qoy#11747,d_fy_year#11748,d_fy_quarter_seq#11749,d_fy_week_seq#11750,d_day_name#11751,d_quarter_name#11752,d_holiday#11753,d_weekend#11754,d_following_holiday#11755,d_first_dom#11756,d_last_dom#11757,d_same_day_ly#11758,d_same_day_lq#11759,d_current_day#11760,... 4 more fields] parquet
            :     :                       +- Relation [d_date_sk#11821,d_date_id#11822,d_date#11823,d_month_seq#11824,d_week_seq#11825,d_quarter_seq#11826,d_year#11827,d_dow#11828,d_moy#11829,d_dom#11830,d_qoy#11831,d_fy_year#11832,d_fy_quarter_seq#11833,d_fy_week_seq#11834,d_day_name#11835,d_quarter_name#11836,d_holiday#11837,d_weekend#11838,d_following_holiday#11839,d_first_dom#11840,d_last_dom#11841,d_same_day_ly#11842,d_same_day_lq#11843,d_current_day#11844,... 4 more fields] parquet
            :     +- Filter isnotnull(cs_item_rev#11630)
            :        +- Aggregate [i_item_id#11638], [i_item_id#11638 AS item_id#11629, MakeDecimal(sum(UnscaledValue(cs_ext_sales_price#141)),17,2) AS cs_item_rev#11630]
            :           +- Project [cs_ext_sales_price#141, i_item_id#11638]
            :              +- Join Inner, (cs_sold_date_sk#118 = d_date_sk#11659)
            :                 :- Project [cs_sold_date_sk#118, cs_ext_sales_price#141, i_item_id#11638]
            :                 :  +- Join Inner, (cs_item_sk#133 = i_item_sk#11637)
            :                 :     :- Project [cs_sold_date_sk#118, cs_item_sk#133, cs_ext_sales_price#141]
            :                 :     :  +- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
            :                 :     :     +- Relation [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_date_sk#120,cs_bill_customer_sk#121,cs_bill_cdemo_sk#122,cs_bill_hdemo_sk#123,cs_bill_addr_sk#124,cs_ship_customer_sk#125,cs_ship_cdemo_sk#126,cs_ship_hdemo_sk#127,cs_ship_addr_sk#128,cs_call_center_sk#129,cs_catalog_page_sk#130,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_item_sk#133,cs_promo_sk#134,cs_order_number#135L,cs_quantity#136,cs_wholesale_cost#137,cs_list_price#138,cs_sales_price#139,cs_ext_discount_amt#140,cs_ext_sales_price#141,... 10 more fields] parquet
            :                 :     +- Project [i_item_sk#11637, i_item_id#11638]
            :                 :        +- Filter (isnotnull(i_item_sk#11637) AND isnotnull(i_item_id#11638))
            :                 :           +- Relation [i_item_sk#11637,i_item_id#11638,i_rec_start_date#11639,i_rec_end_date#11640,i_item_desc#11641,i_current_price#11642,i_wholesale_cost#11643,i_brand_id#11644,i_brand#11645,i_class_id#11646,i_class#11647,i_category_id#11648,i_category#11649,i_manufact_id#11650,i_manufact#11651,i_size#11652,i_formulation#11653,i_color#11654,i_units#11655,i_container#11656,i_manager_id#11657,i_product_name#11658] parquet
            :                 +- Project [d_date_sk#11659]
            :                    +- Join LeftSemi, (d_date#11661 = d_date#11851)
            :                       :- Project [d_date_sk#11659, d_date#11661]
            :                       :  +- Filter isnotnull(d_date_sk#11659)
            :                       :     +- Relation [d_date_sk#11659,d_date_id#11660,d_date#11661,d_month_seq#11662,d_week_seq#11663,d_quarter_seq#11664,d_year#11665,d_dow#11666,d_moy#11667,d_dom#11668,d_qoy#11669,d_fy_year#11670,d_fy_quarter_seq#11671,d_fy_week_seq#11672,d_day_name#11673,d_quarter_name#11674,d_holiday#11675,d_weekend#11676,d_following_holiday#11677,d_first_dom#11678,d_last_dom#11679,d_same_day_ly#11680,d_same_day_lq#11681,d_current_day#11682,... 4 more fields] parquet
            :                       +- Project [d_date#11851]
            :                          +- Filter (isnotnull(d_week_seq#11853) AND (d_week_seq#11853 = scalar-subquery#11631 []))
            :                             :  +- Project [d_week_seq#11769]
            :                             :     +- Filter (isnotnull(d_date#11767) AND (d_date#11767 = 2000-07-21))
            :                             :        +- Relation [d_date_sk#11765,d_date_id#11766,d_date#11767,d_month_seq#11768,d_week_seq#11769,d_quarter_seq#11770,d_year#11771,d_dow#11772,d_moy#11773,d_dom#11774,d_qoy#11775,d_fy_year#11776,d_fy_quarter_seq#11777,d_fy_week_seq#11778,d_day_name#11779,d_quarter_name#11780,d_holiday#11781,d_weekend#11782,d_following_holiday#11783,d_first_dom#11784,d_last_dom#11785,d_same_day_ly#11786,d_same_day_lq#11787,d_current_day#11788,... 4 more fields] parquet
            :                             +- Relation [d_date_sk#11849,d_date_id#11850,d_date#11851,d_month_seq#11852,d_week_seq#11853,d_quarter_seq#11854,d_year#11855,d_dow#11856,d_moy#11857,d_dom#11858,d_qoy#11859,d_fy_year#11860,d_fy_quarter_seq#11861,d_fy_week_seq#11862,d_day_name#11863,d_quarter_name#11864,d_holiday#11865,d_weekend#11866,d_following_holiday#11867,d_first_dom#11868,d_last_dom#11869,d_same_day_ly#11870,d_same_day_lq#11871,d_current_day#11872,... 4 more fields] parquet
            +- Filter isnotnull(ws_item_rev#11634)
               +- Aggregate [i_item_id#11688], [i_item_id#11688 AS item_id#11633, MakeDecimal(sum(UnscaledValue(ws_ext_sales_price#407)),17,2) AS ws_item_rev#11634]
                  +- Project [ws_ext_sales_price#407, i_item_id#11688]
                     +- Join Inner, (ws_sold_date_sk#384 = d_date_sk#11709)
                        :- Project [ws_sold_date_sk#384, ws_ext_sales_price#407, i_item_id#11688]
                        :  +- Join Inner, (ws_item_sk#387 = i_item_sk#11687)
                        :     :- Project [ws_sold_date_sk#384, ws_item_sk#387, ws_ext_sales_price#407]
                        :     :  +- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                        :     :     +- Relation [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_date_sk#386,ws_item_sk#387,ws_bill_customer_sk#388,ws_bill_cdemo_sk#389,ws_bill_hdemo_sk#390,ws_bill_addr_sk#391,ws_ship_customer_sk#392,ws_ship_cdemo_sk#393,ws_ship_hdemo_sk#394,ws_ship_addr_sk#395,ws_web_page_sk#396,ws_web_site_sk#397,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_promo_sk#400,ws_order_number#401L,ws_quantity#402,ws_wholesale_cost#403,ws_list_price#404,ws_sales_price#405,ws_ext_discount_amt#406,ws_ext_sales_price#407,... 10 more fields] parquet
                        :     +- Project [i_item_sk#11687, i_item_id#11688]
                        :        +- Filter (isnotnull(i_item_sk#11687) AND isnotnull(i_item_id#11688))
                        :           +- Relation [i_item_sk#11687,i_item_id#11688,i_rec_start_date#11689,i_rec_end_date#11690,i_item_desc#11691,i_current_price#11692,i_wholesale_cost#11693,i_brand_id#11694,i_brand#11695,i_class_id#11696,i_class#11697,i_category_id#11698,i_category#11699,i_manufact_id#11700,i_manufact#11701,i_size#11702,i_formulation#11703,i_color#11704,i_units#11705,i_container#11706,i_manager_id#11707,i_product_name#11708] parquet
                        +- Project [d_date_sk#11709]
                           +- Join LeftSemi, (d_date#11711 = d_date#11879)
                              :- Project [d_date_sk#11709, d_date#11711]
                              :  +- Filter isnotnull(d_date_sk#11709)
                              :     +- Relation [d_date_sk#11709,d_date_id#11710,d_date#11711,d_month_seq#11712,d_week_seq#11713,d_quarter_seq#11714,d_year#11715,d_dow#11716,d_moy#11717,d_dom#11718,d_qoy#11719,d_fy_year#11720,d_fy_quarter_seq#11721,d_fy_week_seq#11722,d_day_name#11723,d_quarter_name#11724,d_holiday#11725,d_weekend#11726,d_following_holiday#11727,d_first_dom#11728,d_last_dom#11729,d_same_day_ly#11730,d_same_day_lq#11731,d_current_day#11732,... 4 more fields] parquet
                              +- Project [d_date#11879]
                                 +- Filter (isnotnull(d_week_seq#11881) AND (d_week_seq#11881 = scalar-subquery#11635 []))
                                    :  +- Project [d_week_seq#11797]
                                    :     +- Filter (isnotnull(d_date#11795) AND (d_date#11795 = 2000-07-21))
                                    :        +- Relation [d_date_sk#11793,d_date_id#11794,d_date#11795,d_month_seq#11796,d_week_seq#11797,d_quarter_seq#11798,d_year#11799,d_dow#11800,d_moy#11801,d_dom#11802,d_qoy#11803,d_fy_year#11804,d_fy_quarter_seq#11805,d_fy_week_seq#11806,d_day_name#11807,d_quarter_name#11808,d_holiday#11809,d_weekend#11810,d_following_holiday#11811,d_first_dom#11812,d_last_dom#11813,d_same_day_ly#11814,d_same_day_lq#11815,d_current_day#11816,... 4 more fields] parquet
                                    +- Relation [d_date_sk#11877,d_date_id#11878,d_date#11879,d_month_seq#11880,d_week_seq#11881,d_quarter_seq#11882,d_year#11883,d_dow#11884,d_moy#11885,d_dom#11886,d_qoy#11887,d_fy_year#11888,d_fy_quarter_seq#11889,d_fy_week_seq#11890,d_day_name#11891,d_quarter_name#11892,d_holiday#11893,d_weekend#11894,d_following_holiday#11895,d_first_dom#11896,d_last_dom#11897,d_same_day_ly#11898,d_same_day_lq#11899,d_current_day#11900,... 4 more fields] parquet
