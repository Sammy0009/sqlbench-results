AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(30) HashAggregate(keys=[], functions=[sum(sales#6937)], output=[sum(sales)#7111])
   +- ShuffleQueryStage 25
      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#63768]
         +- *(29) HashAggregate(keys=[], functions=[partial_sum(sales#6937)], output=[sum#7117, isEmpty#7118])
            +- Union
               :- *(25) Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#138 as decimal(12,2)))), DecimalType(18,2), true) AS sales#6937]
               :  +- *(25) BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#7043], Inner, BuildRight, false
               :     :- *(25) Project [cs_sold_date_sk#118, cs_quantity#136, cs_list_price#138]
               :     :  +- *(25) SortMergeJoin [cs_bill_customer_sk#121], [c_customer_sk#7025], LeftSemi
               :     :     :- *(23) Sort [cs_bill_customer_sk#121 ASC NULLS FIRST], false, 0
               :     :     :  +- ShuffleQueryStage 23
               :     :     :     +- Exchange hashpartitioning(cs_bill_customer_sk#121, 200), ENSURE_REQUIREMENTS, [id=#63365]
               :     :     :        +- *(19) Project [cs_sold_date_sk#118, cs_bill_customer_sk#121, cs_quantity#136, cs_list_price#138]
               :     :     :           +- *(19) SortMergeJoin [cs_item_sk#133], [item_sk#6944], LeftSemi
               :     :     :              :- *(17) Sort [cs_item_sk#133 ASC NULLS FIRST], false, 0
               :     :     :              :  +- AQEShuffleRead coalesced
               :     :     :              :     +- ShuffleQueryStage 0
               :     :     :              :        +- Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#60439]
               :     :     :              :           +- *(1) Filter isnotnull(cs_sold_date_sk#118)
               :     :     :              :              +- *(1) ColumnarToRow
               :     :     :              :                 +- FileScan parquet [cs_sold_date_sk#118,cs_bill_customer_sk#121,cs_item_sk#133,cs_quantity#136,cs_list_price#138] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:d...
               :     :     :              +- *(18) Sort [item_sk#6944 ASC NULLS FIRST], false, 0
               :     :     :                 +- AQEShuffleRead coalesced
               :     :     :                    +- ShuffleQueryStage 20
               :     :     :                       +- Exchange hashpartitioning(item_sk#6944, 200), ENSURE_REQUIREMENTS, [id=#62771]
               :     :     :                          +- *(15) Project [item_sk#6944]
               :     :     :                             +- *(15) Filter (cnt#6946L > 4)
               :     :     :                                +- *(15) HashAggregate(keys=[_groupingexpression#7113, i_item_sk#500, d_date#600], functions=[count(1)], output=[item_sk#6944, cnt#6946L])
               :     :     :                                   +- AQEShuffleRead coalesced
               :     :     :                                      +- ShuffleQueryStage 14
               :     :     :                                         +- Exchange hashpartitioning(_groupingexpression#7113, i_item_sk#500, d_date#600, 200), ENSURE_REQUIREMENTS, [id=#61899]
               :     :     :                                            +- *(11) HashAggregate(keys=[_groupingexpression#7113, i_item_sk#500, d_date#600], functions=[partial_count(1)], output=[_groupingexpression#7113, i_item_sk#500, d_date#600, count#7120L])
               :     :     :                                               +- *(11) Project [d_date#600, i_item_sk#500, substr(i_item_desc#504, 1, 30) AS _groupingexpression#7113]
               :     :     :                                                  +- *(11) BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
               :     :     :                                                     :- *(11) Project [ss_item_sk#666, d_date#600]
               :     :     :                                                     :  +- *(11) BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
               :     :     :                                                     :     :- *(11) Filter (isnotnull(ss_sold_date_sk#664) AND isnotnull(ss_item_sk#666))
               :     :     :                                                     :     :  +- *(11) ColumnarToRow
               :     :     :                                                     :     :     +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#664), isnotnull(ss_item_sk#666)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
               :     :     :                                                     :     +- BroadcastQueryStage 1
               :     :     :                                                     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60458]
               :     :     :                                                     :           +- *(2) Project [d_date_sk#598, d_date#600]
               :     :     :                                                     :              +- *(2) Filter (d_year#604 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#598))
               :     :     :                                                     :                 +- *(2) ColumnarToRow
               :     :     :                                                     :                    +- FileScan parquet [d_date_sk#598,d_date#600,d_year#604] Batched: true, DataFilters: [d_year#604 IN (2000,2001,2002,2003), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
               :     :     :                                                     +- BroadcastQueryStage 2
               :     :     :                                                        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60477]
               :     :     :                                                           +- *(3) Filter isnotnull(i_item_sk#500)
               :     :     :                                                              +- *(3) ColumnarToRow
               :     :     :                                                                 +- FileScan parquet [i_item_sk#500,i_item_desc#504] Batched: true, DataFilters: [isnotnull(i_item_sk#500)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_desc:string>
               :     :     +- *(24) Sort [c_customer_sk#7025 ASC NULLS FIRST], false, 0
               :     :        +- *(24) Project [c_customer_sk#7025]
               :     :           +- *(24) Filter (isnotnull(ssales#6949) AND (cast(ssales#6949 as decimal(38,8)) > CheckOverflow((0.950000 * promote_precision(cast(Subquery subquery#6950, [id=#60075] as decimal(32,6)))), DecimalType(38,8), true)))
               :     :              :  +- Subquery subquery#6950, [id=#60075]
               :     :              :     +- AdaptiveSparkPlan isFinalPlan=true
                                          +- == Final Plan ==
                                             *(6) HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                             +- ShuffleQueryStage 6
                                                +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#64072]
                                                   +- *(5) HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                      +- *(5) HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                         +- AQEShuffleRead coalesced
                                                            +- ShuffleQueryStage 5
                                                               +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#64014]
                                                                  +- *(4) HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                                     +- *(4) Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                        +- *(4) BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                                           :- *(4) Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                           :  +- *(4) BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                                           :     :- *(4) Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                                           :     :  +- *(4) ColumnarToRow
                                                                           :     :     +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                                           :     +- BroadcastQueryStage 4
                                                                           :        +- ReusedExchange [c_customer_sk#562], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60505]
                                                                           +- BroadcastQueryStage 2
                                                                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#63876]
                                                                                 +- *(2) Project [d_date_sk#6974]
                                                                                    +- *(2) Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                                       +- *(2) ColumnarToRow
                                                                                          +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                          +- == Initial Plan ==
                                             HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                             +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#60073]
                                                +- HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                   +- HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                      +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#60069]
                                                         +- HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                            +- Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                               +- BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                                  :- Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                  :  +- BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                                  :     :- Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                                  :     :  +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60060]
                                                                  :        +- Filter isnotnull(c_customer_sk#562)
                                                                  :           +- FileScan parquet [c_customer_sk#562] Batched: true, DataFilters: [isnotnull(c_customer_sk#562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
                                                                  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60064]
                                                                     +- Project [d_date_sk#6974]
                                                                        +- Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                           +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :     :              +- *(24) HashAggregate(keys=[c_customer_sk#7025], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, ssales#6949])
               :     :                 +- ShuffleQueryStage 17
               :     :                    +- Exchange hashpartitioning(c_customer_sk#7025, 200), ENSURE_REQUIREMENTS, [id=#62258]
               :     :                       +- *(13) HashAggregate(keys=[c_customer_sk#7025], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, sum#7123, isEmpty#7124])
               :     :                          +- *(13) Project [ss_quantity#7012, ss_sales_price#7015, c_customer_sk#7025]
               :     :                             +- *(13) BroadcastHashJoin [ss_customer_sk#7005], [c_customer_sk#7025], Inner, BuildRight, false
               :     :                                :- *(13) Filter isnotnull(ss_customer_sk#7005)
               :     :                                :  +- *(13) ColumnarToRow
               :     :                                :     +- FileScan parquet [ss_customer_sk#7005,ss_quantity#7012,ss_sales_price#7015] Batched: true, DataFilters: [isnotnull(ss_customer_sk#7005)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk)], ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
               :     :                                +- BroadcastQueryStage 3
               :     :                                   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60505]
               :     :                                      +- *(4) Filter isnotnull(c_customer_sk#7025)
               :     :                                         +- *(4) ColumnarToRow
               :     :                                            +- FileScan parquet [c_customer_sk#7025] Batched: true, DataFilters: [isnotnull(c_customer_sk#7025)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
               :     +- BroadcastQueryStage 4
               :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60532]
               :           +- *(5) Project [d_date_sk#7043]
               :              +- *(5) Filter ((((isnotnull(d_year#7049) AND isnotnull(d_moy#7051)) AND (d_year#7049 = 2000)) AND (d_moy#7051 = 7)) AND isnotnull(d_date_sk#7043))
               :                 +- *(5) ColumnarToRow
               :                    +- FileScan parquet [d_date_sk#7043,d_year#7049,d_moy#7051] Batched: true, DataFilters: [isnotnull(d_year#7049), isnotnull(d_moy#7051), (d_year#7049 = 2000), (d_moy#7051 = 7), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,7), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
               +- *(28) Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#404 as decimal(12,2)))), DecimalType(18,2), true) AS sales#6940]
                  +- *(28) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#7071], Inner, BuildRight, false
                     :- *(28) Project [ws_sold_date_sk#384, ws_quantity#402, ws_list_price#404]
                     :  +- *(28) SortMergeJoin [ws_bill_customer_sk#388], [c_customer_sk#7025], LeftSemi
                     :     :- *(26) Sort [ws_bill_customer_sk#388 ASC NULLS FIRST], false, 0
                     :     :  +- ShuffleQueryStage 24
                     :     :     +- Exchange hashpartitioning(ws_bill_customer_sk#388, 200), ENSURE_REQUIREMENTS, [id=#63409]
                     :     :        +- *(22) Project [ws_sold_date_sk#384, ws_bill_customer_sk#388, ws_quantity#402, ws_list_price#404]
                     :     :           +- *(22) SortMergeJoin [ws_item_sk#387], [item_sk#6944], LeftSemi
                     :     :              :- *(20) Sort [ws_item_sk#387 ASC NULLS FIRST], false, 0
                     :     :              :  +- AQEShuffleRead coalesced
                     :     :              :     +- ShuffleQueryStage 5
                     :     :              :        +- Exchange hashpartitioning(ws_item_sk#387, 200), ENSURE_REQUIREMENTS, [id=#60551]
                     :     :              :           +- *(6) Filter isnotnull(ws_sold_date_sk#384)
                     :     :              :              +- *(6) ColumnarToRow
                     :     :              :                 +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387,ws_bill_customer_sk#388,ws_quantity#402,ws_list_price#404] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_bill_customer_sk:int,ws_quantity:int,ws_list_price:d...
                     :     :              +- *(21) Sort [item_sk#6944 ASC NULLS FIRST], false, 0
                     :     :                 +- AQEShuffleRead coalesced
                     :     :                    +- ShuffleQueryStage 22
                     :     :                       +- ReusedExchange [item_sk#6944], Exchange hashpartitioning(item_sk#6944, 200), ENSURE_REQUIREMENTS, [id=#62771]
                     :     +- *(27) Sort [c_customer_sk#7025 ASC NULLS FIRST], false, 0
                     :        +- *(27) Project [c_customer_sk#7025]
                     :           +- *(27) Filter (isnotnull(ssales#6949) AND (cast(ssales#6949 as decimal(38,8)) > CheckOverflow((0.950000 * promote_precision(cast(Subquery subquery#6950, [id=#60075] as decimal(32,6)))), DecimalType(38,8), true)))
                     :              :  +- Subquery subquery#6950, [id=#60075]
                     :              :     +- AdaptiveSparkPlan isFinalPlan=true
                                          +- == Final Plan ==
                                             *(6) HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                             +- ShuffleQueryStage 6
                                                +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#64072]
                                                   +- *(5) HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                      +- *(5) HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                         +- AQEShuffleRead coalesced
                                                            +- ShuffleQueryStage 5
                                                               +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#64014]
                                                                  +- *(4) HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                                     +- *(4) Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                        +- *(4) BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                                           :- *(4) Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                           :  +- *(4) BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                                           :     :- *(4) Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                                           :     :  +- *(4) ColumnarToRow
                                                                           :     :     +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                                           :     +- BroadcastQueryStage 4
                                                                           :        +- ReusedExchange [c_customer_sk#562], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60505]
                                                                           +- BroadcastQueryStage 2
                                                                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#63876]
                                                                                 +- *(2) Project [d_date_sk#6974]
                                                                                    +- *(2) Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                                       +- *(2) ColumnarToRow
                                                                                          +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                          +- == Initial Plan ==
                                             HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                             +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#60073]
                                                +- HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                   +- HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                      +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#60069]
                                                         +- HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                            +- Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                               +- BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                                  :- Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                  :  +- BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                                  :     :- Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                                  :     :  +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60060]
                                                                  :        +- Filter isnotnull(c_customer_sk#562)
                                                                  :           +- FileScan parquet [c_customer_sk#562] Batched: true, DataFilters: [isnotnull(c_customer_sk#562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
                                                                  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60064]
                                                                     +- Project [d_date_sk#6974]
                                                                        +- Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                           +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :              +- *(27) HashAggregate(keys=[c_customer_sk#7025], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, ssales#6949])
                     :                 +- ShuffleQueryStage 19
                     :                    +- ReusedExchange [c_customer_sk#7025, sum#7123, isEmpty#7124], Exchange hashpartitioning(c_customer_sk#7025, 200), ENSURE_REQUIREMENTS, [id=#62258]
                     +- BroadcastQueryStage 13
                        +- ReusedExchange [d_date_sk#7071], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60532]
+- == Initial Plan ==
   HashAggregate(keys=[], functions=[sum(sales#6937)], output=[sum(sales)#7111])
   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#60220]
      +- HashAggregate(keys=[], functions=[partial_sum(sales#6937)], output=[sum#7117, isEmpty#7118])
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#138 as decimal(12,2)))), DecimalType(18,2), true) AS sales#6937]
            :  +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#7043], Inner, BuildRight, false
            :     :- Project [cs_sold_date_sk#118, cs_quantity#136, cs_list_price#138]
            :     :  +- SortMergeJoin [cs_bill_customer_sk#121], [c_customer_sk#7025], LeftSemi
            :     :     :- Sort [cs_bill_customer_sk#121 ASC NULLS FIRST], false, 0
            :     :     :  +- Exchange hashpartitioning(cs_bill_customer_sk#121, 200), ENSURE_REQUIREMENTS, [id=#60167]
            :     :     :     +- Project [cs_sold_date_sk#118, cs_bill_customer_sk#121, cs_quantity#136, cs_list_price#138]
            :     :     :        +- SortMergeJoin [cs_item_sk#133], [item_sk#6944], LeftSemi
            :     :     :           :- Sort [cs_item_sk#133 ASC NULLS FIRST], false, 0
            :     :     :           :  +- Exchange hashpartitioning(cs_item_sk#133, 200), ENSURE_REQUIREMENTS, [id=#60150]
            :     :     :           :     +- Filter isnotnull(cs_sold_date_sk#118)
            :     :     :           :        +- FileScan parquet [cs_sold_date_sk#118,cs_bill_customer_sk#121,cs_item_sk#133,cs_quantity#136,cs_list_price#138] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_bill_customer_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:d...
            :     :     :           +- Sort [item_sk#6944 ASC NULLS FIRST], false, 0
            :     :     :              +- Exchange hashpartitioning(item_sk#6944, 200), ENSURE_REQUIREMENTS, [id=#60151]
            :     :     :                 +- Project [item_sk#6944]
            :     :     :                    +- Filter (cnt#6946L > 4)
            :     :     :                       +- HashAggregate(keys=[_groupingexpression#7113, i_item_sk#500, d_date#600], functions=[count(1)], output=[item_sk#6944, cnt#6946L])
            :     :     :                          +- Exchange hashpartitioning(_groupingexpression#7113, i_item_sk#500, d_date#600, 200), ENSURE_REQUIREMENTS, [id=#60144]
            :     :     :                             +- HashAggregate(keys=[_groupingexpression#7113, i_item_sk#500, d_date#600], functions=[partial_count(1)], output=[_groupingexpression#7113, i_item_sk#500, d_date#600, count#7120L])
            :     :     :                                +- Project [d_date#600, i_item_sk#500, substr(i_item_desc#504, 1, 30) AS _groupingexpression#7113]
            :     :     :                                   +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
            :     :     :                                      :- Project [ss_item_sk#666, d_date#600]
            :     :     :                                      :  +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
            :     :     :                                      :     :- Filter (isnotnull(ss_sold_date_sk#664) AND isnotnull(ss_item_sk#666))
            :     :     :                                      :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#664), isnotnull(ss_item_sk#666)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
            :     :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60135]
            :     :     :                                      :        +- Project [d_date_sk#598, d_date#600]
            :     :     :                                      :           +- Filter (d_year#604 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#598))
            :     :     :                                      :              +- FileScan parquet [d_date_sk#598,d_date#600,d_year#604] Batched: true, DataFilters: [d_year#604 IN (2000,2001,2002,2003), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
            :     :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60139]
            :     :     :                                         +- Filter isnotnull(i_item_sk#500)
            :     :     :                                            +- FileScan parquet [i_item_sk#500,i_item_desc#504] Batched: true, DataFilters: [isnotnull(i_item_sk#500)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_desc:string>
            :     :     +- Sort [c_customer_sk#7025 ASC NULLS FIRST], false, 0
            :     :        +- Project [c_customer_sk#7025]
            :     :           +- Filter (isnotnull(ssales#6949) AND (cast(ssales#6949 as decimal(38,8)) > CheckOverflow((0.950000 * promote_precision(cast(Subquery subquery#6950, [id=#60075] as decimal(32,6)))), DecimalType(38,8), true)))
            :     :              :  +- Subquery subquery#6950, [id=#60075]
            :     :              :     +- AdaptiveSparkPlan isFinalPlan=true
                                       +- == Final Plan ==
                                          *(6) HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                          +- ShuffleQueryStage 6
                                             +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#64072]
                                                +- *(5) HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                   +- *(5) HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                      +- AQEShuffleRead coalesced
                                                         +- ShuffleQueryStage 5
                                                            +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#64014]
                                                               +- *(4) HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                                  +- *(4) Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                     +- *(4) BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                                        :- *(4) Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                        :  +- *(4) BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                                        :     :- *(4) Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                                        :     :  +- *(4) ColumnarToRow
                                                                        :     :     +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                                        :     +- BroadcastQueryStage 4
                                                                        :        +- ReusedExchange [c_customer_sk#562], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60505]
                                                                        +- BroadcastQueryStage 2
                                                                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#63876]
                                                                              +- *(2) Project [d_date_sk#6974]
                                                                                 +- *(2) Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                                    +- *(2) ColumnarToRow
                                                                                       +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                       +- == Initial Plan ==
                                          HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                          +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#60073]
                                             +- HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                +- HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                   +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#60069]
                                                      +- HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                         +- Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                            +- BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                               :- Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                               :  +- BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                               :     :- Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                               :     :  +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60060]
                                                               :        +- Filter isnotnull(c_customer_sk#562)
                                                               :           +- FileScan parquet [c_customer_sk#562] Batched: true, DataFilters: [isnotnull(c_customer_sk#562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
                                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60064]
                                                                  +- Project [d_date_sk#6974]
                                                                     +- Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                        +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
            :     :              +- HashAggregate(keys=[c_customer_sk#7025], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, ssales#6949])
            :     :                 +- Exchange hashpartitioning(c_customer_sk#7025, 200), ENSURE_REQUIREMENTS, [id=#60161]
            :     :                    +- HashAggregate(keys=[c_customer_sk#7025], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, sum#7123, isEmpty#7124])
            :     :                       +- Project [ss_quantity#7012, ss_sales_price#7015, c_customer_sk#7025]
            :     :                          +- BroadcastHashJoin [ss_customer_sk#7005], [c_customer_sk#7025], Inner, BuildRight, false
            :     :                             :- Filter isnotnull(ss_customer_sk#7005)
            :     :                             :  +- FileScan parquet [ss_customer_sk#7005,ss_quantity#7012,ss_sales_price#7015] Batched: true, DataFilters: [isnotnull(ss_customer_sk#7005)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk)], ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
            :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60156]
            :     :                                +- Filter isnotnull(c_customer_sk#7025)
            :     :                                   +- FileScan parquet [c_customer_sk#7025] Batched: true, DataFilters: [isnotnull(c_customer_sk#7025)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60173]
            :        +- Project [d_date_sk#7043]
            :           +- Filter ((((isnotnull(d_year#7049) AND isnotnull(d_moy#7051)) AND (d_year#7049 = 2000)) AND (d_moy#7051 = 7)) AND isnotnull(d_date_sk#7043))
            :              +- FileScan parquet [d_date_sk#7043,d_year#7049,d_moy#7051] Batched: true, DataFilters: [isnotnull(d_year#7049), isnotnull(d_moy#7051), (d_year#7049 = 2000), (d_moy#7051 = 7), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,7), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#404 as decimal(12,2)))), DecimalType(18,2), true) AS sales#6940]
               +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#7071], Inner, BuildRight, false
                  :- Project [ws_sold_date_sk#384, ws_quantity#402, ws_list_price#404]
                  :  +- SortMergeJoin [ws_bill_customer_sk#388], [c_customer_sk#7025], LeftSemi
                  :     :- Sort [ws_bill_customer_sk#388 ASC NULLS FIRST], false, 0
                  :     :  +- Exchange hashpartitioning(ws_bill_customer_sk#388, 200), ENSURE_REQUIREMENTS, [id=#60208]
                  :     :     +- Project [ws_sold_date_sk#384, ws_bill_customer_sk#388, ws_quantity#402, ws_list_price#404]
                  :     :        +- SortMergeJoin [ws_item_sk#387], [item_sk#6944], LeftSemi
                  :     :           :- Sort [ws_item_sk#387 ASC NULLS FIRST], false, 0
                  :     :           :  +- Exchange hashpartitioning(ws_item_sk#387, 200), ENSURE_REQUIREMENTS, [id=#60191]
                  :     :           :     +- Filter isnotnull(ws_sold_date_sk#384)
                  :     :           :        +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387,ws_bill_customer_sk#388,ws_quantity#402,ws_list_price#404] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_bill_customer_sk:int,ws_quantity:int,ws_list_price:d...
                  :     :           +- Sort [item_sk#6944 ASC NULLS FIRST], false, 0
                  :     :              +- Exchange hashpartitioning(item_sk#6944, 200), ENSURE_REQUIREMENTS, [id=#60192]
                  :     :                 +- Project [item_sk#6944]
                  :     :                    +- Filter (cnt#6946L > 4)
                  :     :                       +- HashAggregate(keys=[_groupingexpression#7114, i_item_sk#500, d_date#600], functions=[count(1)], output=[item_sk#6944, cnt#6946L])
                  :     :                          +- Exchange hashpartitioning(_groupingexpression#7114, i_item_sk#500, d_date#600, 200), ENSURE_REQUIREMENTS, [id=#60185]
                  :     :                             +- HashAggregate(keys=[_groupingexpression#7114, i_item_sk#500, d_date#600], functions=[partial_count(1)], output=[_groupingexpression#7114, i_item_sk#500, d_date#600, count#7120L])
                  :     :                                +- Project [d_date#600, i_item_sk#500, substr(i_item_desc#504, 1, 30) AS _groupingexpression#7114]
                  :     :                                   +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
                  :     :                                      :- Project [ss_item_sk#666, d_date#600]
                  :     :                                      :  +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                  :     :                                      :     :- Filter (isnotnull(ss_sold_date_sk#664) AND isnotnull(ss_item_sk#666))
                  :     :                                      :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#664), isnotnull(ss_item_sk#666)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60176]
                  :     :                                      :        +- Project [d_date_sk#598, d_date#600]
                  :     :                                      :           +- Filter (d_year#604 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#598))
                  :     :                                      :              +- FileScan parquet [d_date_sk#598,d_date#600,d_year#604] Batched: true, DataFilters: [d_year#604 IN (2000,2001,2002,2003), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date,d_year:int>
                  :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60180]
                  :     :                                         +- Filter isnotnull(i_item_sk#500)
                  :     :                                            +- FileScan parquet [i_item_sk#500,i_item_desc#504] Batched: true, DataFilters: [isnotnull(i_item_sk#500)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_item_desc:string>
                  :     +- Sort [c_customer_sk#7025 ASC NULLS FIRST], false, 0
                  :        +- Project [c_customer_sk#7025]
                  :           +- Filter (isnotnull(ssales#6949) AND (cast(ssales#6949 as decimal(38,8)) > CheckOverflow((0.950000 * promote_precision(cast(Subquery subquery#6950, [id=#60075] as decimal(32,6)))), DecimalType(38,8), true)))
                  :              :  +- Subquery subquery#6950, [id=#60075]
                  :              :     +- AdaptiveSparkPlan isFinalPlan=true
                                       +- == Final Plan ==
                                          *(6) HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                          +- ShuffleQueryStage 6
                                             +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#64072]
                                                +- *(5) HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                   +- *(5) HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                      +- AQEShuffleRead coalesced
                                                         +- ShuffleQueryStage 5
                                                            +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#64014]
                                                               +- *(4) HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                                  +- *(4) Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                     +- *(4) BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                                        :- *(4) Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                                        :  +- *(4) BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                                        :     :- *(4) Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                                        :     :  +- *(4) ColumnarToRow
                                                                        :     :     +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                                        :     +- BroadcastQueryStage 4
                                                                        :        +- ReusedExchange [c_customer_sk#562], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60505]
                                                                        +- BroadcastQueryStage 2
                                                                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#63876]
                                                                              +- *(2) Project [d_date_sk#6974]
                                                                                 +- *(2) Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                                    +- *(2) ColumnarToRow
                                                                                       +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                       +- == Initial Plan ==
                                          HashAggregate(keys=[], functions=[max(csales#6947)], output=[tpcds_cmax#6948])
                                          +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#60073]
                                             +- HashAggregate(keys=[], functions=[partial_max(csales#6947)], output=[max#7126])
                                                +- HashAggregate(keys=[c_customer_sk#562], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[csales#6947])
                                                   +- Exchange hashpartitioning(c_customer_sk#562, 200), ENSURE_REQUIREMENTS, [id=#60069]
                                                      +- HashAggregate(keys=[c_customer_sk#562], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6961 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#6964 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#562, sum#7129, isEmpty#7130])
                                                         +- Project [ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                            +- BroadcastHashJoin [ss_sold_date_sk#6951], [d_date_sk#6974], Inner, BuildRight, false
                                                               :- Project [ss_sold_date_sk#6951, ss_quantity#6961, ss_sales_price#6964, c_customer_sk#562]
                                                               :  +- BroadcastHashJoin [ss_customer_sk#6954], [c_customer_sk#562], Inner, BuildRight, false
                                                               :     :- Filter (isnotnull(ss_customer_sk#6954) AND isnotnull(ss_sold_date_sk#6951))
                                                               :     :  +- FileScan parquet [ss_sold_date_sk#6951,ss_customer_sk#6954,ss_quantity#6961,ss_sales_price#6964] Batched: true, DataFilters: [isnotnull(ss_customer_sk#6954), isnotnull(ss_sold_date_sk#6951)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60060]
                                                               :        +- Filter isnotnull(c_customer_sk#562)
                                                               :           +- FileScan parquet [c_customer_sk#562] Batched: true, DataFilters: [isnotnull(c_customer_sk#562)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
                                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60064]
                                                                  +- Project [d_date_sk#6974]
                                                                     +- Filter (d_year#6980 IN (2000,2001,2002,2003) AND isnotnull(d_date_sk#6974))
                                                                        +- FileScan parquet [d_date_sk#6974,d_year#6980] Batched: true, DataFilters: [d_year#6980 IN (2000,2001,2002,2003), isnotnull(d_date_sk#6974)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [In(d_year, [2000,2001,2002,2003]), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  :              +- HashAggregate(keys=[c_customer_sk#7025], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, ssales#6949])
                  :                 +- Exchange hashpartitioning(c_customer_sk#7025, 200), ENSURE_REQUIREMENTS, [id=#60202]
                  :                    +- HashAggregate(keys=[c_customer_sk#7025], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7012 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#7015 as decimal(12,2)))), DecimalType(18,2), true))], output=[c_customer_sk#7025, sum#7123, isEmpty#7124])
                  :                       +- Project [ss_quantity#7012, ss_sales_price#7015, c_customer_sk#7025]
                  :                          +- BroadcastHashJoin [ss_customer_sk#7005], [c_customer_sk#7025], Inner, BuildRight, false
                  :                             :- Filter isnotnull(ss_customer_sk#7005)
                  :                             :  +- FileScan parquet [ss_customer_sk#7005,ss_quantity#7012,ss_sales_price#7015] Batched: true, DataFilters: [isnotnull(ss_customer_sk#7005)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_customer_sk)], ReadSchema: struct<ss_customer_sk:int,ss_quantity:int,ss_sales_price:decimal(7,2)>
                  :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#60197]
                  :                                +- Filter isnotnull(c_customer_sk#7025)
                  :                                   +- FileScan parquet [c_customer_sk#7025] Batched: true, DataFilters: [isnotnull(c_customer_sk#7025)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk)], ReadSchema: struct<c_customer_sk:int>
                  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#60214]
                     +- Project [d_date_sk#7071]
                        +- Filter ((((isnotnull(d_year#7077) AND isnotnull(d_moy#7079)) AND (d_year#7077 = 2000)) AND (d_moy#7079 = 7)) AND isnotnull(d_date_sk#7071))
                           +- FileScan parquet [d_date_sk#7071,d_year#7077,d_moy#7079] Batched: true, DataFilters: [isnotnull(d_year#7077), isnotnull(d_moy#7079), (d_year#7077 = 2000), (d_moy#7079 = 7), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2000), EqualTo(d_moy,7), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
