GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#12575 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#12576 as decimal(22,6)))), DecimalType(22,6), true) ASC NULLS FIRST, psum#12578 ASC NULLS FIRST], true
      +- Project [cc_name#794, d_year#604, avg_monthly_sales#12576, sum_sales#12575, sum_sales#12595 AS psum#12578, sum_sales#12603 AS nsum#12579]
         +- Join Inner, ((((i_category#512 = i_category#12748) AND (i_brand#508 = i_brand#12744)) AND (cc_name#794 = cc_name#12826)) AND (rn#12577 = (rn#12855 - 1)))
            :- Project [i_category#512, i_brand#508, cc_name#794, d_year#604, sum_sales#12575, avg_monthly_sales#12576, rn#12577, sum_sales#12595]
            :  +- Join Inner, ((((i_category#512 = i_category#12628) AND (i_brand#508 = i_brand#12624)) AND (cc_name#794 = cc_name#12706)) AND (rn#12577 = (rn#12735 + 1)))
            :     :- Project [i_category#512, i_brand#508, cc_name#794, d_year#604, sum_sales#12575, avg_monthly_sales#12576, rn#12577]
            :     :  +- Filter ((isnotnull(avg_monthly_sales#12576) AND (avg_monthly_sales#12576 > 0.000000)) AND (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#12575 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#12576 as decimal(22,6)))), DecimalType(22,6), true), false)) / promote_precision(cast(avg_monthly_sales#12576 as decimal(22,6)))), DecimalType(38,16), true) > 0.1000000000000000))
            :     :     +- Window [avg(_w0#12589) windowspecdefinition(i_category#512, i_brand#508, cc_name#794, d_year#604, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#12576], [i_category#512, i_brand#508, cc_name#794, d_year#604]
            :     :        +- Project [i_category#512, i_brand#508, cc_name#794, d_year#604, sum_sales#12575, _w0#12589, rn#12577]
            :     :           +- Filter (isnotnull(d_year#604) AND (d_year#604 = 1999))
            :     :              +- Window [rank(d_year#604, d_moy#606) windowspecdefinition(i_category#512, i_brand#508, cc_name#794, d_year#604 ASC NULLS FIRST, d_moy#606 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#12577], [i_category#512, i_brand#508, cc_name#794], [d_year#604 ASC NULLS FIRST, d_moy#606 ASC NULLS FIRST]
            :     :                 +- Aggregate [i_category#512, i_brand#508, cc_name#794, d_year#604, d_moy#606], [i_category#512, i_brand#508, cc_name#794, d_year#604, d_moy#606, MakeDecimal(sum(UnscaledValue(cs_sales_price#139)),17,2) AS sum_sales#12575, MakeDecimal(sum(UnscaledValue(cs_sales_price#139)),17,2) AS _w0#12589]
            :     :                    +- Project [i_brand#508, i_category#512, cs_sales_price#139, d_year#604, d_moy#606, cc_name#794]
            :     :                       +- Join Inner, (cc_call_center_sk#788 = cs_call_center_sk#129)
            :     :                          :- Project [i_brand#508, i_category#512, cs_call_center_sk#129, cs_sales_price#139, d_year#604, d_moy#606]
            :     :                          :  +- Join Inner, (cs_sold_date_sk#118 = d_date_sk#598)
            :     :                          :     :- Project [i_brand#508, i_category#512, cs_sold_date_sk#118, cs_call_center_sk#129, cs_sales_price#139]
            :     :                          :     :  +- Join Inner, (cs_item_sk#133 = i_item_sk#500)
            :     :                          :     :     :- Project [i_item_sk#500, i_brand#508, i_category#512]
            :     :                          :     :     :  +- Filter (isnotnull(i_item_sk#500) AND (isnotnull(i_category#512) AND isnotnull(i_brand#508)))
            :     :                          :     :     :     +- Relation [i_item_sk#500,i_item_id#501,i_rec_start_date#502,i_rec_end_date#503,i_item_desc#504,i_current_price#505,i_wholesale_cost#506,i_brand_id#507,i_brand#508,i_class_id#509,i_class#510,i_category_id#511,i_category#512,i_manufact_id#513,i_manufact#514,i_size#515,i_formulation#516,i_color#517,i_units#518,i_container#519,i_manager_id#520,i_product_name#521] parquet
            :     :                          :     :     +- Project [cs_sold_date_sk#118, cs_call_center_sk#129, cs_item_sk#133, cs_sales_price#139]
            :     :                          :     :        +- Filter (isnotnull(cs_item_sk#133) AND (isnotnull(cs_sold_date_sk#118) AND isnotnull(cs_call_center_sk#129)))
            :     :                          :     :           +- Relation [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_date_sk#120,cs_bill_customer_sk#121,cs_bill_cdemo_sk#122,cs_bill_hdemo_sk#123,cs_bill_addr_sk#124,cs_ship_customer_sk#125,cs_ship_cdemo_sk#126,cs_ship_hdemo_sk#127,cs_ship_addr_sk#128,cs_call_center_sk#129,cs_catalog_page_sk#130,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_item_sk#133,cs_promo_sk#134,cs_order_number#135L,cs_quantity#136,cs_wholesale_cost#137,cs_list_price#138,cs_sales_price#139,cs_ext_discount_amt#140,cs_ext_sales_price#141,... 10 more fields] parquet
            :     :                          :     +- Project [d_date_sk#598, d_year#604, d_moy#606]
            :     :                          :        +- Filter ((((d_year#604 = 1999) OR ((d_year#604 = 1998) AND (d_moy#606 = 12))) OR ((d_year#604 = 2000) AND (d_moy#606 = 1))) AND isnotnull(d_date_sk#598))
            :     :                          :           +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
            :     :                          +- Project [cc_call_center_sk#788, cc_name#794]
            :     :                             +- Filter (isnotnull(cc_call_center_sk#788) AND isnotnull(cc_name#794))
            :     :                                +- Relation [cc_call_center_sk#788,cc_call_center_id#789,cc_rec_start_date#790,cc_rec_end_date#791,cc_closed_date_sk#792,cc_open_date_sk#793,cc_name#794,cc_class#795,cc_employees#796,cc_sq_ft#797,cc_hours#798,cc_manager#799,cc_mkt_id#800,cc_mkt_class#801,cc_mkt_desc#802,cc_market_manager#803,cc_division#804,cc_division_name#805,cc_company#806,cc_company_name#807,cc_street_number#808,cc_street_name#809,cc_street_type#810,cc_suite_number#811,... 7 more fields] parquet
            :     +- Project [i_category#12628, i_brand#12624, cc_name#12706, sum_sales#12575 AS sum_sales#12595, rn#12735]
            :        +- Window [rank(d_year#12678, d_moy#12680) windowspecdefinition(i_category#12628, i_brand#12624, cc_name#12706, d_year#12678 ASC NULLS FIRST, d_moy#12680 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#12735], [i_category#12628, i_brand#12624, cc_name#12706], [d_year#12678 ASC NULLS FIRST, d_moy#12680 ASC NULLS FIRST]
            :           +- Aggregate [i_category#12628, i_brand#12624, cc_name#12706, d_year#12678, d_moy#12680], [i_category#12628, i_brand#12624, cc_name#12706, d_year#12678, d_moy#12680, MakeDecimal(sum(UnscaledValue(cs_sales_price#12659)),17,2) AS sum_sales#12575]
            :              +- Project [i_brand#12624, i_category#12628, cs_sales_price#12659, d_year#12678, d_moy#12680, cc_name#12706]
            :                 +- Join Inner, (cc_call_center_sk#12700 = cs_call_center_sk#12649)
            :                    :- Project [i_brand#12624, i_category#12628, cs_call_center_sk#12649, cs_sales_price#12659, d_year#12678, d_moy#12680]
            :                    :  +- Join Inner, (cs_sold_date_sk#12638 = d_date_sk#12672)
            :                    :     :- Project [i_brand#12624, i_category#12628, cs_sold_date_sk#12638, cs_call_center_sk#12649, cs_sales_price#12659]
            :                    :     :  +- Join Inner, (cs_item_sk#12653 = i_item_sk#12616)
            :                    :     :     :- Project [i_item_sk#12616, i_brand#12624, i_category#12628]
            :                    :     :     :  +- Filter (isnotnull(i_item_sk#12616) AND (isnotnull(i_category#12628) AND isnotnull(i_brand#12624)))
            :                    :     :     :     +- Relation [i_item_sk#12616,i_item_id#12617,i_rec_start_date#12618,i_rec_end_date#12619,i_item_desc#12620,i_current_price#12621,i_wholesale_cost#12622,i_brand_id#12623,i_brand#12624,i_class_id#12625,i_class#12626,i_category_id#12627,i_category#12628,i_manufact_id#12629,i_manufact#12630,i_size#12631,i_formulation#12632,i_color#12633,i_units#12634,i_container#12635,i_manager_id#12636,i_product_name#12637] parquet
            :                    :     :     +- Project [cs_sold_date_sk#12638, cs_call_center_sk#12649, cs_item_sk#12653, cs_sales_price#12659]
            :                    :     :        +- Filter ((isnotnull(cs_item_sk#12653) AND isnotnull(cs_sold_date_sk#12638)) AND isnotnull(cs_call_center_sk#12649))
            :                    :     :           +- Relation [cs_sold_date_sk#12638,cs_sold_time_sk#12639,cs_ship_date_sk#12640,cs_bill_customer_sk#12641,cs_bill_cdemo_sk#12642,cs_bill_hdemo_sk#12643,cs_bill_addr_sk#12644,cs_ship_customer_sk#12645,cs_ship_cdemo_sk#12646,cs_ship_hdemo_sk#12647,cs_ship_addr_sk#12648,cs_call_center_sk#12649,cs_catalog_page_sk#12650,cs_ship_mode_sk#12651,cs_warehouse_sk#12652,cs_item_sk#12653,cs_promo_sk#12654,cs_order_number#12655L,cs_quantity#12656,cs_wholesale_cost#12657,cs_list_price#12658,cs_sales_price#12659,cs_ext_discount_amt#12660,cs_ext_sales_price#12661,... 10 more fields] parquet
            :                    :     +- Project [d_date_sk#12672, d_year#12678, d_moy#12680]
            :                    :        +- Filter ((((d_year#12678 = 1999) OR ((d_year#12678 = 1998) AND (d_moy#12680 = 12))) OR ((d_year#12678 = 2000) AND (d_moy#12680 = 1))) AND isnotnull(d_date_sk#12672))
            :                    :           +- Relation [d_date_sk#12672,d_date_id#12673,d_date#12674,d_month_seq#12675,d_week_seq#12676,d_quarter_seq#12677,d_year#12678,d_dow#12679,d_moy#12680,d_dom#12681,d_qoy#12682,d_fy_year#12683,d_fy_quarter_seq#12684,d_fy_week_seq#12685,d_day_name#12686,d_quarter_name#12687,d_holiday#12688,d_weekend#12689,d_following_holiday#12690,d_first_dom#12691,d_last_dom#12692,d_same_day_ly#12693,d_same_day_lq#12694,d_current_day#12695,... 4 more fields] parquet
            :                    +- Project [cc_call_center_sk#12700, cc_name#12706]
            :                       +- Filter (isnotnull(cc_call_center_sk#12700) AND isnotnull(cc_name#12706))
            :                          +- Relation [cc_call_center_sk#12700,cc_call_center_id#12701,cc_rec_start_date#12702,cc_rec_end_date#12703,cc_closed_date_sk#12704,cc_open_date_sk#12705,cc_name#12706,cc_class#12707,cc_employees#12708,cc_sq_ft#12709,cc_hours#12710,cc_manager#12711,cc_mkt_id#12712,cc_mkt_class#12713,cc_mkt_desc#12714,cc_market_manager#12715,cc_division#12716,cc_division_name#12717,cc_company#12718,cc_company_name#12719,cc_street_number#12720,cc_street_name#12721,cc_street_type#12722,cc_suite_number#12723,... 7 more fields] parquet
            +- Project [i_category#12748, i_brand#12744, cc_name#12826, sum_sales#12575 AS sum_sales#12603, rn#12855]
               +- Window [rank(d_year#12798, d_moy#12800) windowspecdefinition(i_category#12748, i_brand#12744, cc_name#12826, d_year#12798 ASC NULLS FIRST, d_moy#12800 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#12855], [i_category#12748, i_brand#12744, cc_name#12826], [d_year#12798 ASC NULLS FIRST, d_moy#12800 ASC NULLS FIRST]
                  +- Aggregate [i_category#12748, i_brand#12744, cc_name#12826, d_year#12798, d_moy#12800], [i_category#12748, i_brand#12744, cc_name#12826, d_year#12798, d_moy#12800, MakeDecimal(sum(UnscaledValue(cs_sales_price#12779)),17,2) AS sum_sales#12575]
                     +- Project [i_brand#12744, i_category#12748, cs_sales_price#12779, d_year#12798, d_moy#12800, cc_name#12826]
                        +- Join Inner, (cc_call_center_sk#12820 = cs_call_center_sk#12769)
                           :- Project [i_brand#12744, i_category#12748, cs_call_center_sk#12769, cs_sales_price#12779, d_year#12798, d_moy#12800]
                           :  +- Join Inner, (cs_sold_date_sk#12758 = d_date_sk#12792)
                           :     :- Project [i_brand#12744, i_category#12748, cs_sold_date_sk#12758, cs_call_center_sk#12769, cs_sales_price#12779]
                           :     :  +- Join Inner, (cs_item_sk#12773 = i_item_sk#12736)
                           :     :     :- Project [i_item_sk#12736, i_brand#12744, i_category#12748]
                           :     :     :  +- Filter (isnotnull(i_item_sk#12736) AND (isnotnull(i_category#12748) AND isnotnull(i_brand#12744)))
                           :     :     :     +- Relation [i_item_sk#12736,i_item_id#12737,i_rec_start_date#12738,i_rec_end_date#12739,i_item_desc#12740,i_current_price#12741,i_wholesale_cost#12742,i_brand_id#12743,i_brand#12744,i_class_id#12745,i_class#12746,i_category_id#12747,i_category#12748,i_manufact_id#12749,i_manufact#12750,i_size#12751,i_formulation#12752,i_color#12753,i_units#12754,i_container#12755,i_manager_id#12756,i_product_name#12757] parquet
                           :     :     +- Project [cs_sold_date_sk#12758, cs_call_center_sk#12769, cs_item_sk#12773, cs_sales_price#12779]
                           :     :        +- Filter ((isnotnull(cs_item_sk#12773) AND isnotnull(cs_sold_date_sk#12758)) AND isnotnull(cs_call_center_sk#12769))
                           :     :           +- Relation [cs_sold_date_sk#12758,cs_sold_time_sk#12759,cs_ship_date_sk#12760,cs_bill_customer_sk#12761,cs_bill_cdemo_sk#12762,cs_bill_hdemo_sk#12763,cs_bill_addr_sk#12764,cs_ship_customer_sk#12765,cs_ship_cdemo_sk#12766,cs_ship_hdemo_sk#12767,cs_ship_addr_sk#12768,cs_call_center_sk#12769,cs_catalog_page_sk#12770,cs_ship_mode_sk#12771,cs_warehouse_sk#12772,cs_item_sk#12773,cs_promo_sk#12774,cs_order_number#12775L,cs_quantity#12776,cs_wholesale_cost#12777,cs_list_price#12778,cs_sales_price#12779,cs_ext_discount_amt#12780,cs_ext_sales_price#12781,... 10 more fields] parquet
                           :     +- Project [d_date_sk#12792, d_year#12798, d_moy#12800]
                           :        +- Filter ((((d_year#12798 = 1999) OR ((d_year#12798 = 1998) AND (d_moy#12800 = 12))) OR ((d_year#12798 = 2000) AND (d_moy#12800 = 1))) AND isnotnull(d_date_sk#12792))
                           :           +- Relation [d_date_sk#12792,d_date_id#12793,d_date#12794,d_month_seq#12795,d_week_seq#12796,d_quarter_seq#12797,d_year#12798,d_dow#12799,d_moy#12800,d_dom#12801,d_qoy#12802,d_fy_year#12803,d_fy_quarter_seq#12804,d_fy_week_seq#12805,d_day_name#12806,d_quarter_name#12807,d_holiday#12808,d_weekend#12809,d_following_holiday#12810,d_first_dom#12811,d_last_dom#12812,d_same_day_ly#12813,d_same_day_lq#12814,d_current_day#12815,... 4 more fields] parquet
                           +- Project [cc_call_center_sk#12820, cc_name#12826]
                              +- Filter (isnotnull(cc_call_center_sk#12820) AND isnotnull(cc_name#12826))
                                 +- Relation [cc_call_center_sk#12820,cc_call_center_id#12821,cc_rec_start_date#12822,cc_rec_end_date#12823,cc_closed_date_sk#12824,cc_open_date_sk#12825,cc_name#12826,cc_class#12827,cc_employees#12828,cc_sq_ft#12829,cc_hours#12830,cc_manager#12831,cc_mkt_id#12832,cc_mkt_class#12833,cc_mkt_desc#12834,cc_market_manager#12835,cc_division#12836,cc_division_name#12837,cc_company#12838,cc_company_name#12839,cc_street_number#12840,cc_street_name#12841,cc_street_type#12842,cc_suite_number#12843,... 7 more fields] parquet
