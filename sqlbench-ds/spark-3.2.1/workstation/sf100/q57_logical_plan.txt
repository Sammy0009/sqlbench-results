GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#18446 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#18447 as decimal(22,6)))), DecimalType(22,6), true) ASC NULLS FIRST, psum#18449 ASC NULLS FIRST], true
      +- Project [cc_name#6, d_year#618, avg_monthly_sales#18447, sum_sales#18446, sum_sales#18466 AS psum#18449, sum_sales#18474 AS nsum#18450]
         +- Join Inner, ((((i_category#680 = i_category#18619) AND (i_brand#676 = i_brand#18615)) AND (cc_name#6 = cc_name#18697)) AND (rn#18448 = (rn#18726 - 1)))
            :- Project [i_category#680, i_brand#676, cc_name#6, d_year#618, sum_sales#18446, avg_monthly_sales#18447, rn#18448, sum_sales#18466]
            :  +- Join Inner, ((((i_category#680 = i_category#18499) AND (i_brand#676 = i_brand#18495)) AND (cc_name#6 = cc_name#18577)) AND (rn#18448 = (rn#18606 + 1)))
            :     :- Project [i_category#680, i_brand#676, cc_name#6, d_year#618, sum_sales#18446, avg_monthly_sales#18447, rn#18448]
            :     :  +- Filter ((isnotnull(avg_monthly_sales#18447) AND (avg_monthly_sales#18447 > 0.000000)) AND (CheckOverflow((promote_precision(abs(CheckOverflow((promote_precision(cast(sum_sales#18446 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#18447 as decimal(22,6)))), DecimalType(22,6), true), false)) / promote_precision(cast(avg_monthly_sales#18447 as decimal(22,6)))), DecimalType(38,16), true) > 0.1000000000000000))
            :     :     +- Window [avg(_w0#18460) windowspecdefinition(i_category#680, i_brand#676, cc_name#6, d_year#618, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#18447], [i_category#680, i_brand#676, cc_name#6, d_year#618]
            :     :        +- Project [i_category#680, i_brand#676, cc_name#6, d_year#618, sum_sales#18446, _w0#18460, rn#18448]
            :     :           +- Filter (isnotnull(d_year#618) AND (d_year#618 = 1999))
            :     :              +- Window [rank(d_year#618, d_moy#620) windowspecdefinition(i_category#680, i_brand#676, cc_name#6, d_year#618 ASC NULLS FIRST, d_moy#620 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#18448], [i_category#680, i_brand#676, cc_name#6], [d_year#618 ASC NULLS FIRST, d_moy#620 ASC NULLS FIRST]
            :     :                 +- Aggregate [i_category#680, i_brand#676, cc_name#6, d_year#618, d_moy#620], [i_category#680, i_brand#676, cc_name#6, d_year#618, d_moy#620, MakeDecimal(sum(UnscaledValue(cs_sales_price#565)),17,2) AS sum_sales#18446, MakeDecimal(sum(UnscaledValue(cs_sales_price#565)),17,2) AS _w0#18460]
            :     :                    +- Project [cs_sales_price#565, d_year#618, d_moy#620, i_brand#676, i_category#680, cc_name#6]
            :     :                       +- Join Inner, (cc_call_center_sk#0 = cs_call_center_sk#555)
            :     :                          :- Project [cs_call_center_sk#555, cs_sales_price#565, d_year#618, d_moy#620, i_brand#676, i_category#680]
            :     :                          :  +- Join Inner, (cs_item_sk#559 = i_item_sk#668)
            :     :                          :     :- Project [cs_call_center_sk#555, cs_item_sk#559, cs_sales_price#565, d_year#618, d_moy#620]
            :     :                          :     :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#612)
            :     :                          :     :     :- Project [cs_sold_date_sk#544, cs_call_center_sk#555, cs_item_sk#559, cs_sales_price#565]
            :     :                          :     :     :  +- Filter (isnotnull(cs_sold_date_sk#544) AND (isnotnull(cs_item_sk#559) AND isnotnull(cs_call_center_sk#555)))
            :     :                          :     :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
            :     :                          :     :     +- Project [d_date_sk#612, d_year#618, d_moy#620]
            :     :                          :     :        +- Filter ((((d_year#618 = 1999) OR ((d_year#618 = 1998) AND (d_moy#620 = 12))) OR ((d_year#618 = 2000) AND (d_moy#620 = 1))) AND isnotnull(d_date_sk#612))
            :     :                          :     :           +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :     :                          :     +- Project [i_item_sk#668, i_brand#676, i_category#680]
            :     :                          :        +- Filter (isnotnull(i_item_sk#668) AND (isnotnull(i_category#680) AND isnotnull(i_brand#676)))
            :     :                          :           +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
            :     :                          +- Project [cc_call_center_sk#0, cc_name#6]
            :     :                             +- Filter (isnotnull(cc_call_center_sk#0) AND isnotnull(cc_name#6))
            :     :                                +- Relation [cc_call_center_sk#0,cc_call_center_id#1,cc_rec_start_date#2,cc_rec_end_date#3,cc_closed_date_sk#4,cc_open_date_sk#5,cc_name#6,cc_class#7,cc_employees#8,cc_sq_ft#9,cc_hours#10,cc_manager#11,cc_mkt_id#12,cc_mkt_class#13,cc_mkt_desc#14,cc_market_manager#15,cc_division#16,cc_division_name#17,cc_company#18,cc_company_name#19,cc_street_number#20,cc_street_name#21,cc_street_type#22,cc_suite_number#23,... 7 more fields] parquet
            :     +- Project [i_category#18499, i_brand#18495, cc_name#18577, sum_sales#18446 AS sum_sales#18466, rn#18606]
            :        +- Window [rank(d_year#18549, d_moy#18551) windowspecdefinition(i_category#18499, i_brand#18495, cc_name#18577, d_year#18549 ASC NULLS FIRST, d_moy#18551 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#18606], [i_category#18499, i_brand#18495, cc_name#18577], [d_year#18549 ASC NULLS FIRST, d_moy#18551 ASC NULLS FIRST]
            :           +- Aggregate [i_category#18499, i_brand#18495, cc_name#18577, d_year#18549, d_moy#18551], [i_category#18499, i_brand#18495, cc_name#18577, d_year#18549, d_moy#18551, MakeDecimal(sum(UnscaledValue(cs_sales_price#18530)),17,2) AS sum_sales#18446]
            :              +- Project [cs_sales_price#18530, d_year#18549, d_moy#18551, i_brand#18495, i_category#18499, cc_name#18577]
            :                 +- Join Inner, (cc_call_center_sk#18571 = cs_call_center_sk#18520)
            :                    :- Project [cs_call_center_sk#18520, cs_sales_price#18530, d_year#18549, d_moy#18551, i_brand#18495, i_category#18499]
            :                    :  +- Join Inner, (cs_item_sk#18524 = i_item_sk#18487)
            :                    :     :- Project [cs_call_center_sk#18520, cs_item_sk#18524, cs_sales_price#18530, d_year#18549, d_moy#18551]
            :                    :     :  +- Join Inner, (cs_sold_date_sk#18509 = d_date_sk#18543)
            :                    :     :     :- Project [cs_sold_date_sk#18509, cs_call_center_sk#18520, cs_item_sk#18524, cs_sales_price#18530]
            :                    :     :     :  +- Filter (isnotnull(cs_sold_date_sk#18509) AND (isnotnull(cs_item_sk#18524) AND isnotnull(cs_call_center_sk#18520)))
            :                    :     :     :     +- Relation [cs_sold_date_sk#18509,cs_sold_time_sk#18510,cs_ship_date_sk#18511,cs_bill_customer_sk#18512,cs_bill_cdemo_sk#18513,cs_bill_hdemo_sk#18514,cs_bill_addr_sk#18515,cs_ship_customer_sk#18516,cs_ship_cdemo_sk#18517,cs_ship_hdemo_sk#18518,cs_ship_addr_sk#18519,cs_call_center_sk#18520,cs_catalog_page_sk#18521,cs_ship_mode_sk#18522,cs_warehouse_sk#18523,cs_item_sk#18524,cs_promo_sk#18525,cs_order_number#18526L,cs_quantity#18527,cs_wholesale_cost#18528,cs_list_price#18529,cs_sales_price#18530,cs_ext_discount_amt#18531,cs_ext_sales_price#18532,... 10 more fields] parquet
            :                    :     :     +- Project [d_date_sk#18543, d_year#18549, d_moy#18551]
            :                    :     :        +- Filter ((((d_year#18549 = 1999) OR ((d_year#18549 = 1998) AND (d_moy#18551 = 12))) OR ((d_year#18549 = 2000) AND (d_moy#18551 = 1))) AND isnotnull(d_date_sk#18543))
            :                    :     :           +- Relation [d_date_sk#18543,d_date_id#18544,d_date#18545,d_month_seq#18546,d_week_seq#18547,d_quarter_seq#18548,d_year#18549,d_dow#18550,d_moy#18551,d_dom#18552,d_qoy#18553,d_fy_year#18554,d_fy_quarter_seq#18555,d_fy_week_seq#18556,d_day_name#18557,d_quarter_name#18558,d_holiday#18559,d_weekend#18560,d_following_holiday#18561,d_first_dom#18562,d_last_dom#18563,d_same_day_ly#18564,d_same_day_lq#18565,d_current_day#18566,... 4 more fields] parquet
            :                    :     +- Project [i_item_sk#18487, i_brand#18495, i_category#18499]
            :                    :        +- Filter (isnotnull(i_item_sk#18487) AND (isnotnull(i_category#18499) AND isnotnull(i_brand#18495)))
            :                    :           +- Relation [i_item_sk#18487,i_item_id#18488,i_rec_start_date#18489,i_rec_end_date#18490,i_item_desc#18491,i_current_price#18492,i_wholesale_cost#18493,i_brand_id#18494,i_brand#18495,i_class_id#18496,i_class#18497,i_category_id#18498,i_category#18499,i_manufact_id#18500,i_manufact#18501,i_size#18502,i_formulation#18503,i_color#18504,i_units#18505,i_container#18506,i_manager_id#18507,i_product_name#18508] parquet
            :                    +- Project [cc_call_center_sk#18571, cc_name#18577]
            :                       +- Filter (isnotnull(cc_call_center_sk#18571) AND isnotnull(cc_name#18577))
            :                          +- Relation [cc_call_center_sk#18571,cc_call_center_id#18572,cc_rec_start_date#18573,cc_rec_end_date#18574,cc_closed_date_sk#18575,cc_open_date_sk#18576,cc_name#18577,cc_class#18578,cc_employees#18579,cc_sq_ft#18580,cc_hours#18581,cc_manager#18582,cc_mkt_id#18583,cc_mkt_class#18584,cc_mkt_desc#18585,cc_market_manager#18586,cc_division#18587,cc_division_name#18588,cc_company#18589,cc_company_name#18590,cc_street_number#18591,cc_street_name#18592,cc_street_type#18593,cc_suite_number#18594,... 7 more fields] parquet
            +- Project [i_category#18619, i_brand#18615, cc_name#18697, sum_sales#18446 AS sum_sales#18474, rn#18726]
               +- Window [rank(d_year#18669, d_moy#18671) windowspecdefinition(i_category#18619, i_brand#18615, cc_name#18697, d_year#18669 ASC NULLS FIRST, d_moy#18671 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#18726], [i_category#18619, i_brand#18615, cc_name#18697], [d_year#18669 ASC NULLS FIRST, d_moy#18671 ASC NULLS FIRST]
                  +- Aggregate [i_category#18619, i_brand#18615, cc_name#18697, d_year#18669, d_moy#18671], [i_category#18619, i_brand#18615, cc_name#18697, d_year#18669, d_moy#18671, MakeDecimal(sum(UnscaledValue(cs_sales_price#18650)),17,2) AS sum_sales#18446]
                     +- Project [cs_sales_price#18650, d_year#18669, d_moy#18671, i_brand#18615, i_category#18619, cc_name#18697]
                        +- Join Inner, (cc_call_center_sk#18691 = cs_call_center_sk#18640)
                           :- Project [cs_call_center_sk#18640, cs_sales_price#18650, d_year#18669, d_moy#18671, i_brand#18615, i_category#18619]
                           :  +- Join Inner, (cs_item_sk#18644 = i_item_sk#18607)
                           :     :- Project [cs_call_center_sk#18640, cs_item_sk#18644, cs_sales_price#18650, d_year#18669, d_moy#18671]
                           :     :  +- Join Inner, (cs_sold_date_sk#18629 = d_date_sk#18663)
                           :     :     :- Project [cs_sold_date_sk#18629, cs_call_center_sk#18640, cs_item_sk#18644, cs_sales_price#18650]
                           :     :     :  +- Filter (isnotnull(cs_sold_date_sk#18629) AND (isnotnull(cs_item_sk#18644) AND isnotnull(cs_call_center_sk#18640)))
                           :     :     :     +- Relation [cs_sold_date_sk#18629,cs_sold_time_sk#18630,cs_ship_date_sk#18631,cs_bill_customer_sk#18632,cs_bill_cdemo_sk#18633,cs_bill_hdemo_sk#18634,cs_bill_addr_sk#18635,cs_ship_customer_sk#18636,cs_ship_cdemo_sk#18637,cs_ship_hdemo_sk#18638,cs_ship_addr_sk#18639,cs_call_center_sk#18640,cs_catalog_page_sk#18641,cs_ship_mode_sk#18642,cs_warehouse_sk#18643,cs_item_sk#18644,cs_promo_sk#18645,cs_order_number#18646L,cs_quantity#18647,cs_wholesale_cost#18648,cs_list_price#18649,cs_sales_price#18650,cs_ext_discount_amt#18651,cs_ext_sales_price#18652,... 10 more fields] parquet
                           :     :     +- Project [d_date_sk#18663, d_year#18669, d_moy#18671]
                           :     :        +- Filter ((((d_year#18669 = 1999) OR ((d_year#18669 = 1998) AND (d_moy#18671 = 12))) OR ((d_year#18669 = 2000) AND (d_moy#18671 = 1))) AND isnotnull(d_date_sk#18663))
                           :     :           +- Relation [d_date_sk#18663,d_date_id#18664,d_date#18665,d_month_seq#18666,d_week_seq#18667,d_quarter_seq#18668,d_year#18669,d_dow#18670,d_moy#18671,d_dom#18672,d_qoy#18673,d_fy_year#18674,d_fy_quarter_seq#18675,d_fy_week_seq#18676,d_day_name#18677,d_quarter_name#18678,d_holiday#18679,d_weekend#18680,d_following_holiday#18681,d_first_dom#18682,d_last_dom#18683,d_same_day_ly#18684,d_same_day_lq#18685,d_current_day#18686,... 4 more fields] parquet
                           :     +- Project [i_item_sk#18607, i_brand#18615, i_category#18619]
                           :        +- Filter (isnotnull(i_item_sk#18607) AND (isnotnull(i_category#18619) AND isnotnull(i_brand#18615)))
                           :           +- Relation [i_item_sk#18607,i_item_id#18608,i_rec_start_date#18609,i_rec_end_date#18610,i_item_desc#18611,i_current_price#18612,i_wholesale_cost#18613,i_brand_id#18614,i_brand#18615,i_class_id#18616,i_class#18617,i_category_id#18618,i_category#18619,i_manufact_id#18620,i_manufact#18621,i_size#18622,i_formulation#18623,i_color#18624,i_units#18625,i_container#18626,i_manager_id#18627,i_product_name#18628] parquet
                           +- Project [cc_call_center_sk#18691, cc_name#18697]
                              +- Filter (isnotnull(cc_call_center_sk#18691) AND isnotnull(cc_name#18697))
                                 +- Relation [cc_call_center_sk#18691,cc_call_center_id#18692,cc_rec_start_date#18693,cc_rec_end_date#18694,cc_closed_date_sk#18695,cc_open_date_sk#18696,cc_name#18697,cc_class#18698,cc_employees#18699,cc_sq_ft#18700,cc_hours#18701,cc_manager#18702,cc_mkt_id#18703,cc_mkt_class#18704,cc_mkt_desc#18705,cc_market_manager#18706,cc_division#18707,cc_division_name#18708,cc_company#18709,cc_company_name#18710,cc_street_number#18711,cc_street_name#18712,cc_street_type#18713,cc_suite_number#18714,... 7 more fields] parquet
