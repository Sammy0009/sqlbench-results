GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#772 ASC NULLS FIRST], true
      +- Aggregate [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ship_carriers#22645, year#22646], [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ship_carriers#22645, year#22646, sum(jan_sales#22647) AS jan_sales#22697, sum(feb_sales#22648) AS feb_sales#22698, sum(mar_sales#22649) AS mar_sales#22699, sum(apr_sales#22650) AS apr_sales#22700, sum(may_sales#22651) AS may_sales#22701, sum(jun_sales#22652) AS jun_sales#22702, sum(jul_sales#22653) AS jul_sales#22703, sum(aug_sales#22654) AS aug_sales#22704, sum(sep_sales#22655) AS sep_sales#22705, sum(oct_sales#22656) AS oct_sales#22706, sum(nov_sales#22657) AS nov_sales#22707, sum(dec_sales#22658) AS dec_sales#22708, sum(CheckOverflow((promote_precision(jan_sales#22647) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS jan_sales_per_sq_foot#22709, sum(CheckOverflow((promote_precision(feb_sales#22648) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS feb_sales_per_sq_foot#22710, sum(CheckOverflow((promote_precision(mar_sales#22649) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS mar_sales_per_sq_foot#22711, sum(CheckOverflow((promote_precision(apr_sales#22650) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS apr_sales_per_sq_foot#22712, ... 20 more fields]
         +- Union false, false
            :- Aggregate [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618], [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ZHOU,MSC AS ship_carriers#22645, d_year#618 AS year#22646, sum(CASE WHEN (d_moy#620 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#22647, sum(CASE WHEN (d_moy#620 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#22648, sum(CASE WHEN (d_moy#620 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#22649, sum(CASE WHEN (d_moy#620 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#22650, sum(CASE WHEN (d_moy#620 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#22651, sum(CASE WHEN (d_moy#620 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#22652, sum(CASE WHEN (d_moy#620 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#22653, sum(CASE WHEN (d_moy#620 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#22654, sum(CASE WHEN (d_moy#620 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#22655, sum(CASE WHEN (d_moy#620 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#22656, sum(CASE WHEN (d_moy#620 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#22657, sum(CASE WHEN (d_moy#620 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#22658, sum(CASE WHEN (d_moy#620 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#22659, sum(CASE WHEN (d_moy#620 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#22660, sum(CASE WHEN (d_moy#620 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#22661, sum(CASE WHEN (d_moy#620 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#22662, ... 8 more fields]
            :  +- Project [ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :     +- Join Inner, (ws_sold_time_sk#477 = t_time_sk#456)
            :        :- Project [ws_sold_time_sk#477, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :        :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#612)
            :        :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :  +- Join Inner, (ws_ship_mode_sk#490 = sm_ship_mode_sk#444)
            :        :     :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :     :  +- Join Inner, (ws_warehouse_sk#491 = w_warehouse_sk#770)
            :        :     :     :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_warehouse_sk#491, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506]
            :        :     :     :     :  +- Filter (isnotnull(ws_warehouse_sk#491) AND ((isnotnull(ws_ship_mode_sk#490) AND isnotnull(ws_sold_date_sk#476)) AND isnotnull(ws_sold_time_sk#477)))
            :        :     :     :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
            :        :     :     :     +- Project [w_warehouse_sk#770, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#770)
            :        :     :     :           +- Relation [w_warehouse_sk#770,w_warehouse_id#771,w_warehouse_name#772,w_warehouse_sq_ft#773,w_street_number#774,w_street_name#775,w_street_type#776,w_suite_number#777,w_city#778,w_county#779,w_state#780,w_zip#781,w_country#782,w_gmt_offset#783] parquet
            :        :     :     +- Project [sm_ship_mode_sk#444]
            :        :     :        +- Filter (sm_carrier#448 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#444))
            :        :     :           +- Relation [sm_ship_mode_sk#444,sm_ship_mode_id#445,sm_type#446,sm_code#447,sm_carrier#448,sm_contract#449] parquet
            :        :     +- Project [d_date_sk#612, d_year#618, d_moy#620]
            :        :        +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2000)) AND isnotnull(d_date_sk#612))
            :        :           +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :        +- Project [t_time_sk#456]
            :           +- Filter ((isnotnull(t_time#458) AND ((t_time#458 >= 12143) AND (t_time#458 <= 40943))) AND isnotnull(t_time_sk#456))
            :              +- Relation [t_time_sk#456,t_time_id#457,t_time#458,t_hour#459,t_minute#460,t_second#461,t_am_pm#462,t_shift#463,t_sub_shift#464,t_meal_time#465] parquet
            +- Aggregate [w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745, d_year#22753], [w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745, ZHOU,MSC AS ship_carriers#22671, d_year#22753 AS year#22672, sum(CASE WHEN (d_moy#22755 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#22673, sum(CASE WHEN (d_moy#22755 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#22674, sum(CASE WHEN (d_moy#22755 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#22675, sum(CASE WHEN (d_moy#22755 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#22676, sum(CASE WHEN (d_moy#22755 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#22677, sum(CASE WHEN (d_moy#22755 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#22678, sum(CASE WHEN (d_moy#22755 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#22679, sum(CASE WHEN (d_moy#22755 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#22680, sum(CASE WHEN (d_moy#22755 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#22681, sum(CASE WHEN (d_moy#22755 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#22682, sum(CASE WHEN (d_moy#22755 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#22683, sum(CASE WHEN (d_moy#22755 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#22684, sum(CASE WHEN (d_moy#22755 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#22685, sum(CASE WHEN (d_moy#22755 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#22686, sum(CASE WHEN (d_moy#22755 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#22687, sum(CASE WHEN (d_moy#22755 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#22688, ... 8 more fields]
               +- Project [cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745, d_year#22753, d_moy#22755]
                  +- Join Inner, (cs_sold_time_sk#545 = t_time_sk#22775)
                     :- Project [cs_sold_time_sk#545, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745, d_year#22753, d_moy#22755]
                     :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#22747)
                     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745]
                     :     :  +- Join Inner, (cs_ship_mode_sk#557 = sm_ship_mode_sk#22785)
                     :     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745]
                     :     :     :  +- Join Inner, (cs_warehouse_sk#558 = w_warehouse_sk#22733)
                     :     :     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_warehouse_sk#558, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574]
                     :     :     :     :  +- Filter (isnotnull(cs_warehouse_sk#558) AND ((isnotnull(cs_ship_mode_sk#557) AND isnotnull(cs_sold_date_sk#544)) AND isnotnull(cs_sold_time_sk#545)))
                     :     :     :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
                     :     :     :     +- Project [w_warehouse_sk#22733, w_warehouse_name#22735, w_warehouse_sq_ft#22736, w_city#22741, w_county#22742, w_state#22743, w_country#22745]
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#22733)
                     :     :     :           +- Relation [w_warehouse_sk#22733,w_warehouse_id#22734,w_warehouse_name#22735,w_warehouse_sq_ft#22736,w_street_number#22737,w_street_name#22738,w_street_type#22739,w_suite_number#22740,w_city#22741,w_county#22742,w_state#22743,w_zip#22744,w_country#22745,w_gmt_offset#22746] parquet
                     :     :     +- Project [sm_ship_mode_sk#22785]
                     :     :        +- Filter (sm_carrier#22789 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#22785))
                     :     :           +- Relation [sm_ship_mode_sk#22785,sm_ship_mode_id#22786,sm_type#22787,sm_code#22788,sm_carrier#22789,sm_contract#22790] parquet
                     :     +- Project [d_date_sk#22747, d_year#22753, d_moy#22755]
                     :        +- Filter ((isnotnull(d_year#22753) AND (d_year#22753 = 2000)) AND isnotnull(d_date_sk#22747))
                     :           +- Relation [d_date_sk#22747,d_date_id#22748,d_date#22749,d_month_seq#22750,d_week_seq#22751,d_quarter_seq#22752,d_year#22753,d_dow#22754,d_moy#22755,d_dom#22756,d_qoy#22757,d_fy_year#22758,d_fy_quarter_seq#22759,d_fy_week_seq#22760,d_day_name#22761,d_quarter_name#22762,d_holiday#22763,d_weekend#22764,d_following_holiday#22765,d_first_dom#22766,d_last_dom#22767,d_same_day_ly#22768,d_same_day_lq#22769,d_current_day#22770,... 4 more fields] parquet
                     +- Project [t_time_sk#22775]
                        +- Filter ((isnotnull(t_time#22777) AND ((t_time#22777 >= 12143) AND (t_time#22777 <= 40943))) AND isnotnull(t_time_sk#22775))
                           +- Relation [t_time_sk#22775,t_time_id#22776,t_time#22777,t_hour#22778,t_minute#22779,t_second#22780,t_am_pm#22781,t_shift#22782,t_sub_shift#22783,t_meal_time#22784] parquet
