GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#188 ASC NULLS FIRST], true
      +- Aggregate [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793], [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#14792, year#14793, sum(jan_sales#14794) AS jan_sales#14844, sum(feb_sales#14795) AS feb_sales#14845, sum(mar_sales#14796) AS mar_sales#14846, sum(apr_sales#14797) AS apr_sales#14847, sum(may_sales#14798) AS may_sales#14848, sum(jun_sales#14799) AS jun_sales#14849, sum(jul_sales#14800) AS jul_sales#14850, sum(aug_sales#14801) AS aug_sales#14851, sum(sep_sales#14802) AS sep_sales#14852, sum(oct_sales#14803) AS oct_sales#14853, sum(nov_sales#14804) AS nov_sales#14854, sum(dec_sales#14805) AS dec_sales#14855, sum(CheckOverflow((promote_precision(jan_sales#14794) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS jan_sales_per_sq_foot#14856, sum(CheckOverflow((promote_precision(feb_sales#14795) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS feb_sales_per_sq_foot#14857, sum(CheckOverflow((promote_precision(mar_sales#14796) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS mar_sales_per_sq_foot#14858, sum(CheckOverflow((promote_precision(apr_sales#14797) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS apr_sales_per_sq_foot#14859, ... 20 more fields]
         +- Union false, false
            :- Aggregate [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ZHOU,MSC AS ship_carriers#14792, d_year#604 AS year#14793, sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#14794, sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#14795, sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#14796, sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#14797, sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#14798, sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#14799, sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#14800, sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#14801, sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#14802, sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#14803, sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#14804, sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#14805, sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#14806, sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#14807, sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#14808, sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#14809, ... 8 more fields]
            :  +- Project [ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
            :     +- Join Inner, (ws_ship_mode_sk#398 = sm_ship_mode_sk#550)
            :        :- Project [ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
            :        :  +- Join Inner, (ws_sold_time_sk#385 = t_time_sk#28)
            :        :     :- Project [ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
            :        :     :  +- Join Inner, (ws_sold_date_sk#384 = d_date_sk#598)
            :        :     :     :- Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
            :        :     :     :  +- Join Inner, (ws_warehouse_sk#399 = w_warehouse_sk#186)
            :        :     :     :     :- Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_warehouse_sk#399, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414]
            :        :     :     :     :  +- Filter ((isnotnull(ws_warehouse_sk#399) AND isnotnull(ws_sold_date_sk#384)) AND (isnotnull(ws_sold_time_sk#385) AND isnotnull(ws_ship_mode_sk#398)))
            :        :     :     :     :     +- Relation [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_date_sk#386,ws_item_sk#387,ws_bill_customer_sk#388,ws_bill_cdemo_sk#389,ws_bill_hdemo_sk#390,ws_bill_addr_sk#391,ws_ship_customer_sk#392,ws_ship_cdemo_sk#393,ws_ship_hdemo_sk#394,ws_ship_addr_sk#395,ws_web_page_sk#396,ws_web_site_sk#397,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_promo_sk#400,ws_order_number#401L,ws_quantity#402,ws_wholesale_cost#403,ws_list_price#404,ws_sales_price#405,ws_ext_discount_amt#406,ws_ext_sales_price#407,... 10 more fields] parquet
            :        :     :     :     +- Project [w_warehouse_sk#186, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#186)
            :        :     :     :           +- Relation [w_warehouse_sk#186,w_warehouse_id#187,w_warehouse_name#188,w_warehouse_sq_ft#189,w_street_number#190,w_street_name#191,w_street_type#192,w_suite_number#193,w_city#194,w_county#195,w_state#196,w_zip#197,w_country#198,w_gmt_offset#199] parquet
            :        :     :     +- Project [d_date_sk#598, d_year#604, d_moy#606]
            :        :     :        +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 2000)) AND isnotnull(d_date_sk#598))
            :        :     :           +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
            :        :     +- Project [t_time_sk#28]
            :        :        +- Filter ((isnotnull(t_time#30) AND ((t_time#30 >= 12143) AND (t_time#30 <= 40943))) AND isnotnull(t_time_sk#28))
            :        :           +- Relation [t_time_sk#28,t_time_id#29,t_time#30,t_hour#31,t_minute#32,t_second#33,t_am_pm#34,t_shift#35,t_sub_shift#36,t_meal_time#37] parquet
            :        +- Project [sm_ship_mode_sk#550]
            :           +- Filter (sm_carrier#554 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#550))
            :              +- Relation [sm_ship_mode_sk#550,sm_ship_mode_id#551,sm_type#552,sm_code#553,sm_carrier#554,sm_contract#555] parquet
            +- Aggregate [w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900], [w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, ZHOU,MSC AS ship_carriers#14818, d_year#14900 AS year#14819, sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#14820, sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#14821, sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#14822, sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#14823, sum(CASE WHEN (d_moy#14902 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#14824, sum(CASE WHEN (d_moy#14902 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#14825, sum(CASE WHEN (d_moy#14902 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#14826, sum(CASE WHEN (d_moy#14902 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#14827, sum(CASE WHEN (d_moy#14902 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#14828, sum(CASE WHEN (d_moy#14902 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#14829, sum(CASE WHEN (d_moy#14902 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#14830, sum(CASE WHEN (d_moy#14902 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#14831, sum(CASE WHEN (d_moy#14902 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#14832, sum(CASE WHEN (d_moy#14902 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#14833, sum(CASE WHEN (d_moy#14902 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#14834, sum(CASE WHEN (d_moy#14902 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#14835, ... 8 more fields]
               +- Project [cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                  +- Join Inner, (cs_ship_mode_sk#131 = sm_ship_mode_sk#14932)
                     :- Project [cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                     :  +- Join Inner, (cs_sold_time_sk#119 = t_time_sk#14922)
                     :     :- Project [cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892, d_year#14900, d_moy#14902]
                     :     :  +- Join Inner, (cs_sold_date_sk#118 = d_date_sk#14894)
                     :     :     :- Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892]
                     :     :     :  +- Join Inner, (cs_warehouse_sk#132 = w_warehouse_sk#14880)
                     :     :     :     :- Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_warehouse_sk#132, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148]
                     :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#132) AND isnotnull(cs_sold_date_sk#118)) AND (isnotnull(cs_sold_time_sk#119) AND isnotnull(cs_ship_mode_sk#131)))
                     :     :     :     :     +- Relation [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_date_sk#120,cs_bill_customer_sk#121,cs_bill_cdemo_sk#122,cs_bill_hdemo_sk#123,cs_bill_addr_sk#124,cs_ship_customer_sk#125,cs_ship_cdemo_sk#126,cs_ship_hdemo_sk#127,cs_ship_addr_sk#128,cs_call_center_sk#129,cs_catalog_page_sk#130,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_item_sk#133,cs_promo_sk#134,cs_order_number#135L,cs_quantity#136,cs_wholesale_cost#137,cs_list_price#138,cs_sales_price#139,cs_ext_discount_amt#140,cs_ext_sales_price#141,... 10 more fields] parquet
                     :     :     :     +- Project [w_warehouse_sk#14880, w_warehouse_name#14882, w_warehouse_sq_ft#14883, w_city#14888, w_county#14889, w_state#14890, w_country#14892]
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#14880)
                     :     :     :           +- Relation [w_warehouse_sk#14880,w_warehouse_id#14881,w_warehouse_name#14882,w_warehouse_sq_ft#14883,w_street_number#14884,w_street_name#14885,w_street_type#14886,w_suite_number#14887,w_city#14888,w_county#14889,w_state#14890,w_zip#14891,w_country#14892,w_gmt_offset#14893] parquet
                     :     :     +- Project [d_date_sk#14894, d_year#14900, d_moy#14902]
                     :     :        +- Filter ((isnotnull(d_year#14900) AND (d_year#14900 = 2000)) AND isnotnull(d_date_sk#14894))
                     :     :           +- Relation [d_date_sk#14894,d_date_id#14895,d_date#14896,d_month_seq#14897,d_week_seq#14898,d_quarter_seq#14899,d_year#14900,d_dow#14901,d_moy#14902,d_dom#14903,d_qoy#14904,d_fy_year#14905,d_fy_quarter_seq#14906,d_fy_week_seq#14907,d_day_name#14908,d_quarter_name#14909,d_holiday#14910,d_weekend#14911,d_following_holiday#14912,d_first_dom#14913,d_last_dom#14914,d_same_day_ly#14915,d_same_day_lq#14916,d_current_day#14917,... 4 more fields] parquet
                     :     +- Project [t_time_sk#14922]
                     :        +- Filter ((isnotnull(t_time#14924) AND ((t_time#14924 >= 12143) AND (t_time#14924 <= 40943))) AND isnotnull(t_time_sk#14922))
                     :           +- Relation [t_time_sk#14922,t_time_id#14923,t_time#14924,t_hour#14925,t_minute#14926,t_second#14927,t_am_pm#14928,t_shift#14929,t_sub_shift#14930,t_meal_time#14931] parquet
                     +- Project [sm_ship_mode_sk#14932]
                        +- Filter (sm_carrier#14936 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#14932))
                           +- Relation [sm_ship_mode_sk#14932,sm_ship_mode_id#14933,sm_type#14934,sm_code#14935,sm_carrier#14936,sm_contract#14937] parquet
