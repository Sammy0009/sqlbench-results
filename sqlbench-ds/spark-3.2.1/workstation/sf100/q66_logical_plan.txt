GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#188 ASC NULLS FIRST], true
      +- Aggregate [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410], [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ship_carriers#13409, year#13410, sum(jan_sales#13411) AS jan_sales#13461, sum(feb_sales#13412) AS feb_sales#13462, sum(mar_sales#13413) AS mar_sales#13463, sum(apr_sales#13414) AS apr_sales#13464, sum(may_sales#13415) AS may_sales#13465, sum(jun_sales#13416) AS jun_sales#13466, sum(jul_sales#13417) AS jul_sales#13467, sum(aug_sales#13418) AS aug_sales#13468, sum(sep_sales#13419) AS sep_sales#13469, sum(oct_sales#13420) AS oct_sales#13470, sum(nov_sales#13421) AS nov_sales#13471, sum(dec_sales#13422) AS dec_sales#13472, sum(CheckOverflow((promote_precision(jan_sales#13411) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS jan_sales_per_sq_foot#13473, sum(CheckOverflow((promote_precision(feb_sales#13412) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS feb_sales_per_sq_foot#13474, sum(CheckOverflow((promote_precision(mar_sales#13413) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS mar_sales_per_sq_foot#13475, sum(CheckOverflow((promote_precision(apr_sales#13414) / promote_precision(cast(cast(w_warehouse_sq_ft#189 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS apr_sales_per_sq_foot#13476, ... 20 more fields]
         +- Union false, false
            :- Aggregate [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604], [w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, ZHOU,MSC AS ship_carriers#13409, d_year#604 AS year#13410, sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#13411, sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#13412, sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#13413, sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#13414, sum(CASE WHEN (d_moy#606 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#13415, sum(CASE WHEN (d_moy#606 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#13416, sum(CASE WHEN (d_moy#606 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#13417, sum(CASE WHEN (d_moy#606 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#13418, sum(CASE WHEN (d_moy#606 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#13419, sum(CASE WHEN (d_moy#606 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#13420, sum(CASE WHEN (d_moy#606 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#13421, sum(CASE WHEN (d_moy#606 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#405 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#13422, sum(CASE WHEN (d_moy#606 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#13423, sum(CASE WHEN (d_moy#606 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#13424, sum(CASE WHEN (d_moy#606 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#13425, sum(CASE WHEN (d_moy#606 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#414 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#402 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#13426, ... 8 more fields]
            :  +- Project [ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
            :     +- Join Inner, (ws_ship_mode_sk#398 = sm_ship_mode_sk#550)
            :        :- Project [ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
            :        :  +- Join Inner, (ws_sold_time_sk#385 = t_time_sk#28)
            :        :     :- Project [ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198, d_year#604, d_moy#606]
            :        :     :  +- Join Inner, (ws_sold_date_sk#384 = d_date_sk#598)
            :        :     :     :- Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
            :        :     :     :  +- Join Inner, (ws_warehouse_sk#399 = w_warehouse_sk#186)
            :        :     :     :     :- Project [ws_sold_date_sk#384, ws_sold_time_sk#385, ws_ship_mode_sk#398, ws_warehouse_sk#399, ws_quantity#402, ws_sales_price#405, ws_net_paid_inc_tax#414]
            :        :     :     :     :  +- Filter ((isnotnull(ws_warehouse_sk#399) AND isnotnull(ws_sold_date_sk#384)) AND (isnotnull(ws_sold_time_sk#385) AND isnotnull(ws_ship_mode_sk#398)))
            :        :     :     :     :     +- Relation [ws_sold_date_sk#384,ws_sold_time_sk#385,ws_ship_date_sk#386,ws_item_sk#387,ws_bill_customer_sk#388,ws_bill_cdemo_sk#389,ws_bill_hdemo_sk#390,ws_bill_addr_sk#391,ws_ship_customer_sk#392,ws_ship_cdemo_sk#393,ws_ship_hdemo_sk#394,ws_ship_addr_sk#395,ws_web_page_sk#396,ws_web_site_sk#397,ws_ship_mode_sk#398,ws_warehouse_sk#399,ws_promo_sk#400,ws_order_number#401L,ws_quantity#402,ws_wholesale_cost#403,ws_list_price#404,ws_sales_price#405,ws_ext_discount_amt#406,ws_ext_sales_price#407,... 10 more fields] parquet
            :        :     :     :     +- Project [w_warehouse_sk#186, w_warehouse_name#188, w_warehouse_sq_ft#189, w_city#194, w_county#195, w_state#196, w_country#198]
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#186)
            :        :     :     :           +- Relation [w_warehouse_sk#186,w_warehouse_id#187,w_warehouse_name#188,w_warehouse_sq_ft#189,w_street_number#190,w_street_name#191,w_street_type#192,w_suite_number#193,w_city#194,w_county#195,w_state#196,w_zip#197,w_country#198,w_gmt_offset#199] parquet
            :        :     :     +- Project [d_date_sk#598, d_year#604, d_moy#606]
            :        :     :        +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 2000)) AND isnotnull(d_date_sk#598))
            :        :     :           +- Relation [d_date_sk#598,d_date_id#599,d_date#600,d_month_seq#601,d_week_seq#602,d_quarter_seq#603,d_year#604,d_dow#605,d_moy#606,d_dom#607,d_qoy#608,d_fy_year#609,d_fy_quarter_seq#610,d_fy_week_seq#611,d_day_name#612,d_quarter_name#613,d_holiday#614,d_weekend#615,d_following_holiday#616,d_first_dom#617,d_last_dom#618,d_same_day_ly#619,d_same_day_lq#620,d_current_day#621,... 4 more fields] parquet
            :        :     +- Project [t_time_sk#28]
            :        :        +- Filter ((isnotnull(t_time#30) AND ((t_time#30 >= 12143) AND (t_time#30 <= 40943))) AND isnotnull(t_time_sk#28))
            :        :           +- Relation [t_time_sk#28,t_time_id#29,t_time#30,t_hour#31,t_minute#32,t_second#33,t_am_pm#34,t_shift#35,t_sub_shift#36,t_meal_time#37] parquet
            :        +- Project [sm_ship_mode_sk#550]
            :           +- Filter (sm_carrier#554 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#550))
            :              +- Relation [sm_ship_mode_sk#550,sm_ship_mode_id#551,sm_type#552,sm_code#553,sm_carrier#554,sm_contract#555] parquet
            +- Aggregate [w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517], [w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, ZHOU,MSC AS ship_carriers#13435, d_year#13517 AS year#13436, sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#13437, sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#13438, sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#13439, sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#13440, sum(CASE WHEN (d_moy#13519 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#13441, sum(CASE WHEN (d_moy#13519 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#13442, sum(CASE WHEN (d_moy#13519 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#13443, sum(CASE WHEN (d_moy#13519 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#13444, sum(CASE WHEN (d_moy#13519 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#13445, sum(CASE WHEN (d_moy#13519 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#13446, sum(CASE WHEN (d_moy#13519 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#13447, sum(CASE WHEN (d_moy#13519 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#143 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#13448, sum(CASE WHEN (d_moy#13519 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#13449, sum(CASE WHEN (d_moy#13519 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#13450, sum(CASE WHEN (d_moy#13519 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#13451, sum(CASE WHEN (d_moy#13519 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#148 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#136 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#13452, ... 8 more fields]
               +- Project [cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                  +- Join Inner, (cs_ship_mode_sk#131 = sm_ship_mode_sk#13549)
                     :- Project [cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                     :  +- Join Inner, (cs_sold_time_sk#119 = t_time_sk#13539)
                     :     :- Project [cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509, d_year#13517, d_moy#13519]
                     :     :  +- Join Inner, (cs_sold_date_sk#118 = d_date_sk#13511)
                     :     :     :- Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509]
                     :     :     :  +- Join Inner, (cs_warehouse_sk#132 = w_warehouse_sk#13497)
                     :     :     :     :- Project [cs_sold_date_sk#118, cs_sold_time_sk#119, cs_ship_mode_sk#131, cs_warehouse_sk#132, cs_quantity#136, cs_ext_list_price#143, cs_net_paid_inc_tax#148]
                     :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#132) AND isnotnull(cs_sold_date_sk#118)) AND (isnotnull(cs_sold_time_sk#119) AND isnotnull(cs_ship_mode_sk#131)))
                     :     :     :     :     +- Relation [cs_sold_date_sk#118,cs_sold_time_sk#119,cs_ship_date_sk#120,cs_bill_customer_sk#121,cs_bill_cdemo_sk#122,cs_bill_hdemo_sk#123,cs_bill_addr_sk#124,cs_ship_customer_sk#125,cs_ship_cdemo_sk#126,cs_ship_hdemo_sk#127,cs_ship_addr_sk#128,cs_call_center_sk#129,cs_catalog_page_sk#130,cs_ship_mode_sk#131,cs_warehouse_sk#132,cs_item_sk#133,cs_promo_sk#134,cs_order_number#135L,cs_quantity#136,cs_wholesale_cost#137,cs_list_price#138,cs_sales_price#139,cs_ext_discount_amt#140,cs_ext_sales_price#141,... 10 more fields] parquet
                     :     :     :     +- Project [w_warehouse_sk#13497, w_warehouse_name#13499, w_warehouse_sq_ft#13500, w_city#13505, w_county#13506, w_state#13507, w_country#13509]
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#13497)
                     :     :     :           +- Relation [w_warehouse_sk#13497,w_warehouse_id#13498,w_warehouse_name#13499,w_warehouse_sq_ft#13500,w_street_number#13501,w_street_name#13502,w_street_type#13503,w_suite_number#13504,w_city#13505,w_county#13506,w_state#13507,w_zip#13508,w_country#13509,w_gmt_offset#13510] parquet
                     :     :     +- Project [d_date_sk#13511, d_year#13517, d_moy#13519]
                     :     :        +- Filter ((isnotnull(d_year#13517) AND (d_year#13517 = 2000)) AND isnotnull(d_date_sk#13511))
                     :     :           +- Relation [d_date_sk#13511,d_date_id#13512,d_date#13513,d_month_seq#13514,d_week_seq#13515,d_quarter_seq#13516,d_year#13517,d_dow#13518,d_moy#13519,d_dom#13520,d_qoy#13521,d_fy_year#13522,d_fy_quarter_seq#13523,d_fy_week_seq#13524,d_day_name#13525,d_quarter_name#13526,d_holiday#13527,d_weekend#13528,d_following_holiday#13529,d_first_dom#13530,d_last_dom#13531,d_same_day_ly#13532,d_same_day_lq#13533,d_current_day#13534,... 4 more fields] parquet
                     :     +- Project [t_time_sk#13539]
                     :        +- Filter ((isnotnull(t_time#13541) AND ((t_time#13541 >= 12143) AND (t_time#13541 <= 40943))) AND isnotnull(t_time_sk#13539))
                     :           +- Relation [t_time_sk#13539,t_time_id#13540,t_time#13541,t_hour#13542,t_minute#13543,t_second#13544,t_am_pm#13545,t_shift#13546,t_sub_shift#13547,t_meal_time#13548] parquet
                     +- Project [sm_ship_mode_sk#13549]
                        +- Filter (sm_carrier#13553 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#13549))
                           +- Relation [sm_ship_mode_sk#13549,sm_ship_mode_id#13550,sm_type#13551,sm_code#13552,sm_carrier#13553,sm_contract#13554] parquet
