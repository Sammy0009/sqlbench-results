AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[substr(r_reason_desc, 1, 20)#19764 ASC NULLS FIRST,avg(ws_quantity)#19765 ASC NULLS FIRST,avg(wr_refunded_cash)#19766 ASC NULLS FIRST,avg(wr_fee)#19767 ASC NULLS FIRST], output=[substr(r_reason_desc, 1, 20)#19764,avg(ws_quantity)#19765,avg(wr_refunded_cash)#19766,avg(wr_fee)#19767])
   +- *(12) HashAggregate(keys=[r_reason_desc#546], functions=[avg(ws_quantity#402), avg(UnscaledValue(wr_refunded_cash#472)), avg(UnscaledValue(wr_fee#470))], output=[substr(r_reason_desc, 1, 20)#19764, avg(ws_quantity)#19765, avg(wr_refunded_cash)#19766, avg(wr_fee)#19767])
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 8
            +- Exchange hashpartitioning(r_reason_desc#546, 200), ENSURE_REQUIREMENTS, [id=#166482]
               +- *(11) HashAggregate(keys=[r_reason_desc#546], functions=[partial_avg(ws_quantity#402), partial_avg(UnscaledValue(wr_refunded_cash#472)), partial_avg(UnscaledValue(wr_fee#470))], output=[r_reason_desc#546, sum#19781, count#19782L, sum#19783, count#19784L, sum#19785, count#19786L])
                  +- *(11) Project [ws_quantity#402, wr_fee#470, wr_refunded_cash#472, r_reason_desc#546]
                     +- *(11) BroadcastHashJoin [wr_reason_sk#464], [r_reason_sk#544], Inner, BuildRight, false
                        :- *(11) Project [ws_quantity#402, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                        :  +- *(11) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#598], Inner, BuildRight, false
                        :     :- *(11) Project [ws_sold_date_sk#384, ws_quantity#402, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                        :     :  +- *(11) BroadcastHashJoin [wr_refunded_addr_sk#458], [ca_address_sk#214], Inner, BuildRight, ((((ca_state#222 IN (SD,CO,OK) AND (ws_net_profit#417 >= 100.00)) AND (ws_net_profit#417 <= 200.00)) OR ((ca_state#222 IN (MA,GA,MI) AND (ws_net_profit#417 >= 150.00)) AND (ws_net_profit#417 <= 300.00))) OR ((ca_state#222 IN (CA,IA,IL) AND (ws_net_profit#417 >= 50.00)) AND (ws_net_profit#417 <= 250.00))), false
                        :     :     :- *(11) Project [ws_sold_date_sk#384, ws_quantity#402, ws_net_profit#417, wr_refunded_addr_sk#458, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                        :     :     :  +- *(11) BroadcastHashJoin [wr_returning_cdemo_sk#460, cd_marital_status#50, cd_education_status#51], [cd_demo_sk#19752, cd_marital_status#19754, cd_education_status#19755], Inner, BuildRight, false
                        :     :     :     :- *(11) Project [ws_sold_date_sk#384, ws_quantity#402, ws_net_profit#417, wr_refunded_addr_sk#458, wr_returning_cdemo_sk#460, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472, cd_marital_status#50, cd_education_status#51]
                        :     :     :     :  +- *(11) BroadcastHashJoin [wr_refunded_cdemo_sk#456], [cd_demo_sk#48], Inner, BuildRight, ((((((cd_marital_status#50 = D) AND (cd_education_status#51 = Secondary)) AND (ws_sales_price#405 >= 100.00)) AND (ws_sales_price#405 <= 150.00)) OR ((((cd_marital_status#50 = S) AND (cd_education_status#51 = College)) AND (ws_sales_price#405 >= 50.00)) AND (ws_sales_price#405 <= 100.00))) OR ((((cd_marital_status#50 = W) AND (cd_education_status#51 = Primary)) AND (ws_sales_price#405 >= 150.00)) AND (ws_sales_price#405 <= 200.00))), false
                        :     :     :     :     :- *(11) Project [ws_sold_date_sk#384, ws_quantity#402, ws_sales_price#405, ws_net_profit#417, wr_refunded_cdemo_sk#456, wr_refunded_addr_sk#458, wr_returning_cdemo_sk#460, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                        :     :     :     :     :  +- *(11) BroadcastHashJoin [ws_web_page_sk#396], [wp_web_page_sk#0], Inner, BuildRight, false
                        :     :     :     :     :     :- *(11) Project [ws_sold_date_sk#384, ws_web_page_sk#396, ws_quantity#402, ws_sales_price#405, ws_net_profit#417, wr_refunded_cdemo_sk#456, wr_refunded_addr_sk#458, wr_returning_cdemo_sk#460, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                        :     :     :     :     :     :  +- *(11) SortMergeJoin [ws_item_sk#387, ws_order_number#401L], [wr_item_sk#454, wr_order_number#465L], Inner
                        :     :     :     :     :     :     :- *(9) Sort [ws_item_sk#387 ASC NULLS FIRST, ws_order_number#401L ASC NULLS FIRST], false, 0
                        :     :     :     :     :     :     :  +- AQEShuffleRead coalesced
                        :     :     :     :     :     :     :     +- ShuffleQueryStage 0
                        :     :     :     :     :     :     :        +- Exchange hashpartitioning(ws_item_sk#387, ws_order_number#401L, 200), ENSURE_REQUIREMENTS, [id=#165565]
                        :     :     :     :     :     :     :           +- *(1) Filter (((((isnotnull(ws_item_sk#387) AND isnotnull(ws_order_number#401L)) AND isnotnull(ws_web_page_sk#396)) AND isnotnull(ws_sold_date_sk#384)) AND ((((ws_sales_price#405 >= 100.00) AND (ws_sales_price#405 <= 150.00)) OR ((ws_sales_price#405 >= 50.00) AND (ws_sales_price#405 <= 100.00))) OR ((ws_sales_price#405 >= 150.00) AND (ws_sales_price#405 <= 200.00)))) AND ((((ws_net_profit#417 >= 100.00) AND (ws_net_profit#417 <= 200.00)) OR ((ws_net_profit#417 >= 150.00) AND (ws_net_profit#417 <= 300.00))) OR ((ws_net_profit#417 >= 50.00) AND (ws_net_profit#417 <= 250.00))))
                        :     :     :     :     :     :     :              +- *(1) ColumnarToRow
                        :     :     :     :     :     :     :                 +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387,ws_web_page_sk#396,ws_order_number#401L,ws_quantity#402,ws_sales_price#405,ws_net_profit#417] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_order_number#401L), isnotnull(ws_web_page_sk#396), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_order_number), IsNotNull(ws_web_page_sk), IsNotNull(ws_sold_..., ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_web_page_sk:int,ws_order_number:bigint,ws_quantity:i...
                        :     :     :     :     :     :     +- *(10) Sort [wr_item_sk#454 ASC NULLS FIRST, wr_order_number#465L ASC NULLS FIRST], false, 0
                        :     :     :     :     :     :        +- AQEShuffleRead coalesced
                        :     :     :     :     :     :           +- ShuffleQueryStage 1
                        :     :     :     :     :     :              +- Exchange hashpartitioning(wr_item_sk#454, wr_order_number#465L, 200), ENSURE_REQUIREMENTS, [id=#165582]
                        :     :     :     :     :     :                 +- *(2) Filter (((((isnotnull(wr_item_sk#454) AND isnotnull(wr_order_number#465L)) AND isnotnull(wr_refunded_cdemo_sk#456)) AND isnotnull(wr_returning_cdemo_sk#460)) AND isnotnull(wr_refunded_addr_sk#458)) AND isnotnull(wr_reason_sk#464))
                        :     :     :     :     :     :                    +- *(2) ColumnarToRow
                        :     :     :     :     :     :                       +- FileScan parquet [wr_item_sk#454,wr_refunded_cdemo_sk#456,wr_refunded_addr_sk#458,wr_returning_cdemo_sk#460,wr_reason_sk#464,wr_order_number#465L,wr_fee#470,wr_refunded_cash#472] Batched: true, DataFilters: [isnotnull(wr_item_sk#454), isnotnull(wr_order_number#465L), isnotnull(wr_refunded_cdemo_sk#456),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_order_number), IsNotNull(wr_refunded_cdemo_sk), IsNotNull(wr..., ReadSchema: struct<wr_item_sk:int,wr_refunded_cdemo_sk:int,wr_refunded_addr_sk:int,wr_returning_cdemo_sk:int,...
                        :     :     :     :     :     +- BroadcastQueryStage 2
                        :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#165601]
                        :     :     :     :     :           +- *(3) Filter isnotnull(wp_web_page_sk#0)
                        :     :     :     :     :              +- *(3) ColumnarToRow
                        :     :     :     :     :                 +- FileScan parquet [wp_web_page_sk#0] Batched: true, DataFilters: [isnotnull(wp_web_page_sk#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_page.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wp_web_page_sk)], ReadSchema: struct<wp_web_page_sk:int>
                        :     :     :     :     +- BroadcastQueryStage 3
                        :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#165618]
                        :     :     :     :           +- *(4) Filter (((isnotnull(cd_demo_sk#48) AND isnotnull(cd_marital_status#50)) AND isnotnull(cd_education_status#51)) AND ((((cd_marital_status#50 = D) AND (cd_education_status#51 = Secondary)) OR ((cd_marital_status#50 = S) AND (cd_education_status#51 = College))) OR ((cd_marital_status#50 = W) AND (cd_education_status#51 = Primary))))
                        :     :     :     :              +- *(4) ColumnarToRow
                        :     :     :     :                 +- FileScan parquet [cd_demo_sk#48,cd_marital_status#50,cd_education_status#51] Batched: true, DataFilters: [isnotnull(cd_demo_sk#48), isnotnull(cd_marital_status#50), isnotnull(cd_education_status#51), ((..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status), IsNotNull(cd_education_status), Or(Or(And(E..., ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
                        :     :     :     +- BroadcastQueryStage 4
                        :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, false], input[1, string, false], input[2, string, false]),false), [id=#165635]
                        :     :     :           +- *(5) Filter ((isnotnull(cd_demo_sk#19752) AND isnotnull(cd_marital_status#19754)) AND isnotnull(cd_education_status#19755))
                        :     :     :              +- *(5) ColumnarToRow
                        :     :     :                 +- FileScan parquet [cd_demo_sk#19752,cd_marital_status#19754,cd_education_status#19755] Batched: true, DataFilters: [isnotnull(cd_demo_sk#19752), isnotnull(cd_marital_status#19754), isnotnull(cd_education_status#1..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status), IsNotNull(cd_education_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
                        :     :     +- BroadcastQueryStage 5
                        :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#165654]
                        :     :           +- *(6) Project [ca_address_sk#214, ca_state#222]
                        :     :              +- *(6) Filter (((isnotnull(ca_country#224) AND (ca_country#224 = United States)) AND isnotnull(ca_address_sk#214)) AND ((ca_state#222 IN (SD,CO,OK) OR ca_state#222 IN (MA,GA,MI)) OR ca_state#222 IN (CA,IA,IL)))
                        :     :                 +- *(6) ColumnarToRow
                        :     :                    +- FileScan parquet [ca_address_sk#214,ca_state#222,ca_country#224] Batched: true, DataFilters: [isnotnull(ca_country#224), (ca_country#224 = United States), isnotnull(ca_address_sk#214), ((ca_..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_country), EqualTo(ca_country,United States), IsNotNull(ca_address_sk), Or(Or(In(ca_..., ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
                        :     +- BroadcastQueryStage 6
                        :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#165675]
                        :           +- *(7) Project [d_date_sk#598]
                        :              +- *(7) Filter ((isnotnull(d_year#604) AND (d_year#604 = 1998)) AND isnotnull(d_date_sk#598))
                        :                 +- *(7) ColumnarToRow
                        :                    +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 1998), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1998), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                        +- BroadcastQueryStage 7
                           +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#165694]
                              +- *(8) Filter isnotnull(r_reason_sk#544)
                                 +- *(8) ColumnarToRow
                                    +- FileScan parquet [r_reason_sk#544,r_reason_desc#546] Batched: true, DataFilters: [isnotnull(r_reason_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/reason.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_reason_sk)], ReadSchema: struct<r_reason_sk:int,r_reason_desc:string>
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[substr(r_reason_desc, 1, 20)#19764 ASC NULLS FIRST,avg(ws_quantity)#19765 ASC NULLS FIRST,avg(wr_refunded_cash)#19766 ASC NULLS FIRST,avg(wr_fee)#19767 ASC NULLS FIRST], output=[substr(r_reason_desc, 1, 20)#19764,avg(ws_quantity)#19765,avg(wr_refunded_cash)#19766,avg(wr_fee)#19767])
   +- HashAggregate(keys=[r_reason_desc#546], functions=[avg(ws_quantity#402), avg(UnscaledValue(wr_refunded_cash#472)), avg(UnscaledValue(wr_fee#470))], output=[substr(r_reason_desc, 1, 20)#19764, avg(ws_quantity)#19765, avg(wr_refunded_cash)#19766, avg(wr_fee)#19767])
      +- Exchange hashpartitioning(r_reason_desc#546, 200), ENSURE_REQUIREMENTS, [id=#165481]
         +- HashAggregate(keys=[r_reason_desc#546], functions=[partial_avg(ws_quantity#402), partial_avg(UnscaledValue(wr_refunded_cash#472)), partial_avg(UnscaledValue(wr_fee#470))], output=[r_reason_desc#546, sum#19781, count#19782L, sum#19783, count#19784L, sum#19785, count#19786L])
            +- Project [ws_quantity#402, wr_fee#470, wr_refunded_cash#472, r_reason_desc#546]
               +- BroadcastHashJoin [wr_reason_sk#464], [r_reason_sk#544], Inner, BuildRight, false
                  :- Project [ws_quantity#402, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                  :  +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#598], Inner, BuildRight, false
                  :     :- Project [ws_sold_date_sk#384, ws_quantity#402, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                  :     :  +- BroadcastHashJoin [wr_refunded_addr_sk#458], [ca_address_sk#214], Inner, BuildRight, ((((ca_state#222 IN (SD,CO,OK) AND (ws_net_profit#417 >= 100.00)) AND (ws_net_profit#417 <= 200.00)) OR ((ca_state#222 IN (MA,GA,MI) AND (ws_net_profit#417 >= 150.00)) AND (ws_net_profit#417 <= 300.00))) OR ((ca_state#222 IN (CA,IA,IL) AND (ws_net_profit#417 >= 50.00)) AND (ws_net_profit#417 <= 250.00))), false
                  :     :     :- Project [ws_sold_date_sk#384, ws_quantity#402, ws_net_profit#417, wr_refunded_addr_sk#458, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                  :     :     :  +- BroadcastHashJoin [wr_returning_cdemo_sk#460, cd_marital_status#50, cd_education_status#51], [cd_demo_sk#19752, cd_marital_status#19754, cd_education_status#19755], Inner, BuildRight, false
                  :     :     :     :- Project [ws_sold_date_sk#384, ws_quantity#402, ws_net_profit#417, wr_refunded_addr_sk#458, wr_returning_cdemo_sk#460, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472, cd_marital_status#50, cd_education_status#51]
                  :     :     :     :  +- BroadcastHashJoin [wr_refunded_cdemo_sk#456], [cd_demo_sk#48], Inner, BuildRight, ((((((cd_marital_status#50 = D) AND (cd_education_status#51 = Secondary)) AND (ws_sales_price#405 >= 100.00)) AND (ws_sales_price#405 <= 150.00)) OR ((((cd_marital_status#50 = S) AND (cd_education_status#51 = College)) AND (ws_sales_price#405 >= 50.00)) AND (ws_sales_price#405 <= 100.00))) OR ((((cd_marital_status#50 = W) AND (cd_education_status#51 = Primary)) AND (ws_sales_price#405 >= 150.00)) AND (ws_sales_price#405 <= 200.00))), false
                  :     :     :     :     :- Project [ws_sold_date_sk#384, ws_quantity#402, ws_sales_price#405, ws_net_profit#417, wr_refunded_cdemo_sk#456, wr_refunded_addr_sk#458, wr_returning_cdemo_sk#460, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                  :     :     :     :     :  +- BroadcastHashJoin [ws_web_page_sk#396], [wp_web_page_sk#0], Inner, BuildRight, false
                  :     :     :     :     :     :- Project [ws_sold_date_sk#384, ws_web_page_sk#396, ws_quantity#402, ws_sales_price#405, ws_net_profit#417, wr_refunded_cdemo_sk#456, wr_refunded_addr_sk#458, wr_returning_cdemo_sk#460, wr_reason_sk#464, wr_fee#470, wr_refunded_cash#472]
                  :     :     :     :     :     :  +- SortMergeJoin [ws_item_sk#387, ws_order_number#401L], [wr_item_sk#454, wr_order_number#465L], Inner
                  :     :     :     :     :     :     :- Sort [ws_item_sk#387 ASC NULLS FIRST, ws_order_number#401L ASC NULLS FIRST], false, 0
                  :     :     :     :     :     :     :  +- Exchange hashpartitioning(ws_item_sk#387, ws_order_number#401L, 200), ENSURE_REQUIREMENTS, [id=#165449]
                  :     :     :     :     :     :     :     +- Filter (((((isnotnull(ws_item_sk#387) AND isnotnull(ws_order_number#401L)) AND isnotnull(ws_web_page_sk#396)) AND isnotnull(ws_sold_date_sk#384)) AND ((((ws_sales_price#405 >= 100.00) AND (ws_sales_price#405 <= 150.00)) OR ((ws_sales_price#405 >= 50.00) AND (ws_sales_price#405 <= 100.00))) OR ((ws_sales_price#405 >= 150.00) AND (ws_sales_price#405 <= 200.00)))) AND ((((ws_net_profit#417 >= 100.00) AND (ws_net_profit#417 <= 200.00)) OR ((ws_net_profit#417 >= 150.00) AND (ws_net_profit#417 <= 300.00))) OR ((ws_net_profit#417 >= 50.00) AND (ws_net_profit#417 <= 250.00))))
                  :     :     :     :     :     :     :        +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387,ws_web_page_sk#396,ws_order_number#401L,ws_quantity#402,ws_sales_price#405,ws_net_profit#417] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_order_number#401L), isnotnull(ws_web_page_sk#396), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_order_number), IsNotNull(ws_web_page_sk), IsNotNull(ws_sold_..., ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_web_page_sk:int,ws_order_number:bigint,ws_quantity:i...
                  :     :     :     :     :     :     +- Sort [wr_item_sk#454 ASC NULLS FIRST, wr_order_number#465L ASC NULLS FIRST], false, 0
                  :     :     :     :     :     :        +- Exchange hashpartitioning(wr_item_sk#454, wr_order_number#465L, 200), ENSURE_REQUIREMENTS, [id=#165450]
                  :     :     :     :     :     :           +- Filter (((((isnotnull(wr_item_sk#454) AND isnotnull(wr_order_number#465L)) AND isnotnull(wr_refunded_cdemo_sk#456)) AND isnotnull(wr_returning_cdemo_sk#460)) AND isnotnull(wr_refunded_addr_sk#458)) AND isnotnull(wr_reason_sk#464))
                  :     :     :     :     :     :              +- FileScan parquet [wr_item_sk#454,wr_refunded_cdemo_sk#456,wr_refunded_addr_sk#458,wr_returning_cdemo_sk#460,wr_reason_sk#464,wr_order_number#465L,wr_fee#470,wr_refunded_cash#472] Batched: true, DataFilters: [isnotnull(wr_item_sk#454), isnotnull(wr_order_number#465L), isnotnull(wr_refunded_cdemo_sk#456),..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_order_number), IsNotNull(wr_refunded_cdemo_sk), IsNotNull(wr..., ReadSchema: struct<wr_item_sk:int,wr_refunded_cdemo_sk:int,wr_refunded_addr_sk:int,wr_returning_cdemo_sk:int,...
                  :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#165456]
                  :     :     :     :     :        +- Filter isnotnull(wp_web_page_sk#0)
                  :     :     :     :     :           +- FileScan parquet [wp_web_page_sk#0] Batched: true, DataFilters: [isnotnull(wp_web_page_sk#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_page.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wp_web_page_sk)], ReadSchema: struct<wp_web_page_sk:int>
                  :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#165460]
                  :     :     :     :        +- Filter (((isnotnull(cd_demo_sk#48) AND isnotnull(cd_marital_status#50)) AND isnotnull(cd_education_status#51)) AND ((((cd_marital_status#50 = D) AND (cd_education_status#51 = Secondary)) OR ((cd_marital_status#50 = S) AND (cd_education_status#51 = College))) OR ((cd_marital_status#50 = W) AND (cd_education_status#51 = Primary))))
                  :     :     :     :           +- FileScan parquet [cd_demo_sk#48,cd_marital_status#50,cd_education_status#51] Batched: true, DataFilters: [isnotnull(cd_demo_sk#48), isnotnull(cd_marital_status#50), isnotnull(cd_education_status#51), ((..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status), IsNotNull(cd_education_status), Or(Or(And(E..., ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
                  :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, int, false], input[1, string, false], input[2, string, false]),false), [id=#165464]
                  :     :     :        +- Filter ((isnotnull(cd_demo_sk#19752) AND isnotnull(cd_marital_status#19754)) AND isnotnull(cd_education_status#19755))
                  :     :     :           +- FileScan parquet [cd_demo_sk#19752,cd_marital_status#19754,cd_education_status#19755] Batched: true, DataFilters: [isnotnull(cd_demo_sk#19752), isnotnull(cd_marital_status#19754), isnotnull(cd_education_status#1..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status), IsNotNull(cd_education_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string,cd_education_status:string>
                  :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#165468]
                  :     :        +- Project [ca_address_sk#214, ca_state#222]
                  :     :           +- Filter (((isnotnull(ca_country#224) AND (ca_country#224 = United States)) AND isnotnull(ca_address_sk#214)) AND ((ca_state#222 IN (SD,CO,OK) OR ca_state#222 IN (MA,GA,MI)) OR ca_state#222 IN (CA,IA,IL)))
                  :     :              +- FileScan parquet [ca_address_sk#214,ca_state#222,ca_country#224] Batched: true, DataFilters: [isnotnull(ca_country#224), (ca_country#224 = United States), isnotnull(ca_address_sk#214), ((ca_..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_country), EqualTo(ca_country,United States), IsNotNull(ca_address_sk), Or(Or(In(ca_..., ReadSchema: struct<ca_address_sk:int,ca_state:string,ca_country:string>
                  :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#165472]
                  :        +- Project [d_date_sk#598]
                  :           +- Filter ((isnotnull(d_year#604) AND (d_year#604 = 1998)) AND isnotnull(d_date_sk#598))
                  :              +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 = 1998), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,1998), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                  +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#165476]
                     +- Filter isnotnull(r_reason_sk#544)
                        +- FileScan parquet [r_reason_sk#544,r_reason_desc#546] Batched: true, DataFilters: [isnotnull(r_reason_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/reason.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_reason_sk)], ReadSchema: struct<r_reason_sk:int,r_reason_desc:string>
