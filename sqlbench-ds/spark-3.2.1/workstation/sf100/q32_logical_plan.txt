Aggregate [MakeDecimal(sum(UnscaledValue(cs_ext_discount_amt#566)),17,2) AS excess discount amount#13209]
+- Project [cs_ext_discount_amt#566]
   +- Join Inner, (d_date_sk#612 = cs_sold_date_sk#544)
      :- Project [cs_sold_date_sk#544, cs_ext_discount_amt#566]
      :  +- Join Inner, ((cast(cs_ext_discount_amt#566 as decimal(14,7)) > (1.3 * avg(cs_ext_discount_amt))#13212) AND (cs_item_sk#13228 = i_item_sk#668))
      :     :- Project [cs_sold_date_sk#544, cs_ext_discount_amt#566, i_item_sk#668]
      :     :  +- Join Inner, (i_item_sk#668 = cs_item_sk#559)
      :     :     :- Project [cs_sold_date_sk#544, cs_item_sk#559, cs_ext_discount_amt#566]
      :     :     :  +- Filter (isnotnull(cs_item_sk#559) AND (isnotnull(cs_ext_discount_amt#566) AND isnotnull(cs_sold_date_sk#544)))
      :     :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
      :     :     +- Project [i_item_sk#668]
      :     :        +- Filter ((isnotnull(i_manufact_id#681) AND (i_manufact_id#681 = 283)) AND isnotnull(i_item_sk#668))
      :     :           +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
      :     +- Filter isnotnull((1.3 * avg(cs_ext_discount_amt))#13212)
      :        +- Aggregate [cs_item_sk#13228], [CheckOverflow((1.300000 * promote_precision(cast((avg(UnscaledValue(cs_ext_discount_amt#13235)) / 100.0) as decimal(11,6)))), DecimalType(14,7), true) AS (1.3 * avg(cs_ext_discount_amt))#13212, cs_item_sk#13228]
      :           +- Project [cs_item_sk#13228, cs_ext_discount_amt#13235]
      :              +- Join Inner, (d_date_sk#13247 = cs_sold_date_sk#13213)
      :                 :- Project [cs_sold_date_sk#13213, cs_item_sk#13228, cs_ext_discount_amt#13235]
      :                 :  +- Filter (isnotnull(cs_sold_date_sk#13213) AND isnotnull(cs_item_sk#13228))
      :                 :     +- Relation [cs_sold_date_sk#13213,cs_sold_time_sk#13214,cs_ship_date_sk#13215,cs_bill_customer_sk#13216,cs_bill_cdemo_sk#13217,cs_bill_hdemo_sk#13218,cs_bill_addr_sk#13219,cs_ship_customer_sk#13220,cs_ship_cdemo_sk#13221,cs_ship_hdemo_sk#13222,cs_ship_addr_sk#13223,cs_call_center_sk#13224,cs_catalog_page_sk#13225,cs_ship_mode_sk#13226,cs_warehouse_sk#13227,cs_item_sk#13228,cs_promo_sk#13229,cs_order_number#13230L,cs_quantity#13231,cs_wholesale_cost#13232,cs_list_price#13233,cs_sales_price#13234,cs_ext_discount_amt#13235,cs_ext_sales_price#13236,... 10 more fields] parquet
      :                 +- Project [d_date_sk#13247]
      :                    +- Filter ((isnotnull(d_date#13249) AND ((d_date#13249 >= 1999-02-22) AND (d_date#13249 <= 1999-05-23))) AND isnotnull(d_date_sk#13247))
      :                       +- Relation [d_date_sk#13247,d_date_id#13248,d_date#13249,d_month_seq#13250,d_week_seq#13251,d_quarter_seq#13252,d_year#13253,d_dow#13254,d_moy#13255,d_dom#13256,d_qoy#13257,d_fy_year#13258,d_fy_quarter_seq#13259,d_fy_week_seq#13260,d_day_name#13261,d_quarter_name#13262,d_holiday#13263,d_weekend#13264,d_following_holiday#13265,d_first_dom#13266,d_last_dom#13267,d_same_day_ly#13268,d_same_day_lq#13269,d_current_day#13270,... 4 more fields] parquet
      +- Project [d_date_sk#612]
         +- Filter ((isnotnull(d_date#614) AND ((d_date#614 >= 1999-02-22) AND (d_date#614 <= 1999-05-23))) AND isnotnull(d_date_sk#612))
            +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
