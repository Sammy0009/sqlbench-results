AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#11625 ASC NULLS FIRST,ss_item_rev#11626 ASC NULLS FIRST], output=[item_id#11625,ss_item_rev#11626,ss_dev#11621,cs_item_rev#11630,cs_dev#11622,ws_item_rev#11634,ws_dev#11623,average#11624])
   +- *(16) Project [item_id#11625, ss_item_rev#11626, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS ss_dev#11621, cs_item_rev#11630, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(cs_item_rev#11630 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS cs_dev#11622, ws_item_rev#11634, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ws_item_rev#11634 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS ws_dev#11623, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true) AS average#11624]
      +- *(16) BroadcastHashJoin [item_id#11625], [item_id#11633], Inner, BuildRight, ((((((((cast(ss_item_rev#11626 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#11634)), DecimalType(19,3), true)) AND (cast(ss_item_rev#11626 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#11634)), DecimalType(20,3), true))) AND (cast(cs_item_rev#11630 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#11634)), DecimalType(19,3), true))) AND (cast(cs_item_rev#11630 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#11634)), DecimalType(20,3), true))) AND (cast(ws_item_rev#11634 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#11626)), DecimalType(19,3), true))) AND (cast(ws_item_rev#11634 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#11626)), DecimalType(20,3), true))) AND (cast(ws_item_rev#11634 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#11630)), DecimalType(19,3), true))) AND (cast(ws_item_rev#11634 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#11630)), DecimalType(20,3), true))), false
         :- *(16) Project [item_id#11625, ss_item_rev#11626, cs_item_rev#11630]
         :  +- *(16) SortMergeJoin [item_id#11625], [item_id#11629], Inner, ((((cast(ss_item_rev#11626 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#11630)), DecimalType(19,3), true)) AND (cast(ss_item_rev#11626 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#11630)), DecimalType(20,3), true))) AND (cast(cs_item_rev#11630 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#11626)), DecimalType(19,3), true))) AND (cast(cs_item_rev#11630 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#11626)), DecimalType(20,3), true)))
         :     :- *(14) Sort [item_id#11625 ASC NULLS FIRST], false, 0
         :     :  +- *(14) Filter isnotnull(ss_item_rev#11626)
         :     :     +- *(14) HashAggregate(keys=[i_item_id#501], functions=[sum(UnscaledValue(ss_ext_sales_price#679))], output=[item_id#11625, ss_item_rev#11626])
         :     :        +- AQEShuffleRead coalesced
         :     :           +- ShuffleQueryStage 15
         :     :              +- Exchange hashpartitioning(i_item_id#501, 200), ENSURE_REQUIREMENTS, [id=#93382]
         :     :                 +- *(10) HashAggregate(keys=[i_item_id#501], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#679))], output=[i_item_id#501, sum#11917L])
         :     :                    +- *(10) Project [ss_ext_sales_price#679, i_item_id#501]
         :     :                       +- *(10) BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
         :     :                          :- *(10) Project [ss_sold_date_sk#664, ss_ext_sales_price#679, i_item_id#501]
         :     :                          :  +- *(10) BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
         :     :                          :     :- *(10) Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
         :     :                          :     :  +- *(10) ColumnarToRow
         :     :                          :     :     +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666,ss_ext_sales_price#679] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ext_sales_price:decimal(7,2)>
         :     :                          :     +- BroadcastQueryStage 0
         :     :                          :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#92450]
         :     :                          :           +- *(1) Filter (isnotnull(i_item_sk#500) AND isnotnull(i_item_id#501))
         :     :                          :              +- *(1) ColumnarToRow
         :     :                          :                 +- FileScan parquet [i_item_sk#500,i_item_id#501] Batched: true, DataFilters: [isnotnull(i_item_sk#500), isnotnull(i_item_id#501)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :     :                          +- BroadcastQueryStage 10
         :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#92918]
         :     :                                +- *(7) Project [d_date_sk#598]
         :     :                                   +- *(7) BroadcastHashJoin [d_date#600], [d_date#11823], LeftSemi, BuildRight, false
         :     :                                      :- *(7) Filter isnotnull(d_date_sk#598)
         :     :                                      :  +- *(7) ColumnarToRow
         :     :                                      :     +- FileScan parquet [d_date_sk#598,d_date#600] Batched: true, DataFilters: [isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :     :                                      +- BroadcastQueryStage 1
         :     :                                         +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, date, true]),false), [id=#92469]
         :     :                                            +- *(2) Project [d_date#11823]
         :     :                                               +- *(2) Filter (isnotnull(d_week_seq#11825) AND (d_week_seq#11825 = Subquery subquery#11627, [id=#92269]))
         :     :                                                  :  +- Subquery subquery#11627, [id=#92269]
         :     :                                                  :     +- AdaptiveSparkPlan isFinalPlan=true
                                                                        +- == Final Plan ==
                                                                           *(1) Project [d_week_seq#11741]
                                                                           +- *(1) Filter (isnotnull(d_date#11739) AND (d_date#11739 = 2000-07-21))
                                                                              +- *(1) ColumnarToRow
                                                                                 +- FileScan parquet [d_date#11739,d_week_seq#11741] Batched: true, DataFilters: [isnotnull(d_date#11739), (d_date#11739 = 2000-07-21)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-07-21)], ReadSchema: struct<d_date:date,d_week_seq:int>
                                                                        +- == Initial Plan ==
                                                                           Project [d_week_seq#11741]
                                                                           +- Filter (isnotnull(d_date#11739) AND (d_date#11739 = 2000-07-21))
                                                                              +- FileScan parquet [d_date#11739,d_week_seq#11741] Batched: true, DataFilters: [isnotnull(d_date#11739), (d_date#11739 = 2000-07-21)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-07-21)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                                  +- *(2) ColumnarToRow
         :     :                                                     +- FileScan parquet [d_date#11823,d_week_seq#11825] Batched: true, DataFilters: [isnotnull(d_week_seq#11825)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     +- *(15) Sort [item_id#11629 ASC NULLS FIRST], false, 0
         :        +- *(15) Filter isnotnull(cs_item_rev#11630)
         :           +- *(15) HashAggregate(keys=[i_item_id#11638], functions=[sum(UnscaledValue(cs_ext_sales_price#141))], output=[item_id#11629, cs_item_rev#11630])
         :              +- AQEShuffleRead coalesced
         :                 +- ShuffleQueryStage 16
         :                    +- Exchange hashpartitioning(i_item_id#11638, 200), ENSURE_REQUIREMENTS, [id=#93425]
         :                       +- *(11) HashAggregate(keys=[i_item_id#11638], functions=[partial_sum(UnscaledValue(cs_ext_sales_price#141))], output=[i_item_id#11638, sum#11919L])
         :                          +- *(11) Project [cs_ext_sales_price#141, i_item_id#11638]
         :                             +- *(11) BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#11659], Inner, BuildRight, false
         :                                :- *(11) Project [cs_sold_date_sk#118, cs_ext_sales_price#141, i_item_id#11638]
         :                                :  +- *(11) BroadcastHashJoin [cs_item_sk#133], [i_item_sk#11637], Inner, BuildRight, false
         :                                :     :- *(11) Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
         :                                :     :  +- *(11) ColumnarToRow
         :                                :     :     +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133,cs_ext_sales_price#141] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_ext_sales_price:decimal(7,2)>
         :                                :     +- BroadcastQueryStage 3
         :                                :        +- ReusedExchange [i_item_sk#11637, i_item_id#11638], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#92450]
         :                                +- BroadcastQueryStage 12
         :                                   +- ReusedExchange [d_date_sk#11659], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#92918]
         +- BroadcastQueryStage 18
            +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true]),false), [id=#93626]
               +- *(13) Filter isnotnull(ws_item_rev#11634)
                  +- *(13) HashAggregate(keys=[i_item_id#11688], functions=[sum(UnscaledValue(ws_ext_sales_price#407))], output=[item_id#11633, ws_item_rev#11634])
                     +- AQEShuffleRead coalesced
                        +- ShuffleQueryStage 17
                           +- Exchange hashpartitioning(i_item_id#11688, 200), ENSURE_REQUIREMENTS, [id=#93470]
                              +- *(12) HashAggregate(keys=[i_item_id#11688], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#407))], output=[i_item_id#11688, sum#11921L])
                                 +- *(12) Project [ws_ext_sales_price#407, i_item_id#11688]
                                    +- *(12) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#11709], Inner, BuildRight, false
                                       :- *(12) Project [ws_sold_date_sk#384, ws_ext_sales_price#407, i_item_id#11688]
                                       :  +- *(12) BroadcastHashJoin [ws_item_sk#387], [i_item_sk#11687], Inner, BuildRight, false
                                       :     :- *(12) Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                                       :     :  +- *(12) ColumnarToRow
                                       :     :     +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387,ws_ext_sales_price#407] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_ext_sales_price:decimal(7,2)>
                                       :     +- BroadcastQueryStage 7
                                       :        +- ReusedExchange [i_item_sk#11687, i_item_id#11688], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#92450]
                                       +- BroadcastQueryStage 14
                                          +- ReusedExchange [d_date_sk#11709], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#92918]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#11625 ASC NULLS FIRST,ss_item_rev#11626 ASC NULLS FIRST], output=[item_id#11625,ss_item_rev#11626,ss_dev#11621,cs_item_rev#11630,cs_dev#11622,ws_item_rev#11634,ws_dev#11623,average#11624])
   +- Project [item_id#11625, ss_item_rev#11626, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS ss_dev#11621, cs_item_rev#11630, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(cs_item_rev#11630 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS cs_dev#11622, ws_item_rev#11634, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(ws_item_rev#11634 as decimal(23,6))) / promote_precision(CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true))), DecimalType(38,17), true)) * 100.00000000000000000), DecimalType(38,13), true) AS ws_dev#11623, CheckOverflow((promote_precision(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#11626 as decimal(18,2))) + promote_precision(cast(cs_item_rev#11630 as decimal(18,2)))), DecimalType(18,2), true) as decimal(19,2))) + promote_precision(cast(ws_item_rev#11634 as decimal(19,2)))), DecimalType(19,2), true)) / 3.00), DecimalType(23,6), true) AS average#11624]
      +- SortMergeJoin [item_id#11625], [item_id#11633], Inner, ((((((((cast(ss_item_rev#11626 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#11634)), DecimalType(19,3), true)) AND (cast(ss_item_rev#11626 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#11634)), DecimalType(20,3), true))) AND (cast(cs_item_rev#11630 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ws_item_rev#11634)), DecimalType(19,3), true))) AND (cast(cs_item_rev#11630 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ws_item_rev#11634)), DecimalType(20,3), true))) AND (cast(ws_item_rev#11634 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#11626)), DecimalType(19,3), true))) AND (cast(ws_item_rev#11634 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#11626)), DecimalType(20,3), true))) AND (cast(ws_item_rev#11634 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#11630)), DecimalType(19,3), true))) AND (cast(ws_item_rev#11634 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#11630)), DecimalType(20,3), true)))
         :- Project [item_id#11625, ss_item_rev#11626, cs_item_rev#11630]
         :  +- SortMergeJoin [item_id#11625], [item_id#11629], Inner, ((((cast(ss_item_rev#11626 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(cs_item_rev#11630)), DecimalType(19,3), true)) AND (cast(ss_item_rev#11626 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(cs_item_rev#11630)), DecimalType(20,3), true))) AND (cast(cs_item_rev#11630 as decimal(19,3)) >= CheckOverflow((0.90 * promote_precision(ss_item_rev#11626)), DecimalType(19,3), true))) AND (cast(cs_item_rev#11630 as decimal(20,3)) <= CheckOverflow((1.10 * promote_precision(ss_item_rev#11626)), DecimalType(20,3), true)))
         :     :- Sort [item_id#11625 ASC NULLS FIRST], false, 0
         :     :  +- Filter isnotnull(ss_item_rev#11626)
         :     :     +- HashAggregate(keys=[i_item_id#501], functions=[sum(UnscaledValue(ss_ext_sales_price#679))], output=[item_id#11625, ss_item_rev#11626])
         :     :        +- Exchange hashpartitioning(i_item_id#501, 200), ENSURE_REQUIREMENTS, [id=#92359]
         :     :           +- HashAggregate(keys=[i_item_id#501], functions=[partial_sum(UnscaledValue(ss_ext_sales_price#679))], output=[i_item_id#501, sum#11917L])
         :     :              +- Project [ss_ext_sales_price#679, i_item_id#501]
         :     :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
         :     :                    :- Project [ss_sold_date_sk#664, ss_ext_sales_price#679, i_item_id#501]
         :     :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#500], Inner, BuildRight, false
         :     :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
         :     :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666,ss_ext_sales_price#679] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_ext_sales_price:decimal(7,2)>
         :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#92347]
         :     :                    :        +- Filter (isnotnull(i_item_sk#500) AND isnotnull(i_item_id#501))
         :     :                    :           +- FileScan parquet [i_item_sk#500,i_item_id#501] Batched: true, DataFilters: [isnotnull(i_item_sk#500), isnotnull(i_item_id#501)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :     :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#92354]
         :     :                       +- Project [d_date_sk#598]
         :     :                          +- BroadcastHashJoin [d_date#600], [d_date#11823], LeftSemi, BuildRight, false
         :     :                             :- Filter isnotnull(d_date_sk#598)
         :     :                             :  +- FileScan parquet [d_date_sk#598,d_date#600] Batched: true, DataFilters: [isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :     :                             +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, date, true]),false), [id=#92350]
         :     :                                +- Project [d_date#11823]
         :     :                                   +- Filter (isnotnull(d_week_seq#11825) AND (d_week_seq#11825 = Subquery subquery#11627, [id=#92269]))
         :     :                                      :  +- Subquery subquery#11627, [id=#92269]
         :     :                                      :     +- AdaptiveSparkPlan isFinalPlan=true
                                                            +- == Final Plan ==
                                                               *(1) Project [d_week_seq#11741]
                                                               +- *(1) Filter (isnotnull(d_date#11739) AND (d_date#11739 = 2000-07-21))
                                                                  +- *(1) ColumnarToRow
                                                                     +- FileScan parquet [d_date#11739,d_week_seq#11741] Batched: true, DataFilters: [isnotnull(d_date#11739), (d_date#11739 = 2000-07-21)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-07-21)], ReadSchema: struct<d_date:date,d_week_seq:int>
                                                            +- == Initial Plan ==
                                                               Project [d_week_seq#11741]
                                                               +- Filter (isnotnull(d_date#11739) AND (d_date#11739 = 2000-07-21))
                                                                  +- FileScan parquet [d_date#11739,d_week_seq#11741] Batched: true, DataFilters: [isnotnull(d_date#11739), (d_date#11739 = 2000-07-21)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-07-21)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                      +- FileScan parquet [d_date#11823,d_week_seq#11825] Batched: true, DataFilters: [isnotnull(d_week_seq#11825)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     +- Sort [item_id#11629 ASC NULLS FIRST], false, 0
         :        +- Filter isnotnull(cs_item_rev#11630)
         :           +- HashAggregate(keys=[i_item_id#11638], functions=[sum(UnscaledValue(cs_ext_sales_price#141))], output=[item_id#11629, cs_item_rev#11630])
         :              +- Exchange hashpartitioning(i_item_id#11638, 200), ENSURE_REQUIREMENTS, [id=#92374]
         :                 +- HashAggregate(keys=[i_item_id#11638], functions=[partial_sum(UnscaledValue(cs_ext_sales_price#141))], output=[i_item_id#11638, sum#11919L])
         :                    +- Project [cs_ext_sales_price#141, i_item_id#11638]
         :                       +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#11659], Inner, BuildRight, false
         :                          :- Project [cs_sold_date_sk#118, cs_ext_sales_price#141, i_item_id#11638]
         :                          :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#11637], Inner, BuildRight, false
         :                          :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
         :                          :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133,cs_ext_sales_price#141] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_ext_sales_price:decimal(7,2)>
         :                          :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#92362]
         :                          :        +- Filter (isnotnull(i_item_sk#11637) AND isnotnull(i_item_id#11638))
         :                          :           +- FileScan parquet [i_item_sk#11637,i_item_id#11638] Batched: true, DataFilters: [isnotnull(i_item_sk#11637), isnotnull(i_item_id#11638)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#92369]
         :                             +- Project [d_date_sk#11659]
         :                                +- BroadcastHashJoin [d_date#11661], [d_date#11851], LeftSemi, BuildRight, false
         :                                   :- Filter isnotnull(d_date_sk#11659)
         :                                   :  +- FileScan parquet [d_date_sk#11659,d_date#11661] Batched: true, DataFilters: [isnotnull(d_date_sk#11659)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :                                   +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, date, true]),false), [id=#92365]
         :                                      +- Project [d_date#11851]
         :                                         +- Filter (isnotnull(d_week_seq#11853) AND (d_week_seq#11853 = Subquery subquery#11631, [id=#92275]))
         :                                            :  +- Subquery subquery#11631, [id=#92275]
         :                                            :     +- AdaptiveSparkPlan isFinalPlan=false
         :                                            :        +- Project [d_week_seq#11769]
         :                                            :           +- Filter (isnotnull(d_date#11767) AND (d_date#11767 = 2000-07-21))
         :                                            :              +- FileScan parquet [d_date#11767,d_week_seq#11769] Batched: true, DataFilters: [isnotnull(d_date#11767), (d_date#11767 = 2000-07-21)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-07-21)], ReadSchema: struct<d_date:date,d_week_seq:int>
         :                                            +- FileScan parquet [d_date#11851,d_week_seq#11853] Batched: true, DataFilters: [isnotnull(d_week_seq#11853)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
         +- Sort [item_id#11633 ASC NULLS FIRST], false, 0
            +- Filter isnotnull(ws_item_rev#11634)
               +- HashAggregate(keys=[i_item_id#11688], functions=[sum(UnscaledValue(ws_ext_sales_price#407))], output=[item_id#11633, ws_item_rev#11634])
                  +- Exchange hashpartitioning(i_item_id#11688, 200), ENSURE_REQUIREMENTS, [id=#92395]
                     +- HashAggregate(keys=[i_item_id#11688], functions=[partial_sum(UnscaledValue(ws_ext_sales_price#407))], output=[i_item_id#11688, sum#11921L])
                        +- Project [ws_ext_sales_price#407, i_item_id#11688]
                           +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#11709], Inner, BuildRight, false
                              :- Project [ws_sold_date_sk#384, ws_ext_sales_price#407, i_item_id#11688]
                              :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#11687], Inner, BuildRight, false
                              :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                              :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387,ws_ext_sales_price#407] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_ext_sales_price:decimal(7,2)>
                              :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#92383]
                              :        +- Filter (isnotnull(i_item_sk#11687) AND isnotnull(i_item_id#11688))
                              :           +- FileScan parquet [i_item_sk#11687,i_item_id#11688] Batched: true, DataFilters: [isnotnull(i_item_sk#11687), isnotnull(i_item_id#11688)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
                              +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#92390]
                                 +- Project [d_date_sk#11709]
                                    +- BroadcastHashJoin [d_date#11711], [d_date#11879], LeftSemi, BuildRight, false
                                       :- Filter isnotnull(d_date_sk#11709)
                                       :  +- FileScan parquet [d_date_sk#11709,d_date#11711] Batched: true, DataFilters: [isnotnull(d_date_sk#11709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
                                       +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, date, true]),false), [id=#92386]
                                          +- Project [d_date#11879]
                                             +- Filter (isnotnull(d_week_seq#11881) AND (d_week_seq#11881 = Subquery subquery#11635, [id=#92281]))
                                                :  +- Subquery subquery#11635, [id=#92281]
                                                :     +- AdaptiveSparkPlan isFinalPlan=false
                                                :        +- Project [d_week_seq#11797]
                                                :           +- Filter (isnotnull(d_date#11795) AND (d_date#11795 = 2000-07-21))
                                                :              +- FileScan parquet [d_date#11795,d_week_seq#11797] Batched: true, DataFilters: [isnotnull(d_date#11795), (d_date#11795 = 2000-07-21)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date), EqualTo(d_date,2000-07-21)], ReadSchema: struct<d_date:date,d_week_seq:int>
                                                +- FileScan parquet [d_date#11879,d_week_seq#11881] Batched: true, DataFilters: [isnotnull(d_week_seq#11881)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq)], ReadSchema: struct<d_date:date,d_week_seq:int>
