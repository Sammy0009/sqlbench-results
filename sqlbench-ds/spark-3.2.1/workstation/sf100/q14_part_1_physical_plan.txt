AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#5105 ASC NULLS FIRST,i_brand_id#5106 ASC NULLS FIRST,i_class_id#5107 ASC NULLS FIRST,i_category_id#5108 ASC NULLS FIRST], output=[channel#5105,i_brand_id#5106,i_class_id#5107,i_category_id#5108,sum(sales)#5095,sum(number_sales)#5096L])
   +- *(128) HashAggregate(keys=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L], functions=[sum(sales#4511), sum(number_sales#4512L)], output=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, sum(sales)#5095, sum(number_sales)#5096L])
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 189
            +- Exchange hashpartitioning(channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L, 200), ENSURE_REQUIREMENTS, [id=#40703]
               +- *(127) HashAggregate(keys=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L], functions=[partial_sum(sales#4511), partial_sum(number_sales#4512L)], output=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L, sum#5129, isEmpty#5130, sum#5131L])
                  +- *(127) Expand [[sales#4511, number_sales#4512L, channel#5100, i_brand_id#4863, i_class_id#4865, i_category_id#4867, 0], [sales#4511, number_sales#4512L, channel#5100, i_brand_id#4863, i_class_id#4865, null, 1], [sales#4511, number_sales#4512L, channel#5100, i_brand_id#4863, null, null, 3], [sales#4511, number_sales#4512L, channel#5100, null, null, null, 7], [sales#4511, number_sales#4512L, null, null, null, null, 15]], [sales#4511, number_sales#4512L, channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L]
                     +- Union
                        :- *(124) Project [sales#4511, number_sales#4512L, store AS channel#5100, i_brand_id#4863, i_class_id#4865, i_category_id#4867]
                        :  +- *(124) Filter (isnotnull(sales#4511) AND (cast(sales#4511 as decimal(32,6)) > cast(Subquery subquery#4514, [id=#19398] as decimal(32,6))))
                        :     :  +- Subquery subquery#4514, [id=#19398]
                        :     :     +- AdaptiveSparkPlan isFinalPlan=true
                                    +- == Final Plan ==
                                       *(8) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4535])
                                       +- ShuffleQueryStage 6
                                          +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#40874]
                                             +- *(7) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5152, count#5153L])
                                                +- Union
                                                   :- *(4) Project [ss_quantity#4668 AS quantity#4529, ss_list_price#4670 AS list_price#4530]
                                                   :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#4658], [d_date_sk#4681], Inner, BuildRight, false
                                                   :     :- *(4) Filter isnotnull(ss_sold_date_sk#4658)
                                                   :     :  +- *(4) ColumnarToRow
                                                   :     :     +- FileScan parquet [ss_sold_date_sk#4658,ss_quantity#4668,ss_list_price#4670] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4658)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                   :     +- BroadcastQueryStage 1
                                                   :        +- ReusedExchange [d_date_sk#4681], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                                                   :- *(5) Project [cs_quantity#4727 AS quantity#4531, cs_list_price#4729 AS list_price#4532]
                                                   :  +- *(5) BroadcastHashJoin [cs_sold_date_sk#4709], [d_date_sk#4743], Inner, BuildRight, false
                                                   :     :- *(5) Filter isnotnull(cs_sold_date_sk#4709)
                                                   :     :  +- *(5) ColumnarToRow
                                                   :     :     +- FileScan parquet [cs_sold_date_sk#4709,cs_quantity#4727,cs_list_price#4729] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                   :     +- BroadcastQueryStage 3
                                                   :        +- ReusedExchange [d_date_sk#4743], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                                                   +- *(6) Project [ws_quantity#4789 AS quantity#4533, ws_list_price#4791 AS list_price#4534]
                                                      +- *(6) BroadcastHashJoin [ws_sold_date_sk#4771], [d_date_sk#4805], Inner, BuildRight, false
                                                         :- *(6) Filter isnotnull(ws_sold_date_sk#4771)
                                                         :  +- *(6) ColumnarToRow
                                                         :     +- FileScan parquet [ws_sold_date_sk#4771,ws_quantity#4789,ws_list_price#4791] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4771)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                         +- BroadcastQueryStage 5
                                                            +- ReusedExchange [d_date_sk#4805], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                                    +- == Initial Plan ==
                                       HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4535])
                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#19396]
                                          +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5152, count#5153L])
                                             +- Union
                                                :- Project [ss_quantity#4668 AS quantity#4529, ss_list_price#4670 AS list_price#4530]
                                                :  +- BroadcastHashJoin [ss_sold_date_sk#4658], [d_date_sk#4681], Inner, BuildRight, false
                                                :     :- Filter isnotnull(ss_sold_date_sk#4658)
                                                :     :  +- FileScan parquet [ss_sold_date_sk#4658,ss_quantity#4668,ss_list_price#4670] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4658)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19384]
                                                :        +- Project [d_date_sk#4681]
                                                :           +- Filter (((isnotnull(d_year#4687) AND (d_year#4687 >= 1999)) AND (d_year#4687 <= 2001)) AND isnotnull(d_date_sk#4681))
                                                :              +- FileScan parquet [d_date_sk#4681,d_year#4687] Batched: true, DataFilters: [isnotnull(d_year#4687), (d_year#4687 >= 1999), (d_year#4687 <= 2001), isnotnull(d_date_sk#4681)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                :- Project [cs_quantity#4727 AS quantity#4531, cs_list_price#4729 AS list_price#4532]
                                                :  +- BroadcastHashJoin [cs_sold_date_sk#4709], [d_date_sk#4743], Inner, BuildRight, false
                                                :     :- Filter isnotnull(cs_sold_date_sk#4709)
                                                :     :  +- FileScan parquet [cs_sold_date_sk#4709,cs_quantity#4727,cs_list_price#4729] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19387]
                                                :        +- Project [d_date_sk#4743]
                                                :           +- Filter (((isnotnull(d_year#4749) AND (d_year#4749 >= 1999)) AND (d_year#4749 <= 2001)) AND isnotnull(d_date_sk#4743))
                                                :              +- FileScan parquet [d_date_sk#4743,d_year#4749] Batched: true, DataFilters: [isnotnull(d_year#4749), (d_year#4749 >= 1999), (d_year#4749 <= 2001), isnotnull(d_date_sk#4743)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                +- Project [ws_quantity#4789 AS quantity#4533, ws_list_price#4791 AS list_price#4534]
                                                   +- BroadcastHashJoin [ws_sold_date_sk#4771], [d_date_sk#4805], Inner, BuildRight, false
                                                      :- Filter isnotnull(ws_sold_date_sk#4771)
                                                      :  +- FileScan parquet [ws_sold_date_sk#4771,ws_quantity#4789,ws_list_price#4791] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4771)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19390]
                                                         +- Project [d_date_sk#4805]
                                                            +- Filter (((isnotnull(d_year#4811) AND (d_year#4811 >= 1999)) AND (d_year#4811 <= 2001)) AND isnotnull(d_date_sk#4805))
                                                               +- FileScan parquet [d_date_sk#4805,d_year#4811] Batched: true, DataFilters: [isnotnull(d_year#4811), (d_year#4811 >= 1999), (d_year#4811 <= 2001), isnotnull(d_date_sk#4805)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :     +- *(124) HashAggregate(keys=[i_brand_id#4863, i_class_id#4865, i_category_id#4867], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4843 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4845 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#4863, i_class_id#4865, i_category_id#4867, sales#4511, number_sales#4512L])
                        :        +- AQEShuffleRead coalesced
                        :           +- ShuffleQueryStage 186
                        :              +- Exchange hashpartitioning(i_brand_id#4863, i_class_id#4865, i_category_id#4867, 200), ENSURE_REQUIREMENTS, [id=#40350]
                        :                 +- *(121) HashAggregate(keys=[i_brand_id#4863, i_class_id#4865, i_category_id#4867], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4843 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4845 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#4863, i_class_id#4865, i_category_id#4867, sum#5135, isEmpty#5136, count#5137L])
                        :                    +- *(121) Project [ss_quantity#4843, ss_list_price#4845, i_brand_id#4863, i_class_id#4865, i_category_id#4867]
                        :                       +- *(121) BroadcastHashJoin [ss_sold_date_sk#4833], [d_date_sk#4878], Inner, BuildRight, false
                        :                          :- *(121) Project [ss_sold_date_sk#4833, ss_quantity#4843, ss_list_price#4845, i_brand_id#4863, i_class_id#4865, i_category_id#4867]
                        :                          :  +- *(121) BroadcastHashJoin [ss_item_sk#4835], [i_item_sk#4856], Inner, BuildRight, false
                        :                          :     :- *(121) BroadcastHashJoin [ss_item_sk#4835], [ss_item_sk#4528], LeftSemi, BuildRight, false
                        :                          :     :  :- AQEShuffleRead local
                        :                          :     :  :  +- ShuffleQueryStage 0
                        :                          :     :  :     +- Exchange hashpartitioning(ss_item_sk#4835, 200), ENSURE_REQUIREMENTS, [id=#21034]
                        :                          :     :  :        +- *(1) Filter (isnotnull(ss_item_sk#4835) AND isnotnull(ss_sold_date_sk#4833))
                        :                          :     :  :           +- *(1) ColumnarToRow
                        :                          :     :  :              +- FileScan parquet [ss_sold_date_sk#4833,ss_item_sk#4835,ss_quantity#4843,ss_list_price#4845] Batched: true, DataFilters: [isnotnull(ss_item_sk#4835), isnotnull(ss_sold_date_sk#4833)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                        :                          :     :  +- BroadcastQueryStage 170
                        :                          :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#39686]
                        :                          :     :        +- AQEShuffleRead local
                        :                          :     :           +- ShuffleQueryStage 159
                        :                          :     :              +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#38915]
                        :                          :     :                 +- *(112) Project [i_item_sk#500 AS ss_item_sk#4528]
                        :                          :     :                    +- *(112) BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                        :                          :     :                       :- BroadcastQueryStage 1
                        :                          :     :                       :  +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#21051]
                        :                          :     :                       :     +- *(2) Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                        :                          :     :                       :        +- *(2) ColumnarToRow
                        :                          :     :                       :           +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :     :                       +- *(112) HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                        :                          :     :                          +- AQEShuffleRead coalesced
                        :                          :     :                             +- ShuffleQueryStage 148
                        :                          :     :                                +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#37948]
                        :                          :     :                                   +- *(96) HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                        :                          :     :                                      +- *(96) SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                        :                          :     :                                         :- *(94) Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                        :                          :     :                                         :  +- AQEShuffleRead coalesced
                        :                          :     :                                         :     +- ShuffleQueryStage 137
                        :                          :     :                                         :        +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#37169]
                        :                          :     :                                         :           +- *(88) HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                        :                          :     :                                         :              +- AQEShuffleRead coalesced
                        :                          :     :                                         :                 +- ShuffleQueryStage 126
                        :                          :     :                                         :                    +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#36223]
                        :                          :     :                                         :                       +- *(82) HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                        :                          :     :                                         :                          +- *(82) Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                        :                          :     :                                         :                             +- *(82) BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                        :                          :     :                                         :                                :- *(82) Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                        :                          :     :                                         :                                :  +- *(82) BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                        :                          :     :                                         :                                :     :- *(82) Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                        :                          :     :                                         :                                :     :  +- *(82) ColumnarToRow
                        :                          :     :                                         :                                :     :     +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                        :                          :     :                                         :                                :     +- BroadcastQueryStage 115
                        :                          :     :                                         :                                :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#33614]
                        :                          :     :                                         :                                :           +- *(66) SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                        :                          :     :                                         :                                :              :- *(64) Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                        :                          :     :                                         :                                :              :  +- AQEShuffleRead coalesced
                        :                          :     :                                         :                                :              :     +- ShuffleQueryStage 2
                        :                          :     :                                         :                                :              :        +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#21066]
                        :                          :     :                                         :                                :              :           +- *(3) Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                        :                          :     :                                         :                                :              :              +- *(3) ColumnarToRow
                        :                          :     :                                         :                                :              :                 +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :     :                                         :                                :              +- *(65) Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                        :                          :     :                                         :                                :                 +- AQEShuffleRead coalesced
                        :                          :     :                                         :                                :                    +- ShuffleQueryStage 93
                        :                          :     :                                         :                                :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#25851]
                        :                          :     :                                         :                                :                          +- *(52) Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                        :                          :     :                                         :                                :                             +- *(52) BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                        :                          :     :                                         :                                :                                :- *(52) Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                        :                          :     :                                         :                                :                                :  +- *(52) BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                        :                          :     :                                         :                                :                                :     :- *(52) Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                        :                          :     :                                         :                                :                                :     :  +- *(52) ColumnarToRow
                        :                          :     :                                         :                                :                                :     :     +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                        :                          :     :                                         :                                :                                :     +- BroadcastQueryStage 3
                        :                          :     :                                         :                                :                                :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#21083]
                        :                          :     :                                         :                                :                                :           +- *(4) Filter isnotnull(i_item_sk#4558)
                        :                          :     :                                         :                                :                                :              +- *(4) ColumnarToRow
                        :                          :     :                                         :                                :                                :                 +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :     :                                         :                                :                                +- BroadcastQueryStage 4
                        :                          :     :                                         :                                :                                   +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                        :                          :     :                                         :                                :                                      +- *(5) Project [d_date_sk#4580]
                        :                          :     :                                         :                                :                                         +- *(5) Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                        :                          :     :                                         :                                :                                            +- *(5) ColumnarToRow
                        :                          :     :                                         :                                :                                               +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                          :     :                                         :                                +- BroadcastQueryStage 6
                        :                          :     :                                         :                                   +- ReusedExchange [d_date_sk#598], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                        :                          :     :                                         +- *(95) Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                        :                          :     :                                            +- AQEShuffleRead coalesced
                        :                          :     :                                               +- ShuffleQueryStage 94
                        :                          :     :                                                  +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#25899]
                        :                          :     :                                                     +- *(53) Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                        :                          :     :                                                        +- *(53) BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                        :                          :     :                                                           :- *(53) Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                        :                          :     :                                                           :  +- *(53) BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                        :                          :     :                                                           :     :- *(53) Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                        :                          :     :                                                           :     :  +- *(53) ColumnarToRow
                        :                          :     :                                                           :     :     +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                        :                          :     :                                                           :     +- BroadcastQueryStage 8
                        :                          :     :                                                           :        +- ReusedExchange [i_item_sk#4608, i_brand_id#4615, i_class_id#4617, i_category_id#4619], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#21083]
                        :                          :     :                                                           +- BroadcastQueryStage 10
                        :                          :     :                                                              +- ReusedExchange [d_date_sk#4630], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                        :                          :     +- BroadcastQueryStage 181
                        :                          :        +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#40037]
                        :                          :           +- *(118) BroadcastHashJoin [i_item_sk#4856], [ss_item_sk#4528], LeftSemi, BuildRight, false
                        :                          :              :- AQEShuffleRead local
                        :                          :              :  +- ShuffleQueryStage 11
                        :                          :              :     +- Exchange hashpartitioning(i_item_sk#4856, 200), ENSURE_REQUIREMENTS, [id=#21208]
                        :                          :              :        +- *(9) Filter isnotnull(i_item_sk#4856)
                        :                          :              :           +- *(9) ColumnarToRow
                        :                          :              :              +- FileScan parquet [i_item_sk#4856,i_brand_id#4863,i_class_id#4865,i_category_id#4867] Batched: true, DataFilters: [isnotnull(i_item_sk#4856)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :              +- BroadcastQueryStage 172
                        :                          :                 +- ReusedExchange [ss_item_sk#4528], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#39686]
                        :                          +- BroadcastQueryStage 26
                        :                             +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21395]
                        :                                +- *(17) Project [d_date_sk#4878]
                        :                                   +- *(17) Filter ((((isnotnull(d_year#4884) AND isnotnull(d_moy#4886)) AND (d_year#4884 = 2001)) AND (d_moy#4886 = 11)) AND isnotnull(d_date_sk#4878))
                        :                                      +- *(17) ColumnarToRow
                        :                                         +- FileScan parquet [d_date_sk#4878,d_year#4884,d_moy#4886] Batched: true, DataFilters: [isnotnull(d_year#4884), isnotnull(d_moy#4886), (d_year#4884 = 2001), (d_moy#4886 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                        :- *(125) Project [sales#4516, number_sales#4517L, catalog AS channel#5118, i_brand_id#4947, i_class_id#4949, i_category_id#4951]
                        :  +- *(125) Filter (isnotnull(sales#4516) AND (cast(sales#4516 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#4514, [id=#19398] as decimal(32,6))))
                        :     :  +- ReusedSubquery Subquery subquery#4514, [id=#19398]
                        :     +- *(125) HashAggregate(keys=[i_brand_id#4947, i_class_id#4949, i_category_id#4951], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#4924 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#4926 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#4947, i_class_id#4949, i_category_id#4951, sales#4516, number_sales#4517L])
                        :        +- AQEShuffleRead coalesced
                        :           +- ShuffleQueryStage 187
                        :              +- Exchange hashpartitioning(i_brand_id#4947, i_class_id#4949, i_category_id#4951, 200), ENSURE_REQUIREMENTS, [id=#40401]
                        :                 +- *(122) HashAggregate(keys=[i_brand_id#4947, i_class_id#4949, i_category_id#4951], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#4924 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#4926 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#4947, i_class_id#4949, i_category_id#4951, sum#5141, isEmpty#5142, count#5143L])
                        :                    +- *(122) Project [cs_quantity#4924, cs_list_price#4926, i_brand_id#4947, i_class_id#4949, i_category_id#4951]
                        :                       +- *(122) BroadcastHashJoin [cs_sold_date_sk#4906], [d_date_sk#4962], Inner, BuildRight, false
                        :                          :- *(122) Project [cs_sold_date_sk#4906, cs_quantity#4924, cs_list_price#4926, i_brand_id#4947, i_class_id#4949, i_category_id#4951]
                        :                          :  +- *(122) BroadcastHashJoin [cs_item_sk#4921], [i_item_sk#4940], Inner, BuildRight, false
                        :                          :     :- *(122) BroadcastHashJoin [cs_item_sk#4921], [ss_item_sk#4528], LeftSemi, BuildRight, false
                        :                          :     :  :- AQEShuffleRead local
                        :                          :     :  :  +- ShuffleQueryStage 27
                        :                          :     :  :     +- Exchange hashpartitioning(cs_item_sk#4921, 200), ENSURE_REQUIREMENTS, [id=#21419]
                        :                          :     :  :        +- *(18) Filter (isnotnull(cs_item_sk#4921) AND isnotnull(cs_sold_date_sk#4906))
                        :                          :     :  :           +- *(18) ColumnarToRow
                        :                          :     :  :              +- FileScan parquet [cs_sold_date_sk#4906,cs_item_sk#4921,cs_quantity#4924,cs_list_price#4926] Batched: true, DataFilters: [isnotnull(cs_item_sk#4921), isnotnull(cs_sold_date_sk#4906)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                        :                          :     :  +- BroadcastQueryStage 174
                        :                          :     :     +- ReusedExchange [ss_item_sk#4528], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#39686]
                        :                          :     +- BroadcastQueryStage 183
                        :                          :        +- ReusedExchange [i_item_sk#4940, i_brand_id#4947, i_class_id#4949, i_category_id#4951], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#40037]
                        :                          +- BroadcastQueryStage 59
                        :                             +- ReusedExchange [d_date_sk#4962], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21395]
                        +- *(126) Project [sales#4521, number_sales#4522L, web AS channel#5122, i_brand_id#5031, i_class_id#5033, i_category_id#5035]
                           +- *(126) Filter (isnotnull(sales#4521) AND (cast(sales#4521 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#4514, [id=#19398] as decimal(32,6))))
                              :  +- ReusedSubquery Subquery subquery#4514, [id=#19398]
                              +- *(126) HashAggregate(keys=[i_brand_id#5031, i_class_id#5033, i_category_id#5035], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5008 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5010 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5031, i_class_id#5033, i_category_id#5035, sales#4521, number_sales#4522L])
                                 +- AQEShuffleRead coalesced
                                    +- ShuffleQueryStage 188
                                       +- Exchange hashpartitioning(i_brand_id#5031, i_class_id#5033, i_category_id#5035, 200), ENSURE_REQUIREMENTS, [id=#40452]
                                          +- *(123) HashAggregate(keys=[i_brand_id#5031, i_class_id#5033, i_category_id#5035], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5008 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5010 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5031, i_class_id#5033, i_category_id#5035, sum#5147, isEmpty#5148, count#5149L])
                                             +- *(123) Project [ws_quantity#5008, ws_list_price#5010, i_brand_id#5031, i_class_id#5033, i_category_id#5035]
                                                +- *(123) BroadcastHashJoin [ws_sold_date_sk#4990], [d_date_sk#5046], Inner, BuildRight, false
                                                   :- *(123) Project [ws_sold_date_sk#4990, ws_quantity#5008, ws_list_price#5010, i_brand_id#5031, i_class_id#5033, i_category_id#5035]
                                                   :  +- *(123) BroadcastHashJoin [ws_item_sk#4993], [i_item_sk#5024], Inner, BuildRight, false
                                                   :     :- *(123) BroadcastHashJoin [ws_item_sk#4993], [ss_item_sk#4528], LeftSemi, BuildRight, false
                                                   :     :  :- AQEShuffleRead local
                                                   :     :  :  +- ShuffleQueryStage 60
                                                   :     :  :     +- Exchange hashpartitioning(ws_item_sk#4993, 200), ENSURE_REQUIREMENTS, [id=#21816]
                                                   :     :  :        +- *(35) Filter (isnotnull(ws_item_sk#4993) AND isnotnull(ws_sold_date_sk#4990))
                                                   :     :  :           +- *(35) ColumnarToRow
                                                   :     :  :              +- FileScan parquet [ws_sold_date_sk#4990,ws_item_sk#4993,ws_quantity#5008,ws_list_price#5010] Batched: true, DataFilters: [isnotnull(ws_item_sk#4993), isnotnull(ws_sold_date_sk#4990)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                   :     :  +- BroadcastQueryStage 178
                                                   :     :     +- ReusedExchange [ss_item_sk#4528], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#39686]
                                                   :     +- BroadcastQueryStage 185
                                                   :        +- ReusedExchange [i_item_sk#5024, i_brand_id#5031, i_class_id#5033, i_category_id#5035], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#40037]
                                                   +- BroadcastQueryStage 92
                                                      +- ReusedExchange [d_date_sk#5046], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21395]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#5105 ASC NULLS FIRST,i_brand_id#5106 ASC NULLS FIRST,i_class_id#5107 ASC NULLS FIRST,i_category_id#5108 ASC NULLS FIRST], output=[channel#5105,i_brand_id#5106,i_class_id#5107,i_category_id#5108,sum(sales)#5095,sum(number_sales)#5096L])
   +- HashAggregate(keys=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L], functions=[sum(sales#4511), sum(number_sales#4512L)], output=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, sum(sales)#5095, sum(number_sales)#5096L])
      +- Exchange hashpartitioning(channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L, 200), ENSURE_REQUIREMENTS, [id=#20102]
         +- HashAggregate(keys=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L], functions=[partial_sum(sales#4511), partial_sum(number_sales#4512L)], output=[channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L, sum#5129, isEmpty#5130, sum#5131L])
            +- Expand [[sales#4511, number_sales#4512L, channel#5100, i_brand_id#4863, i_class_id#4865, i_category_id#4867, 0], [sales#4511, number_sales#4512L, channel#5100, i_brand_id#4863, i_class_id#4865, null, 1], [sales#4511, number_sales#4512L, channel#5100, i_brand_id#4863, null, null, 3], [sales#4511, number_sales#4512L, channel#5100, null, null, null, 7], [sales#4511, number_sales#4512L, null, null, null, null, 15]], [sales#4511, number_sales#4512L, channel#5105, i_brand_id#5106, i_class_id#5107, i_category_id#5108, spark_grouping_id#5104L]
               +- Union
                  :- Project [sales#4511, number_sales#4512L, store AS channel#5100, i_brand_id#4863, i_class_id#4865, i_category_id#4867]
                  :  +- Filter (isnotnull(sales#4511) AND (cast(sales#4511 as decimal(32,6)) > cast(Subquery subquery#4514, [id=#19398] as decimal(32,6))))
                  :     :  +- Subquery subquery#4514, [id=#19398]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=true
                              +- == Final Plan ==
                                 *(8) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4535])
                                 +- ShuffleQueryStage 6
                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#40874]
                                       +- *(7) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5152, count#5153L])
                                          +- Union
                                             :- *(4) Project [ss_quantity#4668 AS quantity#4529, ss_list_price#4670 AS list_price#4530]
                                             :  +- *(4) BroadcastHashJoin [ss_sold_date_sk#4658], [d_date_sk#4681], Inner, BuildRight, false
                                             :     :- *(4) Filter isnotnull(ss_sold_date_sk#4658)
                                             :     :  +- *(4) ColumnarToRow
                                             :     :     +- FileScan parquet [ss_sold_date_sk#4658,ss_quantity#4668,ss_list_price#4670] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4658)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                             :     +- BroadcastQueryStage 1
                                             :        +- ReusedExchange [d_date_sk#4681], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                                             :- *(5) Project [cs_quantity#4727 AS quantity#4531, cs_list_price#4729 AS list_price#4532]
                                             :  +- *(5) BroadcastHashJoin [cs_sold_date_sk#4709], [d_date_sk#4743], Inner, BuildRight, false
                                             :     :- *(5) Filter isnotnull(cs_sold_date_sk#4709)
                                             :     :  +- *(5) ColumnarToRow
                                             :     :     +- FileScan parquet [cs_sold_date_sk#4709,cs_quantity#4727,cs_list_price#4729] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                             :     +- BroadcastQueryStage 3
                                             :        +- ReusedExchange [d_date_sk#4743], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                                             +- *(6) Project [ws_quantity#4789 AS quantity#4533, ws_list_price#4791 AS list_price#4534]
                                                +- *(6) BroadcastHashJoin [ws_sold_date_sk#4771], [d_date_sk#4805], Inner, BuildRight, false
                                                   :- *(6) Filter isnotnull(ws_sold_date_sk#4771)
                                                   :  +- *(6) ColumnarToRow
                                                   :     +- FileScan parquet [ws_sold_date_sk#4771,ws_quantity#4789,ws_list_price#4791] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4771)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                   +- BroadcastQueryStage 5
                                                      +- ReusedExchange [d_date_sk#4805], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#21102]
                              +- == Initial Plan ==
                                 HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4535])
                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#19396]
                                    +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5152, count#5153L])
                                       +- Union
                                          :- Project [ss_quantity#4668 AS quantity#4529, ss_list_price#4670 AS list_price#4530]
                                          :  +- BroadcastHashJoin [ss_sold_date_sk#4658], [d_date_sk#4681], Inner, BuildRight, false
                                          :     :- Filter isnotnull(ss_sold_date_sk#4658)
                                          :     :  +- FileScan parquet [ss_sold_date_sk#4658,ss_quantity#4668,ss_list_price#4670] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4658)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                          :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19384]
                                          :        +- Project [d_date_sk#4681]
                                          :           +- Filter (((isnotnull(d_year#4687) AND (d_year#4687 >= 1999)) AND (d_year#4687 <= 2001)) AND isnotnull(d_date_sk#4681))
                                          :              +- FileScan parquet [d_date_sk#4681,d_year#4687] Batched: true, DataFilters: [isnotnull(d_year#4687), (d_year#4687 >= 1999), (d_year#4687 <= 2001), isnotnull(d_date_sk#4681)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          :- Project [cs_quantity#4727 AS quantity#4531, cs_list_price#4729 AS list_price#4532]
                                          :  +- BroadcastHashJoin [cs_sold_date_sk#4709], [d_date_sk#4743], Inner, BuildRight, false
                                          :     :- Filter isnotnull(cs_sold_date_sk#4709)
                                          :     :  +- FileScan parquet [cs_sold_date_sk#4709,cs_quantity#4727,cs_list_price#4729] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                          :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19387]
                                          :        +- Project [d_date_sk#4743]
                                          :           +- Filter (((isnotnull(d_year#4749) AND (d_year#4749 >= 1999)) AND (d_year#4749 <= 2001)) AND isnotnull(d_date_sk#4743))
                                          :              +- FileScan parquet [d_date_sk#4743,d_year#4749] Batched: true, DataFilters: [isnotnull(d_year#4749), (d_year#4749 >= 1999), (d_year#4749 <= 2001), isnotnull(d_date_sk#4743)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          +- Project [ws_quantity#4789 AS quantity#4533, ws_list_price#4791 AS list_price#4534]
                                             +- BroadcastHashJoin [ws_sold_date_sk#4771], [d_date_sk#4805], Inner, BuildRight, false
                                                :- Filter isnotnull(ws_sold_date_sk#4771)
                                                :  +- FileScan parquet [ws_sold_date_sk#4771,ws_quantity#4789,ws_list_price#4791] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4771)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19390]
                                                   +- Project [d_date_sk#4805]
                                                      +- Filter (((isnotnull(d_year#4811) AND (d_year#4811 >= 1999)) AND (d_year#4811 <= 2001)) AND isnotnull(d_date_sk#4805))
                                                         +- FileScan parquet [d_date_sk#4805,d_year#4811] Batched: true, DataFilters: [isnotnull(d_year#4811), (d_year#4811 >= 1999), (d_year#4811 <= 2001), isnotnull(d_date_sk#4805)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#4863, i_class_id#4865, i_category_id#4867], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4843 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4845 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#4863, i_class_id#4865, i_category_id#4867, sales#4511, number_sales#4512L])
                  :        +- Exchange hashpartitioning(i_brand_id#4863, i_class_id#4865, i_category_id#4867, 200), ENSURE_REQUIREMENTS, [id=#19846]
                  :           +- HashAggregate(keys=[i_brand_id#4863, i_class_id#4865, i_category_id#4867], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4843 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4845 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#4863, i_class_id#4865, i_category_id#4867, sum#5135, isEmpty#5136, count#5137L])
                  :              +- Project [ss_quantity#4843, ss_list_price#4845, i_brand_id#4863, i_class_id#4865, i_category_id#4867]
                  :                 +- BroadcastHashJoin [ss_sold_date_sk#4833], [d_date_sk#4878], Inner, BuildRight, false
                  :                    :- Project [ss_sold_date_sk#4833, ss_quantity#4843, ss_list_price#4845, i_brand_id#4863, i_class_id#4865, i_category_id#4867]
                  :                    :  +- BroadcastHashJoin [ss_item_sk#4835], [i_item_sk#4856], Inner, BuildRight, false
                  :                    :     :- SortMergeJoin [ss_item_sk#4835], [ss_item_sk#4528], LeftSemi
                  :                    :     :  :- Sort [ss_item_sk#4835 ASC NULLS FIRST], false, 0
                  :                    :     :  :  +- Exchange hashpartitioning(ss_item_sk#4835, 200), ENSURE_REQUIREMENTS, [id=#19776]
                  :                    :     :  :     +- Filter (isnotnull(ss_item_sk#4835) AND isnotnull(ss_sold_date_sk#4833))
                  :                    :     :  :        +- FileScan parquet [ss_sold_date_sk#4833,ss_item_sk#4835,ss_quantity#4843,ss_list_price#4845] Batched: true, DataFilters: [isnotnull(ss_item_sk#4835), isnotnull(ss_sold_date_sk#4833)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :                    :     :  +- Sort [ss_item_sk#4528 ASC NULLS FIRST], false, 0
                  :                    :     :     +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#19777]
                  :                    :     :        +- Project [i_item_sk#500 AS ss_item_sk#4528]
                  :                    :     :           +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                  :                    :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#19771]
                  :                    :     :              :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                  :                    :     :              :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :              +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                 +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19768]
                  :                    :     :                    +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                       +- SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                  :                    :     :                          :- Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                  :                    :     :                          :  +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#19761]
                  :                    :     :                          :     +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                          :        +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19750]
                  :                    :     :                          :           +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                          :              +- Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                  :                    :     :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                  :                    :     :                          :                    :- Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                  :                    :     :                          :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                  :                    :     :                          :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                  :                    :     :                          :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :     :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19741]
                  :                    :     :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                  :                    :     :                          :                    :           :- Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                  :                    :     :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#19735]
                  :                    :     :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                  :                    :     :                          :                    :           :        +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :                          :                    :           +- Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                  :                    :     :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#19736]
                  :                    :     :                          :                    :                 +- Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :     :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                  :                    :     :                          :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :     :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                  :                    :     :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                  :                    :     :                          :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :     :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19726]
                  :                    :     :                          :                    :                       :        +- Filter isnotnull(i_item_sk#4558)
                  :                    :     :                          :                    :                       :           +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19730]
                  :                    :     :                          :                    :                          +- Project [d_date_sk#4580]
                  :                    :     :                          :                    :                             +- Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                  :                    :     :                          :                    :                                +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :     :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19745]
                  :                    :     :                          :                       +- Project [d_date_sk#598]
                  :                    :     :                          :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                  :                    :     :                          :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :     :                          +- Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                  :                    :     :                             +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#19762]
                  :                    :     :                                +- Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :     :                                   +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                  :                    :     :                                      :- Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :     :                                      :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                  :                    :     :                                      :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                  :                    :     :                                      :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19752]
                  :                    :     :                                      :        +- Filter isnotnull(i_item_sk#4608)
                  :                    :     :                                      :           +- FileScan parquet [i_item_sk#4608,i_brand_id#4615,i_class_id#4617,i_category_id#4619] Batched: true, DataFilters: [isnotnull(i_item_sk#4608)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19756]
                  :                    :     :                                         +- Project [d_date_sk#4630]
                  :                    :     :                                            +- Filter (((isnotnull(d_year#4636) AND (d_year#4636 >= 1999)) AND (d_year#4636 <= 2001)) AND isnotnull(d_date_sk#4630))
                  :                    :     :                                               +- FileScan parquet [d_date_sk#4630,d_year#4636] Batched: true, DataFilters: [isnotnull(d_year#4636), (d_year#4636 >= 1999), (d_year#4636 <= 2001), isnotnull(d_date_sk#4630)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19837]
                  :                    :        +- SortMergeJoin [i_item_sk#4856], [ss_item_sk#4528], LeftSemi
                  :                    :           :- Sort [i_item_sk#4856 ASC NULLS FIRST], false, 0
                  :                    :           :  +- Exchange hashpartitioning(i_item_sk#4856, 200), ENSURE_REQUIREMENTS, [id=#19831]
                  :                    :           :     +- Filter isnotnull(i_item_sk#4856)
                  :                    :           :        +- FileScan parquet [i_item_sk#4856,i_brand_id#4863,i_class_id#4865,i_category_id#4867] Batched: true, DataFilters: [isnotnull(i_item_sk#4856)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           +- Sort [ss_item_sk#4528 ASC NULLS FIRST], false, 0
                  :                    :              +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#19832]
                  :                    :                 +- Project [i_item_sk#500 AS ss_item_sk#4528]
                  :                    :                    +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                  :                    :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#19826]
                  :                    :                       :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                  :                    :                       :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                       +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                          +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19823]
                  :                    :                             +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                                +- SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                  :                    :                                   :- Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                  :                    :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#19816]
                  :                    :                                   :     +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                                   :        +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19805]
                  :                    :                                   :           +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                                   :              +- Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                  :                    :                                   :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                  :                    :                                   :                    :- Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                  :                    :                                   :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                  :                    :                                   :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                  :                    :                                   :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :                                   :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19796]
                  :                    :                                   :                    :        +- SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                  :                    :                                   :                    :           :- Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#19790]
                  :                    :                                   :                    :           :     +- Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                  :                    :                                   :                    :           :        +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :           +- Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#19791]
                  :                    :                                   :                    :                 +- Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :                                   :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                  :                    :                                   :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :                                   :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                  :                    :                                   :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                  :                    :                                   :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :                                   :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19781]
                  :                    :                                   :                    :                       :        +- Filter isnotnull(i_item_sk#4558)
                  :                    :                                   :                    :                       :           +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19785]
                  :                    :                                   :                    :                          +- Project [d_date_sk#4580]
                  :                    :                                   :                    :                             +- Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                  :                    :                                   :                    :                                +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19800]
                  :                    :                                   :                       +- Project [d_date_sk#598]
                  :                    :                                   :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                  :                    :                                   :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   +- Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                  :                    :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#19817]
                  :                    :                                         +- Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :                                            +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                  :                    :                                               :- Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :                                               :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                  :                    :                                               :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                  :                    :                                               :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19807]
                  :                    :                                               :        +- Filter isnotnull(i_item_sk#4608)
                  :                    :                                               :           +- FileScan parquet [i_item_sk#4608,i_brand_id#4615,i_class_id#4617,i_category_id#4619] Batched: true, DataFilters: [isnotnull(i_item_sk#4608)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19811]
                  :                    :                                                  +- Project [d_date_sk#4630]
                  :                    :                                                     +- Filter (((isnotnull(d_year#4636) AND (d_year#4636 >= 1999)) AND (d_year#4636 <= 2001)) AND isnotnull(d_date_sk#4630))
                  :                    :                                                        +- FileScan parquet [d_date_sk#4630,d_year#4636] Batched: true, DataFilters: [isnotnull(d_year#4636), (d_year#4636 >= 1999), (d_year#4636 <= 2001), isnotnull(d_date_sk#4630)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19841]
                  :                       +- Project [d_date_sk#4878]
                  :                          +- Filter ((((isnotnull(d_year#4884) AND isnotnull(d_moy#4886)) AND (d_year#4884 = 2001)) AND (d_moy#4886 = 11)) AND isnotnull(d_date_sk#4878))
                  :                             +- FileScan parquet [d_date_sk#4878,d_year#4884,d_moy#4886] Batched: true, DataFilters: [isnotnull(d_year#4884), isnotnull(d_moy#4886), (d_year#4884 = 2001), (d_moy#4886 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  :- Project [sales#4516, number_sales#4517L, catalog AS channel#5118, i_brand_id#4947, i_class_id#4949, i_category_id#4951]
                  :  +- Filter (isnotnull(sales#4516) AND (cast(sales#4516 as decimal(32,6)) > cast(Subquery subquery#4519, [id=#19478] as decimal(32,6))))
                  :     :  +- Subquery subquery#4519, [id=#19478]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=false
                  :     :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4535])
                  :     :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#19476]
                  :     :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5152, count#5153L])
                  :     :                 +- Union
                  :     :                    :- Project [ss_quantity#4668 AS quantity#4529, ss_list_price#4670 AS list_price#4530]
                  :     :                    :  +- BroadcastHashJoin [ss_sold_date_sk#4658], [d_date_sk#4681], Inner, BuildRight, false
                  :     :                    :     :- Filter isnotnull(ss_sold_date_sk#4658)
                  :     :                    :     :  +- FileScan parquet [ss_sold_date_sk#4658,ss_quantity#4668,ss_list_price#4670] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4658)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19464]
                  :     :                    :        +- Project [d_date_sk#4681]
                  :     :                    :           +- Filter (((isnotnull(d_year#4687) AND (d_year#4687 >= 1999)) AND (d_year#4687 <= 2001)) AND isnotnull(d_date_sk#4681))
                  :     :                    :              +- FileScan parquet [d_date_sk#4681,d_year#4687] Batched: true, DataFilters: [isnotnull(d_year#4687), (d_year#4687 >= 1999), (d_year#4687 <= 2001), isnotnull(d_date_sk#4681)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    :- Project [cs_quantity#4727 AS quantity#4531, cs_list_price#4729 AS list_price#4532]
                  :     :                    :  +- BroadcastHashJoin [cs_sold_date_sk#4709], [d_date_sk#4743], Inner, BuildRight, false
                  :     :                    :     :- Filter isnotnull(cs_sold_date_sk#4709)
                  :     :                    :     :  +- FileScan parquet [cs_sold_date_sk#4709,cs_quantity#4727,cs_list_price#4729] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :     :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19467]
                  :     :                    :        +- Project [d_date_sk#4743]
                  :     :                    :           +- Filter (((isnotnull(d_year#4749) AND (d_year#4749 >= 1999)) AND (d_year#4749 <= 2001)) AND isnotnull(d_date_sk#4743))
                  :     :                    :              +- FileScan parquet [d_date_sk#4743,d_year#4749] Batched: true, DataFilters: [isnotnull(d_year#4749), (d_year#4749 >= 1999), (d_year#4749 <= 2001), isnotnull(d_date_sk#4743)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    +- Project [ws_quantity#4789 AS quantity#4533, ws_list_price#4791 AS list_price#4534]
                  :     :                       +- BroadcastHashJoin [ws_sold_date_sk#4771], [d_date_sk#4805], Inner, BuildRight, false
                  :     :                          :- Filter isnotnull(ws_sold_date_sk#4771)
                  :     :                          :  +- FileScan parquet [ws_sold_date_sk#4771,ws_quantity#4789,ws_list_price#4791] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4771)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                  :     :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19470]
                  :     :                             +- Project [d_date_sk#4805]
                  :     :                                +- Filter (((isnotnull(d_year#4811) AND (d_year#4811 >= 1999)) AND (d_year#4811 <= 2001)) AND isnotnull(d_date_sk#4805))
                  :     :                                   +- FileScan parquet [d_date_sk#4805,d_year#4811] Batched: true, DataFilters: [isnotnull(d_year#4811), (d_year#4811 >= 1999), (d_year#4811 <= 2001), isnotnull(d_date_sk#4805)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#4947, i_class_id#4949, i_category_id#4951], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#4924 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#4926 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#4947, i_class_id#4949, i_category_id#4951, sales#4516, number_sales#4517L])
                  :        +- Exchange hashpartitioning(i_brand_id#4947, i_class_id#4949, i_category_id#4951, 200), ENSURE_REQUIREMENTS, [id=#19970]
                  :           +- HashAggregate(keys=[i_brand_id#4947, i_class_id#4949, i_category_id#4951], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#4924 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#4926 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#4947, i_class_id#4949, i_category_id#4951, sum#5141, isEmpty#5142, count#5143L])
                  :              +- Project [cs_quantity#4924, cs_list_price#4926, i_brand_id#4947, i_class_id#4949, i_category_id#4951]
                  :                 +- BroadcastHashJoin [cs_sold_date_sk#4906], [d_date_sk#4962], Inner, BuildRight, false
                  :                    :- Project [cs_sold_date_sk#4906, cs_quantity#4924, cs_list_price#4926, i_brand_id#4947, i_class_id#4949, i_category_id#4951]
                  :                    :  +- BroadcastHashJoin [cs_item_sk#4921], [i_item_sk#4940], Inner, BuildRight, false
                  :                    :     :- SortMergeJoin [cs_item_sk#4921], [ss_item_sk#4528], LeftSemi
                  :                    :     :  :- Sort [cs_item_sk#4921 ASC NULLS FIRST], false, 0
                  :                    :     :  :  +- Exchange hashpartitioning(cs_item_sk#4921, 200), ENSURE_REQUIREMENTS, [id=#19900]
                  :                    :     :  :     +- Filter (isnotnull(cs_item_sk#4921) AND isnotnull(cs_sold_date_sk#4906))
                  :                    :     :  :        +- FileScan parquet [cs_sold_date_sk#4906,cs_item_sk#4921,cs_quantity#4924,cs_list_price#4926] Batched: true, DataFilters: [isnotnull(cs_item_sk#4921), isnotnull(cs_sold_date_sk#4906)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :                    :     :  +- Sort [ss_item_sk#4528 ASC NULLS FIRST], false, 0
                  :                    :     :     +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#19901]
                  :                    :     :        +- Project [i_item_sk#500 AS ss_item_sk#4528]
                  :                    :     :           +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                  :                    :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#19895]
                  :                    :     :              :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                  :                    :     :              :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :              +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                 +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19892]
                  :                    :     :                    +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                       +- SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                  :                    :     :                          :- Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                  :                    :     :                          :  +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#19885]
                  :                    :     :                          :     +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                          :        +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19874]
                  :                    :     :                          :           +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :     :                          :              +- Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                  :                    :     :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                  :                    :     :                          :                    :- Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                  :                    :     :                          :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                  :                    :     :                          :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                  :                    :     :                          :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :     :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19865]
                  :                    :     :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                  :                    :     :                          :                    :           :- Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                  :                    :     :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#19859]
                  :                    :     :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                  :                    :     :                          :                    :           :        +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :                          :                    :           +- Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                  :                    :     :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#19860]
                  :                    :     :                          :                    :                 +- Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :     :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                  :                    :     :                          :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :     :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                  :                    :     :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                  :                    :     :                          :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :     :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19850]
                  :                    :     :                          :                    :                       :        +- Filter isnotnull(i_item_sk#4558)
                  :                    :     :                          :                    :                       :           +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19854]
                  :                    :     :                          :                    :                          +- Project [d_date_sk#4580]
                  :                    :     :                          :                    :                             +- Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                  :                    :     :                          :                    :                                +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :     :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19869]
                  :                    :     :                          :                       +- Project [d_date_sk#598]
                  :                    :     :                          :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                  :                    :     :                          :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :     :                          +- Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                  :                    :     :                             +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#19886]
                  :                    :     :                                +- Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :     :                                   +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                  :                    :     :                                      :- Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :     :                                      :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                  :                    :     :                                      :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                  :                    :     :                                      :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19876]
                  :                    :     :                                      :        +- Filter isnotnull(i_item_sk#4608)
                  :                    :     :                                      :           +- FileScan parquet [i_item_sk#4608,i_brand_id#4615,i_class_id#4617,i_category_id#4619] Batched: true, DataFilters: [isnotnull(i_item_sk#4608)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19880]
                  :                    :     :                                         +- Project [d_date_sk#4630]
                  :                    :     :                                            +- Filter (((isnotnull(d_year#4636) AND (d_year#4636 >= 1999)) AND (d_year#4636 <= 2001)) AND isnotnull(d_date_sk#4630))
                  :                    :     :                                               +- FileScan parquet [d_date_sk#4630,d_year#4636] Batched: true, DataFilters: [isnotnull(d_year#4636), (d_year#4636 >= 1999), (d_year#4636 <= 2001), isnotnull(d_date_sk#4630)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19961]
                  :                    :        +- SortMergeJoin [i_item_sk#4940], [ss_item_sk#4528], LeftSemi
                  :                    :           :- Sort [i_item_sk#4940 ASC NULLS FIRST], false, 0
                  :                    :           :  +- Exchange hashpartitioning(i_item_sk#4940, 200), ENSURE_REQUIREMENTS, [id=#19955]
                  :                    :           :     +- Filter isnotnull(i_item_sk#4940)
                  :                    :           :        +- FileScan parquet [i_item_sk#4940,i_brand_id#4947,i_class_id#4949,i_category_id#4951] Batched: true, DataFilters: [isnotnull(i_item_sk#4940)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           +- Sort [ss_item_sk#4528 ASC NULLS FIRST], false, 0
                  :                    :              +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#19956]
                  :                    :                 +- Project [i_item_sk#500 AS ss_item_sk#4528]
                  :                    :                    +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                  :                    :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#19950]
                  :                    :                       :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                  :                    :                       :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                       +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                          +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19947]
                  :                    :                             +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                                +- SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                  :                    :                                   :- Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                  :                    :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#19940]
                  :                    :                                   :     +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                                   :        +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19929]
                  :                    :                                   :           +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                  :                    :                                   :              +- Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                  :                    :                                   :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                  :                    :                                   :                    :- Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                  :                    :                                   :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                  :                    :                                   :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                  :                    :                                   :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :                                   :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19920]
                  :                    :                                   :                    :        +- SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                  :                    :                                   :                    :           :- Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#19914]
                  :                    :                                   :                    :           :     +- Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                  :                    :                                   :                    :           :        +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :           +- Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                  :                    :                                   :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#19915]
                  :                    :                                   :                    :                 +- Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :                                   :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                  :                    :                                   :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                  :                    :                                   :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                  :                    :                                   :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                  :                    :                                   :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :                                   :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19905]
                  :                    :                                   :                    :                       :        +- Filter isnotnull(i_item_sk#4558)
                  :                    :                                   :                    :                       :           +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                   :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19909]
                  :                    :                                   :                    :                          +- Project [d_date_sk#4580]
                  :                    :                                   :                    :                             +- Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                  :                    :                                   :                    :                                +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19924]
                  :                    :                                   :                       +- Project [d_date_sk#598]
                  :                    :                                   :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                  :                    :                                   :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                   +- Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                  :                    :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#19941]
                  :                    :                                         +- Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :                                            +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                  :                    :                                               :- Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                  :                    :                                               :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                  :                    :                                               :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                  :                    :                                               :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19931]
                  :                    :                                               :        +- Filter isnotnull(i_item_sk#4608)
                  :                    :                                               :           +- FileScan parquet [i_item_sk#4608,i_brand_id#4615,i_class_id#4617,i_category_id#4619] Batched: true, DataFilters: [isnotnull(i_item_sk#4608)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19935]
                  :                    :                                                  +- Project [d_date_sk#4630]
                  :                    :                                                     +- Filter (((isnotnull(d_year#4636) AND (d_year#4636 >= 1999)) AND (d_year#4636 <= 2001)) AND isnotnull(d_date_sk#4630))
                  :                    :                                                        +- FileScan parquet [d_date_sk#4630,d_year#4636] Batched: true, DataFilters: [isnotnull(d_year#4636), (d_year#4636 >= 1999), (d_year#4636 <= 2001), isnotnull(d_date_sk#4630)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19965]
                  :                       +- Project [d_date_sk#4962]
                  :                          +- Filter ((((isnotnull(d_year#4968) AND isnotnull(d_moy#4970)) AND (d_year#4968 = 2001)) AND (d_moy#4970 = 11)) AND isnotnull(d_date_sk#4962))
                  :                             +- FileScan parquet [d_date_sk#4962,d_year#4968,d_moy#4970] Batched: true, DataFilters: [isnotnull(d_year#4968), isnotnull(d_moy#4970), (d_year#4968 = 2001), (d_moy#4970 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  +- Project [sales#4521, number_sales#4522L, web AS channel#5122, i_brand_id#5031, i_class_id#5033, i_category_id#5035]
                     +- Filter (isnotnull(sales#4521) AND (cast(sales#4521 as decimal(32,6)) > cast(Subquery subquery#4524, [id=#19558] as decimal(32,6))))
                        :  +- Subquery subquery#4524, [id=#19558]
                        :     +- AdaptiveSparkPlan isFinalPlan=false
                        :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4535])
                        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#19556]
                        :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4529 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4530 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5152, count#5153L])
                        :                 +- Union
                        :                    :- Project [ss_quantity#4668 AS quantity#4529, ss_list_price#4670 AS list_price#4530]
                        :                    :  +- BroadcastHashJoin [ss_sold_date_sk#4658], [d_date_sk#4681], Inner, BuildRight, false
                        :                    :     :- Filter isnotnull(ss_sold_date_sk#4658)
                        :                    :     :  +- FileScan parquet [ss_sold_date_sk#4658,ss_quantity#4668,ss_list_price#4670] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4658)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                        :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19544]
                        :                    :        +- Project [d_date_sk#4681]
                        :                    :           +- Filter (((isnotnull(d_year#4687) AND (d_year#4687 >= 1999)) AND (d_year#4687 <= 2001)) AND isnotnull(d_date_sk#4681))
                        :                    :              +- FileScan parquet [d_date_sk#4681,d_year#4687] Batched: true, DataFilters: [isnotnull(d_year#4687), (d_year#4687 >= 1999), (d_year#4687 <= 2001), isnotnull(d_date_sk#4681)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    :- Project [cs_quantity#4727 AS quantity#4531, cs_list_price#4729 AS list_price#4532]
                        :                    :  +- BroadcastHashJoin [cs_sold_date_sk#4709], [d_date_sk#4743], Inner, BuildRight, false
                        :                    :     :- Filter isnotnull(cs_sold_date_sk#4709)
                        :                    :     :  +- FileScan parquet [cs_sold_date_sk#4709,cs_quantity#4727,cs_list_price#4729] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                        :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19547]
                        :                    :        +- Project [d_date_sk#4743]
                        :                    :           +- Filter (((isnotnull(d_year#4749) AND (d_year#4749 >= 1999)) AND (d_year#4749 <= 2001)) AND isnotnull(d_date_sk#4743))
                        :                    :              +- FileScan parquet [d_date_sk#4743,d_year#4749] Batched: true, DataFilters: [isnotnull(d_year#4749), (d_year#4749 >= 1999), (d_year#4749 <= 2001), isnotnull(d_date_sk#4743)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    +- Project [ws_quantity#4789 AS quantity#4533, ws_list_price#4791 AS list_price#4534]
                        :                       +- BroadcastHashJoin [ws_sold_date_sk#4771], [d_date_sk#4805], Inner, BuildRight, false
                        :                          :- Filter isnotnull(ws_sold_date_sk#4771)
                        :                          :  +- FileScan parquet [ws_sold_date_sk#4771,ws_quantity#4789,ws_list_price#4791] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4771)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                        :                          +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19550]
                        :                             +- Project [d_date_sk#4805]
                        :                                +- Filter (((isnotnull(d_year#4811) AND (d_year#4811 >= 1999)) AND (d_year#4811 <= 2001)) AND isnotnull(d_date_sk#4805))
                        :                                   +- FileScan parquet [d_date_sk#4805,d_year#4811] Batched: true, DataFilters: [isnotnull(d_year#4811), (d_year#4811 >= 1999), (d_year#4811 <= 2001), isnotnull(d_date_sk#4805)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        +- HashAggregate(keys=[i_brand_id#5031, i_class_id#5033, i_category_id#5035], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5008 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5010 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5031, i_class_id#5033, i_category_id#5035, sales#4521, number_sales#4522L])
                           +- Exchange hashpartitioning(i_brand_id#5031, i_class_id#5033, i_category_id#5035, 200), ENSURE_REQUIREMENTS, [id=#20094]
                              +- HashAggregate(keys=[i_brand_id#5031, i_class_id#5033, i_category_id#5035], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5008 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5010 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5031, i_class_id#5033, i_category_id#5035, sum#5147, isEmpty#5148, count#5149L])
                                 +- Project [ws_quantity#5008, ws_list_price#5010, i_brand_id#5031, i_class_id#5033, i_category_id#5035]
                                    +- BroadcastHashJoin [ws_sold_date_sk#4990], [d_date_sk#5046], Inner, BuildRight, false
                                       :- Project [ws_sold_date_sk#4990, ws_quantity#5008, ws_list_price#5010, i_brand_id#5031, i_class_id#5033, i_category_id#5035]
                                       :  +- BroadcastHashJoin [ws_item_sk#4993], [i_item_sk#5024], Inner, BuildRight, false
                                       :     :- SortMergeJoin [ws_item_sk#4993], [ss_item_sk#4528], LeftSemi
                                       :     :  :- Sort [ws_item_sk#4993 ASC NULLS FIRST], false, 0
                                       :     :  :  +- Exchange hashpartitioning(ws_item_sk#4993, 200), ENSURE_REQUIREMENTS, [id=#20024]
                                       :     :  :     +- Filter (isnotnull(ws_item_sk#4993) AND isnotnull(ws_sold_date_sk#4990))
                                       :     :  :        +- FileScan parquet [ws_sold_date_sk#4990,ws_item_sk#4993,ws_quantity#5008,ws_list_price#5010] Batched: true, DataFilters: [isnotnull(ws_item_sk#4993), isnotnull(ws_sold_date_sk#4990)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       :     :  +- Sort [ss_item_sk#4528 ASC NULLS FIRST], false, 0
                                       :     :     +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#20025]
                                       :     :        +- Project [i_item_sk#500 AS ss_item_sk#4528]
                                       :     :           +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                                       :     :              :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#20019]
                                       :     :              :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                                       :     :              :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :     :              +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :     :                 +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#20016]
                                       :     :                    +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :     :                       +- SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                                       :     :                          :- Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                                       :     :                          :  +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#20009]
                                       :     :                          :     +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :     :                          :        +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#19998]
                                       :     :                          :           +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :     :                          :              +- Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                                       :     :                          :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                                       :     :                          :                    :- Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                                       :     :                          :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                                       :     :                          :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                                       :     :                          :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :     :                          :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19989]
                                       :     :                          :                    :        +- SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                                       :     :                          :                    :           :- Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                                       :     :                          :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#19983]
                                       :     :                          :                    :           :     +- Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                                       :     :                          :                    :           :        +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :     :                          :                    :           +- Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                                       :     :                          :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#19984]
                                       :     :                          :                    :                 +- Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                                       :     :                          :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                                       :     :                          :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                                       :     :                          :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                                       :     :                          :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                                       :     :                          :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :     :                          :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#19974]
                                       :     :                          :                    :                       :        +- Filter isnotnull(i_item_sk#4558)
                                       :     :                          :                    :                       :           +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :     :                          :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19978]
                                       :     :                          :                    :                          +- Project [d_date_sk#4580]
                                       :     :                          :                    :                             +- Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                                       :     :                          :                    :                                +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :     :                          :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#19993]
                                       :     :                          :                       +- Project [d_date_sk#598]
                                       :     :                          :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                                       :     :                          :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :     :                          +- Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                                       :     :                             +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#20010]
                                       :     :                                +- Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                                       :     :                                   +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                                       :     :                                      :- Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                                       :     :                                      :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                                       :     :                                      :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                                       :     :                                      :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :     :                                      :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#20000]
                                       :     :                                      :        +- Filter isnotnull(i_item_sk#4608)
                                       :     :                                      :           +- FileScan parquet [i_item_sk#4608,i_brand_id#4615,i_class_id#4617,i_category_id#4619] Batched: true, DataFilters: [isnotnull(i_item_sk#4608)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :     :                                      +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#20004]
                                       :     :                                         +- Project [d_date_sk#4630]
                                       :     :                                            +- Filter (((isnotnull(d_year#4636) AND (d_year#4636 >= 1999)) AND (d_year#4636 <= 2001)) AND isnotnull(d_date_sk#4630))
                                       :     :                                               +- FileScan parquet [d_date_sk#4630,d_year#4636] Batched: true, DataFilters: [isnotnull(d_year#4636), (d_year#4636 >= 1999), (d_year#4636 <= 2001), isnotnull(d_date_sk#4630)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#20085]
                                       :        +- SortMergeJoin [i_item_sk#5024], [ss_item_sk#4528], LeftSemi
                                       :           :- Sort [i_item_sk#5024 ASC NULLS FIRST], false, 0
                                       :           :  +- Exchange hashpartitioning(i_item_sk#5024, 200), ENSURE_REQUIREMENTS, [id=#20079]
                                       :           :     +- Filter isnotnull(i_item_sk#5024)
                                       :           :        +- FileScan parquet [i_item_sk#5024,i_brand_id#5031,i_class_id#5033,i_category_id#5035] Batched: true, DataFilters: [isnotnull(i_item_sk#5024)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           +- Sort [ss_item_sk#4528 ASC NULLS FIRST], false, 0
                                       :              +- Exchange hashpartitioning(ss_item_sk#4528, 200), ENSURE_REQUIREMENTS, [id=#20080]
                                       :                 +- Project [i_item_sk#500 AS ss_item_sk#4528]
                                       :                    +- BroadcastHashJoin [i_brand_id#507, i_class_id#509, i_category_id#511], [brand_id#4525, class_id#4526, category_id#4527], Inner, BuildLeft, false
                                       :                       :- BroadcastExchange HashedRelationBroadcastMode(List(input[1, int, false], input[2, int, false], input[3, int, false]),false), [id=#20074]
                                       :                       :  +- Filter ((isnotnull(i_brand_id#507) AND isnotnull(i_class_id#509)) AND isnotnull(i_category_id#511))
                                       :                       :     +- FileScan parquet [i_item_sk#500,i_brand_id#507,i_class_id#509,i_category_id#511] Batched: true, DataFilters: [isnotnull(i_brand_id#507), isnotnull(i_class_id#509), isnotnull(i_category_id#511)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                       +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :                          +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#20071]
                                       :                             +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :                                +- SortMergeJoin [coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527)], [coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619)], LeftSemi
                                       :                                   :- Sort [coalesce(brand_id#4525, 0) ASC NULLS FIRST, isnull(brand_id#4525) ASC NULLS FIRST, coalesce(class_id#4526, 0) ASC NULLS FIRST, isnull(class_id#4526) ASC NULLS FIRST, coalesce(category_id#4527, 0) ASC NULLS FIRST, isnull(category_id#4527) ASC NULLS FIRST], false, 0
                                       :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#4525, 0), isnull(brand_id#4525), coalesce(class_id#4526, 0), isnull(class_id#4526), coalesce(category_id#4527, 0), isnull(category_id#4527), 200), ENSURE_REQUIREMENTS, [id=#20064]
                                       :                                   :     +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :                                   :        +- Exchange hashpartitioning(brand_id#4525, class_id#4526, category_id#4527, 200), ENSURE_REQUIREMENTS, [id=#20053]
                                       :                                   :           +- HashAggregate(keys=[brand_id#4525, class_id#4526, category_id#4527], functions=[], output=[brand_id#4525, class_id#4526, category_id#4527])
                                       :                                   :              +- Project [i_brand_id#4543 AS brand_id#4525, i_class_id#4545 AS class_id#4526, i_category_id#4547 AS category_id#4527]
                                       :                                   :                 +- BroadcastHashJoin [ss_sold_date_sk#664], [d_date_sk#598], Inner, BuildRight, false
                                       :                                   :                    :- Project [ss_sold_date_sk#664, i_brand_id#4543, i_class_id#4545, i_category_id#4547]
                                       :                                   :                    :  +- BroadcastHashJoin [ss_item_sk#666], [i_item_sk#4536], Inner, BuildRight, false
                                       :                                   :                    :     :- Filter (isnotnull(ss_item_sk#666) AND isnotnull(ss_sold_date_sk#664))
                                       :                                   :                    :     :  +- FileScan parquet [ss_sold_date_sk#664,ss_item_sk#666] Batched: true, DataFilters: [isnotnull(ss_item_sk#666), isnotnull(ss_sold_date_sk#664)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :                                   :                    :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#20044]
                                       :                                   :                    :        +- SortMergeJoin [coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547)], [coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569)], LeftSemi
                                       :                                   :                    :           :- Sort [coalesce(i_brand_id#4543, 0) ASC NULLS FIRST, isnull(i_brand_id#4543) ASC NULLS FIRST, coalesce(i_class_id#4545, 0) ASC NULLS FIRST, isnull(i_class_id#4545) ASC NULLS FIRST, coalesce(i_category_id#4547, 0) ASC NULLS FIRST, isnull(i_category_id#4547) ASC NULLS FIRST], false, 0
                                       :                                   :                    :           :  +- Exchange hashpartitioning(coalesce(i_brand_id#4543, 0), isnull(i_brand_id#4543), coalesce(i_class_id#4545, 0), isnull(i_class_id#4545), coalesce(i_category_id#4547, 0), isnull(i_category_id#4547), 200), ENSURE_REQUIREMENTS, [id=#20038]
                                       :                                   :                    :           :     +- Filter (((isnotnull(i_item_sk#4536) AND isnotnull(i_brand_id#4543)) AND isnotnull(i_class_id#4545)) AND isnotnull(i_category_id#4547))
                                       :                                   :                    :           :        +- FileScan parquet [i_item_sk#4536,i_brand_id#4543,i_class_id#4545,i_category_id#4547] Batched: true, DataFilters: [isnotnull(i_item_sk#4536), isnotnull(i_brand_id#4543), isnotnull(i_class_id#4545), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                   :                    :           +- Sort [coalesce(i_brand_id#4565, 0) ASC NULLS FIRST, isnull(i_brand_id#4565) ASC NULLS FIRST, coalesce(i_class_id#4567, 0) ASC NULLS FIRST, isnull(i_class_id#4567) ASC NULLS FIRST, coalesce(i_category_id#4569, 0) ASC NULLS FIRST, isnull(i_category_id#4569) ASC NULLS FIRST], false, 0
                                       :                                   :                    :              +- Exchange hashpartitioning(coalesce(i_brand_id#4565, 0), isnull(i_brand_id#4565), coalesce(i_class_id#4567, 0), isnull(i_class_id#4567), coalesce(i_category_id#4569, 0), isnull(i_category_id#4569), 200), ENSURE_REQUIREMENTS, [id=#20039]
                                       :                                   :                    :                 +- Project [i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                                       :                                   :                    :                    +- BroadcastHashJoin [cs_sold_date_sk#118], [d_date_sk#4580], Inner, BuildRight, false
                                       :                                   :                    :                       :- Project [cs_sold_date_sk#118, i_brand_id#4565, i_class_id#4567, i_category_id#4569]
                                       :                                   :                    :                       :  +- BroadcastHashJoin [cs_item_sk#133], [i_item_sk#4558], Inner, BuildRight, false
                                       :                                   :                    :                       :     :- Filter (isnotnull(cs_item_sk#133) AND isnotnull(cs_sold_date_sk#118))
                                       :                                   :                    :                       :     :  +- FileScan parquet [cs_sold_date_sk#118,cs_item_sk#133] Batched: true, DataFilters: [isnotnull(cs_item_sk#133), isnotnull(cs_sold_date_sk#118)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :                                   :                    :                       :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#20029]
                                       :                                   :                    :                       :        +- Filter isnotnull(i_item_sk#4558)
                                       :                                   :                    :                       :           +- FileScan parquet [i_item_sk#4558,i_brand_id#4565,i_class_id#4567,i_category_id#4569] Batched: true, DataFilters: [isnotnull(i_item_sk#4558)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                   :                    :                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#20033]
                                       :                                   :                    :                          +- Project [d_date_sk#4580]
                                       :                                   :                    :                             +- Filter (((isnotnull(d_year#4586) AND (d_year#4586 >= 1999)) AND (d_year#4586 <= 2001)) AND isnotnull(d_date_sk#4580))
                                       :                                   :                    :                                +- FileScan parquet [d_date_sk#4580,d_year#4586] Batched: true, DataFilters: [isnotnull(d_year#4586), (d_year#4586 >= 1999), (d_year#4586 <= 2001), isnotnull(d_date_sk#4580)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                   :                    +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#20048]
                                       :                                   :                       +- Project [d_date_sk#598]
                                       :                                   :                          +- Filter (((isnotnull(d_year#604) AND (d_year#604 >= 1999)) AND (d_year#604 <= 2001)) AND isnotnull(d_date_sk#598))
                                       :                                   :                             +- FileScan parquet [d_date_sk#598,d_year#604] Batched: true, DataFilters: [isnotnull(d_year#604), (d_year#604 >= 1999), (d_year#604 <= 2001), isnotnull(d_date_sk#598)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                   +- Sort [coalesce(i_brand_id#4615, 0) ASC NULLS FIRST, isnull(i_brand_id#4615) ASC NULLS FIRST, coalesce(i_class_id#4617, 0) ASC NULLS FIRST, isnull(i_class_id#4617) ASC NULLS FIRST, coalesce(i_category_id#4619, 0) ASC NULLS FIRST, isnull(i_category_id#4619) ASC NULLS FIRST], false, 0
                                       :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#4615, 0), isnull(i_brand_id#4615), coalesce(i_class_id#4617, 0), isnull(i_class_id#4617), coalesce(i_category_id#4619, 0), isnull(i_category_id#4619), 200), ENSURE_REQUIREMENTS, [id=#20065]
                                       :                                         +- Project [i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                                       :                                            +- BroadcastHashJoin [ws_sold_date_sk#384], [d_date_sk#4630], Inner, BuildRight, false
                                       :                                               :- Project [ws_sold_date_sk#384, i_brand_id#4615, i_class_id#4617, i_category_id#4619]
                                       :                                               :  +- BroadcastHashJoin [ws_item_sk#387], [i_item_sk#4608], Inner, BuildRight, false
                                       :                                               :     :- Filter (isnotnull(ws_item_sk#387) AND isnotnull(ws_sold_date_sk#384))
                                       :                                               :     :  +- FileScan parquet [ws_sold_date_sk#384,ws_item_sk#387] Batched: true, DataFilters: [isnotnull(ws_item_sk#387), isnotnull(ws_sold_date_sk#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :                                               :     +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [id=#20055]
                                       :                                               :        +- Filter isnotnull(i_item_sk#4608)
                                       :                                               :           +- FileScan parquet [i_item_sk#4608,i_brand_id#4615,i_class_id#4617,i_category_id#4619] Batched: true, DataFilters: [isnotnull(i_item_sk#4608)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                               +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#20059]
                                       :                                                  +- Project [d_date_sk#4630]
                                       :                                                     +- Filter (((isnotnull(d_year#4636) AND (d_year#4636 >= 1999)) AND (d_year#4636 <= 2001)) AND isnotnull(d_date_sk#4630))
                                       :                                                        +- FileScan parquet [d_date_sk#4630,d_year#4636] Batched: true, DataFilters: [isnotnull(d_year#4636), (d_year#4636 >= 1999), (d_year#4636 <= 2001), isnotnull(d_date_sk#4630)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       +- BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [id=#20089]
                                          +- Project [d_date_sk#5046]
                                             +- Filter ((((isnotnull(d_year#5052) AND isnotnull(d_moy#5054)) AND (d_year#5052 = 2001)) AND (d_moy#5054 = 11)) AND isnotnull(d_date_sk#5046))
                                                +- FileScan parquet [d_date_sk#5046,d_year#5052,d_moy#5054] Batched: true, DataFilters: [isnotnull(d_year#5052), isnotnull(d_moy#5054), (d_year#5052 = 2001), (d_moy#5054 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
