AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   GpuColumnarToRow false
   +- GpuTopN(limit=100, orderBy=[channel#6460 ASC NULLS FIRST,i_brand_id#6461 ASC NULLS FIRST,i_class_id#6462 ASC NULLS FIRST,i_category_id#6463 ASC NULLS FIRST], output=[channel#6460,i_brand_id#6461,i_class_id#6462,i_category_id#6463,sum(sales)#6450,sum(number_sales)#6451L])
      +- GpuShuffleCoalesce 2147483647
         +- GpuColumnarExchange gpusinglepartitioning$(), ENSURE_REQUIREMENTS, [id=#119472]
            +- GpuTopN(limit=100, orderBy=[channel#6460 ASC NULLS FIRST,i_brand_id#6461 ASC NULLS FIRST,i_class_id#6462 ASC NULLS FIRST,i_category_id#6463 ASC NULLS FIRST], output=[channel#6460,i_brand_id#6461,i_class_id#6462,i_category_id#6463,sum(sales)#6450,sum(number_sales)#6451L])
               +- GpuHashAggregate(keys=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L], functions=[gpudecimal128sum(sales#5866, DecimalType(38,2), false, false), gpubasicsum(number_sales#5867L, LongType, false)], output=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, sum(sales)#6450, sum(number_sales)#6451L])
                  +- GpuShuffleCoalesce 2147483647
                     +- GpuCustomShuffleReader coalesced
                        +- ShuffleQueryStage 246
                           +- GpuColumnarExchange gpuhashpartitioning(channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L, 200), ENSURE_REQUIREMENTS, [id=#118457]
                              +- GpuHashAggregate(keys=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L], functions=[partial_gpudecimal128sum(sales#5866, DecimalType(38,2), false, false), partial_gpubasicsum(number_sales#5867L, LongType, false)], output=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L, sum#6484, isEmpty#6485, sum#6486L])
                                 +- GpuExpand [[sales#5866, number_sales#5867L, channel#6455, i_brand_id#6218, i_class_id#6220, i_category_id#6222, 0], [sales#5866, number_sales#5867L, channel#6455, i_brand_id#6218, i_class_id#6220, null, 1], [sales#5866, number_sales#5867L, channel#6455, i_brand_id#6218, null, null, 3], [sales#5866, number_sales#5867L, channel#6455, null, null, null, 7], [sales#5866, number_sales#5867L, null, null, null, null, 15]], [sales#5866, number_sales#5867L, channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L]
                                    +- GpuUnion
                                       :- GpuProject [sales#5866, number_sales#5867L, store AS channel#6455, i_brand_id#6218, i_class_id#6220, i_category_id#6222], true
                                       :  +- GpuRowToColumnar targetsize(2147483647)
                                       :     +- *(4) Filter (isnotnull(sales#5866) AND (cast(sales#5866 as decimal(32,6)) > cast(Subquery subquery#5869, [id=#54909] as decimal(32,6))))
                                       :        :  +- Subquery subquery#5869, [id=#54909]
                                       :        :     +- AdaptiveSparkPlan isFinalPlan=true
                                                      +- == Final Plan ==
                                                         *(2) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5890])
                                                         +- ShuffleQueryStage 9
                                                            +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#119386]
                                                               +- *(1) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6507, count#6508L])
                                                                  +- GpuColumnarToRow false
                                                                     +- GpuUnion
                                                                        :- GpuProject [ss_quantity#6023 AS quantity#5884, ss_list_price#6025 AS list_price#5885], true
                                                                        :  +- GpuShuffledHashJoin [ss_sold_date_sk#6013], [d_date_sk#6036], Inner, GpuBuildRight, false
                                                                        :     :- GpuShuffleCoalesce 2147483647
                                                                        :     :  +- GpuCustomShuffleReader coalesced
                                                                        :     :     +- ShuffleQueryStage 0
                                                                        :     :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#6013, 200), ENSURE_REQUIREMENTS, [id=#118552]
                                                                        :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                                                        :     :              +- GpuFilter gpuisnotnull(ss_sold_date_sk#6013), true
                                                                        :     :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#6013,ss_quantity#6023,ss_list_price#6025] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6013)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                                        :     +- GpuCustomShuffleReader coalesced
                                                                        :        +- ShuffleQueryStage 2
                                                                        :           +- ReusedExchange [d_date_sk#6036], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                                                        :- GpuProject [cs_quantity#6082 AS quantity#5886, cs_list_price#6084 AS list_price#5887], true
                                                                        :  +- GpuShuffledHashJoin [cs_sold_date_sk#6064], [d_date_sk#6098], Inner, GpuBuildRight, false
                                                                        :     :- GpuShuffleCoalesce 2147483647
                                                                        :     :  +- GpuCustomShuffleReader coalesced
                                                                        :     :     +- ShuffleQueryStage 3
                                                                        :     :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#6064, 200), ENSURE_REQUIREMENTS, [id=#118623]
                                                                        :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                                                        :     :              +- GpuFilter gpuisnotnull(cs_sold_date_sk#6064), true
                                                                        :     :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#6064,cs_quantity#6082,cs_list_price#6084] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6064)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                                        :     +- GpuCustomShuffleReader coalesced
                                                                        :        +- ShuffleQueryStage 5
                                                                        :           +- ReusedExchange [d_date_sk#6098], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                                                        +- GpuProject [ws_quantity#6144 AS quantity#5888, ws_list_price#6146 AS list_price#5889], true
                                                                           +- GpuShuffledHashJoin [ws_sold_date_sk#6126], [d_date_sk#6160], Inner, GpuBuildRight, false
                                                                              :- GpuShuffleCoalesce 2147483647
                                                                              :  +- GpuCustomShuffleReader coalesced
                                                                              :     +- ShuffleQueryStage 6
                                                                              :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#6126, 200), ENSURE_REQUIREMENTS, [id=#118694]
                                                                              :           +- GpuCoalesceBatches targetsize(2147483647)
                                                                              :              +- GpuFilter gpuisnotnull(ws_sold_date_sk#6126), true
                                                                              :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#6126,ws_quantity#6144,ws_list_price#6146] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6126)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                                              +- GpuCustomShuffleReader coalesced
                                                                                 +- ShuffleQueryStage 8
                                                                                    +- ReusedExchange [d_date_sk#6160], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                                      +- == Initial Plan ==
                                                         HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5890])
                                                         +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#54802]
                                                            +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6507, count#6508L])
                                                               +- Union
                                                                  :- Project [ss_quantity#6023 AS quantity#5884, ss_list_price#6025 AS list_price#5885]
                                                                  :  +- SortMergeJoin [ss_sold_date_sk#6013], [d_date_sk#6036], Inner
                                                                  :     :- Sort [ss_sold_date_sk#6013 ASC NULLS FIRST], false, 0
                                                                  :     :  +- Exchange hashpartitioning(ss_sold_date_sk#6013, 200), ENSURE_REQUIREMENTS, [id=#54779]
                                                                  :     :     +- Filter isnotnull(ss_sold_date_sk#6013)
                                                                  :     :        +- FileScan parquet [ss_sold_date_sk#6013,ss_quantity#6023,ss_list_price#6025] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6013)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                                  :     +- Sort [d_date_sk#6036 ASC NULLS FIRST], false, 0
                                                                  :        +- Exchange hashpartitioning(d_date_sk#6036, 200), ENSURE_REQUIREMENTS, [id=#54780]
                                                                  :           +- Project [d_date_sk#6036]
                                                                  :              +- Filter (((isnotnull(d_year#6042) AND (d_year#6042 >= 1999)) AND (d_year#6042 <= 2001)) AND isnotnull(d_date_sk#6036))
                                                                  :                 +- FileScan parquet [d_date_sk#6036,d_year#6042] Batched: true, DataFilters: [isnotnull(d_year#6042), (d_year#6042 >= 1999), (d_year#6042 <= 2001), isnotnull(d_date_sk#6036)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                                  :- Project [cs_quantity#6082 AS quantity#5886, cs_list_price#6084 AS list_price#5887]
                                                                  :  +- SortMergeJoin [cs_sold_date_sk#6064], [d_date_sk#6098], Inner
                                                                  :     :- Sort [cs_sold_date_sk#6064 ASC NULLS FIRST], false, 0
                                                                  :     :  +- Exchange hashpartitioning(cs_sold_date_sk#6064, 200), ENSURE_REQUIREMENTS, [id=#54786]
                                                                  :     :     +- Filter isnotnull(cs_sold_date_sk#6064)
                                                                  :     :        +- FileScan parquet [cs_sold_date_sk#6064,cs_quantity#6082,cs_list_price#6084] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6064)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                                  :     +- Sort [d_date_sk#6098 ASC NULLS FIRST], false, 0
                                                                  :        +- Exchange hashpartitioning(d_date_sk#6098, 200), ENSURE_REQUIREMENTS, [id=#54787]
                                                                  :           +- Project [d_date_sk#6098]
                                                                  :              +- Filter (((isnotnull(d_year#6104) AND (d_year#6104 >= 1999)) AND (d_year#6104 <= 2001)) AND isnotnull(d_date_sk#6098))
                                                                  :                 +- FileScan parquet [d_date_sk#6098,d_year#6104] Batched: true, DataFilters: [isnotnull(d_year#6104), (d_year#6104 >= 1999), (d_year#6104 <= 2001), isnotnull(d_date_sk#6098)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                                  +- Project [ws_quantity#6144 AS quantity#5888, ws_list_price#6146 AS list_price#5889]
                                                                     +- SortMergeJoin [ws_sold_date_sk#6126], [d_date_sk#6160], Inner
                                                                        :- Sort [ws_sold_date_sk#6126 ASC NULLS FIRST], false, 0
                                                                        :  +- Exchange hashpartitioning(ws_sold_date_sk#6126, 200), ENSURE_REQUIREMENTS, [id=#54793]
                                                                        :     +- Filter isnotnull(ws_sold_date_sk#6126)
                                                                        :        +- FileScan parquet [ws_sold_date_sk#6126,ws_quantity#6144,ws_list_price#6146] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6126)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                                        +- Sort [d_date_sk#6160 ASC NULLS FIRST], false, 0
                                                                           +- Exchange hashpartitioning(d_date_sk#6160, 200), ENSURE_REQUIREMENTS, [id=#54794]
                                                                              +- Project [d_date_sk#6160]
                                                                                 +- Filter (((isnotnull(d_year#6166) AND (d_year#6166 >= 1999)) AND (d_year#6166 <= 2001)) AND isnotnull(d_date_sk#6160))
                                                                                    +- FileScan parquet [d_date_sk#6160,d_year#6166] Batched: true, DataFilters: [isnotnull(d_year#6166), (d_year#6166 >= 1999), (d_year#6166 <= 2001), isnotnull(d_date_sk#6160)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :        +- *(4) HashAggregate(keys=[i_brand_id#6218, i_class_id#6220, i_category_id#6222], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6198 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#6200 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#6218, i_class_id#6220, i_category_id#6222, sales#5866, number_sales#5867L])
                                       :           +- AQEShuffleRead coalesced
                                       :              +- ShuffleQueryStage 243
                                       :                 +- Exchange hashpartitioning(i_brand_id#6218, i_class_id#6220, i_category_id#6222, 200), ENSURE_REQUIREMENTS, [id=#117354]
                                       :                    +- *(1) HashAggregate(keys=[i_brand_id#6218, i_class_id#6220, i_category_id#6222], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6198 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#6200 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#6218, i_class_id#6220, i_category_id#6222, sum#6490, isEmpty#6491, count#6492L])
                                       :                       +- GpuColumnarToRow false
                                       :                          +- GpuProject [ss_quantity#6198, ss_list_price#6200, i_brand_id#6218, i_class_id#6220, i_category_id#6222], true
                                       :                             +- GpuShuffledHashJoin [ss_item_sk#6190], [i_item_sk#6211], Inner, GpuBuildRight, false
                                       :                                :- GpuShuffleCoalesce 2147483647
                                       :                                :  +- GpuCustomShuffleReader coalesced
                                       :                                :     +- ShuffleQueryStage 240
                                       :                                :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#6190, 200), ENSURE_REQUIREMENTS, [id=#116093]
                                       :                                :           +- GpuProject [ss_item_sk#6190, ss_quantity#6198, ss_list_price#6200], true
                                       :                                :              +- GpuShuffledHashJoin [ss_sold_date_sk#6188], [d_date_sk#6233], Inner, GpuBuildRight, false
                                       :                                :                 :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :     +- ShuffleQueryStage 237
                                       :                                :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#6188, 200), ENSURE_REQUIREMENTS, [id=#115438]
                                       :                                :                 :           +- GpuShuffledHashJoin [ss_item_sk#6190], [ss_item_sk#5883], LeftSemi, GpuBuildRight, false
                                       :                                :                 :              :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :              :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :              :     +- ShuffleQueryStage 0
                                       :                                :                 :              :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#6190, 200), ENSURE_REQUIREMENTS, [id=#63565]
                                       :                                :                 :              :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :              :              +- GpuFilter (gpuisnotnull(ss_sold_date_sk#6188) AND gpuisnotnull(ss_item_sk#6190)), true
                                       :                                :                 :              :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#6188,ss_item_sk#6190,ss_quantity#6198,ss_list_price#6200] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6188), isnotnull(ss_item_sk#6190)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                       :                                :                 :              +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                 +- ShuffleQueryStage 226
                                       :                                :                 :                    +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#114426]
                                       :                                :                 :                       +- GpuProject [i_item_sk#668 AS ss_item_sk#5883], true
                                       :                                :                 :                          +- GpuShuffledHashJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner, GpuBuildRight, false
                                       :                                :                 :                             :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                             :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                             :     +- ShuffleQueryStage 1
                                       :                                :                 :                             :        +- GpuColumnarExchange gpuhashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#63593]
                                       :                                :                 :                             :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                             :              +- GpuFilter ((gpuisnotnull(i_brand_id#675) AND gpuisnotnull(i_class_id#677)) AND gpuisnotnull(i_category_id#679)), true
                                       :                                :                 :                             :                 +- GpuFileGpuScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                :                 :                             +- GpuCoalesceBatches RequireSingleBatchWithFilter
                                       :                                :                 :                                +- GpuHashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :                                :                 :                                   +- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                      +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                         +- ShuffleQueryStage 215
                                       :                                :                 :                                            +- GpuColumnarExchange gpuhashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#112516]
                                       :                                :                 :                                               +- GpuHashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :                                :                 :                                                  +- GpuShuffledHashJoin [gpucoalesce(brand_id#5880, 0), gpuisnull(brand_id#5880), gpucoalesce(class_id#5881, 0), gpuisnull(class_id#5881), gpucoalesce(category_id#5882, 0), gpuisnull(category_id#5882)], [gpucoalesce(i_brand_id#5970, 0), gpuisnull(i_brand_id#5970), gpucoalesce(i_class_id#5972, 0), gpuisnull(i_class_id#5972), gpucoalesce(i_category_id#5974, 0), gpuisnull(i_category_id#5974)], LeftSemi, GpuBuildRight, false
                                       :                                :                 :                                                     :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :     +- ShuffleQueryStage 204
                                       :                                :                 :                                                     :        +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(brand_id#5880, 0), gpuisnull(brand_id#5880), gpucoalesce(class_id#5881, 0), gpuisnull(class_id#5881), gpucoalesce(category_id#5882, 0), gpuisnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#111120]
                                       :                                :                 :                                                     :           +- GpuHashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :                                :                 :                                                     :              +- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :                 +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                    +- ShuffleQueryStage 193
                                       :                                :                 :                                                     :                       +- GpuColumnarExchange gpuhashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#108592]
                                       :                                :                 :                                                     :                          +- GpuHashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :                                :                 :                                                     :                             +- GpuProject [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882], true
                                       :                                :                 :                                                     :                                +- GpuShuffledHashJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner, GpuBuildRight, false
                                       :                                :                 :                                                     :                                   :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :                                   :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :     +- ShuffleQueryStage 182
                                       :                                :                 :                                                     :                                   :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#106622]
                                       :                                :                 :                                                     :                                   :           +- GpuProject [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902], true
                                       :                                :                 :                                                     :                                   :              +- GpuShuffledHashJoin [ss_item_sk#254], [i_item_sk#5891], Inner, GpuBuildRight, false
                                       :                                :                 :                                                     :                                   :                 :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :                                   :                 :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                 :     +- ShuffleQueryStage 2
                                       :                                :                 :                                                     :                                   :                 :        +- GpuColumnarExchange gpuhashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#63621]
                                       :                                :                 :                                                     :                                   :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                                                     :                                   :                 :              +- GpuFilter (gpuisnotnull(ss_item_sk#254) AND gpuisnotnull(ss_sold_date_sk#252)), true
                                       :                                :                 :                                                     :                                   :                 :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :                                :                 :                                                     :                                   :                 +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                    +- ShuffleQueryStage 171
                                       :                                :                 :                                                     :                                   :                       +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#101840]
                                       :                                :                 :                                                     :                                   :                          +- GpuShuffledHashJoin [gpucoalesce(i_brand_id#5898, 0), gpuisnull(i_brand_id#5898), gpucoalesce(i_class_id#5900, 0), gpuisnull(i_class_id#5900), gpucoalesce(i_category_id#5902, 0), gpuisnull(i_category_id#5902)], [gpucoalesce(i_brand_id#5920, 0), gpuisnull(i_brand_id#5920), gpucoalesce(i_class_id#5922, 0), gpuisnull(i_class_id#5922), gpucoalesce(i_category_id#5924, 0), gpuisnull(i_category_id#5924)], LeftSemi, GpuBuildRight, false
                                       :                                :                 :                                                     :                                   :                             :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :                                   :                             :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                             :     +- ShuffleQueryStage 3
                                       :                                :                 :                                                     :                                   :                             :        +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(i_brand_id#5898, 0), gpuisnull(i_brand_id#5898), gpucoalesce(i_class_id#5900, 0), gpuisnull(i_class_id#5900), gpucoalesce(i_category_id#5902, 0), gpuisnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#63649]
                                       :                                :                 :                                                     :                                   :                             :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                                                     :                                   :                             :              +- GpuFilter (((gpuisnotnull(i_item_sk#5891) AND gpuisnotnull(i_brand_id#5898)) AND gpuisnotnull(i_class_id#5900)) AND gpuisnotnull(i_category_id#5902)), true
                                       :                                :                 :                                                     :                                   :                             :                 +- GpuFileGpuScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                :                 :                                                     :                                   :                             +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                                +- ShuffleQueryStage 149
                                       :                                :                 :                                                     :                                   :                                   +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(i_brand_id#5920, 0), gpuisnull(i_brand_id#5920), gpucoalesce(i_class_id#5922, 0), gpuisnull(i_class_id#5922), gpucoalesce(i_category_id#5924, 0), gpuisnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#97111]
                                       :                                :                 :                                                     :                                   :                                      +- GpuProject [i_brand_id#5920, i_class_id#5922, i_category_id#5924], true
                                       :                                :                 :                                                     :                                   :                                         +- GpuShuffledHashJoin [cs_item_sk#559], [i_item_sk#5913], Inner, GpuBuildRight, false
                                       :                                :                 :                                                     :                                   :                                            :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :                                   :                                            :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                                            :     +- ShuffleQueryStage 127
                                       :                                :                 :                                                     :                                   :                                            :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#84141]
                                       :                                :                 :                                                     :                                   :                                            :           +- GpuProject [cs_item_sk#559], true
                                       :                                :                 :                                                     :                                   :                                            :              +- GpuShuffledHashJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner, GpuBuildRight, false
                                       :                                :                 :                                                     :                                   :                                            :                 :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                     :                                   :                                            :                 :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                                            :                 :     +- ShuffleQueryStage 4
                                       :                                :                 :                                                     :                                   :                                            :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#63677]
                                       :                                :                 :                                                     :                                   :                                            :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                                                     :                                   :                                            :                 :              +- GpuFilter (gpuisnotnull(cs_sold_date_sk#544) AND gpuisnotnull(cs_item_sk#559)), true
                                       :                                :                 :                                                     :                                   :                                            :                 :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :                                :                 :                                                     :                                   :                                            :                 +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                                            :                    +- ShuffleQueryStage 5
                                       :                                :                 :                                                     :                                   :                                            :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                       :                                :                 :                                                     :                                   :                                            :                          +- GpuProject [d_date_sk#5935], true
                                       :                                :                 :                                                     :                                   :                                            :                             +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                                                     :                                   :                                            :                                +- GpuFilter (((gpuisnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND gpuisnotnull(d_date_sk#5935)), true
                                       :                                :                 :                                                     :                                   :                                            :                                   +- GpuFileGpuScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                :                 :                                                     :                                   :                                            +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                   :                                               +- ShuffleQueryStage 6
                                       :                                :                 :                                                     :                                   :                                                  +- GpuColumnarExchange gpuhashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#63748]
                                       :                                :                 :                                                     :                                   :                                                     +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                                                     :                                   :                                                        +- GpuFilter gpuisnotnull(i_item_sk#5913), true
                                       :                                :                 :                                                     :                                   :                                                           +- GpuFileGpuScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                :                 :                                                     :                                   +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                     :                                      +- ShuffleQueryStage 8
                                       :                                :                 :                                                     :                                         +- ReusedExchange [d_date_sk#612], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                       :                                :                 :                                                     +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                        +- ShuffleQueryStage 160
                                       :                                :                 :                                                           +- GpuColumnarExchange gpuhashpartitioning(gpucoalesce(i_brand_id#5970, 0), gpuisnull(i_brand_id#5970), gpucoalesce(i_class_id#5972, 0), gpuisnull(i_class_id#5972), gpucoalesce(i_category_id#5974, 0), gpuisnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#99692]
                                       :                                :                 :                                                              +- GpuProject [i_brand_id#5970, i_class_id#5972, i_category_id#5974], true
                                       :                                :                 :                                                                 +- GpuShuffledHashJoin [ws_item_sk#479], [i_item_sk#5963], Inner, GpuBuildRight, false
                                       :                                :                 :                                                                    :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                                    :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                                    :     +- ShuffleQueryStage 138
                                       :                                :                 :                                                                    :        +- GpuColumnarExchange gpuhashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#89133]
                                       :                                :                 :                                                                    :           +- GpuProject [ws_item_sk#479], true
                                       :                                :                 :                                                                    :              +- GpuShuffledHashJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner, GpuBuildRight, false
                                       :                                :                 :                                                                    :                 :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :                                                                    :                 :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                                    :                 :     +- ShuffleQueryStage 9
                                       :                                :                 :                                                                    :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#63835]
                                       :                                :                 :                                                                    :                 :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :                                                                    :                 :              +- GpuFilter (gpuisnotnull(ws_sold_date_sk#476) AND gpuisnotnull(ws_item_sk#479)), true
                                       :                                :                 :                                                                    :                 :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :                                :                 :                                                                    :                 +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                                    :                    +- ShuffleQueryStage 11
                                       :                                :                 :                                                                    :                       +- ReusedExchange [d_date_sk#5985], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                       :                                :                 :                                                                    +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                                                                       +- ShuffleQueryStage 13
                                       :                                :                 :                                                                          +- ReusedExchange [i_item_sk#5963, i_brand_id#5970, i_class_id#5972, i_category_id#5974], GpuColumnarExchange gpuhashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#63748]
                                       :                                :                 +- GpuCustomShuffleReader coalesced
                                       :                                :                    +- ShuffleQueryStage 14
                                       :                                :                       +- GpuColumnarExchange gpuhashpartitioning(d_date_sk#6233, 200), ENSURE_REQUIREMENTS, [id=#63963]
                                       :                                :                          +- GpuProject [d_date_sk#6233], true
                                       :                                :                             +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                                +- GpuFilter ((((gpuisnotnull(d_year#6239) AND gpuisnotnull(d_moy#6241)) AND (d_year#6239 = 2001)) AND (d_moy#6241 = 11)) AND gpuisnotnull(d_date_sk#6233)), true
                                       :                                :                                   +- GpuFileGpuScan parquet [d_date_sk#6233,d_year#6239,d_moy#6241] Batched: true, DataFilters: [isnotnull(d_year#6239), isnotnull(d_moy#6241), (d_year#6239 = 2001), (d_moy#6241 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                                       :                                +- GpuCoalesceBatches RequireSingleBatchWithFilter
                                       :                                   +- GpuShuffledHashJoin [i_item_sk#6211], [ss_item_sk#5883], LeftSemi, GpuBuildRight, false
                                       :                                      :- GpuShuffleCoalesce 2147483647
                                       :                                      :  +- GpuCustomShuffleReader coalesced
                                       :                                      :     +- ShuffleQueryStage 16
                                       :                                      :        +- ReusedExchange [i_item_sk#6211, i_brand_id#6218, i_class_id#6220, i_category_id#6222], GpuColumnarExchange gpuhashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#63748]
                                       :                                      +- GpuCustomShuffleReader coalesced
                                       :                                         +- ShuffleQueryStage 228
                                       :                                            +- ReusedExchange [ss_item_sk#5883], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#114426]
                                       :- GpuProject [sales#5871, number_sales#5872L, catalog AS channel#6473, i_brand_id#6302, i_class_id#6304, i_category_id#6306], true
                                       :  +- GpuRowToColumnar targetsize(2147483647)
                                       :     +- *(5) Filter (isnotnull(sales#5871) AND (cast(sales#5871 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#5869, [id=#54909] as decimal(32,6))))
                                       :        :  +- ReusedSubquery Subquery subquery#5869, [id=#54909]
                                       :        +- *(5) HashAggregate(keys=[i_brand_id#6302, i_class_id#6304, i_category_id#6306], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#6279 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#6281 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#6302, i_class_id#6304, i_category_id#6306, sales#5871, number_sales#5872L])
                                       :           +- AQEShuffleRead coalesced
                                       :              +- ShuffleQueryStage 244
                                       :                 +- Exchange hashpartitioning(i_brand_id#6302, i_class_id#6304, i_category_id#6306, 200), ENSURE_REQUIREMENTS, [id=#117703]
                                       :                    +- *(2) HashAggregate(keys=[i_brand_id#6302, i_class_id#6304, i_category_id#6306], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#6279 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#6281 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#6302, i_class_id#6304, i_category_id#6306, sum#6496, isEmpty#6497, count#6498L])
                                       :                       +- GpuColumnarToRow false
                                       :                          +- GpuProject [cs_quantity#6279, cs_list_price#6281, i_brand_id#6302, i_class_id#6304, i_category_id#6306], true
                                       :                             +- GpuShuffledHashJoin [cs_item_sk#6276], [i_item_sk#6295], Inner, GpuBuildRight, false
                                       :                                :- GpuShuffleCoalesce 2147483647
                                       :                                :  +- GpuCustomShuffleReader coalesced
                                       :                                :     +- ShuffleQueryStage 241
                                       :                                :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#6276, 200), ENSURE_REQUIREMENTS, [id=#116531]
                                       :                                :           +- GpuProject [cs_item_sk#6276, cs_quantity#6279, cs_list_price#6281], true
                                       :                                :              +- GpuShuffledHashJoin [cs_sold_date_sk#6261], [d_date_sk#6317], Inner, GpuBuildRight, false
                                       :                                :                 :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :     +- ShuffleQueryStage 238
                                       :                                :                 :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#6261, 200), ENSURE_REQUIREMENTS, [id=#115503]
                                       :                                :                 :           +- GpuShuffledHashJoin [cs_item_sk#6276], [ss_item_sk#5883], LeftSemi, GpuBuildRight, false
                                       :                                :                 :              :- GpuShuffleCoalesce 2147483647
                                       :                                :                 :              :  +- GpuCustomShuffleReader coalesced
                                       :                                :                 :              :     +- ShuffleQueryStage 37
                                       :                                :                 :              :        +- GpuColumnarExchange gpuhashpartitioning(cs_item_sk#6276, 200), ENSURE_REQUIREMENTS, [id=#64407]
                                       :                                :                 :              :           +- GpuCoalesceBatches targetsize(2147483647)
                                       :                                :                 :              :              +- GpuFilter (gpuisnotnull(cs_sold_date_sk#6261) AND gpuisnotnull(cs_item_sk#6276)), true
                                       :                                :                 :              :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#6261,cs_item_sk#6276,cs_quantity#6279,cs_list_price#6281] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6261), isnotnull(cs_item_sk#6276)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                       :                                :                 :              +- GpuCustomShuffleReader coalesced
                                       :                                :                 :                 +- ShuffleQueryStage 230
                                       :                                :                 :                    +- ReusedExchange [ss_item_sk#5883], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#114426]
                                       :                                :                 +- GpuCustomShuffleReader coalesced
                                       :                                :                    +- ShuffleQueryStage 59
                                       :                                :                       +- ReusedExchange [d_date_sk#6317], GpuColumnarExchange gpuhashpartitioning(d_date_sk#6233, 200), ENSURE_REQUIREMENTS, [id=#63963]
                                       :                                +- GpuCoalesceBatches RequireSingleBatchWithFilter
                                       :                                   +- GpuShuffledHashJoin [i_item_sk#6295], [ss_item_sk#5883], LeftSemi, GpuBuildRight, false
                                       :                                      :- GpuShuffleCoalesce 2147483647
                                       :                                      :  +- GpuCustomShuffleReader coalesced
                                       :                                      :     +- ShuffleQueryStage 61
                                       :                                      :        +- ReusedExchange [i_item_sk#6295, i_brand_id#6302, i_class_id#6304, i_category_id#6306], GpuColumnarExchange gpuhashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#63748]
                                       :                                      +- GpuCustomShuffleReader coalesced
                                       :                                         +- ShuffleQueryStage 232
                                       :                                            +- ReusedExchange [ss_item_sk#5883], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#114426]
                                       +- GpuProject [sales#5876, number_sales#5877L, web AS channel#6477, i_brand_id#6386, i_class_id#6388, i_category_id#6390], true
                                          +- GpuRowToColumnar targetsize(2147483647)
                                             +- *(6) Filter (isnotnull(sales#5876) AND (cast(sales#5876 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#5869, [id=#54909] as decimal(32,6))))
                                                :  +- ReusedSubquery Subquery subquery#5869, [id=#54909]
                                                +- *(6) HashAggregate(keys=[i_brand_id#6386, i_class_id#6388, i_category_id#6390], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#6363 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#6365 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#6386, i_class_id#6388, i_category_id#6390, sales#5876, number_sales#5877L])
                                                   +- AQEShuffleRead coalesced
                                                      +- ShuffleQueryStage 245
                                                         +- Exchange hashpartitioning(i_brand_id#6386, i_class_id#6388, i_category_id#6390, 200), ENSURE_REQUIREMENTS, [id=#117992]
                                                            +- *(3) HashAggregate(keys=[i_brand_id#6386, i_class_id#6388, i_category_id#6390], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#6363 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#6365 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#6386, i_class_id#6388, i_category_id#6390, sum#6502, isEmpty#6503, count#6504L])
                                                               +- GpuColumnarToRow false
                                                                  +- GpuProject [ws_quantity#6363, ws_list_price#6365, i_brand_id#6386, i_class_id#6388, i_category_id#6390], true
                                                                     +- GpuShuffledHashJoin [ws_item_sk#6348], [i_item_sk#6379], Inner, GpuBuildRight, false
                                                                        :- GpuShuffleCoalesce 2147483647
                                                                        :  +- GpuCustomShuffleReader coalesced
                                                                        :     +- ShuffleQueryStage 242
                                                                        :        +- GpuColumnarExchange gpuhashpartitioning(ws_item_sk#6348, 200), ENSURE_REQUIREMENTS, [id=#116940]
                                                                        :           +- GpuProject [ws_item_sk#6348, ws_quantity#6363, ws_list_price#6365], true
                                                                        :              +- GpuShuffledHashJoin [ws_sold_date_sk#6345], [d_date_sk#6401], Inner, GpuBuildRight, false
                                                                        :                 :- GpuShuffleCoalesce 2147483647
                                                                        :                 :  +- GpuCustomShuffleReader coalesced
                                                                        :                 :     +- ShuffleQueryStage 239
                                                                        :                 :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#6345, 200), ENSURE_REQUIREMENTS, [id=#115568]
                                                                        :                 :           +- GpuShuffledHashJoin [ws_item_sk#6348], [ss_item_sk#5883], LeftSemi, GpuBuildRight, false
                                                                        :                 :              :- GpuShuffleCoalesce 2147483647
                                                                        :                 :              :  +- GpuCustomShuffleReader coalesced
                                                                        :                 :              :     +- ShuffleQueryStage 82
                                                                        :                 :              :        +- GpuColumnarExchange gpuhashpartitioning(ws_item_sk#6348, 200), ENSURE_REQUIREMENTS, [id=#65265]
                                                                        :                 :              :           +- GpuCoalesceBatches targetsize(2147483647)
                                                                        :                 :              :              +- GpuFilter (gpuisnotnull(ws_sold_date_sk#6345) AND gpuisnotnull(ws_item_sk#6348)), true
                                                                        :                 :              :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#6345,ws_item_sk#6348,ws_quantity#6363,ws_list_price#6365] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6345), isnotnull(ws_item_sk#6348)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                                        :                 :              +- GpuCustomShuffleReader coalesced
                                                                        :                 :                 +- ShuffleQueryStage 234
                                                                        :                 :                    +- ReusedExchange [ss_item_sk#5883], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#114426]
                                                                        :                 +- GpuCustomShuffleReader coalesced
                                                                        :                    +- ShuffleQueryStage 104
                                                                        :                       +- ReusedExchange [d_date_sk#6401], GpuColumnarExchange gpuhashpartitioning(d_date_sk#6233, 200), ENSURE_REQUIREMENTS, [id=#63963]
                                                                        +- GpuCoalesceBatches RequireSingleBatchWithFilter
                                                                           +- GpuShuffledHashJoin [i_item_sk#6379], [ss_item_sk#5883], LeftSemi, GpuBuildRight, false
                                                                              :- GpuShuffleCoalesce 2147483647
                                                                              :  +- GpuCustomShuffleReader coalesced
                                                                              :     +- ShuffleQueryStage 106
                                                                              :        +- ReusedExchange [i_item_sk#6379, i_brand_id#6386, i_class_id#6388, i_category_id#6390], GpuColumnarExchange gpuhashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#63748]
                                                                              +- GpuCustomShuffleReader coalesced
                                                                                 +- ShuffleQueryStage 236
                                                                                    +- ReusedExchange [ss_item_sk#5883], GpuColumnarExchange gpuhashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#114426]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#6460 ASC NULLS FIRST,i_brand_id#6461 ASC NULLS FIRST,i_class_id#6462 ASC NULLS FIRST,i_category_id#6463 ASC NULLS FIRST], output=[channel#6460,i_brand_id#6461,i_class_id#6462,i_category_id#6463,sum(sales)#6450,sum(number_sales)#6451L])
   +- HashAggregate(keys=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L], functions=[sum(sales#5866), sum(number_sales#5867L)], output=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, sum(sales)#6450, sum(number_sales)#6451L])
      +- Exchange hashpartitioning(channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L, 200), ENSURE_REQUIREMENTS, [id=#56027]
         +- HashAggregate(keys=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L], functions=[partial_sum(sales#5866), partial_sum(number_sales#5867L)], output=[channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L, sum#6484, isEmpty#6485, sum#6486L])
            +- Expand [[sales#5866, number_sales#5867L, channel#6455, i_brand_id#6218, i_class_id#6220, i_category_id#6222, 0], [sales#5866, number_sales#5867L, channel#6455, i_brand_id#6218, i_class_id#6220, null, 1], [sales#5866, number_sales#5867L, channel#6455, i_brand_id#6218, null, null, 3], [sales#5866, number_sales#5867L, channel#6455, null, null, null, 7], [sales#5866, number_sales#5867L, null, null, null, null, 15]], [sales#5866, number_sales#5867L, channel#6460, i_brand_id#6461, i_class_id#6462, i_category_id#6463, spark_grouping_id#6459L]
               +- Union
                  :- Project [sales#5866, number_sales#5867L, store AS channel#6455, i_brand_id#6218, i_class_id#6220, i_category_id#6222]
                  :  +- Filter (isnotnull(sales#5866) AND (cast(sales#5866 as decimal(32,6)) > cast(Subquery subquery#5869, [id=#54909] as decimal(32,6))))
                  :     :  +- Subquery subquery#5869, [id=#54909]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=true
                              +- == Final Plan ==
                                 *(2) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5890])
                                 +- ShuffleQueryStage 9
                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#119386]
                                       +- *(1) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6507, count#6508L])
                                          +- GpuColumnarToRow false
                                             +- GpuUnion
                                                :- GpuProject [ss_quantity#6023 AS quantity#5884, ss_list_price#6025 AS list_price#5885], true
                                                :  +- GpuShuffledHashJoin [ss_sold_date_sk#6013], [d_date_sk#6036], Inner, GpuBuildRight, false
                                                :     :- GpuShuffleCoalesce 2147483647
                                                :     :  +- GpuCustomShuffleReader coalesced
                                                :     :     +- ShuffleQueryStage 0
                                                :     :        +- GpuColumnarExchange gpuhashpartitioning(ss_sold_date_sk#6013, 200), ENSURE_REQUIREMENTS, [id=#118552]
                                                :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                                :     :              +- GpuFilter gpuisnotnull(ss_sold_date_sk#6013), true
                                                :     :                 +- GpuFileGpuScan parquet [ss_sold_date_sk#6013,ss_quantity#6023,ss_list_price#6025] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6013)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                :     +- GpuCustomShuffleReader coalesced
                                                :        +- ShuffleQueryStage 2
                                                :           +- ReusedExchange [d_date_sk#6036], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                                :- GpuProject [cs_quantity#6082 AS quantity#5886, cs_list_price#6084 AS list_price#5887], true
                                                :  +- GpuShuffledHashJoin [cs_sold_date_sk#6064], [d_date_sk#6098], Inner, GpuBuildRight, false
                                                :     :- GpuShuffleCoalesce 2147483647
                                                :     :  +- GpuCustomShuffleReader coalesced
                                                :     :     +- ShuffleQueryStage 3
                                                :     :        +- GpuColumnarExchange gpuhashpartitioning(cs_sold_date_sk#6064, 200), ENSURE_REQUIREMENTS, [id=#118623]
                                                :     :           +- GpuCoalesceBatches targetsize(2147483647)
                                                :     :              +- GpuFilter gpuisnotnull(cs_sold_date_sk#6064), true
                                                :     :                 +- GpuFileGpuScan parquet [cs_sold_date_sk#6064,cs_quantity#6082,cs_list_price#6084] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6064)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                :     +- GpuCustomShuffleReader coalesced
                                                :        +- ShuffleQueryStage 5
                                                :           +- ReusedExchange [d_date_sk#6098], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                                                +- GpuProject [ws_quantity#6144 AS quantity#5888, ws_list_price#6146 AS list_price#5889], true
                                                   +- GpuShuffledHashJoin [ws_sold_date_sk#6126], [d_date_sk#6160], Inner, GpuBuildRight, false
                                                      :- GpuShuffleCoalesce 2147483647
                                                      :  +- GpuCustomShuffleReader coalesced
                                                      :     +- ShuffleQueryStage 6
                                                      :        +- GpuColumnarExchange gpuhashpartitioning(ws_sold_date_sk#6126, 200), ENSURE_REQUIREMENTS, [id=#118694]
                                                      :           +- GpuCoalesceBatches targetsize(2147483647)
                                                      :              +- GpuFilter gpuisnotnull(ws_sold_date_sk#6126), true
                                                      :                 +- GpuFileGpuScan parquet [ws_sold_date_sk#6126,ws_quantity#6144,ws_list_price#6146] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6126)], Format: Parquet, Location: InMemoryFileIndex[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                      +- GpuCustomShuffleReader coalesced
                                                         +- ShuffleQueryStage 8
                                                            +- ReusedExchange [d_date_sk#6160], GpuColumnarExchange gpuhashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#63714]
                              +- == Initial Plan ==
                                 HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5890])
                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#54802]
                                    +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6507, count#6508L])
                                       +- Union
                                          :- Project [ss_quantity#6023 AS quantity#5884, ss_list_price#6025 AS list_price#5885]
                                          :  +- SortMergeJoin [ss_sold_date_sk#6013], [d_date_sk#6036], Inner
                                          :     :- Sort [ss_sold_date_sk#6013 ASC NULLS FIRST], false, 0
                                          :     :  +- Exchange hashpartitioning(ss_sold_date_sk#6013, 200), ENSURE_REQUIREMENTS, [id=#54779]
                                          :     :     +- Filter isnotnull(ss_sold_date_sk#6013)
                                          :     :        +- FileScan parquet [ss_sold_date_sk#6013,ss_quantity#6023,ss_list_price#6025] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6013)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                          :     +- Sort [d_date_sk#6036 ASC NULLS FIRST], false, 0
                                          :        +- Exchange hashpartitioning(d_date_sk#6036, 200), ENSURE_REQUIREMENTS, [id=#54780]
                                          :           +- Project [d_date_sk#6036]
                                          :              +- Filter (((isnotnull(d_year#6042) AND (d_year#6042 >= 1999)) AND (d_year#6042 <= 2001)) AND isnotnull(d_date_sk#6036))
                                          :                 +- FileScan parquet [d_date_sk#6036,d_year#6042] Batched: true, DataFilters: [isnotnull(d_year#6042), (d_year#6042 >= 1999), (d_year#6042 <= 2001), isnotnull(d_date_sk#6036)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          :- Project [cs_quantity#6082 AS quantity#5886, cs_list_price#6084 AS list_price#5887]
                                          :  +- SortMergeJoin [cs_sold_date_sk#6064], [d_date_sk#6098], Inner
                                          :     :- Sort [cs_sold_date_sk#6064 ASC NULLS FIRST], false, 0
                                          :     :  +- Exchange hashpartitioning(cs_sold_date_sk#6064, 200), ENSURE_REQUIREMENTS, [id=#54786]
                                          :     :     +- Filter isnotnull(cs_sold_date_sk#6064)
                                          :     :        +- FileScan parquet [cs_sold_date_sk#6064,cs_quantity#6082,cs_list_price#6084] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6064)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                          :     +- Sort [d_date_sk#6098 ASC NULLS FIRST], false, 0
                                          :        +- Exchange hashpartitioning(d_date_sk#6098, 200), ENSURE_REQUIREMENTS, [id=#54787]
                                          :           +- Project [d_date_sk#6098]
                                          :              +- Filter (((isnotnull(d_year#6104) AND (d_year#6104 >= 1999)) AND (d_year#6104 <= 2001)) AND isnotnull(d_date_sk#6098))
                                          :                 +- FileScan parquet [d_date_sk#6098,d_year#6104] Batched: true, DataFilters: [isnotnull(d_year#6104), (d_year#6104 >= 1999), (d_year#6104 <= 2001), isnotnull(d_date_sk#6098)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          +- Project [ws_quantity#6144 AS quantity#5888, ws_list_price#6146 AS list_price#5889]
                                             +- SortMergeJoin [ws_sold_date_sk#6126], [d_date_sk#6160], Inner
                                                :- Sort [ws_sold_date_sk#6126 ASC NULLS FIRST], false, 0
                                                :  +- Exchange hashpartitioning(ws_sold_date_sk#6126, 200), ENSURE_REQUIREMENTS, [id=#54793]
                                                :     +- Filter isnotnull(ws_sold_date_sk#6126)
                                                :        +- FileScan parquet [ws_sold_date_sk#6126,ws_quantity#6144,ws_list_price#6146] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6126)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                +- Sort [d_date_sk#6160 ASC NULLS FIRST], false, 0
                                                   +- Exchange hashpartitioning(d_date_sk#6160, 200), ENSURE_REQUIREMENTS, [id=#54794]
                                                      +- Project [d_date_sk#6160]
                                                         +- Filter (((isnotnull(d_year#6166) AND (d_year#6166 >= 1999)) AND (d_year#6166 <= 2001)) AND isnotnull(d_date_sk#6160))
                                                            +- FileScan parquet [d_date_sk#6160,d_year#6166] Batched: true, DataFilters: [isnotnull(d_year#6166), (d_year#6166 >= 1999), (d_year#6166 <= 2001), isnotnull(d_date_sk#6160)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#6218, i_class_id#6220, i_category_id#6222], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6198 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#6200 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#6218, i_class_id#6220, i_category_id#6222, sales#5866, number_sales#5867L])
                  :        +- Exchange hashpartitioning(i_brand_id#6218, i_class_id#6220, i_category_id#6222, 200), ENSURE_REQUIREMENTS, [id=#55651]
                  :           +- HashAggregate(keys=[i_brand_id#6218, i_class_id#6220, i_category_id#6222], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#6198 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#6200 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#6218, i_class_id#6220, i_category_id#6222, sum#6490, isEmpty#6491, count#6492L])
                  :              +- Project [ss_quantity#6198, ss_list_price#6200, i_brand_id#6218, i_class_id#6220, i_category_id#6222]
                  :                 +- SortMergeJoin [ss_item_sk#6190], [i_item_sk#6211], Inner
                  :                    :- Sort [ss_item_sk#6190 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(ss_item_sk#6190, 200), ENSURE_REQUIREMENTS, [id=#55645]
                  :                    :     +- Project [ss_item_sk#6190, ss_quantity#6198, ss_list_price#6200]
                  :                    :        +- SortMergeJoin [ss_sold_date_sk#6188], [d_date_sk#6233], Inner
                  :                    :           :- Sort [ss_sold_date_sk#6188 ASC NULLS FIRST], false, 0
                  :                    :           :  +- Exchange hashpartitioning(ss_sold_date_sk#6188, 200), ENSURE_REQUIREMENTS, [id=#55555]
                  :                    :           :     +- SortMergeJoin [ss_item_sk#6190], [ss_item_sk#5883], LeftSemi
                  :                    :           :        :- Sort [ss_item_sk#6190 ASC NULLS FIRST], false, 0
                  :                    :           :        :  +- Exchange hashpartitioning(ss_item_sk#6190, 200), ENSURE_REQUIREMENTS, [id=#55548]
                  :                    :           :        :     +- Filter (isnotnull(ss_sold_date_sk#6188) AND isnotnull(ss_item_sk#6190))
                  :                    :           :        :        +- FileScan parquet [ss_sold_date_sk#6188,ss_item_sk#6190,ss_quantity#6198,ss_list_price#6200] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6188), isnotnull(ss_item_sk#6190)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk), IsNotNull(ss_item_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :                    :           :        +- Sort [ss_item_sk#5883 ASC NULLS FIRST], false, 0
                  :                    :           :           +- Exchange hashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#55549]
                  :                    :           :              +- Project [i_item_sk#668 AS ss_item_sk#5883]
                  :                    :           :                 +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner
                  :                    :           :                    :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                    :           :                    :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#55541]
                  :                    :           :                    :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                    :           :                    :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                    +- Sort [brand_id#5880 ASC NULLS FIRST, class_id#5881 ASC NULLS FIRST, category_id#5882 ASC NULLS FIRST], false, 0
                  :                    :           :                       +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                          +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55537]
                  :                    :           :                             +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                                +- SortMergeJoin [coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882)], [coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974)], LeftSemi
                  :                    :           :                                   :- Sort [coalesce(brand_id#5880, 0) ASC NULLS FIRST, isnull(brand_id#5880) ASC NULLS FIRST, coalesce(class_id#5881, 0) ASC NULLS FIRST, isnull(class_id#5881) ASC NULLS FIRST, coalesce(category_id#5882, 0) ASC NULLS FIRST, isnull(category_id#5882) ASC NULLS FIRST], false, 0
                  :                    :           :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#55530]
                  :                    :           :                                   :     +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                                   :        +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55511]
                  :                    :           :                                   :           +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                                   :              +- Project [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882]
                  :                    :           :                                   :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                    :           :                                   :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#55503]
                  :                    :           :                                   :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902]
                  :                    :           :                                   :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5891], Inner
                  :                    :           :                                   :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#55495]
                  :                    :           :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                    :           :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :           :                                   :                    :           +- Sort [i_item_sk#5891 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#55496]
                  :                    :           :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902)], [coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924)], LeftSemi
                  :                    :           :                                   :                    :                    :- Sort [coalesce(i_brand_id#5898, 0) ASC NULLS FIRST, isnull(i_brand_id#5898) ASC NULLS FIRST, coalesce(i_class_id#5900, 0) ASC NULLS FIRST, isnull(i_class_id#5900) ASC NULLS FIRST, coalesce(i_category_id#5902, 0) ASC NULLS FIRST, isnull(i_category_id#5902) ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#55488]
                  :                    :           :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#5891) AND isnotnull(i_brand_id#5898)) AND isnotnull(i_class_id#5900)) AND isnotnull(i_category_id#5902))
                  :                    :           :                                   :                    :                    :        +- FileScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                   :                    :                    +- Sort [coalesce(i_brand_id#5920, 0) ASC NULLS FIRST, isnull(i_brand_id#5920) ASC NULLS FIRST, coalesce(i_class_id#5922, 0) ASC NULLS FIRST, isnull(i_class_id#5922) ASC NULLS FIRST, coalesce(i_category_id#5924, 0) ASC NULLS FIRST, isnull(i_category_id#5924) ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#55489]
                  :                    :           :                                   :                    :                          +- Project [i_brand_id#5920, i_class_id#5922, i_category_id#5924]
                  :                    :           :                                   :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5913], Inner
                  :                    :           :                                   :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#55480]
                  :                    :           :                                   :                    :                                :     +- Project [cs_item_sk#559]
                  :                    :           :                                   :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner
                  :                    :           :                                   :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#55472]
                  :                    :           :                                   :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                  :                    :           :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :           :                                   :                    :                                :           +- Sort [d_date_sk#5935 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                :              +- Exchange hashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#55473]
                  :                    :           :                                   :                    :                                :                 +- Project [d_date_sk#5935]
                  :                    :           :                                   :                    :                                :                    +- Filter (((isnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND isnotnull(d_date_sk#5935))
                  :                    :           :                                   :                    :                                :                       +- FileScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                                   :                    :                                +- Sort [i_item_sk#5913 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                   +- Exchange hashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#55481]
                  :                    :           :                                   :                    :                                      +- Filter isnotnull(i_item_sk#5913)
                  :                    :           :                                   :                    :                                         +- FileScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                   :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#55504]
                  :                    :           :                                   :                          +- Project [d_date_sk#612]
                  :                    :           :                                   :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                    :           :                                   :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                                   +- Sort [coalesce(i_brand_id#5970, 0) ASC NULLS FIRST, isnull(i_brand_id#5970) ASC NULLS FIRST, coalesce(i_class_id#5972, 0) ASC NULLS FIRST, isnull(i_class_id#5972) ASC NULLS FIRST, coalesce(i_category_id#5974, 0) ASC NULLS FIRST, isnull(i_category_id#5974) ASC NULLS FIRST], false, 0
                  :                    :           :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#55531]
                  :                    :           :                                         +- Project [i_brand_id#5970, i_class_id#5972, i_category_id#5974]
                  :                    :           :                                            +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5963], Inner
                  :                    :           :                                               :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                    :           :                                               :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#55522]
                  :                    :           :                                               :     +- Project [ws_item_sk#479]
                  :                    :           :                                               :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner
                  :                    :           :                                               :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                    :           :                                               :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#55514]
                  :                    :           :                                               :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                  :                    :           :                                               :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :           :                                               :           +- Sort [d_date_sk#5985 ASC NULLS FIRST], false, 0
                  :                    :           :                                               :              +- Exchange hashpartitioning(d_date_sk#5985, 200), ENSURE_REQUIREMENTS, [id=#55515]
                  :                    :           :                                               :                 +- Project [d_date_sk#5985]
                  :                    :           :                                               :                    +- Filter (((isnotnull(d_year#5991) AND (d_year#5991 >= 1999)) AND (d_year#5991 <= 2001)) AND isnotnull(d_date_sk#5985))
                  :                    :           :                                               :                       +- FileScan parquet [d_date_sk#5985,d_year#5991] Batched: true, DataFilters: [isnotnull(d_year#5991), (d_year#5991 >= 1999), (d_year#5991 <= 2001), isnotnull(d_date_sk#5985)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                                               +- Sort [i_item_sk#5963 ASC NULLS FIRST], false, 0
                  :                    :           :                                                  +- Exchange hashpartitioning(i_item_sk#5963, 200), ENSURE_REQUIREMENTS, [id=#55523]
                  :                    :           :                                                     +- Filter isnotnull(i_item_sk#5963)
                  :                    :           :                                                        +- FileScan parquet [i_item_sk#5963,i_brand_id#5970,i_class_id#5972,i_category_id#5974] Batched: true, DataFilters: [isnotnull(i_item_sk#5963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           +- Sort [d_date_sk#6233 ASC NULLS FIRST], false, 0
                  :                    :              +- Exchange hashpartitioning(d_date_sk#6233, 200), ENSURE_REQUIREMENTS, [id=#55556]
                  :                    :                 +- Project [d_date_sk#6233]
                  :                    :                    +- Filter ((((isnotnull(d_year#6239) AND isnotnull(d_moy#6241)) AND (d_year#6239 = 2001)) AND (d_moy#6241 = 11)) AND isnotnull(d_date_sk#6233))
                  :                    :                       +- FileScan parquet [d_date_sk#6233,d_year#6239,d_moy#6241] Batched: true, DataFilters: [isnotnull(d_year#6239), isnotnull(d_moy#6241), (d_year#6239 = 2001), (d_moy#6241 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  :                    +- SortMergeJoin [i_item_sk#6211], [ss_item_sk#5883], LeftSemi
                  :                       :- Sort [i_item_sk#6211 ASC NULLS FIRST], false, 0
                  :                       :  +- Exchange hashpartitioning(i_item_sk#6211, 200), ENSURE_REQUIREMENTS, [id=#55638]
                  :                       :     +- Filter isnotnull(i_item_sk#6211)
                  :                       :        +- FileScan parquet [i_item_sk#6211,i_brand_id#6218,i_class_id#6220,i_category_id#6222] Batched: true, DataFilters: [isnotnull(i_item_sk#6211)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                       +- Sort [ss_item_sk#5883 ASC NULLS FIRST], false, 0
                  :                          +- Exchange hashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#55639]
                  :                             +- Project [i_item_sk#668 AS ss_item_sk#5883]
                  :                                +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner
                  :                                   :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                                   :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#55631]
                  :                                   :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                                   :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                                   +- Sort [brand_id#5880 ASC NULLS FIRST, class_id#5881 ASC NULLS FIRST, category_id#5882 ASC NULLS FIRST], false, 0
                  :                                      +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                         +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55627]
                  :                                            +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                               +- SortMergeJoin [coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882)], [coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974)], LeftSemi
                  :                                                  :- Sort [coalesce(brand_id#5880, 0) ASC NULLS FIRST, isnull(brand_id#5880) ASC NULLS FIRST, coalesce(class_id#5881, 0) ASC NULLS FIRST, isnull(class_id#5881) ASC NULLS FIRST, coalesce(category_id#5882, 0) ASC NULLS FIRST, isnull(category_id#5882) ASC NULLS FIRST], false, 0
                  :                                                  :  +- Exchange hashpartitioning(coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#55620]
                  :                                                  :     +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                                  :        +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55601]
                  :                                                  :           +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                                  :              +- Project [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882]
                  :                                                  :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                                                  :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                                                  :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#55593]
                  :                                                  :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902]
                  :                                                  :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5891], Inner
                  :                                                  :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                                                  :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#55585]
                  :                                                  :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                                                  :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                                                  :                    :           +- Sort [i_item_sk#5891 ASC NULLS FIRST], false, 0
                  :                                                  :                    :              +- Exchange hashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#55586]
                  :                                                  :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902)], [coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924)], LeftSemi
                  :                                                  :                    :                    :- Sort [coalesce(i_brand_id#5898, 0) ASC NULLS FIRST, isnull(i_brand_id#5898) ASC NULLS FIRST, coalesce(i_class_id#5900, 0) ASC NULLS FIRST, isnull(i_class_id#5900) ASC NULLS FIRST, coalesce(i_category_id#5902, 0) ASC NULLS FIRST, isnull(i_category_id#5902) ASC NULLS FIRST], false, 0
                  :                                                  :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#55578]
                  :                                                  :                    :                    :     +- Filter (((isnotnull(i_item_sk#5891) AND isnotnull(i_brand_id#5898)) AND isnotnull(i_class_id#5900)) AND isnotnull(i_category_id#5902))
                  :                                                  :                    :                    :        +- FileScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                                                  :                    :                    +- Sort [coalesce(i_brand_id#5920, 0) ASC NULLS FIRST, isnull(i_brand_id#5920) ASC NULLS FIRST, coalesce(i_class_id#5922, 0) ASC NULLS FIRST, isnull(i_class_id#5922) ASC NULLS FIRST, coalesce(i_category_id#5924, 0) ASC NULLS FIRST, isnull(i_category_id#5924) ASC NULLS FIRST], false, 0
                  :                                                  :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#55579]
                  :                                                  :                    :                          +- Project [i_brand_id#5920, i_class_id#5922, i_category_id#5924]
                  :                                                  :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5913], Inner
                  :                                                  :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#55570]
                  :                                                  :                    :                                :     +- Project [cs_item_sk#559]
                  :                                                  :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner
                  :                                                  :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#55562]
                  :                                                  :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                  :                                                  :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                                                  :                    :                                :           +- Sort [d_date_sk#5935 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                :              +- Exchange hashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#55563]
                  :                                                  :                    :                                :                 +- Project [d_date_sk#5935]
                  :                                                  :                    :                                :                    +- Filter (((isnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND isnotnull(d_date_sk#5935))
                  :                                                  :                    :                                :                       +- FileScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                                                  :                    :                                +- Sort [i_item_sk#5913 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                   +- Exchange hashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#55571]
                  :                                                  :                    :                                      +- Filter isnotnull(i_item_sk#5913)
                  :                                                  :                    :                                         +- FileScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                                                  :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                                                  :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#55594]
                  :                                                  :                          +- Project [d_date_sk#612]
                  :                                                  :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                                                  :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                                                  +- Sort [coalesce(i_brand_id#5970, 0) ASC NULLS FIRST, isnull(i_brand_id#5970) ASC NULLS FIRST, coalesce(i_class_id#5972, 0) ASC NULLS FIRST, isnull(i_class_id#5972) ASC NULLS FIRST, coalesce(i_category_id#5974, 0) ASC NULLS FIRST, isnull(i_category_id#5974) ASC NULLS FIRST], false, 0
                  :                                                     +- Exchange hashpartitioning(coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#55621]
                  :                                                        +- Project [i_brand_id#5970, i_class_id#5972, i_category_id#5974]
                  :                                                           +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5963], Inner
                  :                                                              :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                                                              :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#55612]
                  :                                                              :     +- Project [ws_item_sk#479]
                  :                                                              :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner
                  :                                                              :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                                                              :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#55604]
                  :                                                              :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                  :                                                              :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                                                              :           +- Sort [d_date_sk#5985 ASC NULLS FIRST], false, 0
                  :                                                              :              +- Exchange hashpartitioning(d_date_sk#5985, 200), ENSURE_REQUIREMENTS, [id=#55605]
                  :                                                              :                 +- Project [d_date_sk#5985]
                  :                                                              :                    +- Filter (((isnotnull(d_year#5991) AND (d_year#5991 >= 1999)) AND (d_year#5991 <= 2001)) AND isnotnull(d_date_sk#5985))
                  :                                                              :                       +- FileScan parquet [d_date_sk#5985,d_year#5991] Batched: true, DataFilters: [isnotnull(d_year#5991), (d_year#5991 >= 1999), (d_year#5991 <= 2001), isnotnull(d_date_sk#5985)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                                                              +- Sort [i_item_sk#5963 ASC NULLS FIRST], false, 0
                  :                                                                 +- Exchange hashpartitioning(i_item_sk#5963, 200), ENSURE_REQUIREMENTS, [id=#55613]
                  :                                                                    +- Filter isnotnull(i_item_sk#5963)
                  :                                                                       +- FileScan parquet [i_item_sk#5963,i_brand_id#5970,i_class_id#5972,i_category_id#5974] Batched: true, DataFilters: [isnotnull(i_item_sk#5963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :- Project [sales#5871, number_sales#5872L, catalog AS channel#6473, i_brand_id#6302, i_class_id#6304, i_category_id#6306]
                  :  +- Filter (isnotnull(sales#5871) AND (cast(sales#5871 as decimal(32,6)) > cast(Subquery subquery#5874, [id=#55106] as decimal(32,6))))
                  :     :  +- Subquery subquery#5874, [id=#55106]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=false
                  :     :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5890])
                  :     :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#54999]
                  :     :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6507, count#6508L])
                  :     :                 +- Union
                  :     :                    :- Project [ss_quantity#6023 AS quantity#5884, ss_list_price#6025 AS list_price#5885]
                  :     :                    :  +- SortMergeJoin [ss_sold_date_sk#6013], [d_date_sk#6036], Inner
                  :     :                    :     :- Sort [ss_sold_date_sk#6013 ASC NULLS FIRST], false, 0
                  :     :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#6013, 200), ENSURE_REQUIREMENTS, [id=#54976]
                  :     :                    :     :     +- Filter isnotnull(ss_sold_date_sk#6013)
                  :     :                    :     :        +- FileScan parquet [ss_sold_date_sk#6013,ss_quantity#6023,ss_list_price#6025] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6013)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :     :                    :     +- Sort [d_date_sk#6036 ASC NULLS FIRST], false, 0
                  :     :                    :        +- Exchange hashpartitioning(d_date_sk#6036, 200), ENSURE_REQUIREMENTS, [id=#54977]
                  :     :                    :           +- Project [d_date_sk#6036]
                  :     :                    :              +- Filter (((isnotnull(d_year#6042) AND (d_year#6042 >= 1999)) AND (d_year#6042 <= 2001)) AND isnotnull(d_date_sk#6036))
                  :     :                    :                 +- FileScan parquet [d_date_sk#6036,d_year#6042] Batched: true, DataFilters: [isnotnull(d_year#6042), (d_year#6042 >= 1999), (d_year#6042 <= 2001), isnotnull(d_date_sk#6036)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    :- Project [cs_quantity#6082 AS quantity#5886, cs_list_price#6084 AS list_price#5887]
                  :     :                    :  +- SortMergeJoin [cs_sold_date_sk#6064], [d_date_sk#6098], Inner
                  :     :                    :     :- Sort [cs_sold_date_sk#6064 ASC NULLS FIRST], false, 0
                  :     :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#6064, 200), ENSURE_REQUIREMENTS, [id=#54983]
                  :     :                    :     :     +- Filter isnotnull(cs_sold_date_sk#6064)
                  :     :                    :     :        +- FileScan parquet [cs_sold_date_sk#6064,cs_quantity#6082,cs_list_price#6084] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6064)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :     :                    :     +- Sort [d_date_sk#6098 ASC NULLS FIRST], false, 0
                  :     :                    :        +- Exchange hashpartitioning(d_date_sk#6098, 200), ENSURE_REQUIREMENTS, [id=#54984]
                  :     :                    :           +- Project [d_date_sk#6098]
                  :     :                    :              +- Filter (((isnotnull(d_year#6104) AND (d_year#6104 >= 1999)) AND (d_year#6104 <= 2001)) AND isnotnull(d_date_sk#6098))
                  :     :                    :                 +- FileScan parquet [d_date_sk#6098,d_year#6104] Batched: true, DataFilters: [isnotnull(d_year#6104), (d_year#6104 >= 1999), (d_year#6104 <= 2001), isnotnull(d_date_sk#6098)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    +- Project [ws_quantity#6144 AS quantity#5888, ws_list_price#6146 AS list_price#5889]
                  :     :                       +- SortMergeJoin [ws_sold_date_sk#6126], [d_date_sk#6160], Inner
                  :     :                          :- Sort [ws_sold_date_sk#6126 ASC NULLS FIRST], false, 0
                  :     :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#6126, 200), ENSURE_REQUIREMENTS, [id=#54990]
                  :     :                          :     +- Filter isnotnull(ws_sold_date_sk#6126)
                  :     :                          :        +- FileScan parquet [ws_sold_date_sk#6126,ws_quantity#6144,ws_list_price#6146] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6126)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                  :     :                          +- Sort [d_date_sk#6160 ASC NULLS FIRST], false, 0
                  :     :                             +- Exchange hashpartitioning(d_date_sk#6160, 200), ENSURE_REQUIREMENTS, [id=#54991]
                  :     :                                +- Project [d_date_sk#6160]
                  :     :                                   +- Filter (((isnotnull(d_year#6166) AND (d_year#6166 >= 1999)) AND (d_year#6166 <= 2001)) AND isnotnull(d_date_sk#6160))
                  :     :                                      +- FileScan parquet [d_date_sk#6160,d_year#6166] Batched: true, DataFilters: [isnotnull(d_year#6166), (d_year#6166 >= 1999), (d_year#6166 <= 2001), isnotnull(d_date_sk#6160)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#6302, i_class_id#6304, i_category_id#6306], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#6279 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#6281 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#6302, i_class_id#6304, i_category_id#6306, sales#5871, number_sales#5872L])
                  :        +- Exchange hashpartitioning(i_brand_id#6302, i_class_id#6304, i_category_id#6306, 200), ENSURE_REQUIREMENTS, [id=#55835]
                  :           +- HashAggregate(keys=[i_brand_id#6302, i_class_id#6304, i_category_id#6306], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#6279 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#6281 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#6302, i_class_id#6304, i_category_id#6306, sum#6496, isEmpty#6497, count#6498L])
                  :              +- Project [cs_quantity#6279, cs_list_price#6281, i_brand_id#6302, i_class_id#6304, i_category_id#6306]
                  :                 +- SortMergeJoin [cs_item_sk#6276], [i_item_sk#6295], Inner
                  :                    :- Sort [cs_item_sk#6276 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(cs_item_sk#6276, 200), ENSURE_REQUIREMENTS, [id=#55829]
                  :                    :     +- Project [cs_item_sk#6276, cs_quantity#6279, cs_list_price#6281]
                  :                    :        +- SortMergeJoin [cs_sold_date_sk#6261], [d_date_sk#6317], Inner
                  :                    :           :- Sort [cs_sold_date_sk#6261 ASC NULLS FIRST], false, 0
                  :                    :           :  +- Exchange hashpartitioning(cs_sold_date_sk#6261, 200), ENSURE_REQUIREMENTS, [id=#55739]
                  :                    :           :     +- SortMergeJoin [cs_item_sk#6276], [ss_item_sk#5883], LeftSemi
                  :                    :           :        :- Sort [cs_item_sk#6276 ASC NULLS FIRST], false, 0
                  :                    :           :        :  +- Exchange hashpartitioning(cs_item_sk#6276, 200), ENSURE_REQUIREMENTS, [id=#55732]
                  :                    :           :        :     +- Filter (isnotnull(cs_sold_date_sk#6261) AND isnotnull(cs_item_sk#6276))
                  :                    :           :        :        +- FileScan parquet [cs_sold_date_sk#6261,cs_item_sk#6276,cs_quantity#6279,cs_list_price#6281] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6261), isnotnull(cs_item_sk#6276)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :                    :           :        +- Sort [ss_item_sk#5883 ASC NULLS FIRST], false, 0
                  :                    :           :           +- Exchange hashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#55733]
                  :                    :           :              +- Project [i_item_sk#668 AS ss_item_sk#5883]
                  :                    :           :                 +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner
                  :                    :           :                    :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                    :           :                    :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#55725]
                  :                    :           :                    :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                    :           :                    :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                    +- Sort [brand_id#5880 ASC NULLS FIRST, class_id#5881 ASC NULLS FIRST, category_id#5882 ASC NULLS FIRST], false, 0
                  :                    :           :                       +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                          +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55721]
                  :                    :           :                             +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                                +- SortMergeJoin [coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882)], [coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974)], LeftSemi
                  :                    :           :                                   :- Sort [coalesce(brand_id#5880, 0) ASC NULLS FIRST, isnull(brand_id#5880) ASC NULLS FIRST, coalesce(class_id#5881, 0) ASC NULLS FIRST, isnull(class_id#5881) ASC NULLS FIRST, coalesce(category_id#5882, 0) ASC NULLS FIRST, isnull(category_id#5882) ASC NULLS FIRST], false, 0
                  :                    :           :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#55714]
                  :                    :           :                                   :     +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                                   :        +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55695]
                  :                    :           :                                   :           +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                    :           :                                   :              +- Project [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882]
                  :                    :           :                                   :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                    :           :                                   :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#55687]
                  :                    :           :                                   :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902]
                  :                    :           :                                   :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5891], Inner
                  :                    :           :                                   :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#55679]
                  :                    :           :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                    :           :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :           :                                   :                    :           +- Sort [i_item_sk#5891 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#55680]
                  :                    :           :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902)], [coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924)], LeftSemi
                  :                    :           :                                   :                    :                    :- Sort [coalesce(i_brand_id#5898, 0) ASC NULLS FIRST, isnull(i_brand_id#5898) ASC NULLS FIRST, coalesce(i_class_id#5900, 0) ASC NULLS FIRST, isnull(i_class_id#5900) ASC NULLS FIRST, coalesce(i_category_id#5902, 0) ASC NULLS FIRST, isnull(i_category_id#5902) ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#55672]
                  :                    :           :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#5891) AND isnotnull(i_brand_id#5898)) AND isnotnull(i_class_id#5900)) AND isnotnull(i_category_id#5902))
                  :                    :           :                                   :                    :                    :        +- FileScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                   :                    :                    +- Sort [coalesce(i_brand_id#5920, 0) ASC NULLS FIRST, isnull(i_brand_id#5920) ASC NULLS FIRST, coalesce(i_class_id#5922, 0) ASC NULLS FIRST, isnull(i_class_id#5922) ASC NULLS FIRST, coalesce(i_category_id#5924, 0) ASC NULLS FIRST, isnull(i_category_id#5924) ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#55673]
                  :                    :           :                                   :                    :                          +- Project [i_brand_id#5920, i_class_id#5922, i_category_id#5924]
                  :                    :           :                                   :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5913], Inner
                  :                    :           :                                   :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#55664]
                  :                    :           :                                   :                    :                                :     +- Project [cs_item_sk#559]
                  :                    :           :                                   :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner
                  :                    :           :                                   :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#55656]
                  :                    :           :                                   :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                  :                    :           :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :           :                                   :                    :                                :           +- Sort [d_date_sk#5935 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                :              +- Exchange hashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#55657]
                  :                    :           :                                   :                    :                                :                 +- Project [d_date_sk#5935]
                  :                    :           :                                   :                    :                                :                    +- Filter (((isnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND isnotnull(d_date_sk#5935))
                  :                    :           :                                   :                    :                                :                       +- FileScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                                   :                    :                                +- Sort [i_item_sk#5913 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                    :                                   +- Exchange hashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#55665]
                  :                    :           :                                   :                    :                                      +- Filter isnotnull(i_item_sk#5913)
                  :                    :           :                                   :                    :                                         +- FileScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                   :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                    :           :                                   :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#55688]
                  :                    :           :                                   :                          +- Project [d_date_sk#612]
                  :                    :           :                                   :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                    :           :                                   :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                                   +- Sort [coalesce(i_brand_id#5970, 0) ASC NULLS FIRST, isnull(i_brand_id#5970) ASC NULLS FIRST, coalesce(i_class_id#5972, 0) ASC NULLS FIRST, isnull(i_class_id#5972) ASC NULLS FIRST, coalesce(i_category_id#5974, 0) ASC NULLS FIRST, isnull(i_category_id#5974) ASC NULLS FIRST], false, 0
                  :                    :           :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#55715]
                  :                    :           :                                         +- Project [i_brand_id#5970, i_class_id#5972, i_category_id#5974]
                  :                    :           :                                            +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5963], Inner
                  :                    :           :                                               :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                    :           :                                               :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#55706]
                  :                    :           :                                               :     +- Project [ws_item_sk#479]
                  :                    :           :                                               :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner
                  :                    :           :                                               :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                    :           :                                               :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#55698]
                  :                    :           :                                               :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                  :                    :           :                                               :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :           :                                               :           +- Sort [d_date_sk#5985 ASC NULLS FIRST], false, 0
                  :                    :           :                                               :              +- Exchange hashpartitioning(d_date_sk#5985, 200), ENSURE_REQUIREMENTS, [id=#55699]
                  :                    :           :                                               :                 +- Project [d_date_sk#5985]
                  :                    :           :                                               :                    +- Filter (((isnotnull(d_year#5991) AND (d_year#5991 >= 1999)) AND (d_year#5991 <= 2001)) AND isnotnull(d_date_sk#5985))
                  :                    :           :                                               :                       +- FileScan parquet [d_date_sk#5985,d_year#5991] Batched: true, DataFilters: [isnotnull(d_year#5991), (d_year#5991 >= 1999), (d_year#5991 <= 2001), isnotnull(d_date_sk#5985)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                                               +- Sort [i_item_sk#5963 ASC NULLS FIRST], false, 0
                  :                    :           :                                                  +- Exchange hashpartitioning(i_item_sk#5963, 200), ENSURE_REQUIREMENTS, [id=#55707]
                  :                    :           :                                                     +- Filter isnotnull(i_item_sk#5963)
                  :                    :           :                                                        +- FileScan parquet [i_item_sk#5963,i_brand_id#5970,i_class_id#5972,i_category_id#5974] Batched: true, DataFilters: [isnotnull(i_item_sk#5963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           +- Sort [d_date_sk#6317 ASC NULLS FIRST], false, 0
                  :                    :              +- Exchange hashpartitioning(d_date_sk#6317, 200), ENSURE_REQUIREMENTS, [id=#55740]
                  :                    :                 +- Project [d_date_sk#6317]
                  :                    :                    +- Filter ((((isnotnull(d_year#6323) AND isnotnull(d_moy#6325)) AND (d_year#6323 = 2001)) AND (d_moy#6325 = 11)) AND isnotnull(d_date_sk#6317))
                  :                    :                       +- FileScan parquet [d_date_sk#6317,d_year#6323,d_moy#6325] Batched: true, DataFilters: [isnotnull(d_year#6323), isnotnull(d_moy#6325), (d_year#6323 = 2001), (d_moy#6325 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  :                    +- SortMergeJoin [i_item_sk#6295], [ss_item_sk#5883], LeftSemi
                  :                       :- Sort [i_item_sk#6295 ASC NULLS FIRST], false, 0
                  :                       :  +- Exchange hashpartitioning(i_item_sk#6295, 200), ENSURE_REQUIREMENTS, [id=#55822]
                  :                       :     +- Filter isnotnull(i_item_sk#6295)
                  :                       :        +- FileScan parquet [i_item_sk#6295,i_brand_id#6302,i_class_id#6304,i_category_id#6306] Batched: true, DataFilters: [isnotnull(i_item_sk#6295)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                       +- Sort [ss_item_sk#5883 ASC NULLS FIRST], false, 0
                  :                          +- Exchange hashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#55823]
                  :                             +- Project [i_item_sk#668 AS ss_item_sk#5883]
                  :                                +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner
                  :                                   :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                                   :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#55815]
                  :                                   :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                                   :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                                   +- Sort [brand_id#5880 ASC NULLS FIRST, class_id#5881 ASC NULLS FIRST, category_id#5882 ASC NULLS FIRST], false, 0
                  :                                      +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                         +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55811]
                  :                                            +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                               +- SortMergeJoin [coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882)], [coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974)], LeftSemi
                  :                                                  :- Sort [coalesce(brand_id#5880, 0) ASC NULLS FIRST, isnull(brand_id#5880) ASC NULLS FIRST, coalesce(class_id#5881, 0) ASC NULLS FIRST, isnull(class_id#5881) ASC NULLS FIRST, coalesce(category_id#5882, 0) ASC NULLS FIRST, isnull(category_id#5882) ASC NULLS FIRST], false, 0
                  :                                                  :  +- Exchange hashpartitioning(coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#55804]
                  :                                                  :     +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                                  :        +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55785]
                  :                                                  :           +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                  :                                                  :              +- Project [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882]
                  :                                                  :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                                                  :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                                                  :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#55777]
                  :                                                  :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902]
                  :                                                  :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5891], Inner
                  :                                                  :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                                                  :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#55769]
                  :                                                  :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                                                  :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                                                  :                    :           +- Sort [i_item_sk#5891 ASC NULLS FIRST], false, 0
                  :                                                  :                    :              +- Exchange hashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#55770]
                  :                                                  :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902)], [coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924)], LeftSemi
                  :                                                  :                    :                    :- Sort [coalesce(i_brand_id#5898, 0) ASC NULLS FIRST, isnull(i_brand_id#5898) ASC NULLS FIRST, coalesce(i_class_id#5900, 0) ASC NULLS FIRST, isnull(i_class_id#5900) ASC NULLS FIRST, coalesce(i_category_id#5902, 0) ASC NULLS FIRST, isnull(i_category_id#5902) ASC NULLS FIRST], false, 0
                  :                                                  :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#55762]
                  :                                                  :                    :                    :     +- Filter (((isnotnull(i_item_sk#5891) AND isnotnull(i_brand_id#5898)) AND isnotnull(i_class_id#5900)) AND isnotnull(i_category_id#5902))
                  :                                                  :                    :                    :        +- FileScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                                                  :                    :                    +- Sort [coalesce(i_brand_id#5920, 0) ASC NULLS FIRST, isnull(i_brand_id#5920) ASC NULLS FIRST, coalesce(i_class_id#5922, 0) ASC NULLS FIRST, isnull(i_class_id#5922) ASC NULLS FIRST, coalesce(i_category_id#5924, 0) ASC NULLS FIRST, isnull(i_category_id#5924) ASC NULLS FIRST], false, 0
                  :                                                  :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#55763]
                  :                                                  :                    :                          +- Project [i_brand_id#5920, i_class_id#5922, i_category_id#5924]
                  :                                                  :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5913], Inner
                  :                                                  :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#55754]
                  :                                                  :                    :                                :     +- Project [cs_item_sk#559]
                  :                                                  :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner
                  :                                                  :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#55746]
                  :                                                  :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                  :                                                  :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                                                  :                    :                                :           +- Sort [d_date_sk#5935 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                :              +- Exchange hashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#55747]
                  :                                                  :                    :                                :                 +- Project [d_date_sk#5935]
                  :                                                  :                    :                                :                    +- Filter (((isnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND isnotnull(d_date_sk#5935))
                  :                                                  :                    :                                :                       +- FileScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                                                  :                    :                                +- Sort [i_item_sk#5913 ASC NULLS FIRST], false, 0
                  :                                                  :                    :                                   +- Exchange hashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#55755]
                  :                                                  :                    :                                      +- Filter isnotnull(i_item_sk#5913)
                  :                                                  :                    :                                         +- FileScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                                                  :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                                                  :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#55778]
                  :                                                  :                          +- Project [d_date_sk#612]
                  :                                                  :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                                                  :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                                                  +- Sort [coalesce(i_brand_id#5970, 0) ASC NULLS FIRST, isnull(i_brand_id#5970) ASC NULLS FIRST, coalesce(i_class_id#5972, 0) ASC NULLS FIRST, isnull(i_class_id#5972) ASC NULLS FIRST, coalesce(i_category_id#5974, 0) ASC NULLS FIRST, isnull(i_category_id#5974) ASC NULLS FIRST], false, 0
                  :                                                     +- Exchange hashpartitioning(coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#55805]
                  :                                                        +- Project [i_brand_id#5970, i_class_id#5972, i_category_id#5974]
                  :                                                           +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5963], Inner
                  :                                                              :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                                                              :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#55796]
                  :                                                              :     +- Project [ws_item_sk#479]
                  :                                                              :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner
                  :                                                              :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                                                              :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#55788]
                  :                                                              :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                  :                                                              :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                                                              :           +- Sort [d_date_sk#5985 ASC NULLS FIRST], false, 0
                  :                                                              :              +- Exchange hashpartitioning(d_date_sk#5985, 200), ENSURE_REQUIREMENTS, [id=#55789]
                  :                                                              :                 +- Project [d_date_sk#5985]
                  :                                                              :                    +- Filter (((isnotnull(d_year#5991) AND (d_year#5991 >= 1999)) AND (d_year#5991 <= 2001)) AND isnotnull(d_date_sk#5985))
                  :                                                              :                       +- FileScan parquet [d_date_sk#5985,d_year#5991] Batched: true, DataFilters: [isnotnull(d_year#5991), (d_year#5991 >= 1999), (d_year#5991 <= 2001), isnotnull(d_date_sk#5985)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                                                              +- Sort [i_item_sk#5963 ASC NULLS FIRST], false, 0
                  :                                                                 +- Exchange hashpartitioning(i_item_sk#5963, 200), ENSURE_REQUIREMENTS, [id=#55797]
                  :                                                                    +- Filter isnotnull(i_item_sk#5963)
                  :                                                                       +- FileScan parquet [i_item_sk#5963,i_brand_id#5970,i_class_id#5972,i_category_id#5974] Batched: true, DataFilters: [isnotnull(i_item_sk#5963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  +- Project [sales#5876, number_sales#5877L, web AS channel#6477, i_brand_id#6386, i_class_id#6388, i_category_id#6390]
                     +- Filter (isnotnull(sales#5876) AND (cast(sales#5876 as decimal(32,6)) > cast(Subquery subquery#5879, [id=#55303] as decimal(32,6))))
                        :  +- Subquery subquery#5879, [id=#55303]
                        :     +- AdaptiveSparkPlan isFinalPlan=false
                        :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5890])
                        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#55196]
                        :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5884 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5885 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6507, count#6508L])
                        :                 +- Union
                        :                    :- Project [ss_quantity#6023 AS quantity#5884, ss_list_price#6025 AS list_price#5885]
                        :                    :  +- SortMergeJoin [ss_sold_date_sk#6013], [d_date_sk#6036], Inner
                        :                    :     :- Sort [ss_sold_date_sk#6013 ASC NULLS FIRST], false, 0
                        :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#6013, 200), ENSURE_REQUIREMENTS, [id=#55173]
                        :                    :     :     +- Filter isnotnull(ss_sold_date_sk#6013)
                        :                    :     :        +- FileScan parquet [ss_sold_date_sk#6013,ss_quantity#6023,ss_list_price#6025] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#6013)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                        :                    :     +- Sort [d_date_sk#6036 ASC NULLS FIRST], false, 0
                        :                    :        +- Exchange hashpartitioning(d_date_sk#6036, 200), ENSURE_REQUIREMENTS, [id=#55174]
                        :                    :           +- Project [d_date_sk#6036]
                        :                    :              +- Filter (((isnotnull(d_year#6042) AND (d_year#6042 >= 1999)) AND (d_year#6042 <= 2001)) AND isnotnull(d_date_sk#6036))
                        :                    :                 +- FileScan parquet [d_date_sk#6036,d_year#6042] Batched: true, DataFilters: [isnotnull(d_year#6042), (d_year#6042 >= 1999), (d_year#6042 <= 2001), isnotnull(d_date_sk#6036)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    :- Project [cs_quantity#6082 AS quantity#5886, cs_list_price#6084 AS list_price#5887]
                        :                    :  +- SortMergeJoin [cs_sold_date_sk#6064], [d_date_sk#6098], Inner
                        :                    :     :- Sort [cs_sold_date_sk#6064 ASC NULLS FIRST], false, 0
                        :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#6064, 200), ENSURE_REQUIREMENTS, [id=#55180]
                        :                    :     :     +- Filter isnotnull(cs_sold_date_sk#6064)
                        :                    :     :        +- FileScan parquet [cs_sold_date_sk#6064,cs_quantity#6082,cs_list_price#6084] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#6064)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                        :                    :     +- Sort [d_date_sk#6098 ASC NULLS FIRST], false, 0
                        :                    :        +- Exchange hashpartitioning(d_date_sk#6098, 200), ENSURE_REQUIREMENTS, [id=#55181]
                        :                    :           +- Project [d_date_sk#6098]
                        :                    :              +- Filter (((isnotnull(d_year#6104) AND (d_year#6104 >= 1999)) AND (d_year#6104 <= 2001)) AND isnotnull(d_date_sk#6098))
                        :                    :                 +- FileScan parquet [d_date_sk#6098,d_year#6104] Batched: true, DataFilters: [isnotnull(d_year#6104), (d_year#6104 >= 1999), (d_year#6104 <= 2001), isnotnull(d_date_sk#6098)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    +- Project [ws_quantity#6144 AS quantity#5888, ws_list_price#6146 AS list_price#5889]
                        :                       +- SortMergeJoin [ws_sold_date_sk#6126], [d_date_sk#6160], Inner
                        :                          :- Sort [ws_sold_date_sk#6126 ASC NULLS FIRST], false, 0
                        :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#6126, 200), ENSURE_REQUIREMENTS, [id=#55187]
                        :                          :     +- Filter isnotnull(ws_sold_date_sk#6126)
                        :                          :        +- FileScan parquet [ws_sold_date_sk#6126,ws_quantity#6144,ws_list_price#6146] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6126)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                        :                          +- Sort [d_date_sk#6160 ASC NULLS FIRST], false, 0
                        :                             +- Exchange hashpartitioning(d_date_sk#6160, 200), ENSURE_REQUIREMENTS, [id=#55188]
                        :                                +- Project [d_date_sk#6160]
                        :                                   +- Filter (((isnotnull(d_year#6166) AND (d_year#6166 >= 1999)) AND (d_year#6166 <= 2001)) AND isnotnull(d_date_sk#6160))
                        :                                      +- FileScan parquet [d_date_sk#6160,d_year#6166] Batched: true, DataFilters: [isnotnull(d_year#6166), (d_year#6166 >= 1999), (d_year#6166 <= 2001), isnotnull(d_date_sk#6160)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        +- HashAggregate(keys=[i_brand_id#6386, i_class_id#6388, i_category_id#6390], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#6363 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#6365 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#6386, i_class_id#6388, i_category_id#6390, sales#5876, number_sales#5877L])
                           +- Exchange hashpartitioning(i_brand_id#6386, i_class_id#6388, i_category_id#6390, 200), ENSURE_REQUIREMENTS, [id=#56019]
                              +- HashAggregate(keys=[i_brand_id#6386, i_class_id#6388, i_category_id#6390], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#6363 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#6365 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#6386, i_class_id#6388, i_category_id#6390, sum#6502, isEmpty#6503, count#6504L])
                                 +- Project [ws_quantity#6363, ws_list_price#6365, i_brand_id#6386, i_class_id#6388, i_category_id#6390]
                                    +- SortMergeJoin [ws_item_sk#6348], [i_item_sk#6379], Inner
                                       :- Sort [ws_item_sk#6348 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(ws_item_sk#6348, 200), ENSURE_REQUIREMENTS, [id=#56013]
                                       :     +- Project [ws_item_sk#6348, ws_quantity#6363, ws_list_price#6365]
                                       :        +- SortMergeJoin [ws_sold_date_sk#6345], [d_date_sk#6401], Inner
                                       :           :- Sort [ws_sold_date_sk#6345 ASC NULLS FIRST], false, 0
                                       :           :  +- Exchange hashpartitioning(ws_sold_date_sk#6345, 200), ENSURE_REQUIREMENTS, [id=#55923]
                                       :           :     +- SortMergeJoin [ws_item_sk#6348], [ss_item_sk#5883], LeftSemi
                                       :           :        :- Sort [ws_item_sk#6348 ASC NULLS FIRST], false, 0
                                       :           :        :  +- Exchange hashpartitioning(ws_item_sk#6348, 200), ENSURE_REQUIREMENTS, [id=#55916]
                                       :           :        :     +- Filter (isnotnull(ws_sold_date_sk#6345) AND isnotnull(ws_item_sk#6348))
                                       :           :        :        +- FileScan parquet [ws_sold_date_sk#6345,ws_item_sk#6348,ws_quantity#6363,ws_list_price#6365] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#6345), isnotnull(ws_item_sk#6348)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       :           :        +- Sort [ss_item_sk#5883 ASC NULLS FIRST], false, 0
                                       :           :           +- Exchange hashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#55917]
                                       :           :              +- Project [i_item_sk#668 AS ss_item_sk#5883]
                                       :           :                 +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner
                                       :           :                    :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                                       :           :                    :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#55909]
                                       :           :                    :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                                       :           :                    :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                    +- Sort [brand_id#5880 ASC NULLS FIRST, class_id#5881 ASC NULLS FIRST, category_id#5882 ASC NULLS FIRST], false, 0
                                       :           :                       +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :           :                          +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55905]
                                       :           :                             +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :           :                                +- SortMergeJoin [coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882)], [coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974)], LeftSemi
                                       :           :                                   :- Sort [coalesce(brand_id#5880, 0) ASC NULLS FIRST, isnull(brand_id#5880) ASC NULLS FIRST, coalesce(class_id#5881, 0) ASC NULLS FIRST, isnull(class_id#5881) ASC NULLS FIRST, coalesce(category_id#5882, 0) ASC NULLS FIRST, isnull(category_id#5882) ASC NULLS FIRST], false, 0
                                       :           :                                   :  +- Exchange hashpartitioning(coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#55898]
                                       :           :                                   :     +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :           :                                   :        +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55879]
                                       :           :                                   :           +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                       :           :                                   :              +- Project [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882]
                                       :           :                                   :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                                       :           :                                   :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#55871]
                                       :           :                                   :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902]
                                       :           :                                   :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5891], Inner
                                       :           :                                   :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#55863]
                                       :           :                                   :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                                       :           :                                   :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :           :                                   :                    :           +- Sort [i_item_sk#5891 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :              +- Exchange hashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#55864]
                                       :           :                                   :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902)], [coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924)], LeftSemi
                                       :           :                                   :                    :                    :- Sort [coalesce(i_brand_id#5898, 0) ASC NULLS FIRST, isnull(i_brand_id#5898) ASC NULLS FIRST, coalesce(i_class_id#5900, 0) ASC NULLS FIRST, isnull(i_class_id#5900) ASC NULLS FIRST, coalesce(i_category_id#5902, 0) ASC NULLS FIRST, isnull(i_category_id#5902) ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#55856]
                                       :           :                                   :                    :                    :     +- Filter (((isnotnull(i_item_sk#5891) AND isnotnull(i_brand_id#5898)) AND isnotnull(i_class_id#5900)) AND isnotnull(i_category_id#5902))
                                       :           :                                   :                    :                    :        +- FileScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                                   :                    :                    +- Sort [coalesce(i_brand_id#5920, 0) ASC NULLS FIRST, isnull(i_brand_id#5920) ASC NULLS FIRST, coalesce(i_class_id#5922, 0) ASC NULLS FIRST, isnull(i_class_id#5922) ASC NULLS FIRST, coalesce(i_category_id#5924, 0) ASC NULLS FIRST, isnull(i_category_id#5924) ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#55857]
                                       :           :                                   :                    :                          +- Project [i_brand_id#5920, i_class_id#5922, i_category_id#5924]
                                       :           :                                   :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5913], Inner
                                       :           :                                   :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#55848]
                                       :           :                                   :                    :                                :     +- Project [cs_item_sk#559]
                                       :           :                                   :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner
                                       :           :                                   :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#55840]
                                       :           :                                   :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                                       :           :                                   :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :           :                                   :                    :                                :           +- Sort [d_date_sk#5935 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :                                :              +- Exchange hashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#55841]
                                       :           :                                   :                    :                                :                 +- Project [d_date_sk#5935]
                                       :           :                                   :                    :                                :                    +- Filter (((isnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND isnotnull(d_date_sk#5935))
                                       :           :                                   :                    :                                :                       +- FileScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                                   :                    :                                +- Sort [i_item_sk#5913 ASC NULLS FIRST], false, 0
                                       :           :                                   :                    :                                   +- Exchange hashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#55849]
                                       :           :                                   :                    :                                      +- Filter isnotnull(i_item_sk#5913)
                                       :           :                                   :                    :                                         +- FileScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                                   :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                                       :           :                                   :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#55872]
                                       :           :                                   :                          +- Project [d_date_sk#612]
                                       :           :                                   :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                                       :           :                                   :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                                   +- Sort [coalesce(i_brand_id#5970, 0) ASC NULLS FIRST, isnull(i_brand_id#5970) ASC NULLS FIRST, coalesce(i_class_id#5972, 0) ASC NULLS FIRST, isnull(i_class_id#5972) ASC NULLS FIRST, coalesce(i_category_id#5974, 0) ASC NULLS FIRST, isnull(i_category_id#5974) ASC NULLS FIRST], false, 0
                                       :           :                                      +- Exchange hashpartitioning(coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#55899]
                                       :           :                                         +- Project [i_brand_id#5970, i_class_id#5972, i_category_id#5974]
                                       :           :                                            +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5963], Inner
                                       :           :                                               :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                                       :           :                                               :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#55890]
                                       :           :                                               :     +- Project [ws_item_sk#479]
                                       :           :                                               :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner
                                       :           :                                               :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                                       :           :                                               :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#55882]
                                       :           :                                               :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                                       :           :                                               :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :           :                                               :           +- Sort [d_date_sk#5985 ASC NULLS FIRST], false, 0
                                       :           :                                               :              +- Exchange hashpartitioning(d_date_sk#5985, 200), ENSURE_REQUIREMENTS, [id=#55883]
                                       :           :                                               :                 +- Project [d_date_sk#5985]
                                       :           :                                               :                    +- Filter (((isnotnull(d_year#5991) AND (d_year#5991 >= 1999)) AND (d_year#5991 <= 2001)) AND isnotnull(d_date_sk#5985))
                                       :           :                                               :                       +- FileScan parquet [d_date_sk#5985,d_year#5991] Batched: true, DataFilters: [isnotnull(d_year#5991), (d_year#5991 >= 1999), (d_year#5991 <= 2001), isnotnull(d_date_sk#5985)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                                               +- Sort [i_item_sk#5963 ASC NULLS FIRST], false, 0
                                       :           :                                                  +- Exchange hashpartitioning(i_item_sk#5963, 200), ENSURE_REQUIREMENTS, [id=#55891]
                                       :           :                                                     +- Filter isnotnull(i_item_sk#5963)
                                       :           :                                                        +- FileScan parquet [i_item_sk#5963,i_brand_id#5970,i_class_id#5972,i_category_id#5974] Batched: true, DataFilters: [isnotnull(i_item_sk#5963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           +- Sort [d_date_sk#6401 ASC NULLS FIRST], false, 0
                                       :              +- Exchange hashpartitioning(d_date_sk#6401, 200), ENSURE_REQUIREMENTS, [id=#55924]
                                       :                 +- Project [d_date_sk#6401]
                                       :                    +- Filter ((((isnotnull(d_year#6407) AND isnotnull(d_moy#6409)) AND (d_year#6407 = 2001)) AND (d_moy#6409 = 11)) AND isnotnull(d_date_sk#6401))
                                       :                       +- FileScan parquet [d_date_sk#6401,d_year#6407,d_moy#6409] Batched: true, DataFilters: [isnotnull(d_year#6407), isnotnull(d_moy#6409), (d_year#6407 = 2001), (d_moy#6409 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                                       +- SortMergeJoin [i_item_sk#6379], [ss_item_sk#5883], LeftSemi
                                          :- Sort [i_item_sk#6379 ASC NULLS FIRST], false, 0
                                          :  +- Exchange hashpartitioning(i_item_sk#6379, 200), ENSURE_REQUIREMENTS, [id=#56006]
                                          :     +- Filter isnotnull(i_item_sk#6379)
                                          :        +- FileScan parquet [i_item_sk#6379,i_brand_id#6386,i_class_id#6388,i_category_id#6390] Batched: true, DataFilters: [isnotnull(i_item_sk#6379)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                          +- Sort [ss_item_sk#5883 ASC NULLS FIRST], false, 0
                                             +- Exchange hashpartitioning(ss_item_sk#5883, 200), ENSURE_REQUIREMENTS, [id=#56007]
                                                +- Project [i_item_sk#668 AS ss_item_sk#5883]
                                                   +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5880, class_id#5881, category_id#5882], Inner
                                                      :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                                                      :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#55999]
                                                      :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                                                      :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                                      +- Sort [brand_id#5880 ASC NULLS FIRST, class_id#5881 ASC NULLS FIRST, category_id#5882 ASC NULLS FIRST], false, 0
                                                         +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                                            +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55995]
                                                               +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                                                  +- SortMergeJoin [coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882)], [coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974)], LeftSemi
                                                                     :- Sort [coalesce(brand_id#5880, 0) ASC NULLS FIRST, isnull(brand_id#5880) ASC NULLS FIRST, coalesce(class_id#5881, 0) ASC NULLS FIRST, isnull(class_id#5881) ASC NULLS FIRST, coalesce(category_id#5882, 0) ASC NULLS FIRST, isnull(category_id#5882) ASC NULLS FIRST], false, 0
                                                                     :  +- Exchange hashpartitioning(coalesce(brand_id#5880, 0), isnull(brand_id#5880), coalesce(class_id#5881, 0), isnull(class_id#5881), coalesce(category_id#5882, 0), isnull(category_id#5882), 200), ENSURE_REQUIREMENTS, [id=#55988]
                                                                     :     +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                                                     :        +- Exchange hashpartitioning(brand_id#5880, class_id#5881, category_id#5882, 200), ENSURE_REQUIREMENTS, [id=#55969]
                                                                     :           +- HashAggregate(keys=[brand_id#5880, class_id#5881, category_id#5882], functions=[], output=[brand_id#5880, class_id#5881, category_id#5882])
                                                                     :              +- Project [i_brand_id#5898 AS brand_id#5880, i_class_id#5900 AS class_id#5881, i_category_id#5902 AS category_id#5882]
                                                                     :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                                                                     :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                                                                     :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#55961]
                                                                     :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5898, i_class_id#5900, i_category_id#5902]
                                                                     :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5891], Inner
                                                                     :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                                                                     :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#55953]
                                                                     :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                                                                     :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                                                     :                    :           +- Sort [i_item_sk#5891 ASC NULLS FIRST], false, 0
                                                                     :                    :              +- Exchange hashpartitioning(i_item_sk#5891, 200), ENSURE_REQUIREMENTS, [id=#55954]
                                                                     :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902)], [coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924)], LeftSemi
                                                                     :                    :                    :- Sort [coalesce(i_brand_id#5898, 0) ASC NULLS FIRST, isnull(i_brand_id#5898) ASC NULLS FIRST, coalesce(i_class_id#5900, 0) ASC NULLS FIRST, isnull(i_class_id#5900) ASC NULLS FIRST, coalesce(i_category_id#5902, 0) ASC NULLS FIRST, isnull(i_category_id#5902) ASC NULLS FIRST], false, 0
                                                                     :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5898, 0), isnull(i_brand_id#5898), coalesce(i_class_id#5900, 0), isnull(i_class_id#5900), coalesce(i_category_id#5902, 0), isnull(i_category_id#5902), 200), ENSURE_REQUIREMENTS, [id=#55946]
                                                                     :                    :                    :     +- Filter (((isnotnull(i_item_sk#5891) AND isnotnull(i_brand_id#5898)) AND isnotnull(i_class_id#5900)) AND isnotnull(i_category_id#5902))
                                                                     :                    :                    :        +- FileScan parquet [i_item_sk#5891,i_brand_id#5898,i_class_id#5900,i_category_id#5902] Batched: true, DataFilters: [isnotnull(i_item_sk#5891), isnotnull(i_brand_id#5898), isnotnull(i_class_id#5900), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                                                     :                    :                    +- Sort [coalesce(i_brand_id#5920, 0) ASC NULLS FIRST, isnull(i_brand_id#5920) ASC NULLS FIRST, coalesce(i_class_id#5922, 0) ASC NULLS FIRST, isnull(i_class_id#5922) ASC NULLS FIRST, coalesce(i_category_id#5924, 0) ASC NULLS FIRST, isnull(i_category_id#5924) ASC NULLS FIRST], false, 0
                                                                     :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5920, 0), isnull(i_brand_id#5920), coalesce(i_class_id#5922, 0), isnull(i_class_id#5922), coalesce(i_category_id#5924, 0), isnull(i_category_id#5924), 200), ENSURE_REQUIREMENTS, [id=#55947]
                                                                     :                    :                          +- Project [i_brand_id#5920, i_class_id#5922, i_category_id#5924]
                                                                     :                    :                             +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5913], Inner
                                                                     :                    :                                :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                                                                     :                    :                                :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#55938]
                                                                     :                    :                                :     +- Project [cs_item_sk#559]
                                                                     :                    :                                :        +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5935], Inner
                                                                     :                    :                                :           :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                                                                     :                    :                                :           :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#55930]
                                                                     :                    :                                :           :     +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                                                                     :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#544), isnotnull(cs_item_sk#559)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk), IsNotNull(cs_item_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                                                     :                    :                                :           +- Sort [d_date_sk#5935 ASC NULLS FIRST], false, 0
                                                                     :                    :                                :              +- Exchange hashpartitioning(d_date_sk#5935, 200), ENSURE_REQUIREMENTS, [id=#55931]
                                                                     :                    :                                :                 +- Project [d_date_sk#5935]
                                                                     :                    :                                :                    +- Filter (((isnotnull(d_year#5941) AND (d_year#5941 >= 1999)) AND (d_year#5941 <= 2001)) AND isnotnull(d_date_sk#5935))
                                                                     :                    :                                :                       +- FileScan parquet [d_date_sk#5935,d_year#5941] Batched: true, DataFilters: [isnotnull(d_year#5941), (d_year#5941 >= 1999), (d_year#5941 <= 2001), isnotnull(d_date_sk#5935)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                                     :                    :                                +- Sort [i_item_sk#5913 ASC NULLS FIRST], false, 0
                                                                     :                    :                                   +- Exchange hashpartitioning(i_item_sk#5913, 200), ENSURE_REQUIREMENTS, [id=#55939]
                                                                     :                    :                                      +- Filter isnotnull(i_item_sk#5913)
                                                                     :                    :                                         +- FileScan parquet [i_item_sk#5913,i_brand_id#5920,i_class_id#5922,i_category_id#5924] Batched: true, DataFilters: [isnotnull(i_item_sk#5913)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                                                     :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                                                                     :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#55962]
                                                                     :                          +- Project [d_date_sk#612]
                                                                     :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                                                                     :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                                     +- Sort [coalesce(i_brand_id#5970, 0) ASC NULLS FIRST, isnull(i_brand_id#5970) ASC NULLS FIRST, coalesce(i_class_id#5972, 0) ASC NULLS FIRST, isnull(i_class_id#5972) ASC NULLS FIRST, coalesce(i_category_id#5974, 0) ASC NULLS FIRST, isnull(i_category_id#5974) ASC NULLS FIRST], false, 0
                                                                        +- Exchange hashpartitioning(coalesce(i_brand_id#5970, 0), isnull(i_brand_id#5970), coalesce(i_class_id#5972, 0), isnull(i_class_id#5972), coalesce(i_category_id#5974, 0), isnull(i_category_id#5974), 200), ENSURE_REQUIREMENTS, [id=#55989]
                                                                           +- Project [i_brand_id#5970, i_class_id#5972, i_category_id#5974]
                                                                              +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5963], Inner
                                                                                 :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                                                                                 :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#55980]
                                                                                 :     +- Project [ws_item_sk#479]
                                                                                 :        +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5985], Inner
                                                                                 :           :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                                                                                 :           :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#55972]
                                                                                 :           :     +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                                                                                 :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#476), isnotnull(ws_item_sk#479)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk), IsNotNull(ws_item_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                                                                 :           +- Sort [d_date_sk#5985 ASC NULLS FIRST], false, 0
                                                                                 :              +- Exchange hashpartitioning(d_date_sk#5985, 200), ENSURE_REQUIREMENTS, [id=#55973]
                                                                                 :                 +- Project [d_date_sk#5985]
                                                                                 :                    +- Filter (((isnotnull(d_year#5991) AND (d_year#5991 >= 1999)) AND (d_year#5991 <= 2001)) AND isnotnull(d_date_sk#5985))
                                                                                 :                       +- FileScan parquet [d_date_sk#5985,d_year#5991] Batched: true, DataFilters: [isnotnull(d_year#5991), (d_year#5991 >= 1999), (d_year#5991 <= 2001), isnotnull(d_date_sk#5985)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                                                 +- Sort [i_item_sk#5963 ASC NULLS FIRST], false, 0
                                                                                    +- Exchange hashpartitioning(i_item_sk#5963, 200), ENSURE_REQUIREMENTS, [id=#55981]
                                                                                       +- Filter isnotnull(i_item_sk#5963)
                                                                                          +- FileScan parquet [i_item_sk#5963,i_brand_id#5970,i_class_id#5972,i_category_id#5974] Batched: true, DataFilters: [isnotnull(i_item_sk#5963)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
