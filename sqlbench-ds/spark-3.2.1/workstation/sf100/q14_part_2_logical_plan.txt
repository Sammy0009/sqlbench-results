GlobalLimit 100
+- LocalLimit 100
   +- Project [store AS ty_channel#6951, ty_brand#6952, ty_class#6953, ty_category#6954, ty_sales#6955, ty_number_sales#6956L, store AS ly_channel#6957, ly_brand#6958, ly_class#6959, ly_category#6960, ly_sales#6961, ly_number_sales#6962L]
      +- Sort [i_brand_id#7301 ASC NULLS FIRST, i_class_id#7303 ASC NULLS FIRST, i_category_id#7305 ASC NULLS FIRST], true
         +- Project [i_brand_id#7301 AS ty_brand#6952, i_class_id#7303 AS ty_class#6953, i_category_id#7305 AS ty_category#6954, sales#6940 AS ty_sales#6955, number_sales#6941L AS ty_number_sales#6956L, i_brand_id#7374 AS ly_brand#6958, i_class_id#7376 AS ly_class#6959, i_category_id#7378 AS ly_category#6960, sales#6946 AS ly_sales#6961, number_sales#6947L AS ly_number_sales#6962L, i_brand_id#7301, i_class_id#7303, i_category_id#7305]
            +- Join Inner, (((i_brand_id#7301 = i_brand_id#7374) AND (i_class_id#7303 = i_class_id#7376)) AND (i_category_id#7305 = i_category_id#7378))
               :- Filter (isnotnull(sales#6940) AND (cast(sales#6940 as decimal(32,6)) > cast(scalar-subquery#6944 [] as decimal(32,6))))
               :  :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#6973]
               :  :     +- Union false, false
               :  :        :- Project [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968]
               :  :        :  +- Join Inner, (ss_sold_date_sk#7096 = d_date_sk#7119)
               :  :        :     :- Project [ss_sold_date_sk#7096, ss_quantity#7106, ss_list_price#7108]
               :  :        :     :  +- Filter isnotnull(ss_sold_date_sk#7096)
               :  :        :     :     +- Relation [ss_sold_date_sk#7096,ss_sold_time_sk#7097,ss_item_sk#7098,ss_customer_sk#7099,ss_cdemo_sk#7100,ss_hdemo_sk#7101,ss_addr_sk#7102,ss_store_sk#7103,ss_promo_sk#7104,ss_ticket_number#7105L,ss_quantity#7106,ss_wholesale_cost#7107,ss_list_price#7108,ss_sales_price#7109,ss_ext_discount_amt#7110,ss_ext_sales_price#7111,ss_ext_wholesale_cost#7112,ss_ext_list_price#7113,ss_ext_tax#7114,ss_coupon_amt#7115,ss_net_paid#7116,ss_net_paid_inc_tax#7117,ss_net_profit#7118] parquet
               :  :        :     +- Project [d_date_sk#7119]
               :  :        :        +- Filter ((isnotnull(d_year#7125) AND ((d_year#7125 >= 1999) AND (d_year#7125 <= 2001))) AND isnotnull(d_date_sk#7119))
               :  :        :           +- Relation [d_date_sk#7119,d_date_id#7120,d_date#7121,d_month_seq#7122,d_week_seq#7123,d_quarter_seq#7124,d_year#7125,d_dow#7126,d_moy#7127,d_dom#7128,d_qoy#7129,d_fy_year#7130,d_fy_quarter_seq#7131,d_fy_week_seq#7132,d_day_name#7133,d_quarter_name#7134,d_holiday#7135,d_weekend#7136,d_following_holiday#7137,d_first_dom#7138,d_last_dom#7139,d_same_day_ly#7140,d_same_day_lq#7141,d_current_day#7142,... 4 more fields] parquet
               :  :        :- Project [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970]
               :  :        :  +- Join Inner, (cs_sold_date_sk#7147 = d_date_sk#7181)
               :  :        :     :- Project [cs_sold_date_sk#7147, cs_quantity#7165, cs_list_price#7167]
               :  :        :     :  +- Filter isnotnull(cs_sold_date_sk#7147)
               :  :        :     :     +- Relation [cs_sold_date_sk#7147,cs_sold_time_sk#7148,cs_ship_date_sk#7149,cs_bill_customer_sk#7150,cs_bill_cdemo_sk#7151,cs_bill_hdemo_sk#7152,cs_bill_addr_sk#7153,cs_ship_customer_sk#7154,cs_ship_cdemo_sk#7155,cs_ship_hdemo_sk#7156,cs_ship_addr_sk#7157,cs_call_center_sk#7158,cs_catalog_page_sk#7159,cs_ship_mode_sk#7160,cs_warehouse_sk#7161,cs_item_sk#7162,cs_promo_sk#7163,cs_order_number#7164L,cs_quantity#7165,cs_wholesale_cost#7166,cs_list_price#7167,cs_sales_price#7168,cs_ext_discount_amt#7169,cs_ext_sales_price#7170,... 10 more fields] parquet
               :  :        :     +- Project [d_date_sk#7181]
               :  :        :        +- Filter ((isnotnull(d_year#7187) AND ((d_year#7187 >= 1999) AND (d_year#7187 <= 2001))) AND isnotnull(d_date_sk#7181))
               :  :        :           +- Relation [d_date_sk#7181,d_date_id#7182,d_date#7183,d_month_seq#7184,d_week_seq#7185,d_quarter_seq#7186,d_year#7187,d_dow#7188,d_moy#7189,d_dom#7190,d_qoy#7191,d_fy_year#7192,d_fy_quarter_seq#7193,d_fy_week_seq#7194,d_day_name#7195,d_quarter_name#7196,d_holiday#7197,d_weekend#7198,d_following_holiday#7199,d_first_dom#7200,d_last_dom#7201,d_same_day_ly#7202,d_same_day_lq#7203,d_current_day#7204,... 4 more fields] parquet
               :  :        +- Project [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972]
               :  :           +- Join Inner, (ws_sold_date_sk#7209 = d_date_sk#7243)
               :  :              :- Project [ws_sold_date_sk#7209, ws_quantity#7227, ws_list_price#7229]
               :  :              :  +- Filter isnotnull(ws_sold_date_sk#7209)
               :  :              :     +- Relation [ws_sold_date_sk#7209,ws_sold_time_sk#7210,ws_ship_date_sk#7211,ws_item_sk#7212,ws_bill_customer_sk#7213,ws_bill_cdemo_sk#7214,ws_bill_hdemo_sk#7215,ws_bill_addr_sk#7216,ws_ship_customer_sk#7217,ws_ship_cdemo_sk#7218,ws_ship_hdemo_sk#7219,ws_ship_addr_sk#7220,ws_web_page_sk#7221,ws_web_site_sk#7222,ws_ship_mode_sk#7223,ws_warehouse_sk#7224,ws_promo_sk#7225,ws_order_number#7226L,ws_quantity#7227,ws_wholesale_cost#7228,ws_list_price#7229,ws_sales_price#7230,ws_ext_discount_amt#7231,ws_ext_sales_price#7232,... 10 more fields] parquet
               :  :              +- Project [d_date_sk#7243]
               :  :                 +- Filter ((isnotnull(d_year#7249) AND ((d_year#7249 >= 1999) AND (d_year#7249 <= 2001))) AND isnotnull(d_date_sk#7243))
               :  :                    +- Relation [d_date_sk#7243,d_date_id#7244,d_date#7245,d_month_seq#7246,d_week_seq#7247,d_quarter_seq#7248,d_year#7249,d_dow#7250,d_moy#7251,d_dom#7252,d_qoy#7253,d_fy_year#7254,d_fy_quarter_seq#7255,d_fy_week_seq#7256,d_day_name#7257,d_quarter_name#7258,d_holiday#7259,d_weekend#7260,d_following_holiday#7261,d_first_dom#7262,d_last_dom#7263,d_same_day_ly#7264,d_same_day_lq#7265,d_current_day#7266,... 4 more fields] parquet
               :  +- Aggregate [i_brand_id#7301, i_class_id#7303, i_category_id#7305], [i_brand_id#7301, i_class_id#7303, i_category_id#7305, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7281 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7283 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#6940, count(1) AS number_sales#6941L]
               :     +- Project [ss_quantity#7281, ss_list_price#7283, i_brand_id#7301, i_class_id#7303, i_category_id#7305]
               :        +- Join Inner, (ss_item_sk#7273 = i_item_sk#7294)
               :           :- Project [ss_item_sk#7273, ss_quantity#7281, ss_list_price#7283]
               :           :  +- Join Inner, (ss_sold_date_sk#7271 = d_date_sk#7316)
               :           :     :- Join LeftSemi, (ss_item_sk#7273 = ss_item_sk#6966)
               :           :     :  :- Project [ss_sold_date_sk#7271, ss_item_sk#7273, ss_quantity#7281, ss_list_price#7283]
               :           :     :  :  +- Filter (isnotnull(ss_sold_date_sk#7271) AND isnotnull(ss_item_sk#7273))
               :           :     :  :     +- Relation [ss_sold_date_sk#7271,ss_sold_time_sk#7272,ss_item_sk#7273,ss_customer_sk#7274,ss_cdemo_sk#7275,ss_hdemo_sk#7276,ss_addr_sk#7277,ss_store_sk#7278,ss_promo_sk#7279,ss_ticket_number#7280L,ss_quantity#7281,ss_wholesale_cost#7282,ss_list_price#7283,ss_sales_price#7284,ss_ext_discount_amt#7285,ss_ext_sales_price#7286,ss_ext_wholesale_cost#7287,ss_ext_list_price#7288,ss_ext_tax#7289,ss_coupon_amt#7290,ss_net_paid#7291,ss_net_paid_inc_tax#7292,ss_net_profit#7293] parquet
               :           :     :  +- Project [i_item_sk#668 AS ss_item_sk#6966]
               :           :     :     +- Join Inner, (((i_brand_id#675 = brand_id#6963) AND (i_class_id#677 = class_id#6964)) AND (i_category_id#679 = category_id#6965))
               :           :     :        :- Project [i_item_sk#668, i_brand_id#675, i_class_id#677, i_category_id#679]
               :           :     :        :  +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
               :           :     :        :     +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
               :           :     :        +- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
               :           :     :           +- Join LeftSemi, (((brand_id#6963 <=> i_brand_id#7053) AND (class_id#6964 <=> i_class_id#7055)) AND (category_id#6965 <=> i_category_id#7057))
               :           :     :              :- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
               :           :     :              :  +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
               :           :     :              :     +- Join Inner, (ss_sold_date_sk#252 = d_date_sk#612)
               :           :     :              :        :- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
               :           :     :              :        :  +- Join Inner, (ss_item_sk#254 = i_item_sk#6974)
               :           :     :              :        :     :- Project [ss_sold_date_sk#252, ss_item_sk#254]
               :           :     :              :        :     :  +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
               :           :     :              :        :     :     +- Relation [ss_sold_date_sk#252,ss_sold_time_sk#253,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_quantity#262,ss_wholesale_cost#263,ss_list_price#264,ss_sales_price#265,ss_ext_discount_amt#266,ss_ext_sales_price#267,ss_ext_wholesale_cost#268,ss_ext_list_price#269,ss_ext_tax#270,ss_coupon_amt#271,ss_net_paid#272,ss_net_paid_inc_tax#273,ss_net_profit#274] parquet
               :           :     :              :        :     +- Join LeftSemi, (((i_brand_id#6981 <=> i_brand_id#7003) AND (i_class_id#6983 <=> i_class_id#7005)) AND (i_category_id#6985 <=> i_category_id#7007))
               :           :     :              :        :        :- Project [i_item_sk#6974, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
               :           :     :              :        :        :  +- Filter (isnotnull(i_item_sk#6974) AND ((isnotnull(i_brand_id#6981) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985)))
               :           :     :              :        :        :     +- Relation [i_item_sk#6974,i_item_id#6975,i_rec_start_date#6976,i_rec_end_date#6977,i_item_desc#6978,i_current_price#6979,i_wholesale_cost#6980,i_brand_id#6981,i_brand#6982,i_class_id#6983,i_class#6984,i_category_id#6985,i_category#6986,i_manufact_id#6987,i_manufact#6988,i_size#6989,i_formulation#6990,i_color#6991,i_units#6992,i_container#6993,i_manager_id#6994,i_product_name#6995] parquet
               :           :     :              :        :        +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
               :           :     :              :        :           +- Join Inner, (cs_item_sk#559 = i_item_sk#6996)
               :           :     :              :        :              :- Project [cs_item_sk#559]
               :           :     :              :        :              :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#7018)
               :           :     :              :        :              :     :- Project [cs_sold_date_sk#544, cs_item_sk#559]
               :           :     :              :        :              :     :  +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
               :           :     :              :        :              :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
               :           :     :              :        :              :     +- Project [d_date_sk#7018]
               :           :     :              :        :              :        +- Filter ((isnotnull(d_year#7024) AND ((d_year#7024 >= 1999) AND (d_year#7024 <= 2001))) AND isnotnull(d_date_sk#7018))
               :           :     :              :        :              :           +- Relation [d_date_sk#7018,d_date_id#7019,d_date#7020,d_month_seq#7021,d_week_seq#7022,d_quarter_seq#7023,d_year#7024,d_dow#7025,d_moy#7026,d_dom#7027,d_qoy#7028,d_fy_year#7029,d_fy_quarter_seq#7030,d_fy_week_seq#7031,d_day_name#7032,d_quarter_name#7033,d_holiday#7034,d_weekend#7035,d_following_holiday#7036,d_first_dom#7037,d_last_dom#7038,d_same_day_ly#7039,d_same_day_lq#7040,d_current_day#7041,... 4 more fields] parquet
               :           :     :              :        :              +- Project [i_item_sk#6996, i_brand_id#7003, i_class_id#7005, i_category_id#7007]
               :           :     :              :        :                 +- Filter isnotnull(i_item_sk#6996)
               :           :     :              :        :                    +- Relation [i_item_sk#6996,i_item_id#6997,i_rec_start_date#6998,i_rec_end_date#6999,i_item_desc#7000,i_current_price#7001,i_wholesale_cost#7002,i_brand_id#7003,i_brand#7004,i_class_id#7005,i_class#7006,i_category_id#7007,i_category#7008,i_manufact_id#7009,i_manufact#7010,i_size#7011,i_formulation#7012,i_color#7013,i_units#7014,i_container#7015,i_manager_id#7016,i_product_name#7017] parquet
               :           :     :              :        +- Project [d_date_sk#612]
               :           :     :              :           +- Filter ((isnotnull(d_year#618) AND ((d_year#618 >= 1999) AND (d_year#618 <= 2001))) AND isnotnull(d_date_sk#612))
               :           :     :              :              +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
               :           :     :              +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
               :           :     :                 +- Join Inner, (ws_item_sk#479 = i_item_sk#7046)
               :           :     :                    :- Project [ws_item_sk#479]
               :           :     :                    :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#7068)
               :           :     :                    :     :- Project [ws_sold_date_sk#476, ws_item_sk#479]
               :           :     :                    :     :  +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
               :           :     :                    :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
               :           :     :                    :     +- Project [d_date_sk#7068]
               :           :     :                    :        +- Filter ((isnotnull(d_year#7074) AND ((d_year#7074 >= 1999) AND (d_year#7074 <= 2001))) AND isnotnull(d_date_sk#7068))
               :           :     :                    :           +- Relation [d_date_sk#7068,d_date_id#7069,d_date#7070,d_month_seq#7071,d_week_seq#7072,d_quarter_seq#7073,d_year#7074,d_dow#7075,d_moy#7076,d_dom#7077,d_qoy#7078,d_fy_year#7079,d_fy_quarter_seq#7080,d_fy_week_seq#7081,d_day_name#7082,d_quarter_name#7083,d_holiday#7084,d_weekend#7085,d_following_holiday#7086,d_first_dom#7087,d_last_dom#7088,d_same_day_ly#7089,d_same_day_lq#7090,d_current_day#7091,... 4 more fields] parquet
               :           :     :                    +- Project [i_item_sk#7046, i_brand_id#7053, i_class_id#7055, i_category_id#7057]
               :           :     :                       +- Filter isnotnull(i_item_sk#7046)
               :           :     :                          +- Relation [i_item_sk#7046,i_item_id#7047,i_rec_start_date#7048,i_rec_end_date#7049,i_item_desc#7050,i_current_price#7051,i_wholesale_cost#7052,i_brand_id#7053,i_brand#7054,i_class_id#7055,i_class#7056,i_category_id#7057,i_category#7058,i_manufact_id#7059,i_manufact#7060,i_size#7061,i_formulation#7062,i_color#7063,i_units#7064,i_container#7065,i_manager_id#7066,i_product_name#7067] parquet
               :           :     +- Project [d_date_sk#7316]
               :           :        +- Filter ((isnotnull(d_week_seq#7320) AND (d_week_seq#7320 = scalar-subquery#6943 [])) AND isnotnull(d_date_sk#7316))
               :           :           :  +- Project [d_week_seq#7423]
               :           :           :     +- Filter (((isnotnull(d_year#7425) AND isnotnull(d_moy#7427)) AND isnotnull(d_dom#7428)) AND (((d_year#7425 = 2000) AND (d_moy#7427 = 12)) AND (d_dom#7428 = 12)))
               :           :           :        +- Relation [d_date_sk#7419,d_date_id#7420,d_date#7421,d_month_seq#7422,d_week_seq#7423,d_quarter_seq#7424,d_year#7425,d_dow#7426,d_moy#7427,d_dom#7428,d_qoy#7429,d_fy_year#7430,d_fy_quarter_seq#7431,d_fy_week_seq#7432,d_day_name#7433,d_quarter_name#7434,d_holiday#7435,d_weekend#7436,d_following_holiday#7437,d_first_dom#7438,d_last_dom#7439,d_same_day_ly#7440,d_same_day_lq#7441,d_current_day#7442,... 4 more fields] parquet
               :           :           +- Relation [d_date_sk#7316,d_date_id#7317,d_date#7318,d_month_seq#7319,d_week_seq#7320,d_quarter_seq#7321,d_year#7322,d_dow#7323,d_moy#7324,d_dom#7325,d_qoy#7326,d_fy_year#7327,d_fy_quarter_seq#7328,d_fy_week_seq#7329,d_day_name#7330,d_quarter_name#7331,d_holiday#7332,d_weekend#7333,d_following_holiday#7334,d_first_dom#7335,d_last_dom#7336,d_same_day_ly#7337,d_same_day_lq#7338,d_current_day#7339,... 4 more fields] parquet
               :           +- Join LeftSemi, (i_item_sk#7294 = ss_item_sk#6966)
               :              :- Project [i_item_sk#7294, i_brand_id#7301, i_class_id#7303, i_category_id#7305]
               :              :  +- Filter (((isnotnull(i_item_sk#7294) AND isnotnull(i_brand_id#7301)) AND isnotnull(i_class_id#7303)) AND isnotnull(i_category_id#7305))
               :              :     +- Relation [i_item_sk#7294,i_item_id#7295,i_rec_start_date#7296,i_rec_end_date#7297,i_item_desc#7298,i_current_price#7299,i_wholesale_cost#7300,i_brand_id#7301,i_brand#7302,i_class_id#7303,i_class#7304,i_category_id#7305,i_category#7306,i_manufact_id#7307,i_manufact#7308,i_size#7309,i_formulation#7310,i_color#7311,i_units#7312,i_container#7313,i_manager_id#7314,i_product_name#7315] parquet
               :              +- Project [i_item_sk#668 AS ss_item_sk#6966]
               :                 +- Join Inner, (((i_brand_id#675 = brand_id#6963) AND (i_class_id#677 = class_id#6964)) AND (i_category_id#679 = category_id#6965))
               :                    :- Project [i_item_sk#668, i_brand_id#675, i_class_id#677, i_category_id#679]
               :                    :  +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
               :                    :     +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
               :                    +- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
               :                       +- Join LeftSemi, (((brand_id#6963 <=> i_brand_id#7053) AND (class_id#6964 <=> i_class_id#7055)) AND (category_id#6965 <=> i_category_id#7057))
               :                          :- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
               :                          :  +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
               :                          :     +- Join Inner, (ss_sold_date_sk#252 = d_date_sk#612)
               :                          :        :- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
               :                          :        :  +- Join Inner, (ss_item_sk#254 = i_item_sk#6974)
               :                          :        :     :- Project [ss_sold_date_sk#252, ss_item_sk#254]
               :                          :        :     :  +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
               :                          :        :     :     +- Relation [ss_sold_date_sk#252,ss_sold_time_sk#253,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_quantity#262,ss_wholesale_cost#263,ss_list_price#264,ss_sales_price#265,ss_ext_discount_amt#266,ss_ext_sales_price#267,ss_ext_wholesale_cost#268,ss_ext_list_price#269,ss_ext_tax#270,ss_coupon_amt#271,ss_net_paid#272,ss_net_paid_inc_tax#273,ss_net_profit#274] parquet
               :                          :        :     +- Join LeftSemi, (((i_brand_id#6981 <=> i_brand_id#7003) AND (i_class_id#6983 <=> i_class_id#7005)) AND (i_category_id#6985 <=> i_category_id#7007))
               :                          :        :        :- Project [i_item_sk#6974, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
               :                          :        :        :  +- Filter (isnotnull(i_item_sk#6974) AND ((isnotnull(i_brand_id#6981) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985)))
               :                          :        :        :     +- Relation [i_item_sk#6974,i_item_id#6975,i_rec_start_date#6976,i_rec_end_date#6977,i_item_desc#6978,i_current_price#6979,i_wholesale_cost#6980,i_brand_id#6981,i_brand#6982,i_class_id#6983,i_class#6984,i_category_id#6985,i_category#6986,i_manufact_id#6987,i_manufact#6988,i_size#6989,i_formulation#6990,i_color#6991,i_units#6992,i_container#6993,i_manager_id#6994,i_product_name#6995] parquet
               :                          :        :        +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
               :                          :        :           +- Join Inner, (cs_item_sk#559 = i_item_sk#6996)
               :                          :        :              :- Project [cs_item_sk#559]
               :                          :        :              :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#7018)
               :                          :        :              :     :- Project [cs_sold_date_sk#544, cs_item_sk#559]
               :                          :        :              :     :  +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
               :                          :        :              :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
               :                          :        :              :     +- Project [d_date_sk#7018]
               :                          :        :              :        +- Filter ((isnotnull(d_year#7024) AND ((d_year#7024 >= 1999) AND (d_year#7024 <= 2001))) AND isnotnull(d_date_sk#7018))
               :                          :        :              :           +- Relation [d_date_sk#7018,d_date_id#7019,d_date#7020,d_month_seq#7021,d_week_seq#7022,d_quarter_seq#7023,d_year#7024,d_dow#7025,d_moy#7026,d_dom#7027,d_qoy#7028,d_fy_year#7029,d_fy_quarter_seq#7030,d_fy_week_seq#7031,d_day_name#7032,d_quarter_name#7033,d_holiday#7034,d_weekend#7035,d_following_holiday#7036,d_first_dom#7037,d_last_dom#7038,d_same_day_ly#7039,d_same_day_lq#7040,d_current_day#7041,... 4 more fields] parquet
               :                          :        :              +- Project [i_item_sk#6996, i_brand_id#7003, i_class_id#7005, i_category_id#7007]
               :                          :        :                 +- Filter isnotnull(i_item_sk#6996)
               :                          :        :                    +- Relation [i_item_sk#6996,i_item_id#6997,i_rec_start_date#6998,i_rec_end_date#6999,i_item_desc#7000,i_current_price#7001,i_wholesale_cost#7002,i_brand_id#7003,i_brand#7004,i_class_id#7005,i_class#7006,i_category_id#7007,i_category#7008,i_manufact_id#7009,i_manufact#7010,i_size#7011,i_formulation#7012,i_color#7013,i_units#7014,i_container#7015,i_manager_id#7016,i_product_name#7017] parquet
               :                          :        +- Project [d_date_sk#612]
               :                          :           +- Filter ((isnotnull(d_year#618) AND ((d_year#618 >= 1999) AND (d_year#618 <= 2001))) AND isnotnull(d_date_sk#612))
               :                          :              +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
               :                          +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
               :                             +- Join Inner, (ws_item_sk#479 = i_item_sk#7046)
               :                                :- Project [ws_item_sk#479]
               :                                :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#7068)
               :                                :     :- Project [ws_sold_date_sk#476, ws_item_sk#479]
               :                                :     :  +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
               :                                :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
               :                                :     +- Project [d_date_sk#7068]
               :                                :        +- Filter ((isnotnull(d_year#7074) AND ((d_year#7074 >= 1999) AND (d_year#7074 <= 2001))) AND isnotnull(d_date_sk#7068))
               :                                :           +- Relation [d_date_sk#7068,d_date_id#7069,d_date#7070,d_month_seq#7071,d_week_seq#7072,d_quarter_seq#7073,d_year#7074,d_dow#7075,d_moy#7076,d_dom#7077,d_qoy#7078,d_fy_year#7079,d_fy_quarter_seq#7080,d_fy_week_seq#7081,d_day_name#7082,d_quarter_name#7083,d_holiday#7084,d_weekend#7085,d_following_holiday#7086,d_first_dom#7087,d_last_dom#7088,d_same_day_ly#7089,d_same_day_lq#7090,d_current_day#7091,... 4 more fields] parquet
               :                                +- Project [i_item_sk#7046, i_brand_id#7053, i_class_id#7055, i_category_id#7057]
               :                                   +- Filter isnotnull(i_item_sk#7046)
               :                                      +- Relation [i_item_sk#7046,i_item_id#7047,i_rec_start_date#7048,i_rec_end_date#7049,i_item_desc#7050,i_current_price#7051,i_wholesale_cost#7052,i_brand_id#7053,i_brand#7054,i_class_id#7055,i_class#7056,i_category_id#7057,i_category#7058,i_manufact_id#7059,i_manufact#7060,i_size#7061,i_formulation#7062,i_color#7063,i_units#7064,i_container#7065,i_manager_id#7066,i_product_name#7067] parquet
               +- Filter (isnotnull(sales#6946) AND (cast(sales#6946 as decimal(32,6)) > cast(scalar-subquery#6950 [] as decimal(32,6))))
                  :  +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#6967 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#6968 as decimal(12,2)))), DecimalType(18,2), true)) AS average_sales#6973]
                  :     +- Union false, false
                  :        :- Project [ss_quantity#7106 AS quantity#6967, ss_list_price#7108 AS list_price#6968]
                  :        :  +- Join Inner, (ss_sold_date_sk#7096 = d_date_sk#7119)
                  :        :     :- Project [ss_sold_date_sk#7096, ss_quantity#7106, ss_list_price#7108]
                  :        :     :  +- Filter isnotnull(ss_sold_date_sk#7096)
                  :        :     :     +- Relation [ss_sold_date_sk#7096,ss_sold_time_sk#7097,ss_item_sk#7098,ss_customer_sk#7099,ss_cdemo_sk#7100,ss_hdemo_sk#7101,ss_addr_sk#7102,ss_store_sk#7103,ss_promo_sk#7104,ss_ticket_number#7105L,ss_quantity#7106,ss_wholesale_cost#7107,ss_list_price#7108,ss_sales_price#7109,ss_ext_discount_amt#7110,ss_ext_sales_price#7111,ss_ext_wholesale_cost#7112,ss_ext_list_price#7113,ss_ext_tax#7114,ss_coupon_amt#7115,ss_net_paid#7116,ss_net_paid_inc_tax#7117,ss_net_profit#7118] parquet
                  :        :     +- Project [d_date_sk#7119]
                  :        :        +- Filter ((isnotnull(d_year#7125) AND ((d_year#7125 >= 1999) AND (d_year#7125 <= 2001))) AND isnotnull(d_date_sk#7119))
                  :        :           +- Relation [d_date_sk#7119,d_date_id#7120,d_date#7121,d_month_seq#7122,d_week_seq#7123,d_quarter_seq#7124,d_year#7125,d_dow#7126,d_moy#7127,d_dom#7128,d_qoy#7129,d_fy_year#7130,d_fy_quarter_seq#7131,d_fy_week_seq#7132,d_day_name#7133,d_quarter_name#7134,d_holiday#7135,d_weekend#7136,d_following_holiday#7137,d_first_dom#7138,d_last_dom#7139,d_same_day_ly#7140,d_same_day_lq#7141,d_current_day#7142,... 4 more fields] parquet
                  :        :- Project [cs_quantity#7165 AS quantity#6969, cs_list_price#7167 AS list_price#6970]
                  :        :  +- Join Inner, (cs_sold_date_sk#7147 = d_date_sk#7181)
                  :        :     :- Project [cs_sold_date_sk#7147, cs_quantity#7165, cs_list_price#7167]
                  :        :     :  +- Filter isnotnull(cs_sold_date_sk#7147)
                  :        :     :     +- Relation [cs_sold_date_sk#7147,cs_sold_time_sk#7148,cs_ship_date_sk#7149,cs_bill_customer_sk#7150,cs_bill_cdemo_sk#7151,cs_bill_hdemo_sk#7152,cs_bill_addr_sk#7153,cs_ship_customer_sk#7154,cs_ship_cdemo_sk#7155,cs_ship_hdemo_sk#7156,cs_ship_addr_sk#7157,cs_call_center_sk#7158,cs_catalog_page_sk#7159,cs_ship_mode_sk#7160,cs_warehouse_sk#7161,cs_item_sk#7162,cs_promo_sk#7163,cs_order_number#7164L,cs_quantity#7165,cs_wholesale_cost#7166,cs_list_price#7167,cs_sales_price#7168,cs_ext_discount_amt#7169,cs_ext_sales_price#7170,... 10 more fields] parquet
                  :        :     +- Project [d_date_sk#7181]
                  :        :        +- Filter ((isnotnull(d_year#7187) AND ((d_year#7187 >= 1999) AND (d_year#7187 <= 2001))) AND isnotnull(d_date_sk#7181))
                  :        :           +- Relation [d_date_sk#7181,d_date_id#7182,d_date#7183,d_month_seq#7184,d_week_seq#7185,d_quarter_seq#7186,d_year#7187,d_dow#7188,d_moy#7189,d_dom#7190,d_qoy#7191,d_fy_year#7192,d_fy_quarter_seq#7193,d_fy_week_seq#7194,d_day_name#7195,d_quarter_name#7196,d_holiday#7197,d_weekend#7198,d_following_holiday#7199,d_first_dom#7200,d_last_dom#7201,d_same_day_ly#7202,d_same_day_lq#7203,d_current_day#7204,... 4 more fields] parquet
                  :        +- Project [ws_quantity#7227 AS quantity#6971, ws_list_price#7229 AS list_price#6972]
                  :           +- Join Inner, (ws_sold_date_sk#7209 = d_date_sk#7243)
                  :              :- Project [ws_sold_date_sk#7209, ws_quantity#7227, ws_list_price#7229]
                  :              :  +- Filter isnotnull(ws_sold_date_sk#7209)
                  :              :     +- Relation [ws_sold_date_sk#7209,ws_sold_time_sk#7210,ws_ship_date_sk#7211,ws_item_sk#7212,ws_bill_customer_sk#7213,ws_bill_cdemo_sk#7214,ws_bill_hdemo_sk#7215,ws_bill_addr_sk#7216,ws_ship_customer_sk#7217,ws_ship_cdemo_sk#7218,ws_ship_hdemo_sk#7219,ws_ship_addr_sk#7220,ws_web_page_sk#7221,ws_web_site_sk#7222,ws_ship_mode_sk#7223,ws_warehouse_sk#7224,ws_promo_sk#7225,ws_order_number#7226L,ws_quantity#7227,ws_wholesale_cost#7228,ws_list_price#7229,ws_sales_price#7230,ws_ext_discount_amt#7231,ws_ext_sales_price#7232,... 10 more fields] parquet
                  :              +- Project [d_date_sk#7243]
                  :                 +- Filter ((isnotnull(d_year#7249) AND ((d_year#7249 >= 1999) AND (d_year#7249 <= 2001))) AND isnotnull(d_date_sk#7243))
                  :                    +- Relation [d_date_sk#7243,d_date_id#7244,d_date#7245,d_month_seq#7246,d_week_seq#7247,d_quarter_seq#7248,d_year#7249,d_dow#7250,d_moy#7251,d_dom#7252,d_qoy#7253,d_fy_year#7254,d_fy_quarter_seq#7255,d_fy_week_seq#7256,d_day_name#7257,d_quarter_name#7258,d_holiday#7259,d_weekend#7260,d_following_holiday#7261,d_first_dom#7262,d_last_dom#7263,d_same_day_ly#7264,d_same_day_lq#7265,d_current_day#7266,... 4 more fields] parquet
                  +- Aggregate [i_brand_id#7374, i_class_id#7376, i_category_id#7378], [i_brand_id#7374, i_class_id#7376, i_category_id#7378, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#7354 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#7356 as decimal(12,2)))), DecimalType(18,2), true)) AS sales#6946, count(1) AS number_sales#6947L]
                     +- Project [ss_quantity#7354, ss_list_price#7356, i_brand_id#7374, i_class_id#7376, i_category_id#7378]
                        +- Join Inner, (ss_item_sk#7346 = i_item_sk#7367)
                           :- Project [ss_item_sk#7346, ss_quantity#7354, ss_list_price#7356]
                           :  +- Join Inner, (ss_sold_date_sk#7344 = d_date_sk#7389)
                           :     :- Join LeftSemi, (ss_item_sk#7346 = ss_item_sk#6966)
                           :     :  :- Project [ss_sold_date_sk#7344, ss_item_sk#7346, ss_quantity#7354, ss_list_price#7356]
                           :     :  :  +- Filter (isnotnull(ss_sold_date_sk#7344) AND isnotnull(ss_item_sk#7346))
                           :     :  :     +- Relation [ss_sold_date_sk#7344,ss_sold_time_sk#7345,ss_item_sk#7346,ss_customer_sk#7347,ss_cdemo_sk#7348,ss_hdemo_sk#7349,ss_addr_sk#7350,ss_store_sk#7351,ss_promo_sk#7352,ss_ticket_number#7353L,ss_quantity#7354,ss_wholesale_cost#7355,ss_list_price#7356,ss_sales_price#7357,ss_ext_discount_amt#7358,ss_ext_sales_price#7359,ss_ext_wholesale_cost#7360,ss_ext_list_price#7361,ss_ext_tax#7362,ss_coupon_amt#7363,ss_net_paid#7364,ss_net_paid_inc_tax#7365,ss_net_profit#7366] parquet
                           :     :  +- Project [i_item_sk#668 AS ss_item_sk#6966]
                           :     :     +- Join Inner, (((i_brand_id#675 = brand_id#6963) AND (i_class_id#677 = class_id#6964)) AND (i_category_id#679 = category_id#6965))
                           :     :        :- Project [i_item_sk#668, i_brand_id#675, i_class_id#677, i_category_id#679]
                           :     :        :  +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                           :     :        :     +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
                           :     :        +- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
                           :     :           +- Join LeftSemi, (((brand_id#6963 <=> i_brand_id#7053) AND (class_id#6964 <=> i_class_id#7055)) AND (category_id#6965 <=> i_category_id#7057))
                           :     :              :- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
                           :     :              :  +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
                           :     :              :     +- Join Inner, (ss_sold_date_sk#252 = d_date_sk#612)
                           :     :              :        :- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
                           :     :              :        :  +- Join Inner, (ss_item_sk#254 = i_item_sk#6974)
                           :     :              :        :     :- Project [ss_sold_date_sk#252, ss_item_sk#254]
                           :     :              :        :     :  +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                           :     :              :        :     :     +- Relation [ss_sold_date_sk#252,ss_sold_time_sk#253,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_quantity#262,ss_wholesale_cost#263,ss_list_price#264,ss_sales_price#265,ss_ext_discount_amt#266,ss_ext_sales_price#267,ss_ext_wholesale_cost#268,ss_ext_list_price#269,ss_ext_tax#270,ss_coupon_amt#271,ss_net_paid#272,ss_net_paid_inc_tax#273,ss_net_profit#274] parquet
                           :     :              :        :     +- Join LeftSemi, (((i_brand_id#6981 <=> i_brand_id#7003) AND (i_class_id#6983 <=> i_class_id#7005)) AND (i_category_id#6985 <=> i_category_id#7007))
                           :     :              :        :        :- Project [i_item_sk#6974, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
                           :     :              :        :        :  +- Filter (isnotnull(i_item_sk#6974) AND ((isnotnull(i_brand_id#6981) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985)))
                           :     :              :        :        :     +- Relation [i_item_sk#6974,i_item_id#6975,i_rec_start_date#6976,i_rec_end_date#6977,i_item_desc#6978,i_current_price#6979,i_wholesale_cost#6980,i_brand_id#6981,i_brand#6982,i_class_id#6983,i_class#6984,i_category_id#6985,i_category#6986,i_manufact_id#6987,i_manufact#6988,i_size#6989,i_formulation#6990,i_color#6991,i_units#6992,i_container#6993,i_manager_id#6994,i_product_name#6995] parquet
                           :     :              :        :        +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
                           :     :              :        :           +- Join Inner, (cs_item_sk#559 = i_item_sk#6996)
                           :     :              :        :              :- Project [cs_item_sk#559]
                           :     :              :        :              :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#7018)
                           :     :              :        :              :     :- Project [cs_sold_date_sk#544, cs_item_sk#559]
                           :     :              :        :              :     :  +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                           :     :              :        :              :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
                           :     :              :        :              :     +- Project [d_date_sk#7018]
                           :     :              :        :              :        +- Filter ((isnotnull(d_year#7024) AND ((d_year#7024 >= 1999) AND (d_year#7024 <= 2001))) AND isnotnull(d_date_sk#7018))
                           :     :              :        :              :           +- Relation [d_date_sk#7018,d_date_id#7019,d_date#7020,d_month_seq#7021,d_week_seq#7022,d_quarter_seq#7023,d_year#7024,d_dow#7025,d_moy#7026,d_dom#7027,d_qoy#7028,d_fy_year#7029,d_fy_quarter_seq#7030,d_fy_week_seq#7031,d_day_name#7032,d_quarter_name#7033,d_holiday#7034,d_weekend#7035,d_following_holiday#7036,d_first_dom#7037,d_last_dom#7038,d_same_day_ly#7039,d_same_day_lq#7040,d_current_day#7041,... 4 more fields] parquet
                           :     :              :        :              +- Project [i_item_sk#6996, i_brand_id#7003, i_class_id#7005, i_category_id#7007]
                           :     :              :        :                 +- Filter isnotnull(i_item_sk#6996)
                           :     :              :        :                    +- Relation [i_item_sk#6996,i_item_id#6997,i_rec_start_date#6998,i_rec_end_date#6999,i_item_desc#7000,i_current_price#7001,i_wholesale_cost#7002,i_brand_id#7003,i_brand#7004,i_class_id#7005,i_class#7006,i_category_id#7007,i_category#7008,i_manufact_id#7009,i_manufact#7010,i_size#7011,i_formulation#7012,i_color#7013,i_units#7014,i_container#7015,i_manager_id#7016,i_product_name#7017] parquet
                           :     :              :        +- Project [d_date_sk#612]
                           :     :              :           +- Filter ((isnotnull(d_year#618) AND ((d_year#618 >= 1999) AND (d_year#618 <= 2001))) AND isnotnull(d_date_sk#612))
                           :     :              :              +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
                           :     :              +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
                           :     :                 +- Join Inner, (ws_item_sk#479 = i_item_sk#7046)
                           :     :                    :- Project [ws_item_sk#479]
                           :     :                    :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#7068)
                           :     :                    :     :- Project [ws_sold_date_sk#476, ws_item_sk#479]
                           :     :                    :     :  +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                           :     :                    :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
                           :     :                    :     +- Project [d_date_sk#7068]
                           :     :                    :        +- Filter ((isnotnull(d_year#7074) AND ((d_year#7074 >= 1999) AND (d_year#7074 <= 2001))) AND isnotnull(d_date_sk#7068))
                           :     :                    :           +- Relation [d_date_sk#7068,d_date_id#7069,d_date#7070,d_month_seq#7071,d_week_seq#7072,d_quarter_seq#7073,d_year#7074,d_dow#7075,d_moy#7076,d_dom#7077,d_qoy#7078,d_fy_year#7079,d_fy_quarter_seq#7080,d_fy_week_seq#7081,d_day_name#7082,d_quarter_name#7083,d_holiday#7084,d_weekend#7085,d_following_holiday#7086,d_first_dom#7087,d_last_dom#7088,d_same_day_ly#7089,d_same_day_lq#7090,d_current_day#7091,... 4 more fields] parquet
                           :     :                    +- Project [i_item_sk#7046, i_brand_id#7053, i_class_id#7055, i_category_id#7057]
                           :     :                       +- Filter isnotnull(i_item_sk#7046)
                           :     :                          +- Relation [i_item_sk#7046,i_item_id#7047,i_rec_start_date#7048,i_rec_end_date#7049,i_item_desc#7050,i_current_price#7051,i_wholesale_cost#7052,i_brand_id#7053,i_brand#7054,i_class_id#7055,i_class#7056,i_category_id#7057,i_category#7058,i_manufact_id#7059,i_manufact#7060,i_size#7061,i_formulation#7062,i_color#7063,i_units#7064,i_container#7065,i_manager_id#7066,i_product_name#7067] parquet
                           :     +- Project [d_date_sk#7389]
                           :        +- Filter ((isnotnull(d_week_seq#7393) AND (d_week_seq#7393 = scalar-subquery#6949 [])) AND isnotnull(d_date_sk#7389))
                           :           :  +- Project [d_week_seq#7451]
                           :           :     +- Filter (((isnotnull(d_year#7453) AND isnotnull(d_moy#7455)) AND isnotnull(d_dom#7456)) AND (((d_year#7453 = 1999) AND (d_moy#7455 = 12)) AND (d_dom#7456 = 12)))
                           :           :        +- Relation [d_date_sk#7447,d_date_id#7448,d_date#7449,d_month_seq#7450,d_week_seq#7451,d_quarter_seq#7452,d_year#7453,d_dow#7454,d_moy#7455,d_dom#7456,d_qoy#7457,d_fy_year#7458,d_fy_quarter_seq#7459,d_fy_week_seq#7460,d_day_name#7461,d_quarter_name#7462,d_holiday#7463,d_weekend#7464,d_following_holiday#7465,d_first_dom#7466,d_last_dom#7467,d_same_day_ly#7468,d_same_day_lq#7469,d_current_day#7470,... 4 more fields] parquet
                           :           +- Relation [d_date_sk#7389,d_date_id#7390,d_date#7391,d_month_seq#7392,d_week_seq#7393,d_quarter_seq#7394,d_year#7395,d_dow#7396,d_moy#7397,d_dom#7398,d_qoy#7399,d_fy_year#7400,d_fy_quarter_seq#7401,d_fy_week_seq#7402,d_day_name#7403,d_quarter_name#7404,d_holiday#7405,d_weekend#7406,d_following_holiday#7407,d_first_dom#7408,d_last_dom#7409,d_same_day_ly#7410,d_same_day_lq#7411,d_current_day#7412,... 4 more fields] parquet
                           +- Join LeftSemi, (i_item_sk#7367 = ss_item_sk#6966)
                              :- Project [i_item_sk#7367, i_brand_id#7374, i_class_id#7376, i_category_id#7378]
                              :  +- Filter (((isnotnull(i_item_sk#7367) AND isnotnull(i_brand_id#7374)) AND isnotnull(i_class_id#7376)) AND isnotnull(i_category_id#7378))
                              :     +- Relation [i_item_sk#7367,i_item_id#7368,i_rec_start_date#7369,i_rec_end_date#7370,i_item_desc#7371,i_current_price#7372,i_wholesale_cost#7373,i_brand_id#7374,i_brand#7375,i_class_id#7376,i_class#7377,i_category_id#7378,i_category#7379,i_manufact_id#7380,i_manufact#7381,i_size#7382,i_formulation#7383,i_color#7384,i_units#7385,i_container#7386,i_manager_id#7387,i_product_name#7388] parquet
                              +- Project [i_item_sk#668 AS ss_item_sk#6966]
                                 +- Join Inner, (((i_brand_id#675 = brand_id#6963) AND (i_class_id#677 = class_id#6964)) AND (i_category_id#679 = category_id#6965))
                                    :- Project [i_item_sk#668, i_brand_id#675, i_class_id#677, i_category_id#679]
                                    :  +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                                    :     +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
                                    +- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
                                       +- Join LeftSemi, (((brand_id#6963 <=> i_brand_id#7053) AND (class_id#6964 <=> i_class_id#7055)) AND (category_id#6965 <=> i_category_id#7057))
                                          :- Aggregate [brand_id#6963, class_id#6964, category_id#6965], [brand_id#6963, class_id#6964, category_id#6965]
                                          :  +- Project [i_brand_id#6981 AS brand_id#6963, i_class_id#6983 AS class_id#6964, i_category_id#6985 AS category_id#6965]
                                          :     +- Join Inner, (ss_sold_date_sk#252 = d_date_sk#612)
                                          :        :- Project [ss_sold_date_sk#252, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
                                          :        :  +- Join Inner, (ss_item_sk#254 = i_item_sk#6974)
                                          :        :     :- Project [ss_sold_date_sk#252, ss_item_sk#254]
                                          :        :     :  +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                                          :        :     :     +- Relation [ss_sold_date_sk#252,ss_sold_time_sk#253,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_quantity#262,ss_wholesale_cost#263,ss_list_price#264,ss_sales_price#265,ss_ext_discount_amt#266,ss_ext_sales_price#267,ss_ext_wholesale_cost#268,ss_ext_list_price#269,ss_ext_tax#270,ss_coupon_amt#271,ss_net_paid#272,ss_net_paid_inc_tax#273,ss_net_profit#274] parquet
                                          :        :     +- Join LeftSemi, (((i_brand_id#6981 <=> i_brand_id#7003) AND (i_class_id#6983 <=> i_class_id#7005)) AND (i_category_id#6985 <=> i_category_id#7007))
                                          :        :        :- Project [i_item_sk#6974, i_brand_id#6981, i_class_id#6983, i_category_id#6985]
                                          :        :        :  +- Filter (isnotnull(i_item_sk#6974) AND ((isnotnull(i_brand_id#6981) AND isnotnull(i_class_id#6983)) AND isnotnull(i_category_id#6985)))
                                          :        :        :     +- Relation [i_item_sk#6974,i_item_id#6975,i_rec_start_date#6976,i_rec_end_date#6977,i_item_desc#6978,i_current_price#6979,i_wholesale_cost#6980,i_brand_id#6981,i_brand#6982,i_class_id#6983,i_class#6984,i_category_id#6985,i_category#6986,i_manufact_id#6987,i_manufact#6988,i_size#6989,i_formulation#6990,i_color#6991,i_units#6992,i_container#6993,i_manager_id#6994,i_product_name#6995] parquet
                                          :        :        +- Project [i_brand_id#7003, i_class_id#7005, i_category_id#7007]
                                          :        :           +- Join Inner, (cs_item_sk#559 = i_item_sk#6996)
                                          :        :              :- Project [cs_item_sk#559]
                                          :        :              :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#7018)
                                          :        :              :     :- Project [cs_sold_date_sk#544, cs_item_sk#559]
                                          :        :              :     :  +- Filter (isnotnull(cs_sold_date_sk#544) AND isnotnull(cs_item_sk#559))
                                          :        :              :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
                                          :        :              :     +- Project [d_date_sk#7018]
                                          :        :              :        +- Filter ((isnotnull(d_year#7024) AND ((d_year#7024 >= 1999) AND (d_year#7024 <= 2001))) AND isnotnull(d_date_sk#7018))
                                          :        :              :           +- Relation [d_date_sk#7018,d_date_id#7019,d_date#7020,d_month_seq#7021,d_week_seq#7022,d_quarter_seq#7023,d_year#7024,d_dow#7025,d_moy#7026,d_dom#7027,d_qoy#7028,d_fy_year#7029,d_fy_quarter_seq#7030,d_fy_week_seq#7031,d_day_name#7032,d_quarter_name#7033,d_holiday#7034,d_weekend#7035,d_following_holiday#7036,d_first_dom#7037,d_last_dom#7038,d_same_day_ly#7039,d_same_day_lq#7040,d_current_day#7041,... 4 more fields] parquet
                                          :        :              +- Project [i_item_sk#6996, i_brand_id#7003, i_class_id#7005, i_category_id#7007]
                                          :        :                 +- Filter isnotnull(i_item_sk#6996)
                                          :        :                    +- Relation [i_item_sk#6996,i_item_id#6997,i_rec_start_date#6998,i_rec_end_date#6999,i_item_desc#7000,i_current_price#7001,i_wholesale_cost#7002,i_brand_id#7003,i_brand#7004,i_class_id#7005,i_class#7006,i_category_id#7007,i_category#7008,i_manufact_id#7009,i_manufact#7010,i_size#7011,i_formulation#7012,i_color#7013,i_units#7014,i_container#7015,i_manager_id#7016,i_product_name#7017] parquet
                                          :        +- Project [d_date_sk#612]
                                          :           +- Filter ((isnotnull(d_year#618) AND ((d_year#618 >= 1999) AND (d_year#618 <= 2001))) AND isnotnull(d_date_sk#612))
                                          :              +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
                                          +- Project [i_brand_id#7053, i_class_id#7055, i_category_id#7057]
                                             +- Join Inner, (ws_item_sk#479 = i_item_sk#7046)
                                                :- Project [ws_item_sk#479]
                                                :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#7068)
                                                :     :- Project [ws_sold_date_sk#476, ws_item_sk#479]
                                                :     :  +- Filter (isnotnull(ws_sold_date_sk#476) AND isnotnull(ws_item_sk#479))
                                                :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
                                                :     +- Project [d_date_sk#7068]
                                                :        +- Filter ((isnotnull(d_year#7074) AND ((d_year#7074 >= 1999) AND (d_year#7074 <= 2001))) AND isnotnull(d_date_sk#7068))
                                                :           +- Relation [d_date_sk#7068,d_date_id#7069,d_date#7070,d_month_seq#7071,d_week_seq#7072,d_quarter_seq#7073,d_year#7074,d_dow#7075,d_moy#7076,d_dom#7077,d_qoy#7078,d_fy_year#7079,d_fy_quarter_seq#7080,d_fy_week_seq#7081,d_day_name#7082,d_quarter_name#7083,d_holiday#7084,d_weekend#7085,d_following_holiday#7086,d_first_dom#7087,d_last_dom#7088,d_same_day_ly#7089,d_same_day_lq#7090,d_current_day#7091,... 4 more fields] parquet
                                                +- Project [i_item_sk#7046, i_brand_id#7053, i_class_id#7055, i_category_id#7057]
                                                   +- Filter isnotnull(i_item_sk#7046)
                                                      +- Relation [i_item_sk#7046,i_item_id#7047,i_rec_start_date#7048,i_rec_end_date#7049,i_item_desc#7050,i_current_price#7051,i_wholesale_cost#7052,i_brand_id#7053,i_brand#7054,i_class_id#7055,i_class#7056,i_category_id#7057,i_category#7058,i_manufact_id#7059,i_manufact#7060,i_size#7061,i_formulation#7062,i_color#7063,i_units#7064,i_container#7065,i_manager_id#7066,i_product_name#7067] parquet
