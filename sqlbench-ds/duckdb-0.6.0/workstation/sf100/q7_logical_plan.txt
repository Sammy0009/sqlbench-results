┌───────────────────────────┐                                                                                                                    
│           TOP_N           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          Top 100          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│     item.i_item_id ASC    │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│       HASH_GROUP_BY       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│          avg(#1)          │                                                                                                                    
│          avg(#2)          │                                                                                                                    
│          avg(#3)          │                                                                                                                    
│          avg(#4)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         i_item_id         │                                                                                                                    
│        ss_quantity        │                                                                                                                    
│       ss_list_price       │                                                                                                                    
│       ss_coupon_amt       │                                                                                                                    
│       ss_sales_price      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                                                                                                                    
│  ss_promo_sk = p_promo_sk ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│    EC = 11519879.762608   │                                                                                                     │              
│   COST = 92159038.100867  │                                                                                                     │              
└─────────────┬─────────────┘                                                                                                     │                                           
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                       │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                       │             #0            │
│   ss_item_sk = i_item_sk  ├────────────────────────────────────────────────────────────────────────┐              │                           │
│    EC = 11519879.762608   │                                                                        │              │                           │
│   COST = 80639158.338259  │                                                                        │              │                           │
└─────────────┬─────────────┘                                                                        │              └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │        PARQUET_SCAN       ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         i_item_sk         ││((p_channel_email = 'N') OR│
│ss_sold_date_sk = d_date_sk├───────────────────────────────────────────┐              │         i_item_id         ││  (p_channel_event = 'N')) │
│    EC = 11519879.762608   │                                           │              │         EC=202300         ││                           │
│   COST = 69119278.575650  │                                           │              │                           ││                           │
└─────────────┬─────────────┘                                           │              └───────────────────────────┘└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         HASH_JOIN         │                             │        PARQUET_SCAN       │                             │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                             │         d_date_sk         │                             │         p_promo_sk        │
│  ss_cdemo_sk = cd_demo_sk ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │      p_channel_email      │
│    EC = 57599398.813042   │              │              │  Filters: d_year=2001 AND │                             │      p_channel_event      │
│   COST = 57599398.813042  │              │              │     d_year IS NOT NULL    │                             │          EC=1000          │
│                           │              │              │          EC=8118          │                             │                           │
└─────────────┬─────────────┘              │              └───────────────────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      ss_sold_date_sk      ││         cd_demo_sk        │                                                                                       
│         ss_item_sk        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│        ss_cdemo_sk        ││  Filters: cd_gender=M AND │                                                                                       
│        ss_promo_sk        ││    cd_gender IS NOT NULL  │                                                                                       
│        ss_quantity        ││  cd_education_status=4 yr │                                                                                       
│       ss_list_price       ││         Degree AND        │                                                                                       
│       ss_sales_price      ││ cd_education_status I...  │                                                                                       
│       ss_coupon_amt       ││  cd_marital_status=M AND  │                                                                                       
│        EC=287997144       ││ cd_marital_status IS ...  │                                                                                       
│                           ││         EC=384163         │                                                                                       
└───────────────────────────┘└───────────────────────────┘                                                                                                                    

