┌───────────────────────────┐                                                                                                                                                                                                           
│           TOP_N           │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          Top 100          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│     item.i_item_id ASC    │                                                                                                                                                                                                           
│    item.i_item_desc ASC   │                                                                                                                                                                                                           
│    store.s_store_id ASC   │                                                                                                                                                                                                           
│   store.s_store_name ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│       HASH_GROUP_BY       │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│             #1            │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
│             #3            │                                                                                                                                                                                                           
│          min(#4)          │                                                                                                                                                                                                           
│          min(#5)          │                                                                                                                                                                                                           
│          min(#6)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│         i_item_id         │                                                                                                                                                                                                           
│        i_item_desc        │                                                                                                                                                                                                           
│         s_store_id        │                                                                                                                                                                                                           
│        s_store_name       │                                                                                                                                                                                                           
│       ss_net_profit       │                                                                                                                                                                                                           
│        sr_net_loss        │                                                                                                                                                                                                           
│       cs_net_profit       │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│  ss_store_sk = s_store_sk ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│    EC = 11533021.419681   │                                                                                                                                                                                            │              
│  COST = 126731687.959362  │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │         s_store_sk        │
│      ss_customer_sk =     │                                                                                                                                                                              │         s_store_id        │
│       sr_customer_sk      │                                                                                                                                                                              │        s_store_name       │
│  ss_item_sk = sr_item_sk  │                                                                                                                                                                              │           EC=402          │
│     ss_ticket_number =    │                                                                                                                                                                              │                           │
│      sr_ticket_number     ├───────────────────────────────────────────┐                                                                                                                                  │                           │
│   ss_item_sk = i_item_sk  │                                           │                                                                                                                                  │                           │
│      ss_customer_sk =     │                                           │                                                                                                                                  │                           │
│     cs_bill_customer_sk   │                                           │                                                                                                                                  │                           │
│  ss_item_sk = cs_item_sk  │                                           │                                                                                                                                  │                           │
│    EC = 11533021.419681   │                                           │                                                                                                                                  │                           │
│  COST = 115198666.539681  │                                           │                                                                                                                                  │                           │
└─────────────┬─────────────┘                                           │                                                                                                                                  └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                             │           INNER           │                                                                                                                                                 
│ss_sold_date_sk = d_date_sk│                             │   cs_item_sk = i_item_sk  │                                                                                                                                                 
│    EC = 57599428.800000   ├──────────────┐              │   cs_bill_customer_sk =   ├───────────────────────────────────────────┐                                                                                                     
│   COST = 57599428.800000  │              │              │       sr_customer_sk      │                                           │                                                                                                     
│                           │              │              │  cs_item_sk = sr_item_sk  │                                           │                                                                                                     
│                           │              │              │    EC = 5759917.120000    │                                           │                                                                                                     
│                           │              │              │   COST = 46066216.320000  │                                           │                                                                                                     
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                                                                                  
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                       
│        PARQUET_SCAN       ││        PARQUET_SCAN       ││         HASH_JOIN         │                             │         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      ss_sold_date_sk      ││         d_date_sk         ││           INNER           │                             │           INNER           │                                                                                       
│         ss_item_sk        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││cs_sold_date_sk = d_date_sk│                             │   sr_item_sk = i_item_sk  │                                                                                       
│       ss_customer_sk      ││ Filters: d_moy=4 AND d_moy││    EC = 28799585.600000   ├──────────────┐              │    EC = 5753356.800000    ├───────────────────────────────────────────┐                                           
│        ss_store_sk        ││         IS NOT NULL       ││   COST = 28799585.600000  │              │              │   COST = 11506713.600000  │                                           │                                           
│      ss_ticket_number     ││ d_year=2002 AND d_year IS ││                           │              │              │                           │                                           │                                           
│       ss_net_profit       ││          NOT NULL         ││                           │              │              │                           │                                           │                                           
│        EC=287997144       ││          EC=8118          ││                           │              │              │                           │                                           │                                           
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                           │                                                                        
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                                                          │        PARQUET_SCAN       ││        PARQUET_SCAN       ││         HASH_JOIN         │                             │        PARQUET_SCAN       │                             
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                          │      cs_sold_date_sk      ││         d_date_sk         ││           INNER           │                             │         i_item_sk         │                             
                                                          │    cs_bill_customer_sk    ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   sr_returned_date_sk =   │                             │         i_item_id         │                             
                                                          │         cs_item_sk        ││  Filters: d_year=2002 AND ││          d_date_sk        ├──────────────┐              │        i_item_desc        │                             
                                                          │       cs_net_profit       ││     d_year IS NOT NULL    ││    EC = 5753356.800000    │              │              │         EC=202300         │                             
                                                          │        EC=143997928       ││ d_moy>=4 AND d_moy<=10 AND││   COST = 5753356.800000   │              │              │                           │                             
                                                          │                           ││      d_moy IS NOT NULL    ││                           │              │              │                           │                             
                                                          │                           ││          EC=8118          ││                           │              │              │                           │                             
                                                          └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘              │              └───────────────────────────┘                                                          
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                                                                                                                    │        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                                                    │    sr_returned_date_sk    ││         d_date_sk         │                                                          
                                                                                                                    │         sr_item_sk        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                                                    │       sr_customer_sk      ││  Filters: d_year=2002 AND │                                                          
                                                                                                                    │      sr_ticket_number     ││     d_year IS NOT NULL    │                                                          
                                                                                                                    │        sr_net_loss        ││ d_moy>=4 AND d_moy<=10 AND│                                                          
                                                                                                                    │        EC=28766784        ││      d_moy IS NOT NULL    │                                                          
                                                                                                                    │                           ││          EC=8118          │                                                          
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                                                                                       

