┌───────────────────────────┐                                                                                                                                                 
│           TOP_N           │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          Top 100          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│     item.i_item_id ASC    │                                                                                                                                                 
│     store.s_state ASC     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         i_item_id         │                                                                                                                                                 
│          s_state          │                                                                                                                                                 
│          g_state          │                                                                                                                                                 
│            agg1           │                                                                                                                                                 
│            agg2           │                                                                                                                                                 
│            agg3           │                                                                                                                                                 
│            agg4           │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│       HASH_GROUP_BY       │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #0            │                                                                                                                                                 
│             #1            │                                                                                                                                                 
│          avg(#2)          │                                                                                                                                                 
│          avg(#3)          │                                                                                                                                                 
│          avg(#4)          │                                                                                                                                                 
│          avg(#5)          │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│         i_item_id         │                                                                                                                                                 
│          s_state          │                                                                                                                                                 
│        ss_quantity        │                                                                                                                                                 
│       ss_list_price       │                                                                                                                                                 
│       ss_coupon_amt       │                                                                                                                                                 
│       ss_sales_price      │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│   ss_item_sk = i_item_sk  ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│    EC = 11519879.762608   │                                                                                                                                  │              
│   COST = 92159038.100867  │                                                                                                                                  │              
└─────────────┬─────────────┘                                                                                                                                  │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                    │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                    │         i_item_sk         │
│  ss_store_sk = s_store_sk ├────────────────────────────────────────────────────────────────────────┐                                           │         i_item_id         │
│    EC = 11519879.762608   │                                                                        │                                           │         EC=202300         │
│   COST = 80639158.338259  │                                                                        │                                           │                           │
└─────────────┬─────────────┘                                                                        │                                           └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │             #0            │                                                          
│ss_sold_date_sk = d_date_sk├───────────────────────────────────────────┐              │             #1            │                                                          
│    EC = 11519879.762608   │                                           │              │                           │                                                          
│   COST = 69119278.575650  │                                           │              │                           │                                                          
└─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │        PARQUET_SCAN       ││           FILTER          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │         d_date_sk         ││          IN (...)         │                                                          
│  ss_cdemo_sk = cd_demo_sk ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
│    EC = 57599398.813042   │              │              │  Filters: d_year=1999 AND ││                           │                                                          
│   COST = 57599398.813042  │              │              │     d_year IS NOT NULL    ││                           │                                                          
│                           │              │              │          EC=8118          ││                           │                                                          
└─────────────┬─────────────┘              │              └───────────────────────────┘└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                             │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      ss_sold_date_sk      ││         cd_demo_sk        │                             │            MARK           │                                                          
│         ss_item_sk        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │        s_state = #0       │                                                          
│        ss_cdemo_sk        ││  Filters: cd_gender=M AND │                             │       EC = 0.000000       │                                                          
│        ss_store_sk        ││    cd_gender IS NOT NULL  │                             │      COST = 0.000000      │                                                          
│        ss_quantity        ││cd_education_status=College│                             │                           ├──────────────┐                                           
│       ss_list_price       ││ AND cd_education_status IS│                             │                           │              │                                           
│       ss_sales_price      ││          NOT NULL         │                             │                           │              │                                           
│       ss_coupon_amt       ││  cd_marital_status=M AND  │                             │                           │              │                                           
│        EC=287997144       ││ cd_marital_status IS ...  │                             │                           │              │                                           
│                           ││         EC=384163         │                             │                           │              │                                           
└───────────────────────────┘└───────────────────────────┘                             └─────────────┬─────────────┘              │                                                                        
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                       │        PARQUET_SCAN       ││      COLUMN_DATA_SCAN     │                             
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
                                                                                       │         s_store_sk        ││                           │                             
                                                                                       │          s_state          ││                           │                             
                                                                                       │           EC=402          ││                           │                             
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                          

