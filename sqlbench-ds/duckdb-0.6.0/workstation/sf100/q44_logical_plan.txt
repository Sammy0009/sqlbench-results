┌───────────────────────────┐                                                                                                                                                 
│           TOP_N           │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          Top 100          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│      asceding.rnk ASC     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│            rnk            │                                                                                                                                                 
│      best_performing      │                                                                                                                                                 
│      worst_performing     │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           INNER           │                                                                                                                                                 
│         rnk = rnk         ├────────────────────────────────────────────────────────────────────────┐                                                                        
│   EC = 287997144.000000   │                                                                        │                                                                        
│  COST = 863991432.000000  │                                                                        │                                                                        
└─────────────┬─────────────┘                                                                        │                                                                                                     
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                          │         HASH_JOIN         │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │           INNER           │                                                          
│    item_sk = i_item_sk    ├───────────────────────────────────────────┐              │    item_sk = i_item_sk    ├───────────────────────────────────────────┐              
│   EC = 287997144.000000   │                                           │              │   EC = 287997144.000000   │                                           │              
│  COST = 287997144.000000  │                                           │              │  COST = 287997144.000000  │                                           │              
└─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘                                           │                                           
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         PROJECTION        │                             │        PARQUET_SCAN       ││         PROJECTION        │                             │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                             │         i_item_sk         ││             #0            │                             │         i_item_sk         │
│             #2            │                             │       i_product_name      ││             #2            │                             │       i_product_name      │
│                           │                             │         EC=202300         ││                           │                             │         EC=202300         │
└─────────────┬─────────────┘                             └───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│           FILTER          │                                                          │           FILTER          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│         (rnk < 11)        │                                                          │         (rnk < 11)        │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│           WINDOW          │                                                          │           WINDOW          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│   RANK() OVER (ORDER BY   │                                                          │   RANK() OVER (ORDER BY   │                                                          
│  rank_col ASC NULLS FIRST)│                                                          │ rank_col DESC NULLS FIRST)│                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│          item_sk          │                                                          │          item_sk          │                                                          
│          rank_col         │                                                          │          rank_col         │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│    PIECEWISE_MERGE_JOIN   │                                                          │    PIECEWISE_MERGE_JOIN   │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                          │           INNER           │                                                          
│avg(ss_net_profit) > (0.9 *├──────────────┐                                           │avg(ss_net_profit) > (0.9 *├──────────────┐                                           
│          SUBQUERY)        │              │                                           │          SUBQUERY)        │              │                                           
│       EC = 0.000000       │              │                                           │       EC = 0.000000       │              │                                           
│      COST = 0.000000      │              │                                           │      COST = 0.000000      │              │                                           
└─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘              │                                                                        
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│       HASH_GROUP_BY       ││    UNGROUPED_AGGREGATE    │                             │       HASH_GROUP_BY       ││    UNGROUPED_AGGREGATE    │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            ││         first(#0)         │                             │             #0            ││         first(#0)         │                             
│          avg(#1)          ││                           │                             │          avg(#1)          ││                           │                             
└─────────────┬─────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│         PROJECTION        ││         PROJECTION        │                             │         PROJECTION        ││         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│         ss_item_sk        ││             #0            │                             │         ss_item_sk        ││             #0            │                             
│       ss_net_profit       ││                           │                             │       ss_net_profit       ││                           │                             
└─────────────┬─────────────┘└─────────────┬─────────────┘                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
│        PARQUET_SCAN       ││      STREAMING_LIMIT      │                             │        PARQUET_SCAN       ││      STREAMING_LIMIT      │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│         ss_item_sk        ││                           │                             │         ss_item_sk        ││                           │                             
│       ss_net_profit       ││                           │                             │       ss_net_profit       ││                           │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                             
│Filters: ss_store_sk=21 AND││                           │                             │Filters: ss_store_sk=21 AND││                           │                             
│   ss_store_sk IS NOT NULL ││                           │                             │   ss_store_sk IS NOT NULL ││                           │                             
│        EC=287997144       ││                           │                             │        EC=287997144       ││                           │                             
└───────────────────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘└─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │         PROJECTION        │                                                          │         PROJECTION        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │          rank_col         │                                                          │          rank_col         │                             
                             └─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │       HASH_GROUP_BY       │                                                          │       HASH_GROUP_BY       │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │             #0            │                                                          │             #0            │                             
                             │          avg(#1)          │                                                          │          avg(#1)          │                             
                             └─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │         PROJECTION        │                                                          │         PROJECTION        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │        ss_store_sk        │                                                          │        ss_store_sk        │                             
                             │       ss_net_profit       │                                                          │       ss_net_profit       │                             
                             └─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │         PROJECTION        │                                                          │         PROJECTION        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │             #1            │                                                          │             #1            │                             
                             │             #2            │                                                          │             #2            │                             
                             └─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │           FILTER          │                                                          │           FILTER          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │   (ss_hdemo_sk IS NULL)   │                                                          │   (ss_hdemo_sk IS NULL)   │                             
                             └─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │        PARQUET_SCAN       │                                                          │        PARQUET_SCAN       │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │        ss_hdemo_sk        │                                                          │        ss_hdemo_sk        │                             
                             │        ss_store_sk        │                                                          │        ss_store_sk        │                             
                             │       ss_net_profit       │                                                          │       ss_net_profit       │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │Filters: ss_store_sk=21 AND│                                                          │Filters: ss_store_sk=21 AND│                             
                             │   ss_store_sk IS NOT NULL │                                                          │   ss_store_sk IS NOT NULL │                             
                             │        EC=287997144       │                                                          │        EC=287997144       │                             
                             └───────────────────────────┘                                                          └───────────────────────────┘                                                          

