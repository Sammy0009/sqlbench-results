┌───────────────────────────┐                                                                                                                                                 
│           TOP_N           │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│          Top 100          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ customer.c_customer_id ASC│                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         PROJECTION        │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│             #1            │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│           FILTER          │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│ (CAST(ctr_total_return AS │                                                                                                                                                 
│     DOUBLE) > SUBQUERY)   │                                                                                                                                                 
└─────────────┬─────────────┘                                                                                                                                                                              
┌─────────────┴─────────────┐                                                                                                                                                 
│         HASH_JOIN         │                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
│           SINGLE          │                                                                                                                                                 
│    ctr_store_sk IS NOT    ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│ DISTINCT FROM ctr_store_sk│                                                                                                     │                                           
│       EC = 0.000000       │                                                                                                     │                                           
│      COST = 0.000000      │                                                                                                     │                                           
└─────────────┬─────────────┘                                                                                                     │                                                                        
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                                                       │         PROJECTION        │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                                                                                       │ (avg(ctr_total_return) * 1│                             
│      c_customer_sk =      ├──────────────┐                                                                        │            .2)            │                             
│       ctr_customer_sk     │              │                                                                        │             #0            │                             
│    EC = 1144946.467662    │              │                                                                        │                           │                             
│   COST = 2289892.935323   │              │                                                                        │                           │                             
└─────────────┬─────────────┘              │                                                                        └─────────────┬─────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
│        PARQUET_SCAN       ││         HASH_JOIN         │                                                          │       HASH_GROUP_BY       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│       c_customer_sk       ││           INNER           │                                                          │             #0            │                             
│       c_customer_id       ││ ctr_store_sk = s_store_sk ├───────────────────────────────────────────┐              │          avg(#1)          │                             
│         EC=1999968        ││    EC = 1144946.467662    │                                           │              │                           │                             
│                           ││   COST = 1144946.467662   │                                           │              │                           │                             
└───────────────────────────┘└─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                             │       HASH_GROUP_BY       │                             │        PARQUET_SCAN       ││         PROJECTION        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │             #0            │                             │         s_store_sk        ││        ctr_store_sk       │                             
                             │             #1            │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││      ctr_total_return     │                             
                             │          sum(#2)          │                             │  Filters: s_state=OH AND  ││                           │                             
                             │                           │                             │     s_state IS NOT NULL   ││                           │                             
                             │                           │                             │           EC=80           ││                           │                             
                             └─────────────┬─────────────┘                             └───────────────────────────┘└─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │         PROJECTION        │                                                          │           FILTER          │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │       sr_customer_sk      │                                                          │ (ctr_store_sk IS NOT NULL)│                             
                             │        sr_store_sk        │                                                          │                           │                             
                             │   sr_return_amt_inc_tax   │                                                          │                           │                             
                             └─────────────┬─────────────┘                                                          └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
                             │         HASH_JOIN         │                                                          │         PROJECTION        │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │           INNER           │                                                          │        ctr_store_sk       │                             
                             │   sr_returned_date_sk =   ├──────────────┐                                           │      ctr_total_return     │                             
                             │          d_date_sk        │              │                                           │                           │                             
                             │    EC = 5753356.800000    │              │                                           │                           │                             
                             │   COST = 5753356.800000   │              │                                           │                           │                             
                             └─────────────┬─────────────┘              │                                           └─────────────┬─────────────┘                                                          
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
                             │        PARQUET_SCAN       ││        PARQUET_SCAN       │                             │       HASH_GROUP_BY       │                             
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                             │    sr_returned_date_sk    ││         d_date_sk         │                             │             #0            │                             
                             │       sr_customer_sk      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │             #1            │                             
                             │        sr_store_sk        ││  Filters: d_year=1999 AND │                             │          sum(#2)          │                             
                             │   sr_return_amt_inc_tax   ││     d_year IS NOT NULL    │                             │                           │                             
                             │        EC=28766784        ││          EC=8118          │                             │                           │                             
                             └───────────────────────────┘└───────────────────────────┘                             └─────────────┬─────────────┘                                                          
                                                                                                                    ┌─────────────┴─────────────┐                             
                                                                                                                    │         PROJECTION        │                             
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                                                    │       sr_customer_sk      │                             
                                                                                                                    │        sr_store_sk        │                             
                                                                                                                    │   sr_return_amt_inc_tax   │                             
                                                                                                                    └─────────────┬─────────────┘                                                          
                                                                                                                    ┌─────────────┴─────────────┐                             
                                                                                                                    │         HASH_JOIN         │                             
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                                                    │           INNER           │                             
                                                                                                                    │   sr_returned_date_sk =   ├──────────────┐              
                                                                                                                    │          d_date_sk        │              │              
                                                                                                                    │    EC = 5753356.800000    │              │              
                                                                                                                    │   COST = 5753356.800000   │              │              
                                                                                                                    └─────────────┬─────────────┘              │                                           
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                                                    │        PARQUET_SCAN       ││        PARQUET_SCAN       │
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │    sr_returned_date_sk    ││         d_date_sk         │
                                                                                                                    │       sr_customer_sk      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                    │        sr_store_sk        ││  Filters: d_year=1999 AND │
                                                                                                                    │   sr_return_amt_inc_tax   ││     d_year IS NOT NULL    │
                                                                                                                    │        EC=28766784        ││          EC=8118          │
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             

