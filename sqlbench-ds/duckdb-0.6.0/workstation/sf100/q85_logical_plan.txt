┌───────────────────────────┐                                                                                                                                                                                                           
│           TOP_N           │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          Top 100          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│substr(reason.r_reason_desc│                                                                                                                                                                                                           
│        , 1, 20) ASC       │                                                                                                                                                                                                           
│ avg(web_sales.ws_quantity)│                                                                                                                                                                                                           
│             ASC           │                                                                                                                                                                                                           
│      avg(web_returns      │                                                                                                                                                                                                           
│   .wr_refunded_cash) ASC  │                                                                                                                                                                                                           
│avg(web_returns.wr_fee) ASC│                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│substr(r_reason_desc, 1, 20│                                                                                                                                                                                                           
│             )             │                                                                                                                                                                                                           
│      avg(ws_quantity)     │                                                                                                                                                                                                           
│   avg(wr_refunded_cash)   │                                                                                                                                                                                                           
│        avg(wr_fee)        │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│       HASH_GROUP_BY       │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #0            │                                                                                                                                                                                                           
│          avg(#1)          │                                                                                                                                                                                                           
│          avg(#2)          │                                                                                                                                                                                                           
│          avg(#3)          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│       r_reason_desc       │                                                                                                                                                                                                           
│        ws_quantity        │                                                                                                                                                                                                           
│      wr_refunded_cash     │                                                                                                                                                                                                           
│           wr_fee          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│      ws_web_page_sk =     ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│       wp_web_page_sk      │                                                                                                                                                                                            │              
│    EC = 2880055.680061    │                                                                                                                                                                                            │              
│   COST = 25915731.850091  │                                                                                                                                                                                            │              
└─────────────┬─────────────┘                                                                                                                                                                                            │                                           
┌─────────────┴─────────────┐                                                                                                                                                                              ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                                                                                                              │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                                                                                                              │       wp_web_page_sk      │
│ws_sold_date_sk = d_date_sk├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐              │          EC=2040          │
│    EC = 2880055.680061    │                                                                                                                                                               │              │                           │
│   COST = 23035676.170030  │                                                                                                                                                               │              │                           │
└─────────────┬─────────────┘                                                                                                                                                               │              └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                 ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                                                 │        PARQUET_SCAN       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #0            │                                                                                                                                                 │         d_date_sk         │                             
│             #2            │                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│             #4            │                                                                                                                                                 │  Filters: d_year=1998 AND │                             
│             #9            │                                                                                                                                                 │     d_year IS NOT NULL    │                             
│            #10            │                                                                                                                                                 │          EC=8118          │                             
│            #12            │                                                                                                                                                 │                           │                             
└─────────────┬─────────────┘                                                                                                                                                 └───────────────────────────┘                                                          
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│           FILTER          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│ (((((ws_sales_price >= 100│                                                                                                                                                                                                           
│.00) AND (ws_sales_price <=│                                                                                                                                                                                                           
│        150.00)) AND       │                                                                                                                                                                                                           
│(cd_marital_status = '...  │                                                                                                                                                                                                           
│(cd_education_status =...  │                                                                                                                                                                                                           
│ OR (((ws_sales_price >= 50│                                                                                                                                                                                                           
│.00) AND (ws_sales_price <=│                                                                                                                                                                                                           
│        100.00)) AND       │                                                                                                                                                                                                           
│(cd_marital_status = '...  │                                                                                                                                                                                                           
│(cd_education_status =...  │                                                                                                                                                                                                           
│((ws_sales_price >= 150.00)│                                                                                                                                                                                                           
│ AND (ws_sales_price <= 200│                                                                                                                                                                                                           
│         .00)) AND         │                                                                                                                                                                                                           
│(cd_marital_status = '...  │                                                                                                                                                                                                           
│(cd_education_status =...  │                                                                                                                                                                                                           
│(((ws_net_profit >= 100.00)│                                                                                                                                                                                                           
│  AND (ws_net_profit <= 200│                                                                                                                                                                                                           
│.00)) AND ((ca_state =...  │                                                                                                                                                                                                           
│  OR (ca_state = 'CO') OR  │                                                                                                                                                                                                           
│ (ca_state = 'OK'))) OR (( │                                                                                                                                                                                                           
│(ws_net_profit >= 150....  │                                                                                                                                                                                                           
│ (ws_net_profit <= 300.00))│                                                                                                                                                                                                           
│ AND ((ca_state = 'MA') OR │                                                                                                                                                                                                           
│   (ca_state = 'GA') OR    │                                                                                                                                                                                                           
│ (ca_state = 'MI'))) OR (( │                                                                                                                                                                                                           
│(ws_net_profit >= 50.0...  │                                                                                                                                                                                                           
│(ws_net_profit <= 250....  │                                                                                                                                                                                                           
│(ca_state = 'CA') OR (...  │                                                                                                                                                                                                           
│ = 'IA') OR (ca_state = 'IL│                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│  ws_item_sk = wr_item_sk  │                                                                                                                                                                                                           
│     ws_order_number =     ├──────────────┐                                                                                                                                                                                            
│       wr_order_number     │              │                                                                                                                                                                                            
│    EC = 14400278.400307   │              │                                                                                                                                                                                            
│   COST = 20155620.489968  │              │                                                                                                                                                                                            
└─────────────┬─────────────┘              │                                                                                                                                                                                                                         
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                              
│        PARQUET_SCAN       ││         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│      ws_sold_date_sk      ││           INNER           │                                                                                                                                                                              
│         ws_item_sk        ││ wr_reason_sk = r_reason_sk│                                                                                                                                                                              
│       ws_web_page_sk      ││    EC = 1438835.522415    │                                                                                                                                                                              
│      ws_order_number      ││   COST = 5755342.089661   ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│        ws_quantity        ││                           │                                                                                                     │                                                                        
│       ws_sales_price      ││                           │                                                                                                     │                                                                        
│       ws_net_profit       ││                           │                                                                                                     │                                                                        
│        EC=72001536        ││                           │                                                                                                     │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                     │                                                                                                     
                             ┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
                             │         HASH_JOIN         │                                                                                       │        PARQUET_SCAN       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │           INNER           │                                                                                       │        r_reason_sk        │                                                          
                             │    cd_marital_status =    │                                                                                       │       r_reason_desc       │                                                          
                             │      cd_marital_status    │                                                                                       │           EC=55           │                                                          
                             │   cd_education_status =   ├──────────────┐                                                                        │                           │                                                          
                             │     cd_education_status   │              │                                                                        │                           │                                                          
                             │        cd_demo_sk =       │              │                                                                        │                           │                                                          
                             │    wr_returning_cdemo_sk  │              │                                                                        │                           │                                                          
                             │    EC = 1438835.522415    │              │                                                                        │                           │                                                          
                             │   COST = 4316506.567246   │              │                                                                        │                           │                                                          
                             └─────────────┬─────────────┘              │                                                                        └───────────────────────────┘                                                                                       
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                 
                             │        PARQUET_SCAN       ││         HASH_JOIN         │                                                                                                                                                 
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
                             │         cd_demo_sk        ││           INNER           │                                                                                                                                                 
                             │     cd_marital_status     ││        cd_demo_sk =       ├──────────────┐                                                                                                                                  
                             │    cd_education_status    ││    wr_refunded_cdemo_sk   │              │                                                                                                                                  
                             │         EC=1920816        ││    EC = 1438835.522415    │              │                                                                                                                                  
                             │                           ││   COST = 2877671.044831   │              │                                                                                                                                  
                             └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                                               
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                                                          │        PARQUET_SCAN       ││         HASH_JOIN         │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         cd_demo_sk        ││           INNER           │                                                                                                                    
                                                          │     cd_marital_status     ││   wr_refunded_addr_sk =   ├──────────────┐                                                                                                     
                                                          │    cd_education_status    ││        ca_address_sk      │              │                                                                                                     
                                                          │         EC=1920816        ││    EC = 1438835.522415    │              │                                                                                                     
                                                          │                           ││   COST = 1438835.522415   │              │                                                                                                     
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                                                  
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
                                                                                       │        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                                                       
                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │         wr_item_sk        ││       ca_address_sk       │                                                                                       
                                                                                       │    wr_refunded_cdemo_sk   ││          ca_state         │                                                                                       
                                                                                       │    wr_refunded_addr_sk    ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
                                                                                       │   wr_returning_cdemo_sk   ││ Filters: ca_country=United│                                                                                       
                                                                                       │        wr_reason_sk       ││  States AND ca_country IS │                                                                                       
                                                                                       │      wr_order_number      ││          NOT NULL         │                                                                                       
                                                                                       │           wr_fee          ││         EC=200006         │                                                                                       
                                                                                       │      wr_refunded_cash     ││                           │                                                                                       
                                                                                       │         EC=7194192        ││                           │                                                                                       
                                                                                       └───────────────────────────┘└───────────────────────────┘                                                                                                                    

