┌───────────────────────────┐                                                                                                                                                                                                           
│           TOP_N           │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          Top 100          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│ (CAST("at".amc AS DECIMAL │                                                                                                                                                                                                           
│  (15,4)) / CAST(pt.pmc AS │                                                                                                                                                                                                           
│     DECIMAL(15,4))) ASC   │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│        am_pm_ratio        │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│       CROSS_PRODUCT       ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                     
└─────────────┬─────────────┘                                                                                                     │                                                                                                                                  
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│    UNGROUPED_AGGREGATE    │                                                                                       │    UNGROUPED_AGGREGATE    │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│        count_star()       │                                                                                       │        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                       └─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       │           INNER           │                                                                                       
│      ws_web_page_sk =     ├────────────────────────────────────────────────────────────────────────┐              │      ws_web_page_sk =     ├────────────────────────────────────────────────────────────────────────┐              
│       wp_web_page_sk      │                                                                        │              │       wp_web_page_sk      │                                                                        │              
│     EC = 575939.176077    │                                                                        │              │     EC = 575939.176077    │                                                                        │              
│   COST = 17854114.458377  │                                                                        │              │   COST = 17854114.458377  │                                                                        │              
└─────────────┬─────────────┘                                                                        │              └─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │        PARQUET_SCAN       ││         HASH_JOIN         │                                                          │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │       wp_web_page_sk      ││           INNER           │                                                          │       wp_web_page_sk      │
│     ws_ship_hdemo_sk =    │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││     ws_ship_hdemo_sk =    │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         hd_demo_sk        ├───────────────────────────────────────────┐              │  Filters: wp_char_count>  ││         hd_demo_sk        ├───────────────────────────────────────────┐              │  Filters: wp_char_count>  │
│    EC = 2879695.880383    │                                           │              │=5000 AND wp_char_coun...  ││    EC = 2879695.880383    │                                           │              │=5000 AND wp_char_coun...  │
│   COST = 17278175.282300  │                                           │              │  AND wp_char_count IS NOT ││   COST = 17278175.282300  │                                           │              │  AND wp_char_count IS NOT │
│                           │                                           │              │            NULL           ││                           │                                           │              │            NULL           │
│                           │                                           │              │           EC=408          ││                           │                                           │              │           EC=408          │
└─────────────┬─────────────┘                                           │              └───────────────────────────┘└─────────────┬─────────────┘                                           │              └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             │        PARQUET_SCAN       │                             │         HASH_JOIN         │                             │        PARQUET_SCAN       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             │         hd_demo_sk        │                             │           INNER           │                             │         hd_demo_sk        │                             
│ws_sold_time_sk = t_time_sk├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │ws_sold_time_sk = t_time_sk├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│    EC = 14398479.401917   │              │              │Filters: hd_dep_count=6 AND│                             │    EC = 14398479.401917   │              │              │Filters: hd_dep_count=6 AND│                             
│   COST = 14398479.401917  │              │              │  hd_dep_count IS NOT NULL │                             │   COST = 14398479.401917  │              │              │  hd_dep_count IS NOT NULL │                             
│                           │              │              │          EC=1440          │                             │                           │              │              │          EC=1440          │                             
└─────────────┬─────────────┘              │              └───────────────────────────┘                             └─────────────┬─────────────┘              │              └───────────────────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          │        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      ws_sold_time_sk      ││         t_time_sk         │                                                          │      ws_sold_time_sk      ││         t_time_sk         │                                                          
│      ws_ship_hdemo_sk     ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │      ws_ship_hdemo_sk     ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│       ws_web_page_sk      ││  Filters: t_hour>=10 AND  │                                                          │       ws_web_page_sk      ││  Filters: t_hour>=18 AND  │                                                          
│        EC=72001536        ││ t_hour<=11 AND t_hour...  │                                                          │        EC=72001536        ││ t_hour<=19 AND t_hour...  │                                                          
│                           ││            NULL           │                                                          │                           ││            NULL           │                                                          
│                           ││          EC=6302          │                                                          │                           ││          EC=6302          │                                                          
└───────────────────────────┘└───────────────────────────┘                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

