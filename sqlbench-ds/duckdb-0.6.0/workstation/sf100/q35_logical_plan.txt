┌───────────────────────┐                                                                                                                                                                                                        
│         TOP_N         │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│        Top 100        │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│    ca.ca_state ASC    │                                                                                                                                                                                                        
│ customer_demographics │                                                                                                                                                                                                        
│     .cd_gender ASC    │                                                                                                                                                                                                        
│ customer_demographics │                                                                                                                                                                                                        
│ .cd_marital_status ASC│                                                                                                                                                                                                        
│ customer_demographics │                                                                                                                                                                                                        
│   .cd_dep_count ASC   │                                                                                                                                                                                                        
│ customer_demographics │                                                                                                                                                                                                        
│ .cd_dep_employed_count│                                                                                                                                                                                                        
│           ASC         │                                                                                                                                                                                                        
│ customer_demographics │                                                                                                                                                                                                        
│.cd_dep_college_co...  │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       PROJECTION      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│        ca_state       │                                                                                                                                                                                                        
│       cd_gender       │                                                                                                                                                                                                        
│   cd_marital_status   │                                                                                                                                                                                                        
│      cd_dep_count     │                                                                                                                                                                                                        
│          cnt1         │                                                                                                                                                                                                        
│   min(cd_dep_count)   │                                                                                                                                                                                                        
│   max(cd_dep_count)   │                                                                                                                                                                                                        
│   max(cd_dep_count)   │                                                                                                                                                                                                        
│ cd_dep_employed_count │                                                                                                                                                                                                        
│          cnt2         │                                                                                                                                                                                                        
│min(cd_dep_employed_cou│                                                                                                                                                                                                        
│          nt)          │                                                                                                                                                                                                        
│max(cd_dep_employed_cou│                                                                                                                                                                                                        
│          nt)          │                                                                                                                                                                                                        
│max(cd_dep_employed_cou│                                                                                                                                                                                                        
│          nt)          │                                                                                                                                                                                                        
│  cd_dep_college_count │                                                                                                                                                                                                        
│          cnt3         │                                                                                                                                                                                                        
│min(cd_dep_college_coun│                                                                                                                                                                                                        
│           t)          │                                                                                                                                                                                                        
│max(cd_dep_college_coun│                                                                                                                                                                                                        
│           t)          │                                                                                                                                                                                                        
│max(cd_dep_college_coun│                                                                                                                                                                                                        
│           t)          │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│     HASH_GROUP_BY     │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│           #0          │                                                                                                                                                                                                        
│           #1          │                                                                                                                                                                                                        
│           #2          │                                                                                                                                                                                                        
│           #3          │                                                                                                                                                                                                        
│           #4          │                                                                                                                                                                                                        
│           #5          │                                                                                                                                                                                                        
│      count_star()     │                                                                                                                                                                                                        
│        min(#6)        │                                                                                                                                                                                                        
│        max(#7)        │                                                                                                                                                                                                        
│        min(#8)        │                                                                                                                                                                                                        
│        max(#9)        │                                                                                                                                                                                                        
│        min(#10)       │                                                                                                                                                                                                        
│        max(#11)       │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       PROJECTION      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│        ca_state       │                                                                                                                                                                                                        
│       cd_gender       │                                                                                                                                                                                                        
│   cd_marital_status   │                                                                                                                                                                                                        
│      cd_dep_count     │                                                                                                                                                                                                        
│ cd_dep_employed_count │                                                                                                                                                                                                        
│  cd_dep_college_count │                                                                                                                                                                                                        
│      cd_dep_count     │                                                                                                                                                                                                        
│      cd_dep_count     │                                                                                                                                                                                                        
│ cd_dep_employed_count │                                                                                                                                                                                                        
│ cd_dep_employed_count │                                                                                                                                                                                                        
│  cd_dep_college_count │                                                                                                                                                                                                        
│  cd_dep_college_count │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       PROJECTION      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│           #3          │                                                                                                                                                                                                        
│           #4          │                                                                                                                                                                                                        
│           #5          │                                                                                                                                                                                                        
│           #6          │                                                                                                                                                                                                        
│           #7          │                                                                                                                                                                                                        
│           #8          │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│         FILTER        │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│ (SUBQUERY OR SUBQUERY)│                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       HASH_JOIN       │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│          MARK         │                                                                                                                                                                                                        
│  c_customer_sk IS NOT │                                                                                                                                                                                                        
│      DISTINCT FROM    ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                     
│      c_customer_sk    │                                                                                                                                                                  │                                     
│     EC = 0.000000     │                                                                                                                                                                  │                                     
│    COST = 0.000000    │                                                                                                                                                                  │                                     
└───────────┬───────────┘                                                                                                                                                                  │                                                              
┌───────────┴───────────┐                                                                                                                                                      ┌───────────┴───────────┐                         
│       HASH_JOIN       │                                                                                                                                                      │       PROJECTION      │                         
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                      │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         
│          MARK         │                                                                                                                                                      │           #1          │                         
│  c_customer_sk IS NOT │                                                                                                                                                      │                       │                         
│      DISTINCT FROM    ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                     │                       │                         
│      c_customer_sk    │                                                                                                                │                                     │                       │                         
│     EC = 0.000000     │                                                                                                                │                                     │                       │                         
│    COST = 0.000000    │                                                                                                                │                                     │                       │                         
└───────────┬───────────┘                                                                                                                │                                     └───────────┬───────────┘                                                  
┌───────────┴───────────┐                                                                                                    ┌───────────┴───────────┐                         ┌───────────┴───────────┐                         
│       HASH_JOIN       │                                                                                                    │       PROJECTION      │                         │         FILTER        │                         
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         
│          SEMI         │                                                                                                    │           #1          │                         │(cs_ship_customer_sk IS│                         
│  c_customer_sk IS NOT │                                                                                                    │                       │                         │        NOT NULL)      │                         
│      DISTINCT FROM    ├──────────────────────────────────────────────────────────────┐                                     │                       │                         │                       │                         
│      c_customer_sk    │                                                              │                                     │                       │                         │                       │                         
│     EC = 0.000000     │                                                              │                                     │                       │                         │                       │                         
│    COST = 0.000000    │                                                              │                                     │                       │                         │                       │                         
└───────────┬───────────┘                                                              │                                     └───────────┬───────────┘                         └───────────┬───────────┘                                                  
┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                         ┌───────────┴───────────┐                         ┌───────────┴───────────┐                         
│       HASH_JOIN       │                                                  │       PROJECTION      │                         │         FILTER        │                         │       HASH_JOIN       │                         
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         
│         INNER         │                                                  │           #1          │                         │(ws_bill_customer_sk IS│                         │         INNER         │                         
│  c_current_cdemo_sk = ├─────────────────────────────────────┐            │                       │                         │        NOT NULL)      │                         │   cs_sold_date_sk =   ├────────────┐            
│       cd_demo_sk      │                                     │            │                       │                         │                       │                         │        d_date_sk      │            │            
│  EC = 1999968.000000  │                                     │            │                       │                         │                       │                         │     EC = 0.000000     │            │            
│ COST = 3999936.000000 │                                     │            │                       │                         │                       │                         │    COST = 0.000000    │            │            
└───────────┬───────────┘                                     │            └───────────┬───────────┘                         └───────────┬───────────┘                         └───────────┬───────────┘            │                                     
┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐                         ┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐
│       HASH_JOIN       │                         │      PARQUET_SCAN     ││         FILTER        │                         │       HASH_JOIN       │                         │      PARQUET_SCAN     ││      PARQUET_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         INNER         │                         │       cd_demo_sk      ││ (ss_customer_sk IS NOT│                         │         INNER         │                         │    cs_sold_date_sk    ││       d_date_sk       │
│  c_current_addr_sk =  │                         │       cd_gender       ││          NULL)        │                         │   ws_sold_date_sk =   │                         │  cs_ship_customer_sk  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│      ca_address_sk    ├────────────┐            │   cd_marital_status   ││                       │                         │        d_date_sk      ├────────────┐            │      EC=143997928     ││  Filters: d_qoy<4 AND │
│  EC = 1999968.000000  │            │            │      cd_dep_count     ││                       │                         │     EC = 0.000000     │            │            │                       ││    d_qoy IS NOT NULL  │
│ COST = 1999968.000000 │            │            │ cd_dep_employed_count ││                       │                         │    COST = 0.000000    │            │            │                       ││ d_year=2002 AND d_year│
│                       │            │            │  cd_dep_college_count ││                       │                         │                       │            │            │                       ││       IS NOT NULL     │
│                       │            │            │       EC=1920816      ││                       │                         │                       │            │            │                       ││        EC=40590       │
└───────────┬───────────┘            │            └───────────────────────┘└───────────┬───────────┘                         └───────────┬───────────┘            │            └───────────────────────┘└───────────────────────┘                         
┌───────────┴───────────┐┌───────────┴───────────┐                         ┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐                                                  
│      PARQUET_SCAN     ││      PARQUET_SCAN     │                         │       HASH_JOIN       │                         │      PARQUET_SCAN     ││      PARQUET_SCAN     │                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
│     c_customer_sk     ││     ca_address_sk     │                         │         INNER         │                         │    ws_sold_date_sk    ││       d_date_sk       │                                                  
│   c_current_cdemo_sk  ││        ca_state       │                         │   ss_sold_date_sk =   │                         │  ws_bill_customer_sk  ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
│   c_current_addr_sk   ││       EC=1000032      │                         │        d_date_sk      ├────────────┐            │      EC=72001536      ││  Filters: d_qoy<4 AND │                                                  
│       EC=1999968      ││                       │                         │     EC = 0.000000     │            │            │                       ││    d_qoy IS NOT NULL  │                                                  
│                       ││                       │                         │    COST = 0.000000    │            │            │                       ││ d_year=2002 AND d_year│                                                  
│                       ││                       │                         │                       │            │            │                       ││       IS NOT NULL     │                                                  
│                       ││                       │                         │                       │            │            │                       ││        EC=40590       │                                                  
└───────────────────────┘└───────────────────────┘                         └───────────┬───────────┘            │            └───────────────────────┘└───────────────────────┘                                                                           
                                                                           ┌───────────┴───────────┐┌───────────┴───────────┐                                                                                                    
                                                                           │      PARQUET_SCAN     ││      PARQUET_SCAN     │                                                                                                    
                                                                           │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                    
                                                                           │    ss_sold_date_sk    ││       d_date_sk       │                                                                                                    
                                                                           │     ss_customer_sk    ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                    
                                                                           │      EC=287997144     ││  Filters: d_qoy<4 AND │                                                                                                    
                                                                           │                       ││    d_qoy IS NOT NULL  │                                                                                                    
                                                                           │                       ││ d_year=2002 AND d_year│                                                                                                    
                                                                           │                       ││       IS NOT NULL     │                                                                                                    
                                                                           │                       ││        EC=40590       │                                                                                                    
                                                                           └───────────────────────┘└───────────────────────┘                                                                                                                             

