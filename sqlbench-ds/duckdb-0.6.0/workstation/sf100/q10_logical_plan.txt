┌─────────────────────┐                                                                                                                                                                                                               
│        TOP_N        │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       Top 100       │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│    .cd_gender ASC   │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│  .cd_marital_status │                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│ .cd_education_status│                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│.cd_purchase_estimate│                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│.cd_credit_rating ASC│                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│  .cd_dep_count ASC  │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│.cd_dep_employed_coun│                                                                                                                                                                                                               
│        t ASC        │                                                                                                                                                                                                               
│customer_demographics│                                                                                                                                                                                                               
│.cd_dep_college_count│                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      cd_gender      │                                                                                                                                                                                                               
│  cd_marital_status  │                                                                                                                                                                                                               
│ cd_education_status │                                                                                                                                                                                                               
│         cnt1        │                                                                                                                                                                                                               
│ cd_purchase_estimate│                                                                                                                                                                                                               
│         cnt2        │                                                                                                                                                                                                               
│   cd_credit_rating  │                                                                                                                                                                                                               
│         cnt3        │                                                                                                                                                                                                               
│     cd_dep_count    │                                                                                                                                                                                                               
│         cnt4        │                                                                                                                                                                                                               
│cd_dep_employed_count│                                                                                                                                                                                                               
│         cnt5        │                                                                                                                                                                                                               
│ cd_dep_college_count│                                                                                                                                                                                                               
│         cnt6        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│          #1         │                                                                                                                                                                                                               
│          #2         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
│          #4         │                                                                                                                                                                                                               
│          #5         │                                                                                                                                                                                                               
│          #6         │                                                                                                                                                                                                               
│          #7         │                                                                                                                                                                                                               
│     count_star()    │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│      cd_gender      │                                                                                                                                                                                                               
│  cd_marital_status  │                                                                                                                                                                                                               
│ cd_education_status │                                                                                                                                                                                                               
│ cd_purchase_estimate│                                                                                                                                                                                                               
│   cd_credit_rating  │                                                                                                                                                                                                               
│     cd_dep_count    │                                                                                                                                                                                                               
│cd_dep_employed_count│                                                                                                                                                                                                               
│ cd_dep_college_count│                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #4         │                                                                                                                                                                                                               
│          #5         │                                                                                                                                                                                                               
│          #6         │                                                                                                                                                                                                               
│          #7         │                                                                                                                                                                                                               
│          #8         │                                                                                                                                                                                                               
│          #9         │                                                                                                                                                                                                               
│         #10         │                                                                                                                                                                                                               
│         #11         │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│        FILTER       │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│(SUBQUERY OR SUBQUERY│                                                                                                                                                                                                               
│          )          │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      HASH_JOIN      │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│         MARK        │                                                                                                                                                                                                               
│ c_customer_sk IS NOT│                                                                                                                                                                                                               
│     DISTINCT FROM   ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                  
│     c_customer_sk   │                                                                                                                                                                            │                                  
│    EC = 0.000000    │                                                                                                                                                                            │                                  
│   COST = 0.000000   │                                                                                                                                                                            │                                  
└──────────┬──────────┘                                                                                                                                                                            │                                                         
┌──────────┴──────────┐                                                                                                                                                                 ┌──────────┴──────────┐                       
│      HASH_JOIN      │                                                                                                                                                                 │      PROJECTION     │                       
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─   │                       
│         MARK        │                                                                                                                                                                 │          #1         │                       
│ c_customer_sk IS NOT│                                                                                                                                                                 │                     │                       
│     DISTINCT FROM   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                  │                     │                       
│     c_customer_sk   │                                                                                                                              │                                  │                     │                       
│    EC = 0.000000    │                                                                                                                              │                                  │                     │                       
│   COST = 0.000000   │                                                                                                                              │                                  │                     │                       
└──────────┬──────────┘                                                                                                                              │                                  └──────────┬──────────┘                                              
┌──────────┴──────────┐                                                                                                                   ┌──────────┴──────────┐                       ┌──────────┴──────────┐                       
│      HASH_JOIN      │                                                                                                                   │      PROJECTION     │                       │        FILTER       │                       
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                   │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                       
│         SEMI        │                                                                                                                   │          #1         │                       │ (cs_ship_customer_sk│                       
│ c_customer_sk IS NOT│                                                                                                                   │                     │                       │     IS NOT NULL)    │                       
│     DISTINCT FROM   ├────────────────────────────────────────────────────────────────────────────────┐                                  │                     │                       │                     │                       
│     c_customer_sk   │                                                                                │                                  │                     │                       │                     │                       
│    EC = 0.000000    │                                                                                │                                  │                     │                       │                     │                       
│   COST = 0.000000   │                                                                                │                                  │                     │                       │                     │                       
└──────────┬──────────┘                                                                                │                                  └──────────┬──────────┘                       └──────────┬──────────┘                                              
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐                       ┌──────────┴──────────┐                       ┌──────────┴──────────┐                       
│      HASH_JOIN      │                                                                     │      PROJECTION     │                       │        FILTER       │                       │      HASH_JOIN      │                       
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                       
│        INNER        │                                                                     │          #1         │                       │ (ws_bill_customer_sk│                       │        INNER        │                       
│ c_current_cdemo_sk =├─────────────────────────────────────────────────────────┐           │                     │                       │     IS NOT NULL)    │                       │  cs_sold_date_sk =  ├───────────┐           
│      cd_demo_sk     │                                                         │           │                     │                       │                     │                       │       d_date_sk     │           │           
│ EC = 1999968.000000 │                                                         │           │                     │                       │                     │                       │    EC = 0.000000    │           │           
│COST = 3999936.000000│                                                         │           │                     │                       │                     │                       │   COST = 0.000000   │           │           
└──────────┬──────────┘                                                         │           └──────────┬──────────┘                       └──────────┬──────────┘                       └──────────┬──────────┘           │                                  
┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐
│      HASH_JOIN      │                                              │     PARQUET_SCAN    ││        FILTER       │                       │      HASH_JOIN      │                       │     PARQUET_SCAN    ││     PARQUET_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │
│        INNER        │                                              │      cd_demo_sk     ││  (ss_customer_sk IS │                       │        INNER        │                       │   cs_sold_date_sk   ││      d_date_sk      │
│ c_current_addr_sk = │                                              │      cd_gender      ││       NOT NULL)     │                       │  ws_sold_date_sk =  │                       │ cs_ship_customer_sk ││   ─ ─ ─ ─ ─ ─ ─ ─   │
│     ca_address_sk   │                                              │  cd_marital_status  ││                     │                       │       d_date_sk     │                       │     EC=143997928    ││Filters: d_moy>=1 AND│
│ EC = 1999968.000000 │                                              │ cd_education_status ││                     │                       │    EC = 0.000000    │                       │                     ││  d_moy<=4 AND d_moy │
│COST = 1999968.000000├───────────┐                                  │ cd_purchase_estimate││                     │                       │   COST = 0.000000   ├───────────┐           │                     ││      IS NOT NULL    │
│                     │           │                                  │   cd_credit_rating  ││                     │                       │                     │           │           │                     ││   d_year=1999 AND   │
│                     │           │                                  │     cd_dep_count    ││                     │                       │                     │           │           │                     ││  d_year IS NOT NULL │
│                     │           │                                  │cd_dep_employed_count││                     │                       │                     │           │           │                     ││       EC=40590      │
│                     │           │                                  │ cd_dep_college_count││                     │                       │                     │           │           │                     ││                     │
│                     │           │                                  │      EC=1920816     ││                     │                       │                     │           │           │                     ││                     │
└──────────┬──────────┘           │                                  └─────────────────────┘└──────────┬──────────┘                       └──────────┬──────────┘           │           └─────────────────────┘└─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                                              
│     PARQUET_SCAN    ││      PROJECTION     │                                              │      HASH_JOIN      │                       │     PARQUET_SCAN    ││     PARQUET_SCAN    │                                              
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│    c_customer_sk    ││          #0         │                                              │        INNER        │                       │   ws_sold_date_sk   ││      d_date_sk      │                                              
│  c_current_cdemo_sk ││                     │                                              │  ss_sold_date_sk =  │                       │ ws_bill_customer_sk ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              
│  c_current_addr_sk  ││                     │                                              │       d_date_sk     │                       │     EC=72001536     ││Filters: d_moy>=1 AND│                                              
│      EC=1999968     ││                     │                                              │    EC = 0.000000    ├───────────┐           │                     ││  d_moy<=4 AND d_moy │                                              
│                     ││                     │                                              │   COST = 0.000000   │           │           │                     ││      IS NOT NULL    │                                              
│                     ││                     │                                              │                     │           │           │                     ││   d_year=1999 AND   │                                              
│                     ││                     │                                              │                     │           │           │                     ││  d_year IS NOT NULL │                                              
│                     ││                     │                                              │                     │           │           │                     ││       EC=40590      │                                              
└─────────────────────┘└──────────┬──────────┘                                              └──────────┬──────────┘           │           └─────────────────────┘└─────────────────────┘                                                                     
                       ┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐                                                                                            
                       │        FILTER       │                                              │     PARQUET_SCAN    ││     PARQUET_SCAN    │                                                                                            
                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
                       │       IN (...)      │                                              │   ss_sold_date_sk   ││      d_date_sk      │                                                                                            
                       │                     │                                              │    ss_customer_sk   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
                       │                     │                                              │     EC=287997144    ││Filters: d_moy>=1 AND│                                                                                            
                       │                     │                                              │                     ││  d_moy<=4 AND d_moy │                                                                                            
                       │                     │                                              │                     ││      IS NOT NULL    │                                                                                            
                       │                     │                                              │                     ││   d_year=1999 AND   │                                                                                            
                       │                     │                                              │                     ││  d_year IS NOT NULL │                                                                                            
                       │                     │                                              │                     ││       EC=40590      │                                                                                            
                       └──────────┬──────────┘                                              └─────────────────────┘└─────────────────────┘                                                                                                                   
                       ┌──────────┴──────────┐                                                                                                                                                                                        
                       │      HASH_JOIN      │                                                                                                                                                                                        
                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                        
                       │         MARK        │                                                                                                                                                                                        
                       │    ca_county = #0   ├───────────┐                                                                                                                                                                            
                       │    EC = 0.000000    │           │                                                                                                                                                                            
                       │   COST = 0.000000   │           │                                                                                                                                                                            
                       └──────────┬──────────┘           │                                                                                                                                                                                                   
                       ┌──────────┴──────────┐┌──────────┴──────────┐                                                                                                                                                                 
                       │     PARQUET_SCAN    ││   COLUMN_DATA_SCAN  │                                                                                                                                                                 
                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││                     │                                                                                                                                                                 
                       │    ca_address_sk    ││                     │                                                                                                                                                                 
                       │      ca_county      ││                     │                                                                                                                                                                 
                       │      EC=1000032     ││                     │                                                                                                                                                                 
                       └─────────────────────┘└─────────────────────┘                                                                                                                                                                                        

