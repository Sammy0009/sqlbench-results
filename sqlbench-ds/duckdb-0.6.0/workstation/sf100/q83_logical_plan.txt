┌─────────────┐                                                                                                                                                                                                                  
│    TOP_N    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│   Top 100   │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│sr_items.item│                                                                                                                                                                                                                  
│   _id ASC   │                                                                                                                                                                                                                  
│sr_items.sr_i│                                                                                                                                                                                                                  
│ tem_qty ASC │                                                                                                                                                                                                                  
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                  
│  PROJECTION │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│   item_id   │                                                                                                                                                                                                                  
│ sr_item_qty │                                                                                                                                                                                                                  
│    sr_dev   │                                                                                                                                                                                                                  
│ cr_item_qty │                                                                                                                                                                                                                  
│    cr_dev   │                                                                                                                                                                                                                  
│ wr_item_qty │                                                                                                                                                                                                                  
│    wr_dev   │                                                                                                                                                                                                                  
│   average   │                                                                                                                                                                                                                  
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                  
│  PROJECTION │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│   item_id   │                                                                                                                                                                                                                  
│ sr_item_qty │                                                                                                                                                                                                                  
│((sr_item_qty│                                                                                                                                                                                                                  
│ + cr_item_qt│                                                                                                                                                                                                                  
│y) + wr_item_│                                                                                                                                                                                                                  
│     qty)    │                                                                                                                                                                                                                  
│ cr_item_qty │                                                                                                                                                                                                                  
│ wr_item_qty │                                                                                                                                                                                                                  
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                  
│  HASH_JOIN  │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│    INNER    │                                                                                                                                                                                                                  
│  item_id =  │                                                                                                                                                                                                                  
│    item_id  │                                                                                                                                                                                                                  
│  item_id =  ├───────────────────────────────────────────────────────────────────┐                                                                                                                                              
│    item_id  │                                                                   │                                                                                                                                              
│EC = 57486736│                                                                   │                                                                                                                                              
│   .253751   │                                                                   │                                                                                                                                              
│COST = 718634│                                                                   │                                                                                                                                              
│  08.253751  │                                                                   │                                                                                                                                              
└──────┬──────┘                                                                   │                                                                                                                                                             
┌──────┴──────┐                                                            ┌──────┴──────┐                                                                                                                                       
│HASH_GROUP_BY│                                                            │  HASH_JOIN  │                                                                                                                                       
│   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                                                                                                       
│      #0     │                                                            │    INNER    │                                                                                                                                       
│   sum(#1)   │                                                            │  item_id =  │                                                                                                                                       
│             │                                                            │    item_id  ├───────────────────────────────────────────────────────────────────┐                                                                   
│             │                                                            │EC = 14376672│                                                                   │                                                                   
│             │                                                            │   .000000   │                                                                   │                                                                   
│             │                                                            │COST = 143766│                                                                   │                                                                   
│             │                                                            │  72.000000  │                                                                   │                                                                   
└──────┬──────┘                                                            └──────┬──────┘                                                                   │                                                                                  
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            
│  PROJECTION │                                                            │HASH_GROUP_BY│                                                            │HASH_GROUP_BY│                                                            
│   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            
│  i_item_id  │                                                            │      #0     │                                                            │      #0     │                                                            
│sr_return_qua│                                                            │   sum(#1)   │                                                            │   sum(#1)   │                                                            
│    ntity    │                                                            │             │                                                            │             │                                                            
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘                                                                           
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            
│  HASH_JOIN  │                                                            │  PROJECTION │                                                            │  PROJECTION │                                                            
│   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            
│     SEMI    │                                                            │  i_item_id  │                                                            │  i_item_id  │                                                            
│ d_date = #0 ├─────────────────────────────────────┐                      │cr_return_qua│                                                            │wr_return_qua│                                                            
│EC = 0.000000│                                     │                      │    ntity    │                                                            │    ntity    │                                                            
│COST = 0.0000│                                     │                      │             │                                                            │             │                                                            
│      00     │                                     │                      │             │                                                            │             │                                                            
└──────┬──────┘                                     │                      └──────┬──────┘                                                            └──────┬──────┘                                                                           
┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            
│  HASH_JOIN  │                              │  PROJECTION │               │  HASH_JOIN  │                                                            │  HASH_JOIN  │                                                            
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            
│    INNER    │                              │    d_date   │               │     SEMI    │                                                            │     SEMI    │                                                            
│sr_returned_d│                              │             │               │ d_date = #0 │                                                            │ d_date = #0 │                                                            
│ate_sk = d_da│                              │             │               │EC = 0.000000│                                                            │EC = 0.000000│                                                            
│    te_sk    ├──────────────────────┐       │             │               │COST = 0.0000├─────────────────────────────────────┐                      │COST = 0.0000├─────────────────────────────────────┐                      
│EC = 28766784│                      │       │             │               │      00     │                                     │                      │      00     │                                     │                      
│   .000000   │                      │       │             │               │             │                                     │                      │             │                                     │                      
│COST = 575335│                      │       │             │               │             │                                     │                      │             │                                     │                      
│  68.000000  │                      │       │             │               │             │                                     │                      │             │                                     │                      
└──────┬──────┘                      │       └──────┬──────┘               └──────┬──────┘                                     │                      └──────┬──────┘                                     │                                     
┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐                              ┌──────┴──────┐               
│  HASH_JOIN  │               │ PARQUET_SCAN││  HASH_JOIN  │               │  HASH_JOIN  │                              │  PROJECTION │               │  HASH_JOIN  │                              │  PROJECTION │               
│   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │               
│    INNER    │               │  d_date_sk  ││     SEMI    │               │    INNER    │                              │    d_date   │               │    INNER    │                              │    d_date   │               
│ sr_item_sk =│               │    d_date   ││d_week_seq = │               │cr_returned_d│                              │             │               │wr_returned_d│                              │             │               
│   i_item_sk │               │   EC=40590  ││      #0     │               │ate_sk = d_da│                              │             │               │ate_sk = d_da│                              │             │               
│EC = 28766784├───────┐       │             ││EC = 0.000000├───────┐       │    te_sk    ├──────────────────────┐       │             │               │    te_sk    ├──────────────────────┐       │             │               
│   .000000   │       │       │             ││COST = 0.0000│       │       │EC = 14376672│                      │       │             │               │ EC = 7194192│                      │       │             │               
│COST = 287667│       │       │             ││      00     │       │       │   .000000   │                      │       │             │               │   .000000   │                      │       │             │               
│  84.000000  │       │       │             ││             │       │       │COST = 287533│                      │       │             │               │COST = 143883│                      │       │             │               
│             │       │       │             ││             │       │       │  44.000000  │                      │       │             │               │  84.000000  │                      │       │             │               
└──────┬──────┘       │       └─────────────┘└──────┬──────┘       │       └──────┬──────┘                      │       └──────┬──────┘               └──────┬──────┘                      │       └──────┬──────┘                              
┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐               
│ PARQUET_SCAN││ PARQUET_SCAN│               │ PARQUET_SCAN││  PROJECTION ││  HASH_JOIN  │               │ PARQUET_SCAN││  HASH_JOIN  │               │  HASH_JOIN  │               │ PARQUET_SCAN││  HASH_JOIN  │               
│   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               
│sr_returned_d││  i_item_sk  │               │    d_date   ││      #1     ││    INNER    │               │  d_date_sk  ││     SEMI    │               │    INNER    │               │  d_date_sk  ││     SEMI    │               
│    ate_sk   ││  i_item_id  │               │  d_week_seq ││             ││ cr_item_sk =│               │    d_date   ││d_week_seq = │               │ wr_item_sk =│               │    d_date   ││d_week_seq = │               
│  sr_item_sk ││  EC=202300  │               │   EC=40590  ││             ││   i_item_sk ├───────┐       │   EC=40590  ││      #0     ├───────┐       │   i_item_sk ├───────┐       │   EC=40590  ││      #0     ├───────┐       
│sr_return_qua││             │               │             ││             ││EC = 14376672│       │       │             ││EC = 0.000000│       │       │ EC = 7194192│       │       │             ││EC = 0.000000│       │       
│    ntity    ││             │               │             ││             ││   .000000   │       │       │             ││COST = 0.0000│       │       │   .000000   │       │       │             ││COST = 0.0000│       │       
│ EC=28766784 ││             │               │             ││             ││COST = 143766│       │       │             ││      00     │       │       │COST = 719419│       │       │             ││      00     │       │       
│             ││             │               │             ││             ││  72.000000  │       │       │             ││             │       │       │   2.000000  │       │       │             ││             │       │       
└─────────────┘└─────────────┘               └─────────────┘└──────┬──────┘└──────┬──────┘       │       └─────────────┘└──────┬──────┘       │       └──────┬──────┘       │       └─────────────┘└──────┬──────┘       │                      
                                                            ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐
                                                            │    FILTER   ││ PARQUET_SCAN││ PARQUET_SCAN│               │ PARQUET_SCAN││  PROJECTION ││ PARQUET_SCAN││ PARQUET_SCAN│               │ PARQUET_SCAN││  PROJECTION │
                                                            │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │
                                                            │((CAST(d_date││cr_returned_d││  i_item_sk  │               │    d_date   ││      #1     ││wr_returned_d││  i_item_sk  │               │    d_date   ││      #1     │
                                                            │ AS VARCHAR) ││    ate_sk   ││  i_item_id  │               │  d_week_seq ││             ││    ate_sk   ││  i_item_id  │               │  d_week_seq ││             │
                                                            │= '1998-02-24││  cr_item_sk ││  EC=202300  │               │   EC=40590  ││             ││  wr_item_sk ││  EC=202300  │               │   EC=40590  ││             │
                                                            │ ') OR (CAST ││cr_return_qua││             │               │             ││             ││wr_return_qua││             │               │             ││             │
                                                            │  (d_date AS ││    ntity    ││             │               │             ││             ││    ntity    ││             │               │             ││             │
                                                            │ VARCHAR...  ││ EC=14376672 ││             │               │             ││             ││  EC=7194192 ││             │               │             ││             │
                                                            │ -10-12') OR ││             ││             │               │             ││             ││             ││             │               │             ││             │
                                                            │(CAST(d_...  ││             ││             │               │             ││             ││             ││             │               │             ││             │
                                                            │  VARCHAR) = ││             ││             │               │             ││             ││             ││             │               │             ││             │
                                                            │'1998-11...  ││             ││             │               │             ││             ││             ││             │               │             ││             │
                                                            └──────┬──────┘└─────────────┘└─────────────┘               └─────────────┘└──────┬──────┘└─────────────┘└─────────────┘               └─────────────┘└──────┬──────┘               
                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
                                                            │ PARQUET_SCAN│                                                            │    FILTER   │                                                            │    FILTER   │
                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │
                                                            │    d_date   │                                                            │((CAST(d_date│                                                            │((CAST(d_date│
                                                            │  d_week_seq │                                                            │ AS VARCHAR) │                                                            │ AS VARCHAR) │
                                                            │   EC=40590  │                                                            │= '1998-02-24│                                                            │= '1998-02-24│
                                                            │             │                                                            │ ') OR (CAST │                                                            │ ') OR (CAST │
                                                            │             │                                                            │  (d_date AS │                                                            │  (d_date AS │
                                                            │             │                                                            │ VARCHAR...  │                                                            │ VARCHAR...  │
                                                            │             │                                                            │ -10-12') OR │                                                            │ -10-12') OR │
                                                            │             │                                                            │(CAST(d_...  │                                                            │(CAST(d_...  │
                                                            │             │                                                            │  VARCHAR) = │                                                            │  VARCHAR) = │
                                                            │             │                                                            │'1998-11...  │                                                            │'1998-11...  │
                                                            └─────────────┘                                                            └──────┬──────┘                                                            └──────┬──────┘               
                                                                                                                                       ┌──────┴──────┐                                                            ┌──────┴──────┐
                                                                                                                                       │ PARQUET_SCAN│                                                            │ PARQUET_SCAN│
                                                                                                                                       │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │
                                                                                                                                       │    d_date   │                                                            │    d_date   │
                                                                                                                                       │  d_week_seq │                                                            │  d_week_seq │
                                                                                                                                       │   EC=40590  │                                                            │   EC=40590  │
                                                                                                                                       └─────────────┘                                                            └─────────────┘               

