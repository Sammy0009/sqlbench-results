┌───────────────────────────┐                                                                                       
│           TOP_N           │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│          Top 100          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      count_star() ASC     │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│    UNGROUPED_AGGREGATE    │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│        count_star()       │                                                                                       
└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       
│  ss_hdemo_sk = hd_demo_sk ├────────────────────────────────────────────────────────────────────────┐              
│    EC = 2292223.595468    │                                                                        │              
│   COST = 71066206.050421  │                                                                        │              
└─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         hd_demo_sk        │
│ss_sold_time_sk = t_time_sk├───────────────────────────────────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│    EC = 11461117.977341   │                                           │              │Filters: hd_dep_count=5 AND│
│   COST = 68773982.454952  │                                           │              │  hd_dep_count IS NOT NULL │
│                           │                                           │              │          EC=1440          │
└─────────────┬─────────────┘                                           │              └───────────────────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                             │        PARQUET_SCAN       │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│           INNER           │                             │         t_time_sk         │                             
│  ss_store_sk = s_store_sk │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│    EC = 57312864.477612   ├──────────────┐              │ Filters: t_minute>=30 AND │                             
│   COST = 57312864.477612  │              │              │    t_minute IS NOT NULL   │                             
│                           │              │              │ t_hour=8 AND t_hour IS NOT│                             
│                           │              │              │            NULL           │                             
│                           │              │              │          EC=6302          │                             
└─────────────┬─────────────┘              │              └───────────────────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      ss_sold_time_sk      ││         s_store_sk        │                                                          
│        ss_hdemo_sk        ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│        ss_store_sk        ││ Filters: s_store_name=ese │                                                          
│        EC=287997144       ││ AND s_store_name IS N...  │                                                          
│                           ││           EC=80           │                                                          
└───────────────────────────┘└───────────────────────────┘                                                                                       

