┌───────────────────────────┐                                                                                                                                                                                                           
│           TOP_N           │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          Top 100          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│  customer.c_last_name ASC │                                                                                                                                                                                                           
│ customer.c_first_name ASC │                                                                                                                                                                                                           
│  current_addr.ca_city ASC │                                                                                                                                                                                                           
│     dn.bought_city ASC    │                                                                                                                                                                                                           
│  dn.ss_ticket_number ASC  │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│        c_last_name        │                                                                                                                                                                                                           
│        c_first_name       │                                                                                                                                                                                                           
│          ca_city          │                                                                                                                                                                                                           
│        bought_city        │                                                                                                                                                                                                           
│      ss_ticket_number     │                                                                                                                                                                                                           
│            amt            │                                                                                                                                                                                                           
│           profit          │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│      ss_customer_sk =     │                                                                                                                                                                                                           
│        c_customer_sk      ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│   bought_city != ca_city  │                                                                                                                                                               │                                           
│    EC = 57599428.000000   │                                                                                                                                                               │                                           
│   COST = 59599396.000000  │                                                                                                                                                               │                                           
└─────────────┬─────────────┘                                                                                                                                                               │                                                                        
┌─────────────┴─────────────┐                                                                                                                                                 ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                                                 │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      ss_ticket_number     │                                                                                                                                                 │           INNER           │                             
│       ss_customer_sk      │                                                                                                                                                 │    c_current_addr_sk =    ├──────────────┐              
│        bought_city        │                                                                                                                                                 │        ca_address_sk      │              │              
│            amt            │                                                                                                                                                 │    EC = 1999968.000000    │              │              
│           profit          │                                                                                                                                                 │   COST = 1999968.000000   │              │              
└─────────────┬─────────────┘                                                                                                                                                 └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                                                 ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                                                 │        PARQUET_SCAN       ││        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                                                 │       c_customer_sk       ││       ca_address_sk       │
│             #1            │                                                                                                                                                 │     c_current_addr_sk     ││          ca_city          │
│             #2            │                                                                                                                                                 │        c_first_name       ││         EC=1000032        │
│             #3            │                                                                                                                                                 │        c_last_name        ││                           │
│          sum(#4)          │                                                                                                                                                 │         EC=1999968        ││                           │
│          sum(#5)          │                                                                                                                                                 │                           ││                           │
└─────────────┬─────────────┘                                                                                                                                                 └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│      ss_ticket_number     │                                                                                                                                                                                                           
│       ss_customer_sk      │                                                                                                                                                                                                           
│         ss_addr_sk        │                                                                                                                                                                                                           
│          ca_city          │                                                                                                                                                                                                           
│       ss_coupon_amt       │                                                                                                                                                                                                           
│       ss_net_profit       │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│ ss_addr_sk = ca_address_sk├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│    EC = 57599428.800000   │                                                                                                                                  │                                                                        
│  COST = 230397715.200000  │                                                                                                                                  │                                                                        
└─────────────┬─────────────┘                                                                                                                                  │                                                                                                     
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                                                                                    │        PARQUET_SCAN       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                                                    │       ca_address_sk       │                                                          
│  ss_hdemo_sk = hd_demo_sk ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐              │          ca_city          │                                                          
│    EC = 57599428.800000   │                                                                                                     │              │         EC=1000032        │                                                          
│  COST = 172798286.400000  │                                                                                                     │              │                           │                                                          
└─────────────┬─────────────┘                                                                                                     │              └───────────────────────────┘                                                                                       
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       │         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       │             #0            │                                                                                       
│  ss_store_sk = s_store_sk ├───────────────────────────────────────────┐                                           │                           │                                                                                       
│    EC = 57599428.800000   │                                           │                                           │                           │                                                                                       
│  COST = 115198857.600000  │                                           │                                           │                           │                                                                                       
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                             │         PROJECTION        │                             │           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                             │             #0            │                             │  ((hd_dep_count = 8) OR   │                                                                                       
│ss_sold_date_sk = d_date_sk├──────────────┐              │                           │                             │  (hd_vehicle_count = 4))  │                                                                                       
│    EC = 57599428.800000   │              │              │                           │                             │                           │                                                                                       
│   COST = 57599428.800000  │              │              │                           │                             │                           │                                                                                       
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘                             └─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                                                       
│        PARQUET_SCAN       ││         PROJECTION        ││           FILTER          │                             │        PARQUET_SCAN       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      ss_sold_date_sk      ││             #0            ││          IN (...)         │                             │         hd_demo_sk        │                                                                                       
│       ss_customer_sk      ││                           ││                           │                             │        hd_dep_count       │                                                                                       
│        ss_hdemo_sk        ││                           ││                           │                             │      hd_vehicle_count     │                                                                                       
│         ss_addr_sk        ││                           ││                           │                             │          EC=7200          │                                                                                       
│        ss_store_sk        ││                           ││                           │                             │                           │                                                                                       
│      ss_ticket_number     ││                           ││                           │                             │                           │                                                                                       
│       ss_coupon_amt       ││                           ││                           │                             │                           │                                                                                       
│       ss_net_profit       ││                           ││                           │                             │                           │                                                                                       
│        EC=287997144       ││                           ││                           │                             │                           │                                                                                       
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘                                                                                                                    
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                 
                             │           FILTER          ││         HASH_JOIN         │                                                                                                                                                 
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                 
                             │((d_dow = 6) OR (d_dow = 0)││            MARK           │                                                                                                                                                 
                             │             )             ││        s_city = #0        ├──────────────┐                                                                                                                                  
                             │                           ││       EC = 0.000000       │              │                                                                                                                                  
                             │                           ││      COST = 0.000000      │              │                                                                                                                                  
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                                                               
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                    
                             │        PARQUET_SCAN       ││        PARQUET_SCAN       ││      COLUMN_DATA_SCAN     │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                                                    
                             │         d_date_sk         ││         s_store_sk        ││                           │                                                                                                                    
                             │           d_dow           ││           s_city          ││                           │                                                                                                                    
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││           EC=402          ││                           │                                                                                                                    
                             │ Filters: d_year>=1999 AND ││                           ││                           │                                                                                                                    
                             │ d_year<=2001 AND d_year IS││                           ││                           │                                                                                                                    
                             │          NOT NULL         ││                           ││                           │                                                                                                                    
                             │          EC=40590         ││                           ││                           │                                                                                                                    
                             └───────────────────────────┘└───────────────────────────┘└───────────────────────────┘                                                                                                                                                 

