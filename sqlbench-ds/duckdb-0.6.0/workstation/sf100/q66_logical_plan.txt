┌─────────────────────┐                                                                                                                                                                                                               
│        TOP_N        │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│       Top 100       │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│  x.w_warehouse_name │                                                                                                                                                                                                               
│          ASC        │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│    HASH_GROUP_BY    │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│          #0         │                                                                                                                                                                                                               
│          #1         │                                                                                                                                                                                                               
│          #2         │                                                                                                                                                                                                               
│          #3         │                                                                                                                                                                                                               
│          #4         │                                                                                                                                                                                                               
│          #5         │                                                                                                                                                                                                               
│          #6         │                                                                                                                                                                                                               
│          #7         │                                                                                                                                                                                                               
│       sum(#8)       │                                                                                                                                                                                                               
│       sum(#9)       │                                                                                                                                                                                                               
│       sum(#10)      │                                                                                                                                                                                                               
│       sum(#11)      │                                                                                                                                                                                                               
│       sum(#12)      │                                                                                                                                                                                                               
│       sum(#13)      │                                                                                                                                                                                                               
│       sum(#14)      │                                                                                                                                                                                                               
│       sum(#15)      │                                                                                                                                                                                                               
│       sum(#16)      │                                                                                                                                                                                                               
│       sum(#17)      │                                                                                                                                                                                                               
│       sum(#18)      │                                                                                                                                                                                                               
│       sum(#19)      │                                                                                                                                                                                                               
│       sum(#20)      │                                                                                                                                                                                                               
│       sum(#21)      │                                                                                                                                                                                                               
│       sum(#22)      │                                                                                                                                                                                                               
│       sum(#23)      │                                                                                                                                                                                                               
│       sum(#24)      │                                                                                                                                                                                                               
│       sum(#25)      │                                                                                                                                                                                                               
│       sum(#26)      │                                                                                                                                                                                                               
│       sum(#27)      │                                                                                                                                                                                                               
│       sum(#28)      │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│   w_warehouse_name  │                                                                                                                                                                                                               
│  w_warehouse_sq_ft  │                                                                                                                                                                                                               
│        w_city       │                                                                                                                                                                                                               
│       w_county      │                                                                                                                                                                                                               
│       w_state       │                                                                                                                                                                                                               
│      w_country      │                                                                                                                                                                                                               
│    ship_carriers    │                                                                                                                                                                                                               
│         year        │                                                                                                                                                                                                               
│      jan_sales      │                                                                                                                                                                                                               
│      feb_sales      │                                                                                                                                                                                                               
│      mar_sales      │                                                                                                                                                                                                               
│      apr_sales      │                                                                                                                                                                                                               
│      may_sales      │                                                                                                                                                                                                               
│      jun_sales      │                                                                                                                                                                                                               
│      jul_sales      │                                                                                                                                                                                                               
│      aug_sales      │                                                                                                                                                                                                               
│      sep_sales      │                                                                                                                                                                                                               
│      oct_sales      │                                                                                                                                                                                                               
│      nov_sales      │                                                                                                                                                                                                               
│      dec_sales      │                                                                                                                                                                                                               
│  (CAST(jan_sales AS │                                                                                                                                                                                                               
│    DOUBLE) / #20)   │                                                                                                                                                                                                               
│  (CAST(feb_sales AS │                                                                                                                                                                                                               
│    DOUBLE) / #20)   │                                                                                                                                                                                                               
│  (CAST(mar_sales AS │                                                                                                                                                                                                               
│    DOUBLE) / #20)   │                                                                                                                                                                                                               
│  (CAST(apr_sales AS │                                                                                                                                                                                                               
│    DOUBLE) / #20)   │                                                                                                                                                                                                               
│  (CAST(may_sales AS │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│      PROJECTION     │                                                                                                                                                                                                               
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                               
│   w_warehouse_name  │                                                                                                                                                                                                               
│  w_warehouse_sq_ft  │                                                                                                                                                                                                               
│        w_city       │                                                                                                                                                                                                               
│       w_county      │                                                                                                                                                                                                               
│       w_state       │                                                                                                                                                                                                               
│      w_country      │                                                                                                                                                                                                               
│    ship_carriers    │                                                                                                                                                                                                               
│         year        │                                                                                                                                                                                                               
│      jan_sales      │                                                                                                                                                                                                               
│      feb_sales      │                                                                                                                                                                                                               
│      mar_sales      │                                                                                                                                                                                                               
│      apr_sales      │                                                                                                                                                                                                               
│      may_sales      │                                                                                                                                                                                                               
│      jun_sales      │                                                                                                                                                                                                               
│      jul_sales      │                                                                                                                                                                                                               
│      aug_sales      │                                                                                                                                                                                                               
│      sep_sales      │                                                                                                                                                                                                               
│      oct_sales      │                                                                                                                                                                                                               
│      nov_sales      │                                                                                                                                                                                                               
│      dec_sales      │                                                                                                                                                                                                               
│CAST(w_warehouse_sq_f│                                                                                                                                                                                                               
│     t AS DOUBLE)    │                                                                                                                                                                                                               
│       jan_net       │                                                                                                                                                                                                               
│       feb_net       │                                                                                                                                                                                                               
│       mar_net       │                                                                                                                                                                                                               
│       apr_net       │                                                                                                                                                                                                               
│       may_net       │                                                                                                                                                                                                               
│       jun_net       │                                                                                                                                                                                                               
│       jul_net       │                                                                                                                                                                                                               
└──────────┬──────────┘                                                                                                                                                                                                                                      
┌──────────┴──────────┐                                                                                                                                                                                                               
│        UNION        ├───────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                       
└──────────┬──────────┘                                                                                                       │                                                                                                                              
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│      PROJECTION     │                                                                                            │      PROJECTION     │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│   w_warehouse_name  │                                                                                            │   w_warehouse_name  │                                                                                            
│  w_warehouse_sq_ft  │                                                                                            │  w_warehouse_sq_ft  │                                                                                            
│        w_city       │                                                                                            │        w_city       │                                                                                            
│       w_county      │                                                                                            │       w_county      │                                                                                            
│       w_state       │                                                                                            │       w_state       │                                                                                            
│      w_country      │                                                                                            │      w_country      │                                                                                            
│      'ZHOU,MSC'     │                                                                                            │      'ZHOU,MSC'     │                                                                                            
│         year        │                                                                                            │         year        │                                                                                            
│      jan_sales      │                                                                                            │      jan_sales      │                                                                                            
│      feb_sales      │                                                                                            │      feb_sales      │                                                                                            
│      mar_sales      │                                                                                            │      mar_sales      │                                                                                            
│      apr_sales      │                                                                                            │      apr_sales      │                                                                                            
│      may_sales      │                                                                                            │      may_sales      │                                                                                            
│      jun_sales      │                                                                                            │      jun_sales      │                                                                                            
│      jul_sales      │                                                                                            │      jul_sales      │                                                                                            
│      aug_sales      │                                                                                            │      aug_sales      │                                                                                            
│      sep_sales      │                                                                                            │      sep_sales      │                                                                                            
│      oct_sales      │                                                                                            │      oct_sales      │                                                                                            
│      nov_sales      │                                                                                            │      nov_sales      │                                                                                            
│      dec_sales      │                                                                                            │      dec_sales      │                                                                                            
│       jan_net       │                                                                                            │       jan_net       │                                                                                            
│       feb_net       │                                                                                            │       feb_net       │                                                                                            
│       mar_net       │                                                                                            │       mar_net       │                                                                                            
│       apr_net       │                                                                                            │       apr_net       │                                                                                            
│       may_net       │                                                                                            │       may_net       │                                                                                            
│       jun_net       │                                                                                            │       jun_net       │                                                                                            
│       jul_net       │                                                                                            │       jul_net       │                                                                                            
│       aug_net       │                                                                                            │       aug_net       │                                                                                            
│       sep_net       │                                                                                            │       sep_net       │                                                                                            
└──────────┬──────────┘                                                                                            └──────────┬──────────┘                                                                                                                   
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│    HASH_GROUP_BY    │                                                                                            │    HASH_GROUP_BY    │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│          #0         │                                                                                            │          #0         │                                                                                            
│          #1         │                                                                                            │          #1         │                                                                                            
│          #2         │                                                                                            │          #2         │                                                                                            
│          #3         │                                                                                            │          #3         │                                                                                            
│          #4         │                                                                                            │          #4         │                                                                                            
│          #5         │                                                                                            │          #5         │                                                                                            
│          #6         │                                                                                            │          #6         │                                                                                            
│       sum(#7)       │                                                                                            │       sum(#7)       │                                                                                            
│       sum(#8)       │                                                                                            │       sum(#8)       │                                                                                            
│       sum(#9)       │                                                                                            │       sum(#9)       │                                                                                            
│       sum(#10)      │                                                                                            │       sum(#10)      │                                                                                            
│       sum(#11)      │                                                                                            │       sum(#11)      │                                                                                            
│       sum(#12)      │                                                                                            │       sum(#12)      │                                                                                            
│       sum(#13)      │                                                                                            │       sum(#13)      │                                                                                            
│       sum(#14)      │                                                                                            │       sum(#14)      │                                                                                            
│       sum(#15)      │                                                                                            │       sum(#15)      │                                                                                            
│       sum(#16)      │                                                                                            │       sum(#16)      │                                                                                            
│       sum(#17)      │                                                                                            │       sum(#17)      │                                                                                            
│       sum(#18)      │                                                                                            │       sum(#18)      │                                                                                            
│       sum(#19)      │                                                                                            │       sum(#19)      │                                                                                            
│       sum(#20)      │                                                                                            │       sum(#20)      │                                                                                            
│       sum(#21)      │                                                                                            │       sum(#21)      │                                                                                            
│       sum(#22)      │                                                                                            │       sum(#22)      │                                                                                            
│       sum(#23)      │                                                                                            │       sum(#23)      │                                                                                            
│       sum(#24)      │                                                                                            │       sum(#24)      │                                                                                            
│       sum(#25)      │                                                                                            │       sum(#25)      │                                                                                            
│       sum(#26)      │                                                                                            │       sum(#26)      │                                                                                            
│       sum(#27)      │                                                                                            │       sum(#27)      │                                                                                            
│       sum(#28)      │                                                                                            │       sum(#28)      │                                                                                            
└──────────┬──────────┘                                                                                            └──────────┬──────────┘                                                                                                                   
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│      PROJECTION     │                                                                                            │      PROJECTION     │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│   w_warehouse_name  │                                                                                            │   w_warehouse_name  │                                                                                            
│  w_warehouse_sq_ft  │                                                                                            │  w_warehouse_sq_ft  │                                                                                            
│        w_city       │                                                                                            │        w_city       │                                                                                            
│       w_county      │                                                                                            │       w_county      │                                                                                            
│       w_state       │                                                                                            │       w_state       │                                                                                            
│      w_country      │                                                                                            │      w_country      │                                                                                            
│        d_year       │                                                                                            │        d_year       │                                                                                            
│ CASE  WHEN ((d_moy =│                                                                                            │ CASE  WHEN ((d_moy =│                                                                                            
│    1)) THEN ((CAST  │                                                                                            │    1)) THEN ((CAST  │                                                                                            
│(ws_sales_price ...  │                                                                                            │(cs_ext_list_price AS│                                                                                            
│    (17,2)) * CAST   │                                                                                            │ DECIMAL(17,2)) ...  │                                                                                            
│(ws_quantity AS ...  │                                                                                            │(cs_quantity AS ...  │                                                                                            
│  ))) ELSE 0.00 END  │                                                                                            │ ,0)))) ELSE 0.00 END│                                                                                            
│ CASE  WHEN ((d_moy =│                                                                                            │ CASE  WHEN ((d_moy =│                                                                                            
│    2)) THEN ((CAST  │                                                                                            │    2)) THEN ((CAST  │                                                                                            
│(ws_sales_price ...  │                                                                                            │(cs_ext_list_price AS│                                                                                            
│    (17,2)) * CAST   │                                                                                            │ DECIMAL(17,2)) ...  │                                                                                            
│(ws_quantity AS ...  │                                                                                            │(cs_quantity AS ...  │                                                                                            
│  ))) ELSE 0.00 END  │                                                                                            │ ,0)))) ELSE 0.00 END│                                                                                            
│ CASE  WHEN ((d_moy =│                                                                                            │ CASE  WHEN ((d_moy =│                                                                                            
│    3)) THEN ((CAST  │                                                                                            │    3)) THEN ((CAST  │                                                                                            
│(ws_sales_price ...  │                                                                                            │(cs_ext_list_price AS│                                                                                            
│    (17,2)) * CAST   │                                                                                            │ DECIMAL(17,2)) ...  │                                                                                            
│(ws_quantity AS ...  │                                                                                            │(cs_quantity AS ...  │                                                                                            
│  ))) ELSE 0.00 END  │                                                                                            │ ,0)))) ELSE 0.00 END│                                                                                            
│ CASE  WHEN ((d_moy =│                                                                                            │ CASE  WHEN ((d_moy =│                                                                                            
│    4)) THEN ((CAST  │                                                                                            │    4)) THEN ((CAST  │                                                                                            
│(ws_sales_price ...  │                                                                                            │(cs_ext_list_price AS│                                                                                            
│    (17,2)) * CAST   │                                                                                            │ DECIMAL(17,2)) ...  │                                                                                            
└──────────┬──────────┘                                                                                            └──────────┬──────────┘                                                                                                                   
┌──────────┴──────────┐                                                                                            ┌──────────┴──────────┐                                                                                            
│      HASH_JOIN      │                                                                                            │      HASH_JOIN      │                                                                                            
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            │   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                            
│        INNER        │                                                                                            │        INNER        │                                                                                            
│  ws_ship_mode_sk =  │                                                                                            │  cs_ship_mode_sk =  │                                                                                            
│    sm_ship_mode_sk  ├────────────────────────────────────────────────────────────────────────────────┐           │    sm_ship_mode_sk  ├────────────────────────────────────────────────────────────────────────────────┐           
│ EC = 2879695.880383 │                                                                                │           │ EC = 5759186.026883 │                                                                                │           
│   COST = 23037567   │                                                                                │           │   COST = 46073488   │                                                                                │           
│       .043067       │                                                                                │           │       .215066       │                                                                                │           
└──────────┬──────────┘                                                                                │           └──────────┬──────────┘                                                                                │                                  
┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐
│      HASH_JOIN      │                                                                     │      PROJECTION     ││      HASH_JOIN      │                                                                     │      PROJECTION     │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   │
│        INNER        │                                                                     │          #0         ││        INNER        │                                                                     │          #0         │
│  ws_warehouse_sk =  │                                                                     │                     ││  cs_warehouse_sk =  │                                                                     │                     │
│    w_warehouse_sk   ├─────────────────────────────────────────────────────────┐           │                     ││    w_warehouse_sk   ├─────────────────────────────────────────────────────────┐           │                     │
│ EC = 2879695.880383 │                                                         │           │                     ││ EC = 5759186.026883 │                                                         │           │                     │
│   COST = 20157871   │                                                         │           │                     ││   COST = 40314302   │                                                         │           │                     │
│       .162683       │                                                         │           │                     ││       .188183       │                                                         │           │                     │
└──────────┬──────────┘                                                         │           └──────────┬──────────┘└──────────┬──────────┘                                                         │           └──────────┬──────────┘                       
┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐┌──────────┴──────────┐                                              ┌──────────┴──────────┐┌──────────┴──────────┐
│      HASH_JOIN      │                                              │     PARQUET_SCAN    ││        FILTER       ││      HASH_JOIN      │                                              │     PARQUET_SCAN    ││        FILTER       │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                              │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │
│        INNER        │                                              │    w_warehouse_sk   ││((sm_carrier = 'ZHOU'││        INNER        │                                              │    w_warehouse_sk   ││((sm_carrier = 'ZHOU'│
│  ws_sold_date_sk =  │                                              │   w_warehouse_name  ││ ) OR (sm_carrier =  ││  cs_sold_date_sk =  │                                              │   w_warehouse_name  ││ ) OR (sm_carrier =  │
│       d_date_sk     │                                              │  w_warehouse_sq_ft  ││       'MSC'))       ││       d_date_sk     │                                              │  w_warehouse_sq_ft  ││       'MSC'))       │
│ EC = 2879695.880383 ├──────────────────────────────────┐           │        w_city       ││                     ││ EC = 5759186.026883 ├──────────────────────────────────┐           │        w_city       ││                     │
│   COST = 17278175   │                                  │           │       w_county      ││                     ││   COST = 34555116   │                                  │           │       w_county      ││                     │
│       .282300       │                                  │           │       w_state       ││                     ││       .161300       │                                  │           │       w_state       ││                     │
│                     │                                  │           │      w_country      ││                     ││                     │                                  │           │      w_country      ││                     │
│                     │                                  │           │        EC=15        ││                     ││                     │                                  │           │        EC=15        ││                     │
└──────────┬──────────┘                                  │           └─────────────────────┘└──────────┬──────────┘└──────────┬──────────┘                                  │           └─────────────────────┘└──────────┬──────────┘                       
┌──────────┴──────────┐                       ┌──────────┴──────────┐                       ┌──────────┴──────────┐┌──────────┴──────────┐                       ┌──────────┴──────────┐                       ┌──────────┴──────────┐
│      HASH_JOIN      │                       │     PARQUET_SCAN    │                       │     PARQUET_SCAN    ││      HASH_JOIN      │                       │     PARQUET_SCAN    │                       │     PARQUET_SCAN    │
│   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │   ─ ─ ─ ─ ─ ─ ─ ─   │
│        INNER        │                       │      d_date_sk      │                       │   sm_ship_mode_sk   ││        INNER        │                       │      d_date_sk      │                       │   sm_ship_mode_sk   │
│  ws_sold_time_sk =  │                       │        d_year       │                       │      sm_carrier     ││  cs_sold_time_sk =  │                       │        d_year       │                       │      sm_carrier     │
│       t_time_sk     │                       │        d_moy        │                       │        EC=20        ││       t_time_sk     │                       │        d_moy        │                       │        EC=20        │
│ EC = 14398479.401917├───────────┐           │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     ││ EC = 28795930.134416├───────────┐           │   ─ ─ ─ ─ ─ ─ ─ ─   │                       │                     │
│   COST = 14398479   │           │           │ Filters: d_year=2000│                       │                     ││   COST = 28795930   │           │           │ Filters: d_year=2000│                       │                     │
│       .401917       │           │           │   AND d_year IS NOT │                       │                     ││       .134416       │           │           │   AND d_year IS NOT │                       │                     │
│                     │           │           │         NULL        │                       │                     ││                     │           │           │         NULL        │                       │                     │
│                     │           │           │       EC=8118       │                       │                     ││                     │           │           │       EC=8118       │                       │                     │
└──────────┬──────────┘           │           └─────────────────────┘                       └─────────────────────┘└──────────┬──────────┘           │           └─────────────────────┘                       └─────────────────────┘                       
┌──────────┴──────────┐┌──────────┴──────────┐                                                                     ┌──────────┴──────────┐┌──────────┴──────────┐                                                                     
│     PARQUET_SCAN    ││     PARQUET_SCAN    │                                                                     │     PARQUET_SCAN    ││     PARQUET_SCAN    │                                                                     
│   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     
│   ws_sold_date_sk   ││      t_time_sk      │                                                                     │   cs_sold_date_sk   ││      t_time_sk      │                                                                     
│   ws_sold_time_sk   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     │   cs_sold_time_sk   ││   ─ ─ ─ ─ ─ ─ ─ ─   │                                                                     
│   ws_ship_mode_sk   ││   Filters: t_time>  │                                                                     │   cs_ship_mode_sk   ││   Filters: t_time>  │                                                                     
│   ws_warehouse_sk   ││=12143 AND t_tim...  │                                                                     │   cs_warehouse_sk   ││=12143 AND t_tim...  │                                                                     
│     ws_quantity     ││ AND t_time IS N...  │                                                                     │     cs_quantity     ││ AND t_time IS N...  │                                                                     
│    ws_sales_price   ││       EC=6302       │                                                                     │  cs_ext_list_price  ││       EC=6302       │                                                                     
│ ws_net_paid_inc_tax ││                     │                                                                     │ cs_net_paid_inc_tax ││                     │                                                                     
│     EC=72001536     ││                     │                                                                     │     EC=143997928    ││                     │                                                                     
└─────────────────────┘└─────────────────────┘                                                                     └─────────────────────┘└─────────────────────┘                                                                                            

