┌───────────────────────────┐                                                                                                                    
│           TOP_N           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          Top 100          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│customer_address.ca_zip ASC│                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│       HASH_GROUP_BY       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│          sum(#1)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           ca_zip          │                                                                                                                    
│       cs_sales_price      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                                                                                                                    
│cs_sold_date_sk = d_date_sk├─────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│    EC = 5759917.120000    │                                                                                                     │              
│   COST = 5759917.120000   │                                                                                                     │              
└─────────────┬─────────────┘                                                                                                     │                                           
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐
│         PROJECTION        │                                                                                       │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                       │         d_date_sk         │
│             #2            │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #4            │                                                                                       │  Filters: d_year=1999 AND │
│                           │                                                                                       │     d_year IS NOT NULL    │
│                           │                                                                                       │  d_qoy=1 AND d_qoy IS NOT │
│                           │                                                                                       │            NULL           │
│                           │                                                                                       │          EC=8118          │
└─────────────┬─────────────┘                                                                                       └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                    
│           FILTER          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│       (IN (...) OR        │                                                                                                                    
│(cs_sales_price > 500....  │                                                                                                                    
│ 'CA') OR (ca_state = 'WA')│                                                                                                                    
│   OR (ca_state = 'GA')))  │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│            MARK           │                                                                                                                    
│ substr(ca_zip, 1, 5) = #0 ├────────────────────────────────────────────────────────────────────────┐                                           
│       EC = 0.000000       │                                                                        │                                           
│      COST = 0.000000      │                                                                        │                                           
└─────────────┬─────────────┘                                                                        │                                                                        
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             
│         HASH_JOIN         │                                                          │      COLUMN_DATA_SCAN     │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │                           │                             
│           INNER           │                                                          │                           │                             
│   cs_bill_customer_sk =   ├──────────────┐                                           │                           │                             
│        c_customer_sk      │              │                                           │                           │                             
│   EC = 143997928.000000   │              │                                           │                           │                             
│  COST = 145997896.000000  │              │                                           │                           │                             
└─────────────┬─────────────┘              │                                           └───────────────────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
│        PARQUET_SCAN       ││         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      cs_sold_date_sk      ││           INNER           │                                                                                       
│    cs_bill_customer_sk    ││    c_current_addr_sk =    ├──────────────┐                                                                        
│       cs_sales_price      ││        ca_address_sk      │              │                                                                        
│        EC=143997928       ││    EC = 1999968.000000    │              │                                                                        
│                           ││   COST = 1999968.000000   │              │                                                                        
└───────────────────────────┘└─────────────┬─────────────┘              │                                                                                                     
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
                             │        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                             │       c_customer_sk       ││       ca_address_sk       │                                                          
                             │     c_current_addr_sk     ││          ca_state         │                                                          
                             │         EC=1999968        ││           ca_zip          │                                                          
                             │                           ││         EC=1000032        │                                                          
                             └───────────────────────────┘└───────────────────────────┘                                                                                       

