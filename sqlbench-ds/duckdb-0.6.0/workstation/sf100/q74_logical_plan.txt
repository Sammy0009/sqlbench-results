┌─────────────────┐                                                                                                                                                                                                                 
│      TOP_N      │                                                                                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                 
│     Top 100     │                                                                                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                 
│   t_s_secyear   │                                                                                                                                                                                                                 
│ .customer_id ASC│                                                                                                                                                                                                                 
│   t_s_secyear   │                                                                                                                                                                                                                 
│.customer_la...  │                                                                                                                                                                                                                 
│   t_s_secyear   │                                                                                                                                                                                                                 
│.customer_fi...  │                                                                                                                                                                                                                 
│        ASC      │                                                                                                                                                                                                                 
└────────┬────────┘                                                                                                                                                                                                                                    
┌────────┴────────┐                                                                                                                                                                                                                 
│    PROJECTION   │                                                                                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                 
│        #0       │                                                                                                                                                                                                                 
│        #2       │                                                                                                                                                                                                                 
│        #3       │                                                                                                                                                                                                                 
└────────┬────────┘                                                                                                                                                                                                                                    
┌────────┴────────┐                                                                                                                                                                                                                 
│      FILTER     │                                                                                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                 
│  (CASE  WHEN (  │                                                                                                                                                                                                                 
│(year_total ...  │                                                                                                                                                                                                                 
│ THEN ((year...  │                                                                                                                                                                                                                 
│  / year_total)) │                                                                                                                                                                                                                 
│  ELSE NULL END >│                                                                                                                                                                                                                 
│   CASE  WHEN (  │                                                                                                                                                                                                                 
│(year_total ...  │                                                                                                                                                                                                                 
│  ((year_total / │                                                                                                                                                                                                                 
│ year_total)...  │                                                                                                                                                                                                                 
│     NULL END)   │                                                                                                                                                                                                                 
└────────┬────────┘                                                                                                                                                                                                                                    
┌────────┴────────┐                                                                                                                                                                                                                 
│    HASH_JOIN    │                                                                                                                                                                                                                 
│   ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                                 
│      INNER      │                                                                                                                                                                                                                 
│  customer_id =  │                                                                                                                                                                                                                 
│    customer_id  │                                                                                                                                                                                                                 
│  customer_id =  │                                                                                                                                                                                                                 
│    customer_id  ├───────────────────────────────────────────────┐                                                                                                                                                                 
│  customer_id =  │                                               │                                                                                                                                                                 
│    customer_id  │                                               │                                                                                                                                                                 
│  EC = 230390512 │                                               │                                                                                                                                                                 
│     .224995     │                                               │                                                                                                                                                                 
│ COST = 302390247│                                               │                                                                                                                                                                 
│     .224995     │                                               │                                                                                                                                                                 
└────────┬────────┘                                               │                                                                                                                                                                                    
┌────────┴────────┐                                      ┌────────┴────────┐                                                                                                                                                        
│    PROJECTION   │                                      │    HASH_JOIN    │                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                                                                                                                                        
│        #0       │                                      │      INNER      │                                                                                                                                                        
│        #4       │                                      │  customer_id =  │                                                                                                                                                        
│                 │                                      │    customer_id  │                                                                                                                                                        
│                 │                                      │  customer_id =  ├───────────────────────────────────────────────┐                                                                                                        
│                 │                                      │    customer_id  │                                               │                                                                                                        
│                 │                                      │  EC = 57599428  │                                               │                                                                                                        
│                 │                                      │     .000000     │                                               │                                                                                                        
│                 │                                      │ COST = 71999735 │                                               │                                                                                                        
│                 │                                      │     .000000     │                                               │                                                                                                        
└────────┬────────┘                                      └────────┬────────┘                                               │                                                                                                                           
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                                                                               
│      FILTER     │                                      │    PROJECTION   │                                      │    HASH_JOIN    │                                                                                               
│   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                                                                               
│(year_total > 0.0│                                      │   customer_id   │                                      │      INNER      │                                                                                               
│        )        │                                      │customer_first_na│                                      │  customer_id =  │                                                                                               
│                 │                                      │        me       │                                      │    customer_id  ├───────────────────────────────────────────────┐                                               
│                 │                                      │customer_last_nam│                                      │  EC = 14400307  │                                               │                                               
│                 │                                      │        e        │                                      │     .000000     │                                               │                                               
│                 │                                      │    year_total   │                                      │ COST = 14400307 │                                               │                                               
│                 │                                      │                 │                                      │     .000000     │                                               │                                               
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                               │                                                                  
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      
│  HASH_GROUP_BY  │                                      │  HASH_GROUP_BY  │                                      │    PROJECTION   │                                      │    PROJECTION   │                                      
│   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      
│        #0       │                                      │        #0       │                                      │        #0       │                                      │   customer_id   │                                      
│        #1       │                                      │        #1       │                                      │        #4       │                                      │    year_total   │                                      
│        #2       │                                      │        #2       │                                      │                 │                                      │                 │                                      
│        #3       │                                      │        #3       │                                      │                 │                                      │                 │                                      
│ stddev_samp(#4) │                                      │ stddev_samp(#4) │                                      │                 │                                      │                 │                                      
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                                         
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      
│    PROJECTION   │                                      │    PROJECTION   │                                      │      FILTER     │                                      │  HASH_GROUP_BY  │                                      
│   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      
│  c_customer_id  │                                      │  c_customer_id  │                                      │(year_total > 0.0│                                      │        #0       │                                      
│   c_first_name  │                                      │   c_first_name  │                                      │        )        │                                      │        #1       │                                      
│   c_last_name   │                                      │   c_last_name   │                                      │                 │                                      │        #2       │                                      
│      d_year     │                                      │      d_year     │                                      │                 │                                      │        #3       │                                      
│ CAST(ss_net_paid│                                      │ CAST(ss_net_paid│                                      │                 │                                      │ stddev_samp(#4) │                                      
│    AS DOUBLE)   │                                      │    AS DOUBLE)   │                                      │                 │                                      │                 │                                      
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                                         
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      
│    HASH_JOIN    │                                      │    HASH_JOIN    │                                      │  HASH_GROUP_BY  │                                      │    PROJECTION   │                                      
│   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      
│      INNER      │                                      │      INNER      │                                      │        #0       │                                      │  c_customer_id  │                                      
│ ss_customer_sk =│                                      │ ss_customer_sk =│                                      │        #1       │                                      │   c_first_name  │                                      
│   c_customer_sk ├────────────────────────────┐         │   c_customer_sk ├────────────────────────────┐         │        #2       │                                      │   c_last_name   │                                      
│  EC = 57599428  │                            │         │  EC = 57599428  │                            │         │        #3       │                                      │      d_year     │                                      
│     .800000     │                            │         │     .800000     │                            │         │ stddev_samp(#4) │                                      │ CAST(ws_net_paid│                                      
│ COST = 115198857│                            │         │ COST = 115198857│                            │         │                 │                                      │    AS DOUBLE)   │                                      
│     .600000     │                            │         │     .600000     │                            │         │                 │                                      │                 │                                      
└────────┬────────┘                            │         └────────┬────────┘                            │         └────────┬────────┘                                      └────────┬────────┘                                                         
┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐                                      ┌────────┴────────┐                                      
│    HASH_JOIN    │                   │   PARQUET_SCAN  ││    HASH_JOIN    │                   │   PARQUET_SCAN  ││    PROJECTION   │                                      │    HASH_JOIN    │                                      
│   ─ ─ ─ ─ ─ ─   │                   │   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   │                   │   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                                      
│      INNER      │                   │  c_customer_sk  ││      INNER      │                   │  c_customer_sk  ││  c_customer_id  │                                      │      INNER      │                                      
│ss_sold_date_sk =│                   │  c_customer_id  ││ss_sold_date_sk =│                   │  c_customer_id  ││   c_first_name  │                                      │ws_bill_customer_│                                      
│     d_date_sk   │                   │   c_first_name  ││     d_date_sk   │                   │   c_first_name  ││   c_last_name   │                                      │sk = c_customer_s│                                      
│  EC = 57599428  ├─────────┐         │   c_last_name   ││  EC = 57599428  ├─────────┐         │   c_last_name   ││      d_year     │                                      │        k        ├────────────────────────────┐         
│     .800000     │         │         │    EC=1999968   ││     .800000     │         │         │    EC=1999968   ││ CAST(ws_net_paid│                                      │  EC = 14400307  │                            │         
│ COST = 57599428 │         │         │                 ││ COST = 57599428 │         │         │                 ││    AS DOUBLE)   │                                      │     .200000     │                            │         
│     .800000     │         │         │                 ││     .800000     │         │         │                 ││                 │                                      │ COST = 28800614 │                            │         
│                 │         │         │                 ││                 │         │         │                 ││                 │                                      │     .400000     │                            │         
└────────┬────────┘         │         └─────────────────┘└────────┬────────┘         │         └─────────────────┘└────────┬────────┘                                      └────────┬────────┘                            │                            
┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐                                      ┌────────┴────────┐                   ┌────────┴────────┐
│   PARQUET_SCAN  ││   PARQUET_SCAN  │                   │   PARQUET_SCAN  ││   PARQUET_SCAN  │                   │    HASH_JOIN    │                                      │    HASH_JOIN    │                   │   PARQUET_SCAN  │
│   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   │                   │   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   │                   │   ─ ─ ─ ─ ─ ─   │                                      │   ─ ─ ─ ─ ─ ─   │                   │   ─ ─ ─ ─ ─ ─   │
│ ss_sold_date_sk ││    d_date_sk    │                   │ ss_sold_date_sk ││    d_date_sk    │                   │      INNER      │                                      │      INNER      │                   │  c_customer_sk  │
│  ss_customer_sk ││      d_year     │                   │  ss_customer_sk ││      d_year     │                   │ws_bill_customer_│                                      │ws_sold_date_sk =│                   │  c_customer_id  │
│   ss_net_paid   ││   ─ ─ ─ ─ ─ ─   │                   │   ss_net_paid   ││   ─ ─ ─ ─ ─ ─   │                   │sk = c_customer_s│                                      │     d_date_sk   │                   │   c_first_name  │
│   EC=287997144  ││ Filters: d_year │                   │   EC=287997144  ││ Filters: d_year │                   │        k        │                                      │  EC = 14400307  │                   │   c_last_name   │
│                 ││=2001 AND d_...  │                   │                 ││=2002 AND d_...  │                   │  EC = 14400307  ├────────────────────────────┐         │     .200000     ├─────────┐         │    EC=1999968   │
│                 ││   NOT NULL AND  │                   │                 ││   NOT NULL AND  │                   │     .200000     │                            │         │ COST = 14400307 │         │         │                 │
│                 ││ d_year>=2001 AND│                   │                 ││ d_year>=2001 AND│                   │ COST = 28800614 │                            │         │     .200000     │         │         │                 │
│                 ││ d_year<=2002 AND│                   │                 ││ d_year<=2002 AND│                   │     .400000     │                            │         │                 │         │         │                 │
│                 ││ d_year IS N...  │                   │                 ││ d_year IS N...  │                   │                 │                            │         │                 │         │         │                 │
│                 ││     EC=8118     │                   │                 ││     EC=8118     │                   │                 │                            │         │                 │         │         │                 │
└─────────────────┘└─────────────────┘                   └─────────────────┘└─────────────────┘                   └────────┬────────┘                            │         └────────┬────────┘         │         └─────────────────┘                   
                                                                                                                  ┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐┌────────┴────────┐                   
                                                                                                                  │    HASH_JOIN    │                   │   PARQUET_SCAN  ││   PARQUET_SCAN  ││   PARQUET_SCAN  │                   
                                                                                                                  │   ─ ─ ─ ─ ─ ─   │                   │   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   │                   
                                                                                                                  │      INNER      │                   │  c_customer_sk  ││ ws_sold_date_sk ││    d_date_sk    │                   
                                                                                                                  │ws_sold_date_sk =│                   │  c_customer_id  ││ws_bill_customer_││      d_year     │                   
                                                                                                                  │     d_date_sk   │                   │   c_first_name  ││        sk       ││   ─ ─ ─ ─ ─ ─   │                   
                                                                                                                  │  EC = 14400307  │                   │   c_last_name   ││   ws_net_paid   ││ Filters: d_year │                   
                                                                                                                  │     .200000     ├─────────┐         │    EC=1999968   ││   EC=72001536   ││=2002 AND d_...  │                   
                                                                                                                  │ COST = 14400307 │         │         │                 ││                 ││   NOT NULL AND  │                   
                                                                                                                  │     .200000     │         │         │                 ││                 ││ d_year>=2001 AND│                   
                                                                                                                  │                 │         │         │                 ││                 ││ d_year<=2002 AND│                   
                                                                                                                  │                 │         │         │                 ││                 ││ d_year IS N...  │                   
                                                                                                                  │                 │         │         │                 ││                 ││     EC=8118     │                   
                                                                                                                  └────────┬────────┘         │         └─────────────────┘└─────────────────┘└─────────────────┘                                      
                                                                                                                  ┌────────┴────────┐┌────────┴────────┐                                                                            
                                                                                                                  │   PARQUET_SCAN  ││   PARQUET_SCAN  │                                                                            
                                                                                                                  │   ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─   │                                                                            
                                                                                                                  │ ws_sold_date_sk ││    d_date_sk    │                                                                            
                                                                                                                  │ws_bill_customer_││      d_year     │                                                                            
                                                                                                                  │        sk       ││   ─ ─ ─ ─ ─ ─   │                                                                            
                                                                                                                  │   ws_net_paid   ││ Filters: d_year │                                                                            
                                                                                                                  │   EC=72001536   ││=2001 AND d_...  │                                                                            
                                                                                                                  │                 ││   NOT NULL AND  │                                                                            
                                                                                                                  │                 ││ d_year>=2001 AND│                                                                            
                                                                                                                  │                 ││ d_year<=2002 AND│                                                                            
                                                                                                                  │                 ││ d_year IS N...  │                                                                            
                                                                                                                  │                 ││     EC=8118     │                                                                            
                                                                                                                  └─────────────────┘└─────────────────┘                                                                                               

