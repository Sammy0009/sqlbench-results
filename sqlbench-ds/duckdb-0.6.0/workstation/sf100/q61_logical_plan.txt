┌───────────────┐                                                                                                                                                                                                            
│     TOP_N     │                                                                                                                                                                                                            
│   ─ ─ ─ ─ ─   │                                                                                                                                                                                                            
│    Top 100    │                                                                                                                                                                                                            
│   ─ ─ ─ ─ ─   │                                                                                                                                                                                                            
│promotional_sal│                                                                                                                                                                                                            
│ es.promotions │                                                                                                                                                                                                            
│       ASC     │                                                                                                                                                                                                            
│all_sales.total│                                                                                                                                                                                                            
│       ASC     │                                                                                                                                                                                                            
└───────┬───────┘                                                                                                                                                                                                                             
┌───────┴───────┐                                                                                                                                                                                                            
│   PROJECTION  │                                                                                                                                                                                                            
│   ─ ─ ─ ─ ─   │                                                                                                                                                                                                            
│   promotions  │                                                                                                                                                                                                            
│     total     │                                                                                                                                                                                                            
│  ((CAST(CAST  │                                                                                                                                                                                                            
│ (promotions AS│                                                                                                                                                                                                            
│ DECIMAL(1...  │                                                                                                                                                                                                            
│ DOUBLE) / CAST│                                                                                                                                                                                                            
│ (CAST(total AS│                                                                                                                                                                                                            
│ DECIMAL(1...  │                                                                                                                                                                                                            
│ DOUBLE)) * 100│                                                                                                                                                                                                            
│      .0)      │                                                                                                                                                                                                            
└───────┬───────┘                                                                                                                                                                                                                             
┌───────┴───────┐                                                                                                                                                                                                            
│ CROSS_PRODUCT ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                             
└───────┬───────┘                                                                                                              │                                                                                                              
┌───────┴───────┐                                                                                                      ┌───────┴───────┐                                                                                     
│UNGROUPED_...  │                                                                                                      │UNGROUPED_...  │                                                                                     
│   ─ ─ ─ ─ ─   │                                                                                                      │   ─ ─ ─ ─ ─   │                                                                                     
│    sum(#0)    │                                                                                                      │    sum(#0)    │                                                                                     
└───────┬───────┘                                                                                                      └───────┬───────┘                                                                                                      
┌───────┴───────┐                                                                                                      ┌───────┴───────┐                                                                                     
│   PROJECTION  │                                                                                                      │   PROJECTION  │                                                                                     
│   ─ ─ ─ ─ ─   │                                                                                                      │   ─ ─ ─ ─ ─   │                                                                                     
│ss_ext_sales_pr│                                                                                                      │ss_ext_sales_pr│                                                                                     
│      ice      │                                                                                                      │      ice      │                                                                                     
└───────┬───────┘                                                                                                      └───────┬───────┘                                                                                                      
┌───────┴───────┐                                                                                                      ┌───────┴───────┐                                                                                     
│   HASH_JOIN   │                                                                                                      │   HASH_JOIN   │                                                                                     
│   ─ ─ ─ ─ ─   │                                                                                                      │   ─ ─ ─ ─ ─   │                                                                                     
│     INNER     │                                                                                                      │     INNER     │                                                                                     
│ ss_promo_sk = │                                                                                                      │  ss_item_sk = │                                                                                     
│   p_promo_sk  ├─────────────────────────────────────────────────────────────────────────────────────────────┐        │    i_item_sk  ├────────────────────────────────────────────────────────────────────────────┐        
│  EC = 458501  │                                                                                             │        │  EC = 458501  │                                                                            │        
│    .998844    │                                                                                             │        │    .998844    │                                                                            │        
│COST = 72384921│                                                                                             │        │COST = 71926419│                                                                            │        
│    .240671    │                                                                                             │        │    .241827    │                                                                            │        
└───────┬───────┘                                                                                             │        └───────┬───────┘                                                                            │                         
┌───────┴───────┐                                                                                     ┌───────┴───────┐┌───────┴───────┐                                                                    ┌───────┴───────┐
│   HASH_JOIN   │                                                                                     │   PROJECTION  ││   HASH_JOIN   │                                                                    │  PARQUET_SCAN │
│   ─ ─ ─ ─ ─   │                                                                                     │   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   │                                                                    │   ─ ─ ─ ─ ─   │
│     INNER     │                                                                                     │       #0      ││     INNER     │                                                                    │   i_item_sk   │
│ss_sold_date_sk│                                                                                     │               ││ss_sold_date_sk│                                                                    │   ─ ─ ─ ─ ─   │
│   = d_date_sk ├────────────────────────────────────────────────────────────────────────────┐        │               ││   = d_date_sk ├───────────────────────────────────────────────────────────┐        │Filters: i_cate│
│  EC = 458501  │                                                                            │        │               ││  EC = 2292509 │                                                           │        │  gory=Jewelry │
│    .998844    │                                                                            │        │               ││    .994222    │                                                           │        │ AND i_cat...  │
│COST = 71926419│                                                                            │        │               ││COST = 71467917│                                                           │        │    NOT NULL   │
│    .241827    │                                                                            │        │               ││    .242983    │                                                           │        │    EC=40460   │
└───────┬───────┘                                                                            │        └───────┬───────┘└───────┬───────┘                                                           │        └───────────────┘                 
┌───────┴───────┐                                                                    ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                                                   ┌───────┴───────┐                 
│   HASH_JOIN   │                                                                    │  PARQUET_SCAN ││     FILTER    ││   HASH_JOIN   │                                                   │  PARQUET_SCAN │                 
│   ─ ─ ─ ─ ─   │                                                                    │   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   │                                                   │   ─ ─ ─ ─ ─   │                 
│     INNER     │                                                                    │   d_date_sk   ││((p_channel_dma││     INNER     │                                                   │   d_date_sk   │                 
│  ss_item_sk = │                                                                    │   ─ ─ ─ ─ ─   ││ il = 'Y') OR  ││ss_customer_sk │                                                   │   ─ ─ ─ ─ ─   │                 
│    i_item_sk  │                                                                    │ Filters: d_moy││(p_channel...  ││= c_customer_sk│                                                   │ Filters: d_moy│                 
│  EC = 2292509 ├───────────────────────────────────────────────────────────┐        │=12 AND d_...  ││   = 'Y') OR   ││ EC = 11462549 ├─────────────────────────┐                         │=12 AND d_...  │                 
│    .994222    │                                                           │        │    NOT NULL   ││(p_channel...  ││    .971110    │                         │                         │    NOT NULL   │                 
│COST = 71467917│                                                           │        │d_year=2001 AND││       )       ││COST = 69175407│                         │                         │d_year=2001 AND│                 
│    .242983    │                                                           │        │  d_year IS NOT││               ││    .248761    │                         │                         │  d_year IS NOT│                 
│               │                                                           │        │      NULL     ││               ││               │                         │                         │      NULL     │                 
│               │                                                           │        │    EC=8118    ││               ││               │                         │                         │    EC=8118    │                 
└───────┬───────┘                                                           │        └───────────────┘└───────┬───────┘└───────┬───────┘                         │                         └───────────────┘                                  
┌───────┴───────┐                                                   ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐                 ┌───────┴───────┐                                                   
│   HASH_JOIN   │                                                   │  PARQUET_SCAN │                 │  PARQUET_SCAN ││   HASH_JOIN   │                 │   HASH_JOIN   │                                                   
│   ─ ─ ─ ─ ─   │                                                   │   ─ ─ ─ ─ ─   │                 │   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   │                 │   ─ ─ ─ ─ ─   │                                                   
│     INNER     │                                                   │   i_item_sk   │                 │   p_promo_sk  ││     INNER     │                 │     INNER     │                                                   
│ss_customer_sk │                                                   │   ─ ─ ─ ─ ─   │                 │p_channel_dmail││ ss_store_sk = │                 │c_current_addr_│                                                   
│= c_customer_sk│                                                   │Filters: i_cate│                 │p_channel_email││   s_store_sk  │                 │sk = ca_address│                                                   
│ EC = 11462549 ├─────────────────────────┐                         │  gory=Jewelry │                 │  p_channel_tv ││ EC = 57312864 ├────────┐        │      _sk      ├────────┐                                          
│    .971110    │                         │                         │ AND i_cat...  │                 │    EC=1000    ││    .477612    │        │        │  EC = 399992  │        │                                          
│COST = 69175407│                         │                         │    NOT NULL   │                 │               ││COST = 57312864│        │        │    .800038    │        │                                          
│    .248761    │                         │                         │    EC=40460   │                 │               ││    .477612    │        │        │ COST = 399992 │        │                                          
│               │                         │                         │               │                 │               ││               │        │        │    .800038    │        │                                          
└───────┬───────┘                         │                         └───────────────┘                 └───────────────┘└───────┬───────┘        │        └───────┬───────┘        │                                                           
┌───────┴───────┐                 ┌───────┴───────┐                                                                    ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                                  
│   HASH_JOIN   │                 │   HASH_JOIN   │                                                                    │  PARQUET_SCAN ││  PARQUET_SCAN ││  PARQUET_SCAN ││  PARQUET_SCAN │                                  
│   ─ ─ ─ ─ ─   │                 │   ─ ─ ─ ─ ─   │                                                                    │   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   │                                  
│     INNER     │                 │     INNER     │                                                                    │ss_sold_date_sk││   s_store_sk  ││ c_customer_sk ││ ca_address_sk │                                  
│ ss_store_sk = │                 │c_current_addr_│                                                                    │   ss_item_sk  ││   ─ ─ ─ ─ ─   ││c_current_addr_││   ─ ─ ─ ─ ─   │                                  
│   s_store_sk  │                 │sk = ca_address│                                                                    │ ss_customer_sk││Filters: s_gmt_││       sk      ││Filters: ca_gmt│                                  
│ EC = 57312864 ├────────┐        │      _sk      ├────────┐                                                           │  ss_store_sk  ││  offset=-6.00 ││   EC=1999968  ││ _offset=-6.00 │                                  
│    .477612    │        │        │  EC = 399992  │        │                                                           │ss_ext_sales_pr││ AND s_gmt...  ││               ││ AND ca_gm...  │                                  
│COST = 57312864│        │        │    .800038    │        │                                                           │      ice      ││   IS NOT NULL ││               ││ t IS NOT NULL │                                  
│    .477612    │        │        │ COST = 399992 │        │                                                           │  EC=287997144 ││     EC=80     ││               ││   EC=200006   │                                  
│               │        │        │    .800038    │        │                                                           │               ││               ││               ││               │                                  
└───────┬───────┘        │        └───────┬───────┘        │                                                           └───────────────┘└───────────────┘└───────────────┘└───────────────┘                                                   
┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                                                                                                                                                         
│  PARQUET_SCAN ││  PARQUET_SCAN ││  PARQUET_SCAN ││  PARQUET_SCAN │                                                                                                                                                         
│   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─   │                                                                                                                                                         
│ss_sold_date_sk││   s_store_sk  ││ c_customer_sk ││ ca_address_sk │                                                                                                                                                         
│   ss_item_sk  ││   ─ ─ ─ ─ ─   ││c_current_addr_││   ─ ─ ─ ─ ─   │                                                                                                                                                         
│ ss_customer_sk││Filters: s_gmt_││       sk      ││Filters: ca_gmt│                                                                                                                                                         
│  ss_store_sk  ││  offset=-6.00 ││   EC=1999968  ││ _offset=-6.00 │                                                                                                                                                         
│  ss_promo_sk  ││ AND s_gmt...  ││               ││ AND ca_gm...  │                                                                                                                                                         
│ss_ext_sales_pr││   IS NOT NULL ││               ││ t IS NOT NULL │                                                                                                                                                         
│      ice      ││     EC=80     ││               ││   EC=200006   │                                                                                                                                                         
│  EC=287997144 ││               ││               ││               │                                                                                                                                                         
└───────────────┘└───────────────┘└───────────────┘└───────────────┘                                                                                                                                                                          

