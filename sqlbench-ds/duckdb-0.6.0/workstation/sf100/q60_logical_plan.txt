┌─────────────┐                                                                                                                                                                                                                  
│    TOP_N    │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│   Top 100   │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│tmp1.i_item_i│                                                                                                                                                                                                                  
│    d ASC    │                                                                                                                                                                                                                  
│sum(tmp1.tota│                                                                                                                                                                                                                  
│ l_sales) ASC│                                                                                                                                                                                                                  
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                  
│HASH_GROUP_BY│                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│      #0     │                                                                                                                                                                                                                  
│   sum(#1)   │                                                                                                                                                                                                                  
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                  
│  PROJECTION │                                                                                                                                                                                                                  
│   ─ ─ ─ ─   │                                                                                                                                                                                                                  
│  i_item_id  │                                                                                                                                                                                                                  
│ total_sales │                                                                                                                                                                                                                  
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                  
│    UNION    ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                   
└──────┬──────┘                                                                                                                                              │                                                                                  
┌──────┴──────┐                                                                                                                                       ┌──────┴──────┐                                                            
│    UNION    │                                                                                                                                       │HASH_GROUP_BY│                                                            
│             │                                                                                                                                       │   ─ ─ ─ ─   │                                                            
│             ├───────────────────────────────────────────────────────────────────┐                                                                   │      #0     │                                                            
│             │                                                                   │                                                                   │   sum(#1)   │                                                            
└──────┬──────┘                                                                   │                                                                   └──────┬──────┘                                                                           
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            
│HASH_GROUP_BY│                                                            │HASH_GROUP_BY│                                                            │  PROJECTION │                                                            
│   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            
│      #0     │                                                            │      #0     │                                                            │  i_item_id  │                                                            
│   sum(#1)   │                                                            │   sum(#1)   │                                                            │ws_ext_sales_│                                                            
│             │                                                            │             │                                                            │    price    │                                                            
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘                                                                           
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            
│  PROJECTION │                                                            │  PROJECTION │                                                            │  HASH_JOIN  │                                                            
│   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            
│  i_item_id  │                                                            │  i_item_id  │                                                            │     SEMI    │                                                            
│ss_ext_sales_│                                                            │cs_ext_sales_│                                                            │ i_item_id = │                                                            
│    price    │                                                            │    price    │                                                            │      #0     ├────────────────────────────────────────────────────┐       
│             │                                                            │             │                                                            │EC = 0.000000│                                                    │       
│             │                                                            │             │                                                            │COST = 0.0000│                                                    │       
│             │                                                            │             │                                                            │      00     │                                                    │       
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘                                                    │                      
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                             ┌──────┴──────┐
│  HASH_JOIN  │                                                            │  HASH_JOIN  │                                                            │  HASH_JOIN  │                                             │  PROJECTION │
│   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   │                                             │   ─ ─ ─ ─   │
│     SEMI    │                                                            │     SEMI    │                                                            │    INNER    │                                             │      #0     │
│ i_item_id = │                                                            │ i_item_id = │                                                            │ ws_item_sk =│                                             │             │
│      #0     ├────────────────────────────────────────────────────┐       │      #0     ├────────────────────────────────────────────────────┐       │   i_item_sk ├─────────────────────────────────────┐       │             │
│EC = 0.000000│                                                    │       │EC = 0.000000│                                                    │       │ EC = 2880055│                                     │       │             │
│COST = 0.0000│                                                    │       │COST = 0.0000│                                                    │       │   .680061   │                                     │       │             │
│      00     │                                                    │       │      00     │                                                    │       │COST = 201603│                                     │       │             │
│             │                                                    │       │             │                                                    │       │  89.760430  │                                     │       │             │
└──────┬──────┘                                                    │       └──────┬──────┘                                                    │       └──────┬──────┘                                     │       └──────┬──────┘               
┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐
│  HASH_JOIN  │                                             │  PROJECTION ││  HASH_JOIN  │                                             │  PROJECTION ││  HASH_JOIN  │                              │ PARQUET_SCAN││    FILTER   │
│   ─ ─ ─ ─   │                                             │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                                             │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │
│    INNER    │                                             │      #0     ││    INNER    │                                             │      #0     ││    INNER    │                              │  i_item_sk  ││(i_category =│
│ ss_item_sk =│                                             │             ││ cs_item_sk =│                                             │             ││ws_sold_date_│                              │  i_item_id  ││   'Shoes')  │
│   i_item_sk │                                             │             ││   i_item_sk │                                             │             ││sk = d_date_s│                              │  EC=202300  ││             │
│EC = 11519862├─────────────────────────────────────┐       │             ││ EC = 5759905├─────────────────────────────────────┐       │             ││      k      ├──────────────────────┐       │             ││             │
│   .720966   │                                     │       │             ││   .600534   │                                     │       │             ││ EC = 2880055│                      │       │             ││             │
│COST = 806390│                                     │       │             ││COST = 403193│                                     │       │             ││   .680061   │                      │       │             ││             │
│  39.046760  │                                     │       │             ││  39.203741  │                                     │       │             ││COST = 172803│                      │       │             ││             │
│             │                                     │       │             ││             │                                     │       │             ││  34.080369  │                      │       │             ││             │
└──────┬──────┘                                     │       └──────┬──────┘└──────┬──────┘                                     │       └──────┬──────┘└──────┬──────┘                      │       └─────────────┘└──────┬──────┘               
┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐
│  HASH_JOIN  │                              │ PARQUET_SCAN││    FILTER   ││  HASH_JOIN  │                              │ PARQUET_SCAN││    FILTER   ││  HASH_JOIN  │               │ PARQUET_SCAN│               │ PARQUET_SCAN│
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │
│    INNER    │                              │  i_item_sk  ││(i_category =││    INNER    │                              │  i_item_sk  ││(i_category =││    INNER    │               │  d_date_sk  │               │  i_item_id  │
│ss_sold_date_│                              │  i_item_id  ││   'Shoes')  ││cs_sold_date_│                              │  i_item_id  ││   'Shoes')  ││ws_bill_addr_│               │   ─ ─ ─ ─   │               │  i_category │
│sk = d_date_s│                              │  EC=202300  ││             ││sk = d_date_s│                              │  EC=202300  ││             ││sk = ca_addre│               │Filters: d_mo│               │  EC=202300  │
│      k      ├──────────────────────┐       │             ││             ││      k      ├──────────────────────┐       │             ││             ││    ss_sk    ├───────┐       │y=9 AND d_moy│               │             │
│EC = 11519862│                      │       │             ││             ││ EC = 5759905│                      │       │             ││             ││EC = 14400278│       │       │  IS NOT NULL│               │             │
│   .720966   │                      │       │             ││             ││   .600534   │                      │       │             ││             ││   .400307   │       │       │ d_year=2000 │               │             │
│COST = 691191│                      │       │             ││             ││COST = 345594│                      │       │             ││             ││COST = 144002│       │       │ AND d_y...  │               │             │
│  76.325794  │                      │       │             ││             ││  33.603206  │                      │       │             ││             ││  78.400307  │       │       │   NOT NULL  │               │             │
│             │                      │       │             ││             ││             │                      │       │             ││             ││             │       │       │   EC=8118   │               │             │
└──────┬──────┘                      │       └─────────────┘└──────┬──────┘└──────┬──────┘                      │       └─────────────┘└──────┬──────┘└──────┬──────┘       │       └─────────────┘               └─────────────┘               
┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐                                             
│  HASH_JOIN  │               │ PARQUET_SCAN│               │ PARQUET_SCAN││  HASH_JOIN  │               │ PARQUET_SCAN│               │ PARQUET_SCAN││ PARQUET_SCAN││ PARQUET_SCAN│                                             
│   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                                             
│    INNER    │               │  d_date_sk  │               │  i_item_id  ││    INNER    │               │  d_date_sk  │               │  i_item_id  ││ws_sold_date_││ca_address_sk│                                             
│ ss_addr_sk =│               │   ─ ─ ─ ─   │               │  i_category ││cs_bill_addr_│               │   ─ ─ ─ ─   │               │  i_category ││      sk     ││   ─ ─ ─ ─   │                                             
│ ca_addr...  │               │Filters: d_mo│               │  EC=202300  ││sk = ca_addre│               │Filters: d_mo│               │  EC=202300  ││  ws_item_sk ││Filters: ca_g│                                             
│EC = 57599313├───────┐       │y=9 AND d_moy│               │             ││    ss_sk    ├───────┐       │y=9 AND d_moy│               │             ││ws_bill_addr_││ mt_offset=-5│                                             
│   .604829   │       │       │  IS NOT NULL│               │             ││EC = 28799528│       │       │  IS NOT NULL│               │             ││      sk     ││.00 AND ...  │                                             
│COST = 575993│       │       │ d_year=2000 │               │             ││   .002672   │       │       │ d_year=2000 │               │             ││ws_ext_sales_││  _offset IS │                                             
│  13.604829  │       │       │ AND d_y...  │               │             ││COST = 287995│       │       │ AND d_y...  │               │             ││    price    ││   NOT NULL  │                                             
│             │       │       │   NOT NULL  │               │             ││  28.002672  │       │       │   NOT NULL  │               │             ││ EC=72001536 ││  EC=200006  │                                             
│             │       │       │   EC=8118   │               │             ││             │       │       │   EC=8118   │               │             ││             ││             │                                             
└──────┬──────┘       │       └─────────────┘               └─────────────┘└──────┬──────┘       │       └─────────────┘               └─────────────┘└─────────────┘└─────────────┘                                                            
┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                                                                                                        
│ PARQUET_SCAN││ PARQUET_SCAN│                                             │ PARQUET_SCAN││ PARQUET_SCAN│                                                                                                                        
│   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                                             │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                                                                                                                        
│ss_sold_date_││ca_address_sk│                                             │cs_sold_date_││ca_address_sk│                                                                                                                        
│      sk     ││   ─ ─ ─ ─   │                                             │      sk     ││   ─ ─ ─ ─   │                                                                                                                        
│  ss_item_sk ││Filters: ca_g│                                             │cs_bill_addr_││Filters: ca_g│                                                                                                                        
│  ss_addr_sk ││ mt_offset=-5│                                             │      sk     ││ mt_offset=-5│                                                                                                                        
│ss_ext_sales_││.00 AND ...  │                                             │  cs_item_sk ││.00 AND ...  │                                                                                                                        
│    price    ││  _offset IS │                                             │cs_ext_sales_││  _offset IS │                                                                                                                        
│ EC=287997144││   NOT NULL  │                                             │    price    ││   NOT NULL  │                                                                                                                        
│             ││  EC=200006  │                                             │ EC=143997928││  EC=200006  │                                                                                                                        
└─────────────┘└─────────────┘                                             └─────────────┘└─────────────┘                                                                                                                                       

