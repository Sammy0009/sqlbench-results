┌───────────────────────────┐                                                                                                                                                                              
│           TOP_N           │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│          Top 100          │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│  customer.c_last_name ASC │                                                                                                                                                                              
│  dn.ss_ticket_number ASC  │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│        c_last_name        │                                                                                                                                                                              
│        c_first_name       │                                                                                                                                                                              
│          ca_city          │                                                                                                                                                                              
│        bought_city        │                                                                                                                                                                              
│      ss_ticket_number     │                                                                                                                                                                              
│       extended_price      │                                                                                                                                                                              
│        extended_tax       │                                                                                                                                                                              
│         list_price        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│      ss_customer_sk =     │                                                                                                                                                                              
│        c_customer_sk      ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                           
│   bought_city != ca_city  │                                                                                                                                  │                                           
│    EC = 57599428.000000   │                                                                                                                                  │                                           
│   COST = 59599396.000000  │                                                                                                                                  │                                           
└─────────────┬─────────────┘                                                                                                                                  │                                                                        
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                             
│         PROJECTION        │                                                                                                                    │         HASH_JOIN         │                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│      ss_ticket_number     │                                                                                                                    │           INNER           │                             
│       ss_customer_sk      │                                                                                                                    │    c_current_addr_sk =    │                             
│        bought_city        │                                                                                                                    │        ca_address_sk      ├──────────────┐              
│       extended_price      │                                                                                                                    │    EC = 1999968.000000    │              │              
│         list_price        │                                                                                                                    │   COST = 1999968.000000   │              │              
│        extended_tax       │                                                                                                                    │                           │              │              
└─────────────┬─────────────┘                                                                                                                    └─────────────┬─────────────┘              │                                           
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                                                                                    │        PARQUET_SCAN       ││        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                                                                                    │       c_customer_sk       ││       ca_address_sk       │
│             #1            │                                                                                                                    │     c_current_addr_sk     ││          ca_city          │
│             #2            │                                                                                                                    │        c_first_name       ││         EC=1000032        │
│             #3            │                                                                                                                    │        c_last_name        ││                           │
│          sum(#4)          │                                                                                                                    │         EC=1999968        ││                           │
│          sum(#5)          │                                                                                                                    │                           ││                           │
│          sum(#6)          │                                                                                                                    │                           ││                           │
└─────────────┬─────────────┘                                                                                                                    └───────────────────────────┘└───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                                                                                                              
│         PROJECTION        │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│      ss_ticket_number     │                                                                                                                                                                              
│       ss_customer_sk      │                                                                                                                                                                              
│         ss_addr_sk        │                                                                                                                                                                              
│          ca_city          │                                                                                                                                                                              
│     ss_ext_sales_price    │                                                                                                                                                                              
│     ss_ext_list_price     │                                                                                                                                                                              
│         ss_ext_tax        │                                                                                                                                                                              
└─────────────┬─────────────┘                                                                                                                                                                                                           
┌─────────────┴─────────────┐                                                                                                                                                                              
│         HASH_JOIN         │                                                                                                                                                                              
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                              
│           INNER           │                                                                                                                                                                              
│ ss_addr_sk = ca_address_sk├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│    EC = 57599428.800000   │                                                                                                     │                                                                        
│  COST = 230397715.200000  │                                                                                                     │                                                                        
└─────────────┬─────────────┘                                                                                                     │                                                                                                     
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                                                       │        PARQUET_SCAN       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                       │       ca_address_sk       │                                                          
│  ss_hdemo_sk = hd_demo_sk ├────────────────────────────────────────────────────────────────────────┐              │          ca_city          │                                                          
│    EC = 57599428.800000   │                                                                        │              │         EC=1000032        │                                                          
│  COST = 172798286.400000  │                                                                        │              │                           │                                                          
└─────────────┬─────────────┘                                                                        │              └───────────────────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                          │         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                          │             #0            │                                                                                       
│  ss_store_sk = s_store_sk ├───────────────────────────────────────────┐              │                           │                                                                                       
│    EC = 57599428.800000   │                                           │              │                           │                                                                                       
│  COST = 115198857.600000  │                                           │              │                           │                                                                                       
└─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                             │         PROJECTION        ││           FILTER          │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                             │             #0            ││  ((hd_dep_count = 5) OR   │                                                                                       
│ss_sold_date_sk = d_date_sk├──────────────┐              │                           ││  (hd_vehicle_count = 0))  │                                                                                       
│    EC = 57599428.800000   │              │              │                           ││                           │                                                                                       
│   COST = 57599428.800000  │              │              │                           ││                           │                                                                                       
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
│        PARQUET_SCAN       ││        PARQUET_SCAN       ││           FILTER          ││        PARQUET_SCAN       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      ss_sold_date_sk      ││         d_date_sk         ││ ((s_city = 'Five Points') ││         hd_demo_sk        │                                                                                       
│       ss_customer_sk      ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ OR (s_city = 'Pleasan...  ││        hd_dep_count       │                                                                                       
│        ss_hdemo_sk        ││Filters: d_dom>=1 AND d_dom││             ))            ││      hd_vehicle_count     │                                                                                       
│         ss_addr_sk        ││ <=2 AND d_dom IS NOT NULL ││                           ││          EC=7200          │                                                                                       
│        ss_store_sk        ││  d_year>=1998 AND d_year< ││                           ││                           │                                                                                       
│      ss_ticket_number     ││=2000 AND d_year IS NO...  ││                           ││                           │                                                                                       
│     ss_ext_sales_price    ││          EC=8118          ││                           ││                           │                                                                                       
│     ss_ext_list_price     ││                           ││                           ││                           │                                                                                       
│         ss_ext_tax        ││                           ││                           ││                           │                                                                                       
│        EC=287997144       ││                           ││                           ││                           │                                                                                       
└───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘                                                                                                                    
                                                          ┌─────────────┴─────────────┐                                                                                                                    
                                                          │        PARQUET_SCAN       │                                                                                                                    
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
                                                          │         s_store_sk        │                                                                                                                    
                                                          │           s_city          │                                                                                                                    
                                                          │           EC=402          │                                                                                                                    
                                                          └───────────────────────────┘                                                                                                                                                 

