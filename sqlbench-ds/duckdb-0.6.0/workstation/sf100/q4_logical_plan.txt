┌─────────────┐                                                                                                                                                                                                                                 
│    TOP_N    │                                                                                                                                                                                                                                 
│   ─ ─ ─ ─   │                                                                                                                                                                                                                                 
│   Top 100   │                                                                                                                                                                                                                                 
│   ─ ─ ─ ─   │                                                                                                                                                                                                                                 
│ t_s_secyear │                                                                                                                                                                                                                                 
│ .customer_id│                                                                                                                                                                                                                                 
│      ASC    │                                                                                                                                                                                                                                 
│ t_s_secyear │                                                                                                                                                                                                                                 
│.custome...  │                                                                                                                                                                                                                                 
│  _name ASC  │                                                                                                                                                                                                                                 
│ t_s_secyear │                                                                                                                                                                                                                                 
│.custome...  │                                                                                                                                                                                                                                 
│   name ASC  │                                                                                                                                                                                                                                 
│ t_s_secyear │                                                                                                                                                                                                                                 
│.custome...  │                                                                                                                                                                                                                                 
│      ASC    │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│  PROJECTION │                                                                                                                                                                                                                                 
│   ─ ─ ─ ─   │                                                                                                                                                                                                                                 
│      #0     │                                                                                                                                                                                                                                 
│      #3     │                                                                                                                                                                                                                                 
│      #4     │                                                                                                                                                                                                                                 
│      #5     │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│    FILTER   │                                                                                                                                                                                                                                 
│   ─ ─ ─ ─   │                                                                                                                                                                                                                                 
│((CASE  WHEN │                                                                                                                                                                                                                                 
│((year_total │                                                                                                                                                                                                                                 
│> 0.0)) THEN │                                                                                                                                                                                                                                 
│((year_total │                                                                                                                                                                                                                                 
│/ year_total)│                                                                                                                                                                                                                                 
│ ) ELSE NULL │                                                                                                                                                                                                                                 
│  END > CASE │                                                                                                                                                                                                                                 
│ WHEN ((...  │                                                                                                                                                                                                                                 
│  al > 0.0)) │                                                                                                                                                                                                                                 
│ THEN ((...  │                                                                                                                                                                                                                                 
│al / year_tot│                                                                                                                                                                                                                                 
│  al)) ELSE  │                                                                                                                                                                                                                                 
│ NULL EN...  │                                                                                                                                                                                                                                 
│(CASE  WHEN (│                                                                                                                                                                                                                                 
│(year_to...  │                                                                                                                                                                                                                                 
│ .0)) THEN ( │                                                                                                                                                                                                                                 
│(year_total /│                                                                                                                                                                                                                                 
│ year_total))│                                                                                                                                                                                                                                 
│ ELSE NU...  │                                                                                                                                                                                                                                 
│> CASE  WHEN │                                                                                                                                                                                                                                 
│((year_total │                                                                                                                                                                                                                                 
│> 0.0)) THEN │                                                                                                                                                                                                                                 
│((year_total │                                                                                                                                                                                                                                 
│/ year_total)│                                                                                                                                                                                                                                 
│ ) ELSE NULL │                                                                                                                                                                                                                                 
│     END))   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│  HASH_JOIN  │                                                                                                                                                                                                                                 
│   ─ ─ ─ ─   │                                                                                                                                                                                                                                 
│    INNER    │                                                                                                                                                                                                                                 
│customer_id =│                                                                                                                                                                                                                                 
│  customer_id│                                                                                                                                                                                                                                 
│customer_id =│                                                                                                                                                                                                                                 
│  customer_id│                                                                                                                                                                                                                                 
│customer_id =│                                                                                                                                                                                                                                 
│  customer_id│                                                                                                                                                                                                                                 
│customer_id =│                                                                                                                                                                                                                                 
│  customer_id│                                                                                                                                                                                                                                 
│customer_id =├──────────────────────────────────────────────────────────────────────────────────┐                                                                                                                                              
│  customer_id│                                                                                  │                                                                                                                                              
│customer_id =│                                                                                  │                                                                                                                                              
│  customer_id│                                                                                  │                                                                                                                                              
│customer_id =│                                                                                  │                                                                                                                                              
│  customer_id│                                                                                  │                                                                                                                                              
│customer_id =│                                                                                  │                                                                                                                                              
│  customer_id│                                                                                  │                                                                                                                                              
│EC = 92149619│                                                                                  │                                                                                                                                              
│   8.192220  │                                                                                  │                                                                                                                                              
│COST = 119508│                                                                                  │                                                                                                                                              
│ 5570.449465 │                                                                                  │                                                                                                                                              
└──────┬──────┘                                                                                  │                                                                                                                                              
┌──────┴──────┐                                                                           ┌──────┴──────┐                                                                                                                                       
│  HASH_JOIN  │                                                                           │  HASH_JOIN  │                                                                                                                                       
│   ─ ─ ─ ─   │                                                                           │   ─ ─ ─ ─   │                                                                                                                                       
│    INNER    │                                                                           │    INNER    │                                                                                                                                       
│customer_id =│                                                                           │customer_id =│                                                                                                                                       
│  customer_id│                                                                           │  customer_id│                                                                                                                                       
│EC = 11519474│                                                                           │customer_id =│                                                                                                                                       
│   0.128622  ├─────────────────────────────────────┐                                     │  customer_id├─────────────────────────────────────┐                                                                                                 
│COST = 115194│                                     │                                     │customer_id =│                                     │                                                                                                 
│  740.128622 │                                     │                                     │  customer_id│                                     │                                                                                                 
│             │                                     │                                     │EC = 11519474│                                     │                                                                                                 
│             │                                     │                                     │   0.128622  │                                     │                                                                                                 
│             │                                     │                                     │COST = 158394│                                     │                                                                                                 
│             │                                     │                                     │  632.128622 │                                     │                                                                                                 
└──────┬──────┘                                     │                                     └──────┬──────┘                                     │                                                                                                 
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                                                                                          
│  PROJECTION │                              │  PROJECTION │                              │  PROJECTION │                              │  HASH_JOIN  │                                                                                          
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                                                                                          
│      #0     │                              │      #0     │                              │ customer_id │                              │    INNER    │                                                                                          
│      #8     │                              │      #8     │                              │customer_firs│                              │customer_id =│                                                                                          
│             │                              │             │                              │    t_name   │                              │  customer_id│                                                                                          
│             │                              │             │                              │customer_last│                              │customer_id =├─────────────────────────────────────┐                                                    
│             │                              │             │                              │    _name    │                              │  customer_id│                                     │                                                    
│             │                              │             │                              │customer_logi│                              │EC = 28799585│                                     │                                                    
│             │                              │             │                              │      n      │                              │   .000000   │                                     │                                                    
│             │                              │             │                              │  year_total │                              │COST = 431998│                                     │                                                    
│             │                              │             │                              │             │                              │  92.000000  │                                     │                                                    
└──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                                     │                                                    
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                                             
│    FILTER   │                              │    FILTER   │                              │HASH_GROUP_BY│                              │  PROJECTION │                              │  HASH_JOIN  │                                             
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                                             
│(year_total >│                              │(year_total >│                              │      #0     │                              │ customer_id │                              │    INNER    │                                             
│     0.0)    │                              │     0.0)    │                              │      #1     │                              │  year_total │                              │customer_id =│                                             
│             │                              │             │                              │      #2     │                              │             │                              │  customer_id│                                             
│             │                              │             │                              │      #3     │                              │             │                              │EC = 14400307├─────────────────────────────────────┐       
│             │                              │             │                              │      #4     │                              │             │                              │   .000000   │                                     │       
│             │                              │             │                              │      #5     │                              │             │                              │COST = 144003│                                     │       
│             │                              │             │                              │      #6     │                              │             │                              │  07.000000  │                                     │       
│             │                              │             │                              │      #7     │                              │             │                              │             │                                     │       
│             │                              │             │                              │   sum(#8)   │                              │             │                              │             │                                     │       
└──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                                     │       
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐
│HASH_GROUP_BY│                              │HASH_GROUP_BY│                              │  PROJECTION │                              │HASH_GROUP_BY│                              │  PROJECTION │                              │  PROJECTION │
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │
│      #0     │                              │      #0     │                              │c_customer_id│                              │      #0     │                              │      #0     │                              │ customer_id │
│      #1     │                              │      #1     │                              │ c_first_name│                              │      #1     │                              │      #8     │                              │  year_total │
│      #2     │                              │      #2     │                              │ c_last_name │                              │      #2     │                              │             │                              │             │
│      #3     │                              │      #3     │                              │c_preferred_c│                              │      #3     │                              │             │                              │             │
│      #4     │                              │      #4     │                              │   ust_flag  │                              │      #4     │                              │             │                              │             │
│      #5     │                              │      #5     │                              │c_birth_count│                              │      #5     │                              │             │                              │             │
│      #6     │                              │      #6     │                              │      ry     │                              │      #6     │                              │             │                              │             │
│      #7     │                              │      #7     │                              │   c_login   │                              │      #7     │                              │             │                              │             │
│   sum(#8)   │                              │   sum(#8)   │                              │c_email_addre│                              │   sum(#8)   │                              │             │                              │             │
│             │                              │             │                              │      ss     │                              │             │                              │             │                              │             │
│             │                              │             │                              │    d_year   │                              │             │                              │             │                              │             │
│             │                              │             │                              │(CAST((CAST((│                              │             │                              │             │                              │             │
│             │                              │             │                              │(ss_ext_list_│                              │             │                              │             │                              │             │
│             │                              │             │                              │price - ss_ex│                              │             │                              │             │                              │             │
│             │                              │             │                              │t_wholesale_c│                              │             │                              │             │                              │             │
│             │                              │             │                              │ost) - ss_ext│                              │             │                              │             │                              │             │
│             │                              │             │                              │_discount_amt│                              │             │                              │             │                              │             │
│             │                              │             │                              │ ) AS DECIMAL│                              │             │                              │             │                              │             │
│             │                              │             │                              │(10,2)) ...  │                              │             │                              │             │                              │             │
│             │                              │             │                              │(ss_ext_sales│                              │             │                              │             │                              │             │
│             │                              │             │                              │  _price AS  │                              │             │                              │             │                              │             │
│             │                              │             │                              │ DECIMAL...  │                              │             │                              │             │                              │             │
│             │                              │             │                              │ AS DOUBLE) /│                              │             │                              │             │                              │             │
│             │                              │             │                              │     2.0)    │                              │             │                              │             │                              │             │
└──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐
│  PROJECTION │                              │  PROJECTION │                              │  HASH_JOIN  │                              │  PROJECTION │                              │    FILTER   │                              │HASH_GROUP_BY│
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │
│c_customer_id│                              │c_customer_id│                              │    INNER    │                              │c_customer_id│                              │(year_total >│                              │      #0     │
│ c_first_name│                              │ c_first_name│                              │ss_customer_s│                              │ c_first_name│                              │     0.0)    │                              │      #1     │
│ c_last_name │                              │ c_last_name │                              │k = c_custome│                              │ c_last_name │                              │             │                              │      #2     │
│c_preferred_c│                              │c_preferred_c│                              │     r_sk    │                              │c_preferred_c│                              │             │                              │      #3     │
│   ust_flag  │                              │   ust_flag  │                              │EC = 57599428│                              │   ust_flag  │                              │             │                              │      #4     │
│c_birth_count│                              │c_birth_count│                              │   .800000   │                              │c_birth_count│                              │             │                              │      #5     │
│      ry     │                              │      ry     │                              │COST = 115198│                              │      ry     │                              │             │                              │      #6     │
│   c_login   │                              │   c_login   │                              │  857.600000 │                              │   c_login   │                              │             │                              │      #7     │
│c_email_addre│                              │c_email_addre│                              │             │                              │c_email_addre│                              │             │                              │   sum(#8)   │
│      ss     │                              │      ss     │                              │             │                              │      ss     │                              │             │                              │             │
│    d_year   │                              │    d_year   │                              │             │                              │    d_year   │                              │             │                              │             │
│(CAST((CAST((│                              │(CAST((CAST((│                              │             ├──────────────────────┐       │(CAST((CAST((│                              │             │                              │             │
│(ss_ext_list_│                              │(cs_ext_list_│                              │             │                      │       │(cs_ext_list_│                              │             │                              │             │
│price - ss_ex│                              │price - cs_ex│                              │             │                      │       │price - cs_ex│                              │             │                              │             │
│t_wholesale_c│                              │t_wholesale_c│                              │             │                      │       │t_wholesale_c│                              │             │                              │             │
│ost) - ss_ext│                              │ost) - cs_ext│                              │             │                      │       │ost) - cs_ext│                              │             │                              │             │
│_discount_amt│                              │_discount_amt│                              │             │                      │       │_discount_amt│                              │             │                              │             │
│ ) AS DECIMAL│                              │ ) AS DECIMAL│                              │             │                      │       │ ) AS DECIMAL│                              │             │                              │             │
│(10,2)) ...  │                              │(10,2)) ...  │                              │             │                      │       │(10,2)) ...  │                              │             │                              │             │
│(ss_ext_sales│                              │(cs_ext_sales│                              │             │                      │       │(cs_ext_sales│                              │             │                              │             │
│  _price AS  │                              │  _price AS  │                              │             │                      │       │  _price AS  │                              │             │                              │             │
│ DECIMAL...  │                              │ DECIMAL...  │                              │             │                      │       │ DECIMAL...  │                              │             │                              │             │
│ AS DOUBLE) /│                              │ AS DOUBLE) /│                              │             │                      │       │ AS DOUBLE) /│                              │             │                              │             │
│     2.0)    │                              │     2.0)    │                              │             │                      │       │     2.0)    │                              │             │                              │             │
└──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                      │       └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐
│  HASH_JOIN  │                              │  HASH_JOIN  │                              │  HASH_JOIN  │               │ PARQUET_SCAN││  HASH_JOIN  │                              │HASH_GROUP_BY│                              │  PROJECTION │
│   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │
│    INNER    │                              │    INNER    │                              │    INNER    │               │c_customer_sk││    INNER    │                              │      #0     │                              │c_customer_id│
│ss_customer_s│                              │cs_bill_custo│                              │ss_sold_date_│               │c_customer_id││cs_bill_custo│                              │      #1     │                              │ c_first_name│
│k = c_custome│                              │mer_sk = c_cu│                              │sk = d_date_s│               │ c_first_name││mer_sk = c_cu│                              │      #2     │                              │ c_last_name │
│     r_sk    │                              │  stomer_sk  │                              │      k      │               │ c_last_name ││  stomer_sk  │                              │      #3     │                              │c_preferred_c│
│EC = 57599428│                              │EC = 28799585│                              │EC = 57599428│               │c_preferred_c││EC = 28799585│                              │      #4     │                              │   ust_flag  │
│   .800000   │                              │   .600000   │                              │   .800000   │               │   ust_flag  ││   .600000   │                              │      #5     │                              │c_birth_count│
│COST = 115198│                              │COST = 575991│                              │COST = 575994│               │c_birth_count││COST = 575991│                              │      #6     │                              │      ry     │
│  857.600000 │                              │  71.200000  │                              │  28.800000  │               │      ry     ││  71.200000  │                              │      #7     │                              │   c_login   │
│             │                              │             │                              │             │               │   c_login   ││             │                              │   sum(#8)   │                              │c_email_addre│
│             │                              │             │                              │             │               │c_email_addre││             │                              │             │                              │      ss     │
│             │                              │             │                              │             │               │      ss     ││             │                              │             │                              │    d_year   │
│             ├──────────────────────┐       │             ├──────────────────────┐       │             ├───────┐       │  EC=1999968 ││             ├──────────────────────┐       │             │                              │(CAST((CAST((│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │(ws_ext_list_│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │price - ws_ex│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │t_wholesale_c│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │ost) - ws_ext│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │_discount_amt│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │ ) AS DECIMAL│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │(10,2)) ...  │
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │(ws_ext_sales│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │  _price AS  │
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │ DECIMAL...  │
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │ AS DOUBLE) /│
│             │                      │       │             │                      │       │             │       │       │             ││             │                      │       │             │                              │     2.0)    │
└──────┬──────┘                      │       └──────┬──────┘                      │       └──────┬──────┘       │       └─────────────┘└──────┬──────┘                      │       └──────┬──────┘                              └──────┬──────┘
┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐
│  HASH_JOIN  │               │ PARQUET_SCAN││  HASH_JOIN  │               │ PARQUET_SCAN││ PARQUET_SCAN││ PARQUET_SCAN│               │  HASH_JOIN  │               │ PARQUET_SCAN││  PROJECTION │                              │  HASH_JOIN  │
│   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │
│    INNER    │               │c_customer_sk││    INNER    │               │c_customer_sk││ss_sold_date_││  d_date_sk  │               │    INNER    │               │c_customer_sk││c_customer_id│                              │    INNER    │
│ss_sold_date_│               │c_customer_id││cs_sold_date_│               │c_customer_id││      sk     ││    d_year   │               │cs_sold_date_│               │c_customer_id││ c_first_name│                              │ws_bill_custo│
│sk = d_date_s│               │ c_first_name││sk = d_date_s│               │ c_first_name││ss_customer_s││   ─ ─ ─ ─   │               │sk = d_date_s│               │ c_first_name││ c_last_name │                              │mer_sk = c_cu│
│      k      │               │ c_last_name ││      k      │               │ c_last_name ││      k      ││Filters: d_ye│               │      k      │               │ c_last_name ││c_preferred_c│                              │  stomer_sk  │
│EC = 57599428│               │c_preferred_c││EC = 28799585│               │c_preferred_c││ss_ext_discou││ ar=2002 AND │               │EC = 28799585│               │c_preferred_c││   ust_flag  │                              │EC = 14400307│
│   .800000   │               │   ust_flag  ││   .600000   │               │   ust_flag  ││    nt_amt   ││ d_year ...  │               │   .600000   │               │   ust_flag  ││c_birth_count│                              │   .200000   │
│COST = 575994│               │c_birth_count││COST = 287995│               │c_birth_count││ss_ext_sales_││     NULL    │               │COST = 287995│               │c_birth_count││      ry     │                              │COST = 288006│
│  28.800000  │               │      ry     ││  85.600000  │               │      ry     ││    price    ││   EC=8118   │               │  85.600000  │               │      ry     ││   c_login   │                              │  14.400000  │
│             │               │   c_login   ││             │               │   c_login   ││ss_ext_wholes││             │               │             │               │   c_login   ││c_email_addre│                              │             │
│             │               │c_email_addre││             │               │c_email_addre││   ale_cost  ││             │               │             │               │c_email_addre││      ss     │                              │             │
│             │               │      ss     ││             │               │      ss     ││ss_ext_list_p││             │               │             │               │      ss     ││    d_year   │                              │             │
│             ├───────┐       │  EC=1999968 ││             ├───────┐       │  EC=1999968 ││     rice    ││             │               │             ├───────┐       │  EC=1999968 ││(CAST((CAST((│                              │             ├
│             │       │       │             ││             │       │       │             ││ EC=287997144││             │               │             │       │       │             ││(ws_ext_list_│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││price - ws_ex│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││t_wholesale_c│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││ost) - ws_ext│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││_discount_amt│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││ ) AS DECIMAL│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││(10,2)) ...  │                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││(ws_ext_sales│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││  _price AS  │                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││ DECIMAL...  │                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││ AS DOUBLE) /│                              │             │
│             │       │       │             ││             │       │       │             ││             ││             │               │             │       │       │             ││     2.0)    │                              │             │
└──────┬──────┘       │       └─────────────┘└──────┬──────┘       │       └─────────────┘└─────────────┘└─────────────┘               └──────┬──────┘       │       └─────────────┘└──────┬──────┘                              └──────┬──────┘
┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐                              ┌──────┴──────┐
│ PARQUET_SCAN││ PARQUET_SCAN│               │ PARQUET_SCAN││ PARQUET_SCAN│                                                            │ PARQUET_SCAN││ PARQUET_SCAN│               │  HASH_JOIN  │                              │  HASH_JOIN  │
│   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                                                            │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │               │   ─ ─ ─ ─   │                              │   ─ ─ ─ ─   │
│ss_sold_date_││  d_date_sk  │               │cs_sold_date_││  d_date_sk  │                                                            │cs_sold_date_││  d_date_sk  │               │    INNER    │                              │    INNER    │
│      sk     ││    d_year   │               │      sk     ││    d_year   │                                                            │      sk     ││    d_year   │               │ws_bill_custo│                              │ws_sold_date_│
│ss_customer_s││   ─ ─ ─ ─   │               │cs_bill_custo││   ─ ─ ─ ─   │                                                            │cs_bill_custo││   ─ ─ ─ ─   │               │mer_sk = c_cu│                              │sk = d_date_s│
│      k      ││Filters: d_ye│               │    mer_sk   ││Filters: d_ye│                                                            │    mer_sk   ││Filters: d_ye│               │  stomer_sk  │                              │      k      │
│ss_ext_discou││ ar=2001 AND │               │cs_ext_discou││ ar=2001 AND │                                                            │cs_ext_discou││ ar=2002 AND │               │EC = 14400307│                              │EC = 14400307│
│    nt_amt   ││ d_year ...  │               │    nt_amt   ││ d_year ...  │                                                            │    nt_amt   ││ d_year ...  │               │   .200000   ├──────────────────────┐       │   .200000   ├
│ss_ext_sales_││     NULL    │               │cs_ext_sales_││     NULL    │                                                            │cs_ext_sales_││     NULL    │               │COST = 288006│                      │       │COST = 144003│
│    price    ││   EC=8118   │               │    price    ││   EC=8118   │                                                            │    price    ││   EC=8118   │               │  14.400000  │                      │       │  07.200000  │
│ss_ext_wholes││             │               │cs_ext_wholes││             │                                                            │cs_ext_wholes││             │               │             │                      │       │             │
│   ale_cost  ││             │               │   ale_cost  ││             │                                                            │   ale_cost  ││             │               │             │                      │       │             │
│ss_ext_list_p││             │               │cs_ext_list_p││             │                                                            │cs_ext_list_p││             │               │             │                      │       │             │
│     rice    ││             │               │     rice    ││             │                                                            │     rice    ││             │               │             │                      │       │             │
│ EC=287997144││             │               │ EC=143997928││             │                                                            │ EC=143997928││             │               │             │                      │       │             │
└─────────────┘└─────────────┘               └─────────────┘└─────────────┘                                                            └─────────────┘└─────────────┘               └──────┬──────┘                      │       └──────┬──────┘
                                                                                                                                                                                    ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐
                                                                                                                                                                                    │  HASH_JOIN  │               │ PARQUET_SCAN││ PARQUET_SCAN│
                                                                                                                                                                                    │   ─ ─ ─ ─   │               │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │
                                                                                                                                                                                    │    INNER    │               │c_customer_sk││ws_sold_date_│
                                                                                                                                                                                    │ws_sold_date_│               │c_customer_id││      sk     │
                                                                                                                                                                                    │sk = d_date_s│               │ c_first_name││ws_bill_custo│
                                                                                                                                                                                    │      k      │               │ c_last_name ││    mer_sk   │
                                                                                                                                                                                    │EC = 14400307│               │c_preferred_c││ws_ext_discou│
                                                                                                                                                                                    │   .200000   ├───────┐       │   ust_flag  ││    nt_amt   │
                                                                                                                                                                                    │COST = 144003│       │       │c_birth_count││ws_ext_sales_│
                                                                                                                                                                                    │  07.200000  │       │       │      ry     ││    price    │
                                                                                                                                                                                    │             │       │       │   c_login   ││ws_ext_wholes│
                                                                                                                                                                                    │             │       │       │c_email_addre││   ale_cost  │
                                                                                                                                                                                    │             │       │       │      ss     ││ws_ext_list_p│
                                                                                                                                                                                    │             │       │       │  EC=1999968 ││     rice    │
                                                                                                                                                                                    │             │       │       │             ││ EC=72001536 │
                                                                                                                                                                                    └──────┬──────┘       │       └─────────────┘└─────────────┘
                                                                                                                                                                                    ┌──────┴──────┐┌──────┴──────┐                              
                                                                                                                                                                                    │ PARQUET_SCAN││ PARQUET_SCAN│                              
                                                                                                                                                                                    │   ─ ─ ─ ─   ││   ─ ─ ─ ─   │                              
                                                                                                                                                                                    │ws_sold_date_││  d_date_sk  │                              
                                                                                                                                                                                    │      sk     ││    d_year   │                              
                                                                                                                                                                                    │ws_bill_custo││   ─ ─ ─ ─   │                              
                                                                                                                                                                                    │    mer_sk   ││Filters: d_ye│                              
                                                                                                                                                                                    │ws_ext_discou││ ar=2001 AND │                              
                                                                                                                                                                                    │    nt_amt   ││ d_year ...  │                              
                                                                                                                                                                                    │ws_ext_sales_││     NULL    │                              
                                                                                                                                                                                    │    price    ││   EC=8118   │                              
                                                                                                                                                                                    │ws_ext_wholes││             │                              
                                                                                                                                                                                    │   ale_cost  ││             │                              
                                                                                                                                                                                    │ws_ext_list_p││             │                              
                                                                                                                                                                                    │     rice    ││             │                              
                                                                                                                                                                                    │ EC=72001536 ││             │                              
                                                                                                                                                                                    └─────────────┘└─────────────┘                              

