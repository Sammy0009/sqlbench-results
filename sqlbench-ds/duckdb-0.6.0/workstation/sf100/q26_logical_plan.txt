┌───────────────────────────┐                                                                                                                    
│           TOP_N           │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│          Top 100          │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│     item.i_item_id ASC    │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│       HASH_GROUP_BY       │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│             #0            │                                                                                                                    
│          avg(#1)          │                                                                                                                    
│          avg(#2)          │                                                                                                                    
│          avg(#3)          │                                                                                                                    
│          avg(#4)          │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         PROJECTION        │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│         i_item_id         │                                                                                                                    
│        cs_quantity        │                                                                                                                    
│       cs_list_price       │                                                                                                                    
│       cs_coupon_amt       │                                                                                                                    
│       cs_sales_price      │                                                                                                                    
└─────────────┬─────────────┘                                                                                                                                                 
┌─────────────┴─────────────┐                                                                                                                    
│         HASH_JOIN         │                                                                                                                    
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    
│           INNER           │                                                                                                                    
│  cs_promo_sk = p_promo_sk ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐              
│    EC = 5759914.121318    │                                                                                                     │              
│   COST = 46079312.970541  │                                                                                                     │              
└─────────────┬─────────────┘                                                                                                     │                                           
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                                                       │         PROJECTION        │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                                                       │             #0            │
│   cs_item_sk = i_item_sk  ├────────────────────────────────────────────────────────────────────────┐              │                           │
│    EC = 5759914.121318    │                                                                        │              │                           │
│   COST = 40319398.849223  │                                                                        │              │                           │
└─────────────┬─────────────┘                                                                        │              └─────────────┬─────────────┘                             
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │        PARQUET_SCAN       ││           FILTER          │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                                                          │         i_item_sk         ││((p_channel_email = 'N') OR│
│cs_sold_date_sk = d_date_sk├───────────────────────────────────────────┐              │         i_item_id         ││  (p_channel_event = 'N')) │
│    EC = 5759914.121318    │                                           │              │         EC=202300         ││                           │
│   COST = 34559484.727906  │                                           │              │                           ││                           │
└─────────────┬─────────────┘                                           │              └───────────────────────────┘└─────────────┬─────────────┘                             
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         HASH_JOIN         │                             │        PARQUET_SCAN       │                             │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│           INNER           │                             │         d_date_sk         │                             │         p_promo_sk        │
│     cs_bill_cdemo_sk =    ├──────────────┐              │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │      p_channel_email      │
│         cd_demo_sk        │              │              │  Filters: d_year=2000 AND │                             │      p_channel_event      │
│    EC = 28799570.606588   │              │              │     d_year IS NOT NULL    │                             │          EC=1000          │
│   COST = 28799570.606588  │              │              │          EC=8118          │                             │                           │
└─────────────┬─────────────┘              │              └───────────────────────────┘                             └───────────────────────────┘                             
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│      cs_sold_date_sk      ││         cd_demo_sk        │                                                                                       
│      cs_bill_cdemo_sk     ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         cs_item_sk        ││  Filters: cd_gender=F AND │                                                                                       
│        cs_promo_sk        ││    cd_gender IS NOT NULL  │                                                                                       
│        cs_quantity        ││  cd_education_status=4 yr │                                                                                       
│       cs_list_price       ││         Degree AND        │                                                                                       
│       cs_sales_price      ││ cd_education_status I...  │                                                                                       
│       cs_coupon_amt       ││  cd_marital_status=M AND  │                                                                                       
│        EC=143997928       ││ cd_marital_status IS ...  │                                                                                       
│                           ││         EC=384163         │                                                                                       
└───────────────────────────┘└───────────────────────────┘                                                                                                                    

