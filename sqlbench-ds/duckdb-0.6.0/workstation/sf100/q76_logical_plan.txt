┌───────────────────────┐                                                                                                                                                                                                        
│         TOP_N         │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│        Top 100        │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│    foo.channel ASC    │                                                                                                                                                                                                        
│    foo.col_name ASC   │                                                                                                                                                                                                        
│     foo.d_year ASC    │                                                                                                                                                                                                        
│     foo.d_qoy ASC     │                                                                                                                                                                                                        
│   foo.i_category ASC  │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│     HASH_GROUP_BY     │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│           #0          │                                                                                                                                                                                                        
│           #1          │                                                                                                                                                                                                        
│           #2          │                                                                                                                                                                                                        
│           #3          │                                                                                                                                                                                                        
│           #4          │                                                                                                                                                                                                        
│      count_star()     │                                                                                                                                                                                                        
│        sum(#5)        │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│       PROJECTION      │                                                                                                                                                                                                        
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                        
│        channel        │                                                                                                                                                                                                        
│        col_name       │                                                                                                                                                                                                        
│         d_year        │                                                                                                                                                                                                        
│         d_qoy         │                                                                                                                                                                                                        
│       i_category      │                                                                                                                                                                                                        
│    ext_sales_price    │                                                                                                                                                                                                        
└───────────┬───────────┘                                                                                                                                                                                                                                 
┌───────────┴───────────┐                                                                                                                                                                                                        
│         UNION         ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                              
└───────────┬───────────┘                                                                                                                                         │                                                                                       
┌───────────┴───────────┐                                                                                                                             ┌───────────┴───────────┐                                                  
│         UNION         │                                                                                                                             │       PROJECTION      │                                                  
│                       │                                                                                                                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
│                       │                                                                                                                             │        channel        │                                                  
│                       │                                                                                                                             │        col_name       │                                                  
│                       ├──────────────────────────────────────────────────────────────┐                                                              │         d_year        │                                                  
│                       │                                                              │                                                              │         d_qoy         │                                                  
│                       │                                                              │                                                              │       i_category      │                                                  
│                       │                                                              │                                                              │    ext_sales_price    │                                                  
└───────────┬───────────┘                                                              │                                                              └───────────┬───────────┘                                                                           
┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                  
│       PROJECTION      │                                                  │       PROJECTION      │                                                  │       HASH_JOIN       │                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
│        channel        │                                                  │        channel        │                                                  │         INNER         │                                                  
│        col_name       │                                                  │        col_name       │                                                  │   cs_sold_date_sk =   │                                                  
│         d_year        │                                                  │         d_year        │                                                  │        d_date_sk      ├─────────────────────────────────────┐            
│         d_qoy         │                                                  │         d_qoy         │                                                  │ EC = 143997928.000000 │                                     │            
│       i_category      │                                                  │       i_category      │                                                  │COST = 287995856.000000│                                     │            
│    ext_sales_price    │                                                  │    ext_sales_price    │                                                  │                       │                                     │            
└───────────┬───────────┘                                                  └───────────┬───────────┘                                                  └───────────┬───────────┘                                     │                                     
┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                         ┌───────────┴───────────┐
│       HASH_JOIN       │                                                  │       HASH_JOIN       │                                                  │       HASH_JOIN       │                         │      PARQUET_SCAN     │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│         INNER         │                                                  │         INNER         │                                                  │         INNER         │                         │       d_date_sk       │
│   ss_sold_date_sk =   ├─────────────────────────────────────┐            │   ws_sold_date_sk =   ├─────────────────────────────────────┐            │ cs_item_sk = i_item_sk├────────────┐            │         d_year        │
│        d_date_sk      │                                     │            │        d_date_sk      │                                     │            │ EC = 143997928.000000 │            │            │         d_qoy         │
│ EC = 287997144.000000 │                                     │            │  EC = 72001536.000000 │                                     │            │COST = 143997928.000000│            │            │        EC=40590       │
│COST = 575994288.000000│                                     │            │COST = 144003072.000000│                                     │            │                       │            │            │                       │
└───────────┬───────────┘                                     │            └───────────┬───────────┘                                     │            └───────────┬───────────┘            │            └───────────────────────┘                         
┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐┌───────────┴───────────┐                         
│       HASH_JOIN       │                         │      PARQUET_SCAN     ││       HASH_JOIN       │                         │      PARQUET_SCAN     ││       PROJECTION      ││      PARQUET_SCAN     │                         
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         
│         INNER         │                         │       d_date_sk       ││         INNER         │                         │       d_date_sk       ││           #0          ││       i_item_sk       │                         
│ ss_item_sk = i_item_sk├────────────┐            │         d_year        ││ ws_item_sk = i_item_sk├────────────┐            │         d_year        ││           #2          ││       i_category      │                         
│ EC = 287997144.000000 │            │            │         d_qoy         ││  EC = 72001536.000000 │            │            │         d_qoy         ││           #3          ││       EC=202300       │                         
│COST = 287997144.000000│            │            │        EC=40590       ││ COST = 72001536.000000│            │            │        EC=40590       ││                       ││                       │                         
└───────────┬───────────┘            │            └───────────────────────┘└───────────┬───────────┘            │            └───────────────────────┘└───────────┬───────────┘└───────────────────────┘                                                  
┌───────────┴───────────┐┌───────────┴───────────┐                         ┌───────────┴───────────┐┌───────────┴───────────┐                         ┌───────────┴───────────┐                                                  
│       PROJECTION      ││      PARQUET_SCAN     │                         │       PROJECTION      ││      PARQUET_SCAN     │                         │         FILTER        │                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                         │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
│           #0          ││       i_item_sk       │                         │           #0          ││       i_item_sk       │                         │  (cs_bill_addr_sk IS  │                                                  
│           #1          ││       i_category      │                         │           #1          ││       i_category      │                         │          NULL)        │                                                  
│           #3          ││       EC=202300       │                         │           #3          ││       EC=202300       │                         │                       │                                                  
└───────────┬───────────┘└───────────────────────┘                         └───────────┬───────────┘└───────────────────────┘                         └───────────┬───────────┘                                                                           
┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                  
│         FILTER        │                                                  │         FILTER        │                                                  │      PARQUET_SCAN     │                                                  
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  
│(ss_customer_sk IS NULL│                                                  │  (ws_ship_addr_sk IS  │                                                  │    cs_sold_date_sk    │                                                  
│           )           │                                                  │          NULL)        │                                                  │    cs_bill_addr_sk    │                                                  
│                       │                                                  │                       │                                                  │       cs_item_sk      │                                                  
│                       │                                                  │                       │                                                  │   cs_ext_sales_price  │                                                  
│                       │                                                  │                       │                                                  │      EC=143997928     │                                                  
└───────────┬───────────┘                                                  └───────────┬───────────┘                                                  └───────────────────────┘                                                                           
┌───────────┴───────────┐                                                  ┌───────────┴───────────┐                                                                                                                             
│      PARQUET_SCAN     │                                                  │      PARQUET_SCAN     │                                                                                                                             
│   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                  │   ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                             
│    ss_sold_date_sk    │                                                  │    ws_sold_date_sk    │                                                                                                                             
│       ss_item_sk      │                                                  │       ws_item_sk      │                                                                                                                             
│     ss_customer_sk    │                                                  │    ws_ship_addr_sk    │                                                                                                                             
│   ss_ext_sales_price  │                                                  │   ws_ext_sales_price  │                                                                                                                             
│      EC=287997144     │                                                  │      EC=72001536      │                                                                                                                             
└───────────────────────┘                                                  └───────────────────────┘                                                                                                                                                      

