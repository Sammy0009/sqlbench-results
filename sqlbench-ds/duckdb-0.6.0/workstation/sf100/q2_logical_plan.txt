┌───────────────────────────┐                                                                                                                                                                                                           
│          ORDER_BY         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          ORDERS:          │                                                                                                                                                                                                           
│     y.d_week_seq1 ASC     │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│        d_week_seq1        │                                                                                                                                                                                                           
│ round((CAST(sun_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(sun_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
│ round((CAST(mon_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(mon_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
│ round((CAST(tue_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(tue_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
│ round((CAST(wed_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(wed_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
│ round((CAST(thu_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(thu_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
│ round((CAST(fri_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(fri_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
│ round((CAST(sat_sales1 AS │                                                                                                                                                                                                           
│ DOUBLE) / CAST(sat_sa...  │                                                                                                                                                                                                           
│        DOUBLE)), 2)       │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           INNER           │                                                                                                                                                                                                           
│d_week_seq1 = (d_week_seq2 ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                                     
│           - 53)           │                                                                                                     │                                                                                                     
│    EC = 28799585.000000   │                                                                                                     │                                                                                                     
│   COST = 28799585.000000  │                                                                                                     │                                                                                                     
└─────────────┬─────────────┘                                                                                                     │                                                                                                                                  
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       │         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│        d_week_seq1        │                                                                                       │        d_week_seq2        │                                                                                       
│         sun_sales1        │                                                                                       │         sun_sales2        │                                                                                       
│         mon_sales1        │                                                                                       │         mon_sales2        │                                                                                       
│         tue_sales1        │                                                                                       │         tue_sales2        │                                                                                       
│         wed_sales1        │                                                                                       │         wed_sales2        │                                                                                       
│         thu_sales1        │                                                                                       │         thu_sales2        │                                                                                       
│         fri_sales1        │                                                                                       │         fri_sales2        │                                                                                       
│         sat_sales1        │                                                                                       │         sat_sales2        │                                                                                       
└─────────────┬─────────────┘                                                                                       └─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       │           INNER           │                                                                                       
│  d_week_seq = d_week_seq  ├────────────────────────────────────────────────────────────────────────┐              │  d_week_seq = d_week_seq  ├────────────────────────────────────────────────────────────────────────┐              
│    EC = 28799585.600000   │                                                                        │              │    EC = 28799585.600000   │                                                                        │              
│   COST = 28799585.600000  │                                                                        │              │   COST = 28799585.600000  │                                                                        │              
└─────────────┬─────────────┘                                                                        │              └─────────────┬─────────────┘                                                                        │                                           
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                                                          │        PARQUET_SCAN       ││       HASH_GROUP_BY       │                                                          │        PARQUET_SCAN       │
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│             #0            │                                                          │         d_week_seq        ││             #0            │                                                          │         d_week_seq        │
│          sum(#1)          │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          sum(#1)          │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
│          sum(#2)          │                                                          │  Filters: d_year=1999 AND ││          sum(#2)          │                                                          │  Filters: d_year=2000 AND │
│          sum(#3)          │                                                          │     d_year IS NOT NULL    ││          sum(#3)          │                                                          │     d_year IS NOT NULL    │
│          sum(#4)          │                                                          │          EC=8118          ││          sum(#4)          │                                                          │          EC=8118          │
│          sum(#5)          │                                                          │                           ││          sum(#5)          │                                                          │                           │
│          sum(#6)          │                                                          │                           ││          sum(#6)          │                                                          │                           │
│          sum(#7)          │                                                          │                           ││          sum(#7)          │                                                          │                           │
└─────────────┬─────────────┘                                                          └───────────────────────────┘└─────────────┬─────────────┘                                                          └───────────────────────────┘                             
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│         PROJECTION        │                                                                                       │         PROJECTION        │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│         d_week_seq        │                                                                                       │         d_week_seq        │                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│'Sunday')) THEN (sales...  │                                                                                       │'Sunday')) THEN (sales...  │                                                                                       
│      ) ELSE NULL END      │                                                                                       │      ) ELSE NULL END      │                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│'Monday')) THEN (sales...  │                                                                                       │'Monday')) THEN (sales...  │                                                                                       
│      ) ELSE NULL END      │                                                                                       │      ) ELSE NULL END      │                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│     'Tuesday')) THEN      │                                                                                       │     'Tuesday')) THEN      │                                                                                       
│(sales_price) ELSE NULL END│                                                                                       │(sales_price) ELSE NULL END│                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│    'Wednesday')) THEN     │                                                                                       │    'Wednesday')) THEN     │                                                                                       
│(sales_price) ELSE NULL END│                                                                                       │(sales_price) ELSE NULL END│                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│     'Thursday')) THEN     │                                                                                       │     'Thursday')) THEN     │                                                                                       
│(sales_price) ELSE NULL END│                                                                                       │(sales_price) ELSE NULL END│                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│'Friday')) THEN (sales...  │                                                                                       │'Friday')) THEN (sales...  │                                                                                       
│      ) ELSE NULL END      │                                                                                       │      ) ELSE NULL END      │                                                                                       
│ CASE  WHEN ((d_day_name = │                                                                                       │ CASE  WHEN ((d_day_name = │                                                                                       
│     'Saturday')) THEN     │                                                                                       │     'Saturday')) THEN     │                                                                                       
│(sales_price) ELSE NULL END│                                                                                       │(sales_price) ELSE NULL END│                                                                                       
└─────────────┬─────────────┘                                                                                       └─────────────┬─────────────┘                                                                                                                    
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                                                       
│         HASH_JOIN         │                                                                                       │         HASH_JOIN         │                                                                                       
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       
│           INNER           │                                                                                       │           INNER           │                                                                                       
│  sold_date_sk = d_date_sk ├───────────────────────────────────────────┐                                           │  sold_date_sk = d_date_sk ├───────────────────────────────────────────┐                                           
│   EC = 143997928.000000   │                                           │                                           │   EC = 143997928.000000   │                                           │                                           
│  COST = 143997928.000000  │                                           │                                           │  COST = 143997928.000000  │                                           │                                           
└─────────────┬─────────────┘                                           │                                           └─────────────┬─────────────┘                                           │                                                                        
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                             
│           UNION           │                             │        PARQUET_SCAN       │                             │           UNION           │                             │        PARQUET_SCAN       │                             
│                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
│                           │                             │         d_date_sk         │                             │                           │                             │         d_date_sk         │                             
│                           ├──────────────┐              │         d_week_seq        │                             │                           ├──────────────┐              │         d_week_seq        │                             
│                           │              │              │         d_day_name        │                             │                           │              │              │         d_day_name        │                             
│                           │              │              │          EC=40590         │                             │                           │              │              │          EC=40590         │                             
└─────────────┬─────────────┘              │              └───────────────────────────┘                             └─────────────┬─────────────┘              │              └───────────────────────────┘                                                          
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          │        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│      ws_sold_date_sk      ││      cs_sold_date_sk      │                                                          │      ws_sold_date_sk      ││      cs_sold_date_sk      │                                                          
│     ws_ext_sales_price    ││     cs_ext_sales_price    │                                                          │     ws_ext_sales_price    ││     cs_ext_sales_price    │                                                          
│        EC=72001536        ││        EC=143997928       │                                                          │        EC=72001536        ││        EC=143997928       │                                                          
└───────────────────────────┘└───────────────────────────┘                                                          └───────────────────────────┘└───────────────────────────┘                                                                                       

