┌───────────────────────────┐                                                                                                                                                                                                           
│           TOP_N           │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│          Top 100          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│ customer.c_customer_id ASC│                                                                                                                                                                                                           
│ customer.c_salutation ASC │                                                                                                                                                                                                           
│ customer.c_first_name ASC │                                                                                                                                                                                                           
│  customer.c_last_name ASC │                                                                                                                                                                                                           
│      customer_address     │                                                                                                                                                                                                           
│   .ca_street_number ASC   │                                                                                                                                                                                                           
│      customer_address     │                                                                                                                                                                                                           
│    .ca_street_name ASC    │                                                                                                                                                                                                           
│      customer_address     │                                                                                                                                                                                                           
│    .ca_street_type ASC    │                                                                                                                                                                                                           
│      customer_address     │                                                                                                                                                                                                           
│    .ca_suite_number ASC   │                                                                                                                                                                                                           
│  customer_address.ca_city │                                                                                                                                                                                                           
│             ASC           │                                                                                                                                                                                                           
│ customer_address.ca_county│                                                                                                                                                                                                           
│             ASC           │                                                                                                                                                                                                           
│ customer_address.ca_state │                                                                                                                                                                                                           
│             ASC           │                                                                                                                                                                                                           
│customer_address.ca_zip ASC│                                                                                                                                                                                                           
│customer_address.ca_country│                                                                                                                                                                                                           
│             ASC           │                                                                                                                                                                                                           
│      customer_address     │                                                                                                                                                                                                           
│     .ca_gmt_offset ASC    │                                                                                                                                                                                                           
│      customer_address     │                                                                                                                                                                                                           
│   .ca_location_type ASC   │                                                                                                                                                                                                           
│ ctr1.ctr_total_return ASC │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│       c_customer_id       │                                                                                                                                                                                                           
│        c_salutation       │                                                                                                                                                                                                           
│        c_first_name       │                                                                                                                                                                                                           
│        c_last_name        │                                                                                                                                                                                                           
│      ca_street_number     │                                                                                                                                                                                                           
│       ca_street_name      │                                                                                                                                                                                                           
│       ca_street_type      │                                                                                                                                                                                                           
│      ca_suite_number      │                                                                                                                                                                                                           
│          ca_city          │                                                                                                                                                                                                           
│         ca_county         │                                                                                                                                                                                                           
│          ca_state         │                                                                                                                                                                                                           
│           ca_zip          │                                                                                                                                                                                                           
│         ca_country        │                                                                                                                                                                                                           
│       ca_gmt_offset       │                                                                                                                                                                                                           
│      ca_location_type     │                                                                                                                                                                                                           
│      ctr_total_return     │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         PROJECTION        │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│             #2            │                                                                                                                                                                                                           
│             #3            │                                                                                                                                                                                                           
│             #4            │                                                                                                                                                                                                           
│             #5            │                                                                                                                                                                                                           
│             #6            │                                                                                                                                                                                                           
│             #7            │                                                                                                                                                                                                           
│             #8            │                                                                                                                                                                                                           
│             #9            │                                                                                                                                                                                                           
│            #10            │                                                                                                                                                                                                           
│            #11            │                                                                                                                                                                                                           
│            #12            │                                                                                                                                                                                                           
│            #13            │                                                                                                                                                                                                           
│            #14            │                                                                                                                                                                                                           
│            #15            │                                                                                                                                                                                                           
│            #16            │                                                                                                                                                                                                           
│            #17            │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│           FILTER          │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│ (CAST(ctr_total_return AS │                                                                                                                                                                                                           
│     DOUBLE) > SUBQUERY)   │                                                                                                                                                                                                           
└─────────────┬─────────────┘                                                                                                                                                                                                                                        
┌─────────────┴─────────────┐                                                                                                                                                                                                           
│         HASH_JOIN         │                                                                                                                                                                                                           
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                                           
│           SINGLE          │                                                                                                                                                                                                           
│ ctr_state IS NOT DISTINCT ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                        
│       FROM ctr_state      │                                                                                                                                  │                                                                        
│       EC = 0.000000       │                                                                                                                                  │                                                                        
│      COST = 0.000000      │                                                                                                                                  │                                                                        
└─────────────┬─────────────┘                                                                                                                                  │                                                                                                     
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                                                                                    │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                                                    │ (avg(ctr_total_return) * 1│                                                          
│     ctr_customer_sk =     ├────────────────────────────────────────────────────────────────────────┐                                           │            .2)            │                                                          
│        c_customer_sk      │                                                                        │                                           │             #0            │                                                          
│     EC = 575065.649903    │                                                                        │                                           │                           │                                                          
│    COST = 975058.449942   │                                                                        │                                           │                           │                                                          
└─────────────┬─────────────┘                                                                        │                                           └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          
│       HASH_GROUP_BY       │                                                          │         HASH_JOIN         │                             │       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│             #0            │                                                          │           INNER           │                             │             #0            │                                                          
│             #1            │                                                          │    c_current_addr_sk =    ├──────────────┐              │          avg(#1)          │                                                          
│          sum(#2)          │                                                          │        ca_address_sk      │              │              │                           │                                                          
│                           │                                                          │     EC = 399992.800038    │              │              │                           │                                                          
│                           │                                                          │    COST = 399992.800038   │              │              │                           │                                                          
└─────────────┬─────────────┘                                                          └─────────────┬─────────────┘              │              └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                          
│         PROJECTION        │                                                          │        PARQUET_SCAN       ││        PARQUET_SCAN       ││         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│  cr_returning_customer_sk │                                                          │       c_customer_sk       ││       ca_address_sk       ││         ctr_state         │                                                          
│          ca_state         │                                                          │       c_customer_id       ││      ca_street_number     ││      ctr_total_return     │                                                          
│   cr_return_amt_inc_tax   │                                                          │     c_current_addr_sk     ││       ca_street_name      ││                           │                                                          
│                           │                                                          │        c_salutation       ││       ca_street_type      ││                           │                                                          
│                           │                                                          │        c_first_name       ││      ca_suite_number      ││                           │                                                          
│                           │                                                          │        c_last_name        ││          ca_city          ││                           │                                                          
│                           │                                                          │         EC=1999968        ││         ca_county         ││                           │                                                          
│                           │                                                          │                           ││          ca_state         ││                           │                                                          
│                           │                                                          │                           ││           ca_zip          ││                           │                                                          
│                           │                                                          │                           ││         ca_country        ││                           │                                                          
│                           │                                                          │                           ││       ca_gmt_offset       ││                           │                                                          
│                           │                                                          │                           ││      ca_location_type     ││                           │                                                          
│                           │                                                          │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                          
│                           │                                                          │                           ││  Filters: ca_state=IA AND ││                           │                                                          
│                           │                                                          │                           ││    ca_state IS NOT NULL   ││                           │                                                          
│                           │                                                          │                           ││         EC=200006         ││                           │                                                          
└─────────────┬─────────────┘                                                          └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                                                                                                                    │           FILTER          │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                                                                                                                    │  (ctr_state IS NOT NULL)  │                                                          
│   cr_returning_addr_sk =  ├───────────────────────────────────────────┐                                                                        │                           │                                                          
│        ca_address_sk      │                                           │                                                                        │                           │                                                          
│    EC = 2875334.400000    │                                           │                                                                        │                           │                                                          
│   COST = 5750668.800000   │                                           │                                                                        │                           │                                                          
└─────────────┬─────────────┘                                           │                                                                        └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          
│         HASH_JOIN         │                             │        PARQUET_SCAN       │                                                          │         PROJECTION        │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│           INNER           │                             │       ca_address_sk       │                                                          │         ctr_state         │                                                          
│   cr_returned_date_sk =   ├──────────────┐              │          ca_state         │                                                          │      ctr_total_return     │                                                          
│          d_date_sk        │              │              │         EC=1000032        │                                                          │                           │                                                          
│    EC = 2875334.400000    │              │              │                           │                                                          │                           │                                                          
│   COST = 2875334.400000   │              │              │                           │                                                          │                           │                                                          
└─────────────┬─────────────┘              │              └───────────────────────────┘                                                          └─────────────┬─────────────┘                                                                                       
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐                                                          
│        PARQUET_SCAN       ││        PARQUET_SCAN       │                                                                                       │       HASH_GROUP_BY       │                                                          
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
│    cr_returned_date_sk    ││         d_date_sk         │                                                                                       │             #0            │                                                          
│  cr_returning_customer_sk ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │             #1            │                                                          
│    cr_returning_addr_sk   ││  Filters: d_year=2001 AND │                                                                                       │          sum(#2)          │                                                          
│   cr_return_amt_inc_tax   ││     d_year IS NOT NULL    │                                                                                       │                           │                                                          
│        EC=14376672        ││          EC=8118          │                                                                                       │                           │                                                          
└───────────────────────────┘└───────────────────────────┘                                                                                       └─────────────┬─────────────┘                                                                                       
                                                                                                                                                 ┌─────────────┴─────────────┐                                                          
                                                                                                                                                 │         PROJECTION        │                                                          
                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                                                                                 │  cr_returning_customer_sk │                                                          
                                                                                                                                                 │          ca_state         │                                                          
                                                                                                                                                 │   cr_return_amt_inc_tax   │                                                          
                                                                                                                                                 └─────────────┬─────────────┘                                                                                       
                                                                                                                                                 ┌─────────────┴─────────────┐                                                          
                                                                                                                                                 │         HASH_JOIN         │                                                          
                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                          
                                                                                                                                                 │           INNER           │                                                          
                                                                                                                                                 │   cr_returning_addr_sk =  ├───────────────────────────────────────────┐              
                                                                                                                                                 │        ca_address_sk      │                                           │              
                                                                                                                                                 │    EC = 2875334.400000    │                                           │              
                                                                                                                                                 │   COST = 5750668.800000   │                                           │              
                                                                                                                                                 └─────────────┬─────────────┘                                           │                                           
                                                                                                                                                 ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                                                                                                                                                 │         HASH_JOIN         │                             │        PARQUET_SCAN       │
                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │
                                                                                                                                                 │           INNER           │                             │       ca_address_sk       │
                                                                                                                                                 │   cr_returned_date_sk =   ├──────────────┐              │          ca_state         │
                                                                                                                                                 │          d_date_sk        │              │              │         EC=1000032        │
                                                                                                                                                 │    EC = 2875334.400000    │              │              │                           │
                                                                                                                                                 │   COST = 2875334.400000   │              │              │                           │
                                                                                                                                                 └─────────────┬─────────────┘              │              └───────────────────────────┘                             
                                                                                                                                                 ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             
                                                                                                                                                 │        PARQUET_SCAN       ││        PARQUET_SCAN       │                             
                                                                                                                                                 │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                                                                                 │    cr_returned_date_sk    ││         d_date_sk         │                             
                                                                                                                                                 │  cr_returning_customer_sk ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             
                                                                                                                                                 │    cr_returning_addr_sk   ││  Filters: d_year=2001 AND │                             
                                                                                                                                                 │   cr_return_amt_inc_tax   ││     d_year IS NOT NULL    │                             
                                                                                                                                                 │        EC=14376672        ││          EC=8118          │                             
                                                                                                                                                 └───────────────────────────┘└───────────────────────────┘                                                          

